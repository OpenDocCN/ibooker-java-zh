# 前置内容

## 前言

“well-grounded”是指“全面发展”吗？两年的疫情就能做到这一点，无需这本书。

Merriam-Webster 将“well-grounded”定义为“拥有坚实的基础”。我喜欢这个定义。我们希望在 Java 上有一个坚实的基础——对我们称之为 Java 专家所需知识的实际了解。这本书从《Effective Java》结束的地方开始。

这是本优秀书籍的第二版。第一版教给我们所有关于 Java 7 所需知道的知识。那似乎是很久以前的事情了。Java 7 属于另一个时代，那时语言的最佳更新频率是每三年一次。当时，区分版本很容易。Java 5？泛型和枚举。Java 7？`try-with-resource`。Java 8？流和 lambda。那些舒适的简单日子在 Oracle 引入六个月周期时结束了。记录——那是 Java 14、15 还是 17？增强的 Switch？那不是已经在 Java 11 中了吗？

快速发布周期对于在冒险公司工作的程序员来说很棒。每六个月，他们就能得到新的玩具来玩耍。他们甚至可以尝试即将到来的预览。众多新特性对程序员来说很棒，但对作者来说就不那么好了。在墨水干透之前，新特性的发布就会使许多事物过时。

本、杰森和马蒂恩在这本新的 Java 书中做得非常出色。基本前提保持不变。用我的话说：“如果你想要雇佣一个专业的 Java 程序员，你期望他们已经知道什么？他们需要哪些技能来证明他们是基础扎实的？”

这本书的新版本尽可能与六个月一次的发布周期保持同步。同时，作者并没有用新内容压倒我们。残酷的现实是，大多数企业仍然停留在较旧的 Java 版本上。即使 Java 18 已经发布，许多银行、保险公司和政府部门仍然在使用 Java 8。

这本书比上一版多了大约 200 页。字体稍微大了一些——嗯，我们都已经老了九岁，不是吗？但页边距小了。相当多的章节内容完全更新。这是一个新版本并没有使旧版本过时的例子。两者都应放在一个严肃的 Java 程序员的书架上。

本杰明·J.埃文斯、杰森·R.克拉克和马蒂恩·弗伯格是 Java 专家。他们在红帽、New Relic 和微软担任高级 Java 职位。让我们利用他们的集体智慧。这本书将帮助我们发现我们可以改进的弱点。最终，通过足够的工作，我们可以称自己为*基础扎实的 Java 程序员*。

海因茨·卡布茨

Java 专家通讯

## 序言

这本书的第一版最初是一套为银行外汇部门的新毕业开发者编写的培训笔记。我们中的一人（本），在查看市场上的现有书籍时，发现缺乏针对想要提升水平的 Java 开发者的最新资料。在编写这些资料的过程中，他发现他正在编写那本缺失的书籍，并招募了 Martijn 来帮忙。

那是在 10 多年前——我们写作的时候 Java *7* 正在开发中——而现在的世界已经非常不同了。作为回应，自第一版以来，这本书已经发生了很大的变化。因此，尽管我们的最初主要目标是介绍诸如

+   多语言编程

+   依赖注入

+   多线程编程

+   声音构建和 CI 实践

+   Java 7 的新特性

当我们着手编写第二版时，我们发现需要做一些修改，包括

+   稍微减少多语言的使用

+   对函数式编程增加新的重视

+   加强对多线程的讨论

+   对构建和部署（包括容器）进行不同的处理

+   讨论 Java 11 和 17 的新特性

一个非常重要的变化是，第一版将 Scala 作为讨论的三种非 Java 语言之一（其他是 Groovy 和 Clojure——当时 Kotlin 实际上并不存在）。当时，许多探索 Scala 的开发者正在寻找“Java，但更好的捕鼠器”，这本质上是我们第一版中提出的 Scala 的观点。

然而，从那时起，世界已经发展。Java 8 和 11 变得极其流行，而“更好的捕鼠器”团队大多在编写 Kotlin（或者只是坚持使用 Java）。与此同时，Scala 已经变成了一种非常强大的静态类型、以函数式编程为第一语言的 JVM 语言。这对那些想要的人来说是好事，但它也带来了成本，比如越来越复杂的运行时和随着时间的推移与 Java 越来越少的共同之处。

这种发展有时被简称为“Scala 想在 JVM 上成为 Haskell”，尽管这并不完全准确，而更多的是一种方便的对话简语。因此，在决定从第二版中删除 Groovy 后，我们深思熟虑地考虑了是否保留 Scala 或用 Kotlin 替换它。

我们最终得出的结论基本上是 Scala 正朝着自己的、以函数式编程为重点的方向发展，而我们希望展示一种对刚开始接触非 Java 语言（如 Kotlin）的 Java 开发者来说更容易接近的语言。这让我们陷入了困境。Scala 中 Java 开发者容易接触到的部分与 Kotlin 非常相似（在某些情况下语法几乎相同），但两种语言的哲学和方向完全不同。我们觉得，在书中充分解释 Scala*是什么*——以便覆盖范围与 Kotlin 不同——会占用太多的空间。

因此，我们最终的决定是从三种语言减少到两种额外的语言，为剩余的语言（Kotlin 和 Clojure）的覆盖范围腾出空间并增加深度。因此，尽管我们偶尔会评论 Scala，但我们并没有为其分配整个部分（更不用说章节）。

Clojure 与 Kotlin 或 Java 相比，是一个完全不同的故事——实际上，它是一种非常不同的语言。例如，在第十五章中，我们遇到了一些困难，因为我们在其他语言中介绍的大多数概念（例如，高阶函数和递归）已经在 Clojure 中介绍过，并且只是“风景的一部分”。我们并没有遵循 Java 和 Kotlin 使用的模板，讨论的方向是不同的。Clojure 从根本上讲，是一种功能导向性更强的语言，如果我们遵循与其他语言完全相同的结构，我们只会重复很多次。

在这本书中，我们希望软件开发作为一种社会活动的主题能够清晰地展现出来。我们相信工艺的技术方面很重要，但人与人之间的沟通和互动的微妙之处至少同样重要。在书中轻松地解释这些方面可能有些困难，但这个主题贯穿始终。

开发者通过与技术互动和对持续学习的热情来维持他们的职业生涯。在这本书中，我们希望我们已经能够突出一些能够激发这种热情的话题。这是一次观光之旅，而不是百科全书式的研究，但这是我们的意图——让你开始，然后让你继续关注那些激发你想象的话题。

我们带你从 Java 最新版本的特性到现代软件开发的最佳实践，再到平台的发展前景。在这个过程中，我们展示了在我们作为 Java 技术人员的旅程中具有相关性的亮点。

并发、性能、字节码和类加载是我们最感兴趣的几个核心技术。我们也讨论了在 JVM 上运行的新非 Java 语言，原因有两个：

+   非 Java 语言在整体 Java 生态系统中继续获得重要性。

+   理解不同语言带来的不同视角可以使你在任何你使用的语言中成为一个更好的程序员。

首先，这是一次面向未来的旅程，将你和你自己的兴趣放在首位。我们相信，成为一个扎实的 Java 开发者将帮助你保持参与感和对自身发展的控制，并帮助你更多地了解 Java 及其周围不断变化的世界。我们希望你手中的浓缩经验对你有用且有趣，阅读它能够引发思考并带来乐趣。写作它当然也是这样！

## 致谢

我们还想要感谢以下人员对本书的贡献：

艾莱莎·海德，感谢您作为一位杰出的开发编辑；乔纳森·汤姆森，感谢他在技术审阅中的出色工作；亚历克斯·巴克利，感谢他对类加载过程的详细讨论；海因茨·卡布茨，感谢他对并发章节细节的出色建议和讨论（甚至还有 PRs！）以及另一篇精彩的序言；霍莉·卡明斯，不仅因为帮助激发原始版本，还因为她始终如一、切实可行的建议；布鲁斯·达林，感谢他对 Clojure 材料的讨论；丹·海丁，感谢他对瓦尔哈拉项目当前状态的详细反馈；皮奥特·雅吉尔斯基、路易斯·雅科梅、约瑟夫·巴托克和汤姆·特雷桑斯基，感谢他们对 Gradle 实际工作方式的一些细节的纠正；以及安德鲁·宾斯托克，感谢他对几章内容的非常细致的阅读和一贯的明智建议。

我们还想要感谢曼宁出版社的员工：米哈伊拉·巴蒂尼奇，我们的审阅编辑；迈克尔·哈勒，我们的技术审阅员；迪尔德丽·希姆，我们的项目编辑；帕梅拉·亨特，我们的校对员；以及贾森·埃弗雷特，我们的校对员。对所有审阅者：亚当·科赫、阿兰·洛姆波、亚历克斯·古特、安德烈斯·萨科、安迪·凯法拉斯、安舒曼·普鲁希特、艾什莉·伊特利、克里斯蒂安·索达尔、克里斯托弗·卡德尔、克劳迪娅·马德尔特纳、科诺尔·雷德蒙德、艾尔凡·乌拉赫博士、埃杜·梅伦德斯·冈萨雷斯、埃兹拉·西梅洛夫、乔治·托马斯、吉尔贝托·塔卡里、雨果·达·席尔瓦·波萨尼、伊戈尔·卡普、贾里德·邓肯、贾维德·阿萨罗夫、让-弗朗索瓦·莫林、杰罗姆·梅耶、肯特·R·斯皮尔纳、金伯利·L·温斯顿-杰克逊、康斯坦丁·埃雷明、马特·迪梅尔、迈克尔·哈勒、迈克尔·沃尔、米哈伊尔·科瓦列夫、帕特里夏·吉、拉马南·纳塔拉扬、拉斐尔·维莱拉、萨特杰·库马尔·萨胡、塞尔吉奥·埃德加·马丁内斯·帕切科、西蒙娜·鲁索、史蒂文·K·马库恩扎瓦、塞奥法尼斯·德索皮迪斯、特罗伊·艾斯勒、约什·谢蒂和威廉·E·惠勒，你们的建议帮助使这本书变得更好。

### 来自贾森

感谢许多不同的人多年来对本书的贡献。

向尼莫夫人，感谢你在中学英语课上对我的那些愚蠢小故事给予的额外加分。毫不夸张地说，你的鼓励让我走上了终身写作的道路。

向妈妈，感谢你那感染力极强的阅读热情，我很高兴继承了它。

致爸爸，感谢您分享您对计算机的热爱。这不仅仅为我提供了一份职业，还让我有机会将这份喜悦与他人分享。

致本，首先感谢您的友谊。能够因为您那令人惊叹的好奇心和热情而更深入地了解 JVM，真是件乐事。当然，感谢您邀请我参与第二版。这比我们预期的要辛苦得多，但最终也成了一本更好的书！

最后但同样重要的是，感谢我的妻子，艾梅柏，以及我的孩子们，科拉琳和艾舍尔，在整个制作书籍的奇特而美妙的过程中，他们一直给予我持续的爱和支持。

### 来自马蒂恩

首先，我想感谢本和贾森邀请我成为这个第二版的参与者。与他们的贡献相比，我的贡献微乎其微，但他们非常慷慨地坚持我的名字仍然出现在封面上！

致凯里，在过去十年的职业生涯中，你一直是我的坚强后盾，不仅在我表示“这次只是几处编辑，我保证！”时微笑着回应。

致亨特，你对生活的热情让我想起了我最初为什么会对编程的创造性乐趣产生兴趣。我希望无论你选择什么道路，你都能在生活中找到同样的快乐。

致微软 Java 工程组的优秀成员，Eclipse Adoptium 社区，伦敦 Java 社区，Java 冠军社区，以及太多无法一一提及的人。你们每天都激励着我，我每天都带着学到的新知识和第二天要读的五件事离开！

### 来自本

致我的父母，苏和马丁，感谢他们坚定不移的信念，相信我们会找到并开辟一条少有人走的路。

致我的妻子安娜，感谢她的插图，她的艺术视野，以及她在另一本书中给予我的不懈支持和理解。

纪念玛丽安托，在本书开发过程中，他发现那些被遗忘的笔记本电脑可以成为温暖的小窝，在上面睡觉非常舒适。

致约塞利托，他通过好奇我为什么会坐在屏幕前如此着迷，而那个屏幕比另一个房间里那个有宇宙飞船和爆炸的屏幕有趣得多，从而克服了一些恐惧。

## 关于这本书

### 谁应该阅读这本书？

欢迎来到《扎实的 Java 开发者》。这本书旨在让你成为下一个十年的 Java 开发者，重新点燃你对语言和平台的热情。在这个过程中，你会发现新的 Java 特性，确保你熟悉必要的现代软件技术（如测试驱动开发、基于容器的部署），并开始探索 JVM 上的非 Java 语言世界。

首先，让我们考虑詹姆斯·艾里在精彩的博客文章《编程语言简短、不完整且大多错误的历史》中提供的 Java 语言描述，该文章可在[`mng.bz/2rz9`](http://mng.bz/2rz9)找到：

1996 年——詹姆斯·戈斯林发明了 Java。Java 是一种相对冗长的、垃圾回收的、基于类的、静态类型的、单派发、面向对象的语言，具有单一实现继承和多重接口继承。Sun 大声宣扬 Java 的新颖性。

虽然 Java 的介绍主要是为了设置一个玩笑，让 C#得到同样的描述，但就语言描述而言，这并不坏。完整的博客文章包含了许多其他珍贵的宝石，在空闲时刻阅读它是非常值得的。

这确实提出了一个非常现实的问题：为什么我们还在谈论一个现在已经超过 26 年的语言？当然，它已经稳定，关于它的新鲜或有趣的内容不多？

如果是这样，这将是一本短书。我们还在谈论它，因为 Java 最大的优势之一就是其能够建立在几个核心设计决策之上，这些决策在市场上已被证明非常成功：

+   运行时环境的自动管理（例如，垃圾收集、即时编译）

+   核心语言中的简单语法和相对较少的概念

+   对语言演变的保守态度

+   库中的附加功能和复杂性

+   广泛的开放生态系统

这些设计决策使 Java 世界中的创新得以持续——简单的核心保持了加入开发者社区的门槛较低，广泛的生态系统使得新来者能够轻松找到符合他们需求的现有组件。这些特性使 Java 平台和语言保持强大和充满活力——即使语言有历史性地倾向于缓慢变化。事实证明，强大的一致性和进化变化的结合赢得了许多软件开发者的喜爱。

### 如何使用这本书

本书的内容设计得可以从头到尾阅读，但我们理解有些读者可能希望直接深入研究特定主题，因此我们尽力也满足了这种阅读风格。

我们坚信实践学习，因此我们建议读者在阅读文本的同时尝试书中提供的示例代码。本节的其余部分将讨论如果你更倾向于独立章节风格的阅读，你可以如何接近这本书。

《扎实的 Java 开发者》分为以下五个部分：

+   从 8 到 11，以及更远的地方

+   内部机制

+   JVM 上的非 Java 语言

+   构建和部署

+   Java 前沿

第一部分（第 1-3 章）包含关于 Java 最新版本的三个章节。整本书始终使用 Java 11 语法和语义，并指出对 11 版之后语法的具体应用。

第二部分（第 4-7 章）揭开了一层面纱。艺术的一个真理是，在能够令人信服地打破规则之前，需要了解这些规则。这些章节概述了如何首先弯曲，然后打破 Java 编程语言的规则。

第三部分（第 8-10 章）涵盖了 JVM 上的多语言编程。第八章应被视为必读内容，因为它通过讨论 JVM 上替代语言的分类和使用来设定舞台。

以下两个语言章节涵盖了一种类似 Java 的面向对象函数式语言（Kotlin）和一种真正的函数式语言（Clojure）。这些语言可以独立阅读，尽管对于初学函数式编程的开发者来说，可能希望按顺序阅读它们。

第四部分（第十一章至第十四章）介绍了在现代项目中如何进行构建、部署和测试，并假设读者至少对单元测试有基本了解，例如 JUnit。

第五部分（第十五章至第十八章）基于之前介绍的主题，深入探讨函数式编程、并发和平台内部结构。尽管这些章节可以独立阅读，但在某些部分，我们假设你已经阅读了前面的章节，或者已经对某些主题有所了解。

这本书旨在帮助想要在语言和平台两方面更新其知识库的 Java 开发者。如果你想了解现代 Java 能提供什么，这本书就是为你准备的。

如果你想要提高自己在函数式编程、并发和高级测试等主题上的技巧和理解，这本书将为你提供这些主题的良好基础。这也是一本适合那些对非 Java 语言能教给他们什么以及拓宽视野将如何使他们成为更好的程序员感到好奇的开发者的书。

### 关于代码

你需要下载和安装的是 Java 17（或 11）。只需按照适用于你使用的操作系统的二进制文件的下载和安装说明操作即可。你可以在你常用的 Java 供应商网站上找到二进制文件和说明，或者在由 Eclipse 基金会运营的中立供应商项目 Adoptium 上找到，网址为[`adoptium.net/`](https://adoptium.net/)。

Java 11（以及 17）可以在 Mac、Windows、Linux 以及几乎任何其他现代操作系统和硬件平台上运行。

注意：如果你对 Java 许可等细节问题感到担忧，可以查看附录 A，那里有完整的讨论。

这本书包含了大量的源代码示例，既有编号列表中的，也有与普通文本混排的。在两种情况下，源代码都以`固定宽度`的`字体`格式化，如`this`，以将其与普通文本区分开来。

在许多情况下，原始源代码已经被重新格式化；我们添加了换行并重新调整了缩进，以适应书籍中的可用页面空间。此外，当代码在文本中描述时，源代码中的注释通常已被从列表中删除。许多列表旁边都有代码注释，突出显示重要概念。

你可以从这本书的 liveBook（在线）版本中获取可执行的代码片段，网址为[`livebook.manning.com/book/the-well-grounded-java-developer-second-edition`](https://livebook.manning.com/book/the-well-grounded-java-developer-second-edition)。书中示例的完整代码可以从 Manning 网站[`www.manning.com/books/the-well-grounded-java-developer-second-edition`](https://www.manning.com/books/the-well-grounded-java-developer-second-edition)下载，也可以从 GitHub[`github.com/well-grounded-java/resources`](https://github.com/well-grounded-java/resources)下载。

然而，大多数读者可能希望在一个 IDE 中尝试代码示例。Java 11/17 以及主要 IDE 的最新版本都很好地支持了 Kotlin 和 Clojure：

+   Eclipse IDE

+   IntelliJ IDEA 社区版（或终极版）

+   Apache NetBeans

### liveBook 讨论论坛

购买《精通 Java 开发者，第 2 版》包括免费访问 liveBook，曼宁的在线阅读平台。使用 liveBook 的独特讨论功能，您可以在全球范围内或特定章节或段落中附加评论。为自己做笔记、提出和回答技术问题以及从作者和其他用户那里获得帮助都非常简单。要访问论坛，请访问[`livebook.manning.com/book/the-well-grounded-java-developer-second-edition/discussion`](https://livebook.manning.com/book/the-well-grounded-java-developer-second-edition/discussion)。您还可以在[`livebook.manning.com/discussion`](https://livebook.manning.com/discussion)了解更多关于曼宁论坛和行为准则的信息。

曼宁对读者的承诺是提供一个场所，让读者之间以及读者和作者之间可以进行有意义的对话。这不是对作者参与特定数量活动的承诺，作者对论坛的贡献仍然是自愿的（且未付费）。我们建议您尝试向作者提出一些挑战性的问题，以免他们的兴趣转移！只要这本书有售，论坛和以前讨论的存档将可通过出版社的网站访问。

### 其他在线资源

[`github.com/well-grounded-java/resources`](https://github.com/well-grounded-java/resources)

## 关于作者

![Evans.png](img/Evans.png)

本·埃文斯是 Java 冠军和红帽公司的资深软件工程师。之前他是 New Relic 仪器部门的负责人，并与 jClarity 共同创立，这是一家被微软收购的性能工具初创公司。他还曾担任德意志银行上市衍生品的首席架构师，以及摩根士丹利的资深技术讲师。他在 Java 社区进程执行委员会工作了六年，帮助定义新的 Java 标准。

本是六本书的作者，包括《Java 优化》和《Java 精华》的新版，他的技术文章每月被成千上万的开发者阅读。本是一位经常在世界各地的公司和会议上就 Java 平台、系统架构、性能和并发等主题发表演讲和教育的专家。

![Clark.png](img/Clark.png)

贾森·克拉克是新 relic 的首席工程师和架构师，在那里他参与了从 Ruby 仪器库到容器编排平台的所有工作。他之前是 WebMD 的架构师，负责基于.NET 的 Web 服务。

作为一位常任会议演讲者，Jason 为开源项目 Shoes 做出贡献，旨在使 GUI 编程对初学者和学生来说既简单又有趣。

![](img/Verburg.png)

Martijn Verburg 是微软 Java 工程组的首席 SWE 团队经理。他是伦敦 Java 用户组（即 LJC）的共同领导者，在那里他与他人共同创立了 AdoptOpenJDK（现在是 Eclipse Adoptium），这是世界上领先的（非 Oracle）OpenJDK 发行版。Martijn 是《扎实的 Java 开发者，第 1 版》的共同作者，并担任多个 Java 标准机构（JCP、Jakarta EE 等）的成员。

## 关于封面插图

《扎实的 Java 开发者》封面上的插图“花束售卖者”是从 Sylvain Maréchal 的十九世纪地区服饰习俗汇编中取材的，该汇编在法国出版。

在那些日子里，人们通过他们的服饰就能轻易地识别出他们的居住地以及他们的职业或社会地位。Manning 通过基于几个世纪前丰富多样的地区文化的书封面来庆祝计算机行业的创新精神和主动性，这些文化通过像这样的一些图片被重新带回生活。
