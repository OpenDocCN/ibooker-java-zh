# 前言

这本书提出了一种分阶段的方法来构建和部署更可靠的 Java 微服务。每一章介绍的功能都应该按顺序执行，每个功能都是建立在前面章节功能基础之上的。在这个旅程中有五个阶段：

1.  为可用性测量和监控你的服务。

1.  添加调试信号，让你能够询问关于不可用期间的问题。

1.  改进你的软件交付流水线，以减少引入更多故障的机会。

1.  构建能力，观察部署资产的状态一直到源代码。

1.  添加足够的流量管理，将你的服务提升到你满意的可用性水平。

我们的目标不是建立一个完美的系统，消除所有的故障。我们的目标是最终拥有一个高度可靠的系统，并避免在递减回报的空间中花费时间。

避免递减回报是我们将花费如此多时间谈论有效的测量和监控的原因，以及为什么这个学科在所有其他学科之前。

如果你是一名工程管理人员，第一章就是你的使命宣言：建立一个以可靠性和有效的平台工程团队文化而闻名的应用平台，该团队可以将这些能力传递给更广泛的工程组织。

接下来的章节包含了实现这一使命的蓝图，针对工程师进行了定位。这本书故意将范围限定在*Java*微服务上，以便我可以提供关于如何做到这一点的详细建议，包括针对 Java 微服务经过战斗考验的具体测量数据、代码示例和其他像依赖管理这样的与 Java 虚拟机（JVM）独有的特殊问题。它的重点是立即可操作的。

# 我的旅程

我在软件工程领域的职业旅程形成了一条弧线，最终导致我写下了这本书：

+   一个积极进取的自定义软件初创公司

+   一个名为密苏里的 Shelter Insurance 的传统保险公司

+   硅谷的 Netflix

+   一位远程工作的 Spring 团队工程师

+   一位 Gradle 工程师

当我离开 Shelter Insurance 时，尽管我努力过，我并不理解公共云。在那里的近七年中，我与同一组命名的虚拟机（实际上是裸金属，最初）进行了互动。我习惯于季度发布周期和发布前广泛的手动测试。我觉得领导强调并再次强调我们对代码冻结的期望有多“艰难”，以及在发布后代码冻结不如我们希望的那样严格，等等。我从未经历过应用程序的生产监控——这是网络运营中心的责任，我的门禁卡不需要我知道那里发生了什么。从大多数标准来看，这个组织是成功的。自那时以来，在某些方面它发生了重大变化，而在其他方面几乎没有变化。我很感谢在那里有机会向一些了不起的工程师学习。

在 Netflix，我学到了有关工程和文化的宝贵经验。一段时间后，我带着对能够将这些实践应用于像 Shelter Insurance 这样的公司的希望加入了 Spring 团队。当我创建开源度量库 Micrometer 时，我深深感激于这样一个事实：组织是一个旅程。Micrometer 的前五个监控系统实现中包含三个我知道仍然广泛使用的传统监控系统，而不仅仅是支持当今最佳的监控系统。

数年来，与各种规模的企业合作并为其提供关于应用程序监控和交付自动化的建议，使我了解了组织动态的多样性及其共性。我理解到这些共性，即每个企业都能从中受益的实践和技术，构成了本书的实质内容。每个企业的 Java 组织都可以在一定的时间和实践下应用这些技术。这包括你的组织。

# 本书中使用的约定

本书中使用以下排版约定：

*斜体*

表示新术语、URL、电子邮件地址、文件名和文件扩展名。

`固定宽度`

用于程序清单，以及段落中引用的程序元素，如变量或函数名、数据库、数据类型、环境变量、语句和关键字。

**`固定宽度粗体`**

显示用户应直接输入的命令或其他文本。

*`固定宽度斜体`*

显示应由用户提供的值或由上下文确定的值替换的文本。

###### 提示

这个元素表示一个提示或建议。

###### 注意

这个元素表示一般注释。

###### 警告

这个元素表示警告或注意事项。


# 致谢

Olga Kundzich

在写这本书之前，我不知道一个作者同事圈子的声音会如何渗入书中。当然这完全说得通。我们通过共同工作相互影响！Olga 在广泛话题上的深刻见解，在过去几年对我的思维产生了最大的单一影响，她的声音无处不在这本书中（至少是我能够代表的最好的近似）。你会在书中找到关于“应用平台”、“持续交付”（不，不是持续部署——我总是混淆这两个词）、资产清单、监控以及流量管理的想法，这些都深受她的影响。谢谢 Olga 为这本书投入如此多的精力。

Troy Gaines

对于 Troy，我要感谢他最初介绍我依赖管理、构建自动化、持续集成、单元测试等许多其他重要技能。他是我作为软件开发人员成长的早期和重要影响，我知道他也对许多其他人有着同样的影响。谢谢你，老朋友，花时间审阅这份工作。

Tommy Ludwig

Tommy 是少有的既对分布式跟踪又对聚合度量技术做出贡献的遥测专家之一。在可观察性领域，贡献者通常会过于专注于某个领域，而 Tommy 是少数几个在它们之间游走的人之一。委婉地说，我害怕 Tommy 对第三章的审阅，但很高兴发现我们在这方面的共同点比我预期的要多。感谢指出分布式跟踪标签基数的更微妙观点，这些观点已经进入第三章。

Sam Snyder

我还不认识 Sam 多久，但我很快就明白 Sam 是一个优秀的导师和耐心的老师。谢谢 Sam 同意承担审阅技术书籍这一艰巨任务，并留下了许多积极和鼓励的反馈。

Mike McGarr

我在 2014 年收到了 Mike 的一封突然的电子邮件，不久之后，我就收拾了一切，搬到了加利福尼亚。那封电子邮件使我走上了一条改变一切的道路。我认识了 Netflix 的许多专家，因为 Mike 给了我一个机会，加速了我的学习过程。这彻底改变了我对软件开发和运维的看法。Mike 也是一个了不起的人——一个友善好奇的朋友和领导。谢谢，Mike。

Josh Long

书中有一次，我引用了 Josh Long 关于“没有像”产品的典型说法。我以为我很机智，很有趣。然后 Josh 写了一篇以巴斯光年为特色的序言……Josh 是一股不可阻挡的能量。谢谢 Josh，因为你为这项工作注入了一些那种能量。
