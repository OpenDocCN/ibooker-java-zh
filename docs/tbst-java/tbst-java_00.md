# 前置内容

## 前言

软件开发者实际上是如何谋生的？对于这个问题，“实现软件”是最常见的答案。但这意味着什么？仅仅是编写代码吗？好吧，不是的。虽然代码确实是软件开发者所做的一切的结果，但编写代码的活动只占软件开发者工作时间的一小部分。软件开发者的大部分时间实际上用于设计解决方案、阅读现有代码、理解其执行方式以及学习新事物。编写代码是软件开发者成功完成所有这些任务的结果。因此，程序员的大部分时间都在阅读现有解决方案，而不是有效地编写新的功能。

清洁编码作为一个主题，最终具有相同的目的：教导开发者如何编写更易于阅读的解决方案。开发者意识到，从一开始就编写一个易于阅读的解决方案比花时间试图理解它更有效率。但我们需要诚实并承认，并非所有解决方案都足够干净，可以快速理解。我们总会遇到需要理解某些外部功能执行的场景。

事实上，软件开发者花费大量时间研究应用程序的工作原理。他们阅读并检查应用程序代码库和相关依赖项中的代码，以弄清楚为什么某些事情没有按预期工作。开发者有时阅读代码只是为了了解或更好地理解某个特定的依赖项。在许多情况下，阅读代码是不够的，您必须找到替代（有时更复杂）的方法来弄清楚您的应用程序做了什么。为了理解环境如何影响您的应用程序或您的 Java 应用程序运行的 JVM 实例，您可以使用性能分析、调试和日志调查的组合。如果您对您的选项了如指掌，并且知道如何从中选择，您将节省宝贵的时间。记住，这是开发者花费大部分时间在做的事情。这种开发活动可以非常有益。

我设计这本书是为了帮助人们优化他们调查软件开发挑战的方式。在书中，您将找到最相关的调查技术，这些技术将通过示例应用。我们将讨论调试、性能分析、使用日志以及有效地结合这些技术。在整个书中，我会给您提供有价值的技巧和窍门，帮助您提高效率并更快地解决问题（即使是那些最困难的）。换句话说，这本书的总体目的是让您作为一个开发者变得更加高效。

我希望这本书能给您带来显著的价值，并帮助您在快速找到您调查问题的根本原因方面变得更加高效。

## 致谢

没有在本书的开发过程中给予我帮助的许多聪明、专业和友好的人，这本书是不可能完成的。

我要向我的妻子丹妮拉表示衷心的感谢，她一直在我身边，提供了宝贵的意见，并持续地支持和鼓励我。我还想特别感谢所有给予我宝贵建议的同事和朋友，他们的建议帮助我在最初的目录和提案中取得了进展。

我要感谢整个 Manning 团队在制作这本有价值的资源中所提供的巨大帮助。我特别想感谢玛琳娜·迈克尔、尼克·沃茨和让-弗朗索瓦·莫林，他们表现出极大的支持和专业性。他们的建议为这本书增添了巨大的价值。感谢迪尔德丽·希姆，我的项目经理；米歇尔·米切尔，我的校对编辑；以及凯蒂·滕南特，我的校对员。

我要感谢我的朋友伊奥安娜·戈兹为本书创作的插图。她将我的想法变成了书中你将看到的卡通画。

我还要感谢所有审阅手稿并提供有用反馈的人，这些反馈帮助我改进了本书的内容。我特别想感谢 Manning 的审稿人——亚历克斯·古特、亚历克斯·祖罗夫、阿姆拉赫·乌穆德卢、阿南德·纳塔拉扬、安德烈斯·达米安·萨科、安德烈·斯托西克、阿尼迪亚·邦多帕达亚、阿图尔·斯里尼瓦斯·霍特、贝基·胡特、邦妮·马莱克、布伦特·霍纳德尔、卡尔·霍普、卡塔林·马泰伊、克里斯托弗·卡德尔、西塞罗·赞多纳、科西莫·达米亚诺·普雷特、丹尼尔·R·卡尔、德舒旺·唐、费尔南多·伯纳迪诺、加博尔·哈贾、加瓦·图利、贾姆佩罗·格兰特莱拉、乔治·齐克拉乌里、戈文达·萨班穆里、哈里尔·卡拉科塞、雨果·费盖雷多、雅各波·比斯凯拉、詹姆斯·R·伍德鲁夫、杰森·李、贾维德·阿萨罗夫、让-巴普蒂斯特·邦·恩特梅、杰罗恩·范·威尔根堡、约尔·卡普林、尤尔格·马蒂、克日什托夫·卡米切克、拉蒂夫·本齐内、莱昂纳多·戈梅斯·达·席尔瓦、马诺杰·雷迪、马库斯·盖塞尔、马特·迪梅尔、马特·韦尔克、迈克尔·科莱斯迪斯、迈克尔·沃尔、米哈尔·奥斯亚克、奥利弗·科滕、奥卢布尼米·奥贡萨尼、帕奥洛·布鲁纳斯蒂、彼得·萨博斯、普拉布蒂·普拉卡什、拉杰什·巴拉莫汉、拉杰什·莫哈南、拉韦什·夏尔马、鲁本·冈萨雷斯-鲁比奥、阿布杜·萨马杜·萨雷、西梅翁·莱泽尔松、西蒙内·卡菲罗、斯瓦万蒂·雷迪、斯维塔·纳图、谭伟、谭儒夫、特拉维斯·尼尔森、亚科夫·博格列夫和尤里·克莱曼——以及给予我建议的朋友们：玛丽亚·奇图、阿德里安·布图鲁加、米切拉·瓦卡里乌克、卡塔林·马泰伊。

## 关于本书

### 谁应该阅读这本书

自从你打开这本书以来，我假设你是一位使用 JVM 语言的开发者。你可能使用 Java，但也可能使用 Kotlin 或 Scala。无论你使用哪种 JVM 语言，你都会发现这本书的内容很有价值。它教你相关的调查技巧，你可以使用这些技巧来识别问题的根本原因（即错误），以及如何轻松学习新技术。作为一名软件开发者，你可能已经注意到你在理解应用程序做什么上花费了大量的时间。像其他开发者一样，你可能花更多的时间阅读代码、调试或使用日志，而不是编写代码。那么，为什么不在你工作日中做得最多的事情上变得更加高效呢？

在这本书中，我们将讨论并应用以下主题的例子：

+   简单和高级调试技术

+   高效使用日志来理解应用行为

+   性能分析 CPU 和内存资源消耗

+   性能分析以找到执行代码

+   性能分析以了解应用如何与持久数据交互

+   分析应用之间如何相互通信

+   监控系统事件

无论你的经验如何，你会发现这本书在学习新的调查技术时很有帮助，或者如果你已经是一位经验丰富的开发者，你会发现这是一本很好的复习资料。

阅读本书的先决条件是理解 Java 语言的 basics。我故意使用 Java 设计了所有示例（即使它们适用于任何 JVM 语言），以确保一致性。如果你对 Java 有基本的理解（类、方法、基本的指令，如决策性或重复性指令以及声明变量），你应该能够理解书中的讨论。

### 本书如何组织：路线图

本书分为三部分，共涵盖 12 章。我们将从调试技术开始讨论（在本书的第一部分），讨论并应用简单和更高级的调试技术，并讨论你可以在调查各种场景时如何使用它们来节省时间。我选择从调试开始讨论，因为这是在调查应用在开发阶段某些功能行为时通常的第一步。有些人问我为什么我没有从日志开始，因为它们是生产问题调查的第一种技术。虽然这是真的，但开发者在开始实现功能时必须处理调试器，所以我认为章节的更好安排是从调试技术开始。

在第一章中，我们讨论了本书讨论的调查技术的相关性，并制定了一个学习它们的计划。第 2、3 和 4 章专注于调试，并教你相关的技能，从添加简单的断点到在远程环境中调试应用。第五章，是第一部分的最后一章，讨论了日志。调试和使用日志是构建应用程序最简单（且最常用）的调查技术。

本书第二部分讨论了性能分析技术。普遍观点认为，与调试和研究日志相比，性能分析在现代应用中更为高级且使用较少。虽然我同意性能分析更为高级，但我将展示你可以使用许多性能分析技术来更有效地调查现代 JVM 应用中的问题或研究被认为是必需的框架。

第六章开启了本书的第二部分，讨论了识别您的应用程序在管理 CPU 和内存资源方面是否存在故障。第七章详细介绍了这个主题，并展示了如何找到导致特定延迟的应用程序部分，以及如何观察应用程序在特定时间执行的内容。在第六章和第七章中，我们使用了 VisualVM，这是一个免费工具。第八章继续第七章的讨论，并使用更高级的视觉工具，这些工具通常只有通过授权的剖析工具才能获得。对于本章讨论的细节，我们使用了 JProfiler，这不是一个免费使用的工具。

第九章和第十章专注于更微妙的剖析技术。您将学习到可以在处理应用程序执行背后的多线程架构中深藏的问题时节省时间的技能。第十一章通过解决如何调查应用程序的内存管理来结束第二部分。

本书以第三部分结束，这部分仅有一章：第十二章。在这一章中，我们超越了单个应用程序的边界，讨论了由多个应用程序组成的广泛系统中调查问题的方法。

章节的顺序是我推荐您阅读的顺序，但每个章节都专注于不同的主题。因此，如果您对某个特定主题感兴趣，可以直接跳转到该章节。例如，如果您对调查内存管理问题感兴趣，可以直接跳转到第十一章。

### 关于代码

本书包含许多源代码示例，无论是编号列表还是与普通文本并列。在这两种情况下，源代码都使用`固定宽度字体`如这样来格式化，以将其与普通文本区分开来。有时代码也会**`加粗`**，以突出显示与章节中先前步骤不同的代码，例如当新功能添加到现有代码行时。

在许多情况下，原始源代码已被重新格式化；我们添加了换行符并重新整理了缩进，以适应书中的可用页面空间。在极少数情况下，即使这样也不够，列表中还包括了行续符（➥）。此外，当代码在文本中描述时，源代码中的注释通常也会从列表中删除。代码注释伴随着许多列表，并突出显示重要概念。

您可以从本书的在线版本（liveBook）中获取可执行的代码片段，网址为[`livebook.manning.com/book/troubleshooting-java`](https://livebook.manning.com/book/troubleshooting-java)。本书中示例的完整代码可以从 Manning 网站[www.manning.com](https://www.manning.com)下载。

### liveBook 讨论论坛

购买《Java 故障排除》包括对 Manning 的在线阅读平台 liveBook 的免费访问。使用 liveBook 的独特讨论功能，您可以在全球范围内或针对特定章节或段落添加评论。为自己做笔记、提问和回答技术问题，以及从作者和其他用户那里获得帮助都非常方便。要访问论坛，请访问[`livebook.manning.com/book/troubleshooting-java/discussion`](https://livebook.manning.com/book/troubleshooting-java/discussion)。您还可以在[`livebook.manning.com/discussion`](https://livebook.manning.com/discussion)了解更多关于 Manning 论坛和行为准则的信息。

Manning 对我们读者的承诺是提供一个场所，在那里个人读者之间以及读者与作者之间可以进行有意义的对话。这不是对作者参与特定数量活动的承诺，作者对论坛的贡献仍然是自愿的（且未付费）。我们建议您尝试向他提出一些挑战性的问题，以免他的兴趣转移！只要这本书有售，论坛和以前讨论的存档将可通过出版商的网站访问。

### 作者在线

我建议您在线与我保持联系。您肯定会在我的 YouTube 频道[youtube.com/c/laurentiuspilca](https://www.youtube.com/c/laurentiuspilca)上找到大量与 Java 应用故障排除相关的优质学习材料，您也可以在 Twitter 上关注我 @laurspilca。

## 关于作者

![图片](img/spilca.png)

Laurențiu Spilcă是 Endava 的一名专注的开发主管和培训师，他在那里负责领导并咨询来自欧洲、美国和亚洲多个地点的多个项目。自 2007 年以来，他一直在软件开发领域工作。Laurențiu 认为，不仅要提供高质量的软件，还要分享知识并帮助他人提升技能是至关重要的。这种信念驱使他设计和教授与 Java 技术相关的课程，并举办演讲和研讨会。Laurențiu 还是《Spring Security in Action》（Manning，2020）一书的作者，他最近完成了《Spring Start Here》（Manning，2021）。

## 关于封面插图

《Java 故障排除》封面上的图像是“Homme de l’Istrie”，或“伊斯特里亚人”，取自 Jacques Grasset de Saint-Sauveur 的作品集，该作品集于 1797 年出版。每一幅插图都是手工精心绘制和着色的。

在那些日子里，人们通过他们的服饰很容易就能识别出他们住在哪里，以及他们的职业或社会地位。Manning 通过基于几个世纪前丰富多样的地区文化的封面，以及像这样的作品集中的图片，来庆祝计算机行业的创新精神和主动性。
