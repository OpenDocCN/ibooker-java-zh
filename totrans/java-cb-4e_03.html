<html><head></head><body><section data-pdf-bookmark="Chapter 3. Strings and Things" data-type="chapter" epub:type="chapter"><div class="chapter" id="javacook-strings">&#13;
<h1><span class="label">Chapter 3. </span>Strings and Things</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="3.0 Introduction" data-type="sect1"><div class="sect1" id="javacook-strings-intro">&#13;
<h1>3.0 Introduction</h1>&#13;
&#13;
<p><a data-primary="strings" data-type="indexterm" id="str_ch"/><a data-primary="strings" data-secondary="about" data-type="indexterm" id="idm45290704853528"/>Character strings are an inevitable part of just about any programming task. We use them for printing messages for the user; for referring to files on disk or other external media; and for people’s names, addresses, and affiliations. The uses of strings are many, almost without number (actually, if you need numbers, we’ll get to them in <a data-type="xref" href="ch05.html#javacook-numbers">Chapter 5</a>).</p>&#13;
&#13;
<p>If you’re coming from a programming language like C, you’ll need to remember that <code>String</code> is a defined type (class) in Java—that is, a string is an object and therefore has methods. It is not an array of characters (though it contains one) and should not <span class="keep-together">be thought</span> of as an array. Operations like <code>fileName.endsWith(".gif")</code> and <span class="keep-together"><code>extension.equals(".gif")</code></span> (and the equivalent "<code>.gif".equals(extension)</code>) are <span class="keep-together">commonplace.</span><sup><a data-type="noteref" href="ch03.html#idm45290704847128" id="idm45290704847128-marker">1</a></sup></p>&#13;
&#13;
<p>Java old-timers should note that Java 11 and 12 added several new <code>String</code> methods, including<a data-primary="indent() method (String class)" data-type="indexterm" id="idm45290704844648"/><a data-primary="stripLeading() method" data-type="indexterm" id="idm45290704843944"/><a data-primary="stripTrailing() method" data-type="indexterm" id="idm45290704843272"/><a data-primary="isBlank() method" data-type="indexterm" id="idm45290704842600"/><a data-primary="transform() method" data-type="indexterm" id="idm45290704841928"/>&#13;
<code>indent(int n)</code>, <code>stripLeading()</code> and <code>stripTrailing()</code>, <code>Stream&lt;T&gt;</code> <code>lines()</code>, <code>isBlank()</code>, and <code>transform()</code>.&#13;
Most of these provide obvious functionality; the last one allows applying an instance of a functional&#13;
interface (see <a data-type="xref" href="ch09.html#javacook-fp-intro">Recipe 9.0</a>) to a string and returning the result of that operation.</p>&#13;
&#13;
<p>Although we haven’t discussed the details of the <code>java.io</code> package yet (we will, in <a data-type="xref" href="ch10.html#javacook-io">Chapter 10</a>), you need to be able to read text files for some of these programs. Even if you’re not familiar with <code>java.io</code>, you can probably see from the examples of reading text files that a <code>BufferedReader</code> allows you to read chunks of data and that this class has a very convenient<a data-primary="readLine() method" data-type="indexterm" id="idm45290704834664"/> <code>readLine()</code> method.</p>&#13;
&#13;
<p>Going the other way, <a data-primary="System.out.println() method" data-type="indexterm" id="idm45290704833096"/><code>System.out.println()</code> is normally used to print strings or other values&#13;
to the terminal or standard output. String concatenation is commonly used here, like this:</p>&#13;
&#13;
<pre data-type="programlisting">System.out.println("The answer is " + result);</pre>&#13;
&#13;
<p>One caveat with string concatenation is that if you are appending a bunch of&#13;
things, and a number and a character are concatenated at the front, they are&#13;
added before concatenation due to Java’s precedence rules. So don’t do as I did&#13;
in this contrived example:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kt">int</code> <code class="n">result</code> <code class="o">=</code> <code class="o">...;</code>&#13;
<code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">result</code> <code class="o">+</code> <code class="sc">'='</code> <code class="o">+</code> <code class="s">" the answer."</code><code class="o">);</code></pre>&#13;
&#13;
<p>Given that <code>result</code> is an integer, then <code>result + '=' (<code>result</code> added to the equals sign, which is of the numeric type +char</code>) is a valid<a data-primary="numeric expression" data-type="indexterm" id="idm45290704820200"/> <em>numeric</em> expression, which will result in a single value of type <code>int</code>. If the variable <code>result</code> has the value 42, and given that the character <code>=</code> in a Unicode (or ASCII) code chart has the value 61, the two-line fragment would print:</p>&#13;
&#13;
<pre data-type="programlisting">103 the answer.</pre>&#13;
&#13;
<p>The wrong value and no equals sign! Safer approaches include using parentheses, double quotes around the equals sign, a <code>StringBuilder</code> (see <a data-type="xref" href="#javacook-strings-SECT-3">Recipe 3.2</a>), or <code>String.format()</code> (see <a data-type="xref" href="ch10.html#javacook-io-SECT-3">Recipe 10.4</a>). Of course in this simple example you could just move the <em>=</em> to be part of the string literal, but the example was chosen to illustrate the problem of arithmetic on <code>char</code> values being confused with string contatenation.&#13;
I won’t show you how to sort an array of strings here; the more general notion of sorting a collection of objects will be taken up in <a data-type="xref" href="ch07.html#javacook-structure-SECT-8">Recipe 7.11</a>.</p>&#13;
&#13;
<p>Java 14 enables <a data-primary="text blocks" data-type="indexterm" id="idm45290704798360"/>text blocks, also known as multiline text strings.&#13;
These are delimited with a set of three double quotes, the opening of which <em>must</em>&#13;
have a newline after the quotes (which doesn’t become part of the string; the&#13;
following newlines do):</p>&#13;
<pre>String long = """&#13;
This is a long&#13;
text String."""</pre>&#13;
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="strings-are-immutable">&#13;
<h5>Timeless, Immutable, and Unchangeable</h5>&#13;
<p>Notice that a given <a data-primary="String objects, immutability of" data-type="indexterm" id="idm45290704794264"/><code>String</code> object, once constructed, is immutable. In other words, once I have said <code>String s =</code> "<code>Hello</code>" <code>+ yourName;</code>, the contents of the particular object that reference variable <code>s</code> refers to can never be changed. You can assign <code>s</code> to refer to a different string, even one derived from the original, as in <code>s = s.trim()</code>. And you can retrieve characters from the original string using<a data-primary="charAt() method" data-type="indexterm" id="idm45290704789896"/> <code>charAt()</code>, but it isn’t called <a data-primary="getCharAt() method" data-type="indexterm" id="idm45290704788648"/><code>getCharAt()</code> because there is not, and never will be, a<a data-primary="setCharAt() method" data-type="indexterm" id="idm45290704787560"/> <code>setCharAt()</code> method. Even methods like <a data-primary="toUpperCase() method" data-type="indexterm" id="idm45290704786264"/><code>toUpperCase()</code> don’t change the <code>String</code>; they return a new <code>String</code> object containing the translated characters. If you need to change characters within a <code>String</code>, you should instead create a <a data-primary="StringBuilder" data-type="indexterm" id="idm45290704718888"/><code>StringBuilder</code> (possibly initialized to the starting value of the <code>String</code>), manipulate the <code>StringBuilder</code> to your heart’s content, and then convert that to <code>String</code> at the end, using the ubiquitous <code>toString()</code> method.<sup><a data-type="noteref" href="ch03.html#idm45290704715928" id="idm45290704715928-marker">2</a></sup></p>&#13;
&#13;
<p>How can I be so sure they won’t add a <code>setCharAt()</code> method in the next release? Because&#13;
the immutability of strings is one of the fundamentals of the Java Virtual Machine.&#13;
Immutable objects are generally good for software reliability (some languages do not even allow&#13;
mutable objects). Immutability avoids conflicts,&#13;
particularly where multiple threads are involved, or where software from multiple&#13;
organizations has to work together; for example, you can safely pass immutable objects&#13;
to a third-party library and expect that the objects will not be modifed.</p>&#13;
&#13;
<p>It may be possible to tinker with the <code>String</code>’s internal data structures using the&#13;
Reflection API, as shown in <a data-type="xref" href="ch17.html#javacook-reflection-recipe">Recipe 17.3</a>, but then all bets are off.&#13;
Secured environments do not permit access to the Reflection API,&#13;
and the Java Modules system from Java 9&#13;
tightens reflective access to such internals even further.</p>&#13;
&#13;
<p>Remember also that the <code>String</code> is a fundamental type in Java. Unlike most of the other classes in the core API, the behavior of strings is not changeable; the class is marked <code>final</code> so it cannot be subclassed. So you can’t declare your own <code>String</code> subclass. Think if you could—you could masquerade as a <code>String</code> but provide a <code>setCharAt()</code> method! Again, they thought of that. If you don’t believe me, try it out:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">WolfInStringsClothing</code>&#13;
    <code class="kd">extends</code> <code class="n">java</code><code class="o">.</code><code class="na">lang</code><code class="o">.</code><code class="na">String</code> <code class="o">{</code><code class="c1">//EXPECT COMPILE ERROR</code>&#13;
&#13;
    <code class="kd">public</code> <code class="kt">void</code> <code class="nf">setCharAt</code><code class="o">(</code><code class="kt">int</code> <code class="n">index</code><code class="o">,</code> <code class="kt">char</code> <code class="n">newChar</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="c1">// The implementation of this method</code>&#13;
        <code class="c1">// would be left as an exercise for the reader.</code>&#13;
        <code class="c1">// Hint: compile this code exactly as is before bothering!</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p>Got it? They thought of that!</p>&#13;
&#13;
<p>Of course you do need to be able to modify strings. Some methods extract&#13;
part of a <code>String</code>; these are covered in the first few recipes in this&#13;
chapter. And <code>StringBuilder</code> is an important set of classes that deals in&#13;
characters and strings and has many methods for changing the contents,&#13;
including, of course, a <a data-primary="toString() method" data-type="indexterm" id="idm45290704684312"/><code>toString()</code>  method. Reformed C programmers should&#13;
note that Java strings are not arrays of chars as in C.&#13;
Therefore you must use methods for such&#13;
operations as processing a string one character at a time; see&#13;
<a data-type="xref" href="#javacook-strings-SECT-4">Recipe 3.3</a>. <a data-type="xref" href="#javacook-strings-FIG-1">Figure 3-1</a> shows an overview of&#13;
<code>String</code>, <code>StringBuilder</code>, and C-language strings.</p>&#13;
&#13;
<figure><div class="figure" id="javacook-strings-FIG-1">&#13;
<img alt="jcb4 0301" src="assets/jcb4_0301.png"/>&#13;
<h6><span class="label">Figure 3-1. </span>String, StringBuilder, and C-language strings</h6>&#13;
</div></figure>&#13;
</div></aside>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="3.1 Taking Strings Apart with Substrings or Tokenizing" data-type="sect1"><div class="sect1" id="javacook-strings-SECT-1">&#13;
<h1>3.1 Taking Strings Apart with Substrings or Tokenizing</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-strings-SECT-1.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="strings" data-secondary="substrings" data-type="indexterm" id="str_sub"/><a data-primary="strings" data-secondary="tokenizing" data-type="indexterm" id="str_tok"/><a data-primary="substrings" data-type="indexterm" id="sub_a"/><a data-primary="tokenizing" data-type="indexterm" id="tok_a"/>You want to break a string apart,&#13;
either by indexing positions or by using fixed token characters (e.g., break on spaces to get words).</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-strings-SECT-1.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>For substrings, use the <code>String</code> object’s <a data-primary="substring() method" data-type="indexterm" id="idm45290704668776"/><code>substring()</code> method.&#13;
For tokenizing, construct a <code>StringTokenizer</code> around your string and call its methods <a data-primary="hasMoreTokens() method" data-type="indexterm" id="idm45290704667176"/><code>hasMoreTokens()</code> and <a data-primary="nextToken() method" data-type="indexterm" id="idm45290704666088"/><code>nextToken()</code>.</p>&#13;
&#13;
<p>Or, use regular expressions (see <a data-type="xref" href="ch04.html#javacook-regex">Chapter 4</a>).</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-strings-SECT-1.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>We’ll look first at substrings, and then discuss tokenizing.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Substrings" data-type="sect3"><div class="sect3" id="idm45290704661592">&#13;
<h3>Substrings</h3>&#13;
&#13;
<p>The <code>substring()</code> method constructs a new <code>String</code> object made&#13;
up of a run of characters contained somewhere in the original string,&#13;
the one whose <code>substring()</code> you called. The&#13;
<code>substring</code> method is overloaded: both forms require a starting&#13;
index (which is always <a data-primary="zero-based index" data-type="indexterm" id="idm45290704657800"/><em>zero-based</em>). The one-argument form returns from <code>startIndex</code> to the end.&#13;
The two-argument form takes an ending index (not a length, as in&#13;
some languages) so that an index can be generated by the <code>String</code>&#13;
methods <a data-primary="indexOf() method" data-type="indexterm" id="idm45290704655736"/><code>indexOf()</code> or <a data-primary="lastIndexOf() method" data-type="indexterm" id="idm45290704654616"/><code>las⁠t​IndexOf()</code>:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">SubStringDemo</code> <code class="o">{</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">av</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">String</code> <code class="n">a</code> <code class="o">=</code> <code class="s">"Java is great."</code><code class="o">;</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">a</code><code class="o">);</code>&#13;
        <code class="n">String</code> <code class="n">b</code> <code class="o">=</code> <code class="n">a</code><code class="o">.</code><code class="na">substring</code><code class="o">(</code><code class="mi">5</code><code class="o">);</code>    <code class="c1">// b is the String "is great."</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">b</code><code class="o">);</code>&#13;
        <code class="n">String</code> <code class="n">c</code> <code class="o">=</code> <code class="n">a</code><code class="o">.</code><code class="na">substring</code><code class="o">(</code><code class="mi">5</code><code class="o">,</code><code class="mi">7</code><code class="o">);</code><code class="c1">// c is the String "is"</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">c</code><code class="o">);</code>&#13;
        <code class="n">String</code> <code class="n">d</code> <code class="o">=</code> <code class="n">a</code><code class="o">.</code><code class="na">substring</code><code class="o">(</code><code class="mi">5</code><code class="o">,</code><code class="n">a</code><code class="o">.</code><code class="na">length</code><code class="o">());</code><code class="c1">// d is "is great."</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">d</code><code class="o">);</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p>When run, this prints the following:</p>&#13;
<pre data-type="programlisting" id="I_3_tt67">C:&gt; <strong>java strings.SubStringDemo</strong>&#13;
Java is great.&#13;
is great.&#13;
is&#13;
is great.&#13;
C:&gt;</pre>&#13;
<div data-type="warning" epub:type="warning" id="javacook-strings-SECT-2"><h6>Warning</h6>&#13;
<p>Note that the end index is one beyond the last character!&#13;
Java adopts this policy of having a half-open interval (or inclusive start, exclusive end) fairly consistently;&#13;
there are good practical reasons for adopting this approach,&#13;
and some other languages do so too.</p>&#13;
</div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Tokenizing" data-type="sect3"><div class="sect3" id="idm45290704535432">&#13;
<h3>Tokenizing</h3>&#13;
&#13;
<p>The easiest way is to use a regular expression. We’ll discuss <a data-primary="regular expressions (regex)" data-secondary="strings and" data-type="indexterm" id="idm45290704533384"/>regular expressions in <a data-type="xref" href="ch04.html#javacook-regex">Chapter 4</a>, but&#13;
for now, a string containing a space is a valid regular expression to match space characters,&#13;
so you can most easily split a string into words like this:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="k">for</code> <code class="o">(</code><code class="n">String</code> <code class="n">word</code> <code class="o">:</code> <code class="n">some_input_string</code><code class="o">.</code><code class="na">split</code><code class="o">(</code><code class="s">" "</code><code class="o">))</code> <code class="o">{</code>&#13;
    <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">word</code><code class="o">);</code>&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p>If you need to match multiple spaces, or spaces and tabs, use the string <code>"\s+"</code>.</p>&#13;
&#13;
<p>If you want to split a  file, you can try the string <code>","</code>&#13;
or use one of several third-party libraries for CSV files.</p>&#13;
&#13;
<p>Another method is to use <a data-primary="StringTokenizer" data-type="indexterm" id="idm45290704453608"/><code>StringTokenizer</code>. The <code>StringTokenizer</code> methods implement the <code>Iterator</code> interface and design pattern (see <a data-type="xref" href="ch07.html#javacook-structure-iterate">Recipe 7.6</a>):</p>&#13;
&#13;
<p><em>main/src/main/java/strings/StrTokDemo.java</em></p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">StringTokenizer</code> <code class="n">st</code> <code class="o">=</code> <code class="k">new</code> <code class="n">StringTokenizer</code><code class="o">(</code><code class="s">"Hello World of Java"</code><code class="o">);</code>&#13;
&#13;
<code class="k">while</code> <code class="o">(</code><code class="n">st</code><code class="o">.</code><code class="na">hasMoreTokens</code><code class="o">(</code> <code class="o">))</code>&#13;
    <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Token: "</code> <code class="o">+</code> <code class="n">st</code><code class="o">.</code><code class="na">nextToken</code><code class="o">(</code> <code class="o">));</code></pre>&#13;
&#13;
<p><code>StringTokenizer</code> also implements the <code>Enumeration</code> interface (see <a data-type="xref" href="ch07.html#javacook-structure-iterate">Recipe 7.6</a>),&#13;
but if you use the methods thereof, you need to cast the results to <code>String</code>.</p>&#13;
&#13;
<p>A <code>StringTokenizer</code> normally breaks the <code>String</code> into tokens at what we would think of as word boundaries in European languages. Sometimes you want to break at some other character. No problem. When you construct your <code>StringTokenizer</code>, in addition to passing in the string to be tokenized, pass in a second string that lists the break characters, like this:</p>&#13;
&#13;
<p><em>main/src/main/java/strings/StrTokDemo2.java</em></p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">StringTokenizer</code> <code class="n">st</code> <code class="o">=</code> <code class="k">new</code> <code class="n">StringTokenizer</code><code class="o">(</code><code class="s">"Hello, World|of|Java"</code><code class="o">,</code> <code class="s">", |"</code><code class="o">);</code>&#13;
&#13;
<code class="k">while</code> <code class="o">(</code><code class="n">st</code><code class="o">.</code><code class="na">hasMoreElements</code><code class="o">(</code> <code class="o">))</code>&#13;
    <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Token: "</code> <code class="o">+</code> <code class="n">st</code><code class="o">.</code><code class="na">nextElement</code><code class="o">(</code> <code class="o">));</code></pre>&#13;
&#13;
<p>It outputs the four words, each on a line by itself, with no punctuation.</p>&#13;
&#13;
<p>But wait, there’s more! What if you are reading lines like</p>&#13;
&#13;
<pre data-type="programlisting">FirstName|LastName|Company|PhoneNumber</pre>&#13;
&#13;
<p>and your dear old Aunt Begonia hasn’t been employed for the last 38 years? Her <code>Company</code> field will in all probability be blank.<sup><a data-type="noteref" href="ch03.html#idm45290704071000" id="idm45290704071000-marker">3</a></sup> If you look very closely at the previous code example, you’ll see that it has two delimiters together (the comma and the space); but if you run it, there are no “extra” tokens—that is, the <code>StringTokenizer</code> normally discards adjacent consecutive delimiters. For cases like the phone list, where you need to preserve null fields, there is good news and bad news. The good news is that you can do it: you simply add a second argument of <code>true</code> when constructing the <code>StringTokenizer</code>, meaning that you wish to see the delimiters as tokens. The bad news is that you now get to see the delimiters as tokens, so you have to do the arithmetic yourself. Want to see it? Run this program:</p>&#13;
&#13;
<p><em>main/src/main/java/strings/StrTokDemo3.java</em></p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">StringTokenizer</code> <code class="n">st</code> <code class="o">=</code>&#13;
    <code class="k">new</code> <code class="nf">StringTokenizer</code><code class="o">(</code><code class="s">"Hello, World|of|Java"</code><code class="o">,</code> <code class="s">", |"</code><code class="o">,</code> <code class="kc">true</code><code class="o">);</code>&#13;
&#13;
<code class="k">while</code> <code class="o">(</code><code class="n">st</code><code class="o">.</code><code class="na">hasMoreElements</code><code class="o">(</code> <code class="o">))</code>&#13;
    <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Token: "</code> <code class="o">+</code> <code class="n">st</code><code class="o">.</code><code class="na">nextElement</code><code class="o">(</code> <code class="o">));</code></pre>&#13;
&#13;
<p>You will get this output:</p>&#13;
<pre data-type="programlisting" id="I_3_tt72">C:\&gt;<strong>java strings.StrTokDemo3</strong>&#13;
Token: Hello&#13;
Token: ,&#13;
Token:&#13;
Token: World&#13;
Token: |&#13;
Token: of&#13;
Token: |&#13;
Token: Java&#13;
C:\&gt;</pre>&#13;
&#13;
<p>This isn’t how you’d like <code>StringTokenizer</code> to behave, ideally, but it is serviceable enough most of the time. <a data-type="xref" href="#javacook-strings-EX-1">Example 3-1</a> processes and ignores consecutive tokens, returning the results as an array of <code>String</code>s.</p>&#13;
<div data-type="example" id="javacook-strings-EX-1">&#13;
<h5><span class="label">Example 3-1. </span>main/src/main/java/strings/StrTokDemo4.java (StringTokenizer)</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">StrTokDemo4</code> <code class="o">{</code>&#13;
    <code class="kd">public</code> <code class="kd">final</code> <code class="kd">static</code> <code class="kt">int</code> <code class="n">MAXFIELDS</code> <code class="o">=</code> <code class="mi">5</code><code class="o">;</code>&#13;
    <code class="kd">public</code> <code class="kd">final</code> <code class="kd">static</code> <code class="n">String</code> <code class="n">DELIM</code> <code class="o">=</code> <code class="s">"|"</code><code class="o">;</code>&#13;
&#13;
    <code class="cm">/** Processes one String, returns it as an array of Strings */</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="n">String</code><code class="o">[]</code> <code class="nf">process</code><code class="o">(</code><code class="n">String</code> <code class="n">line</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">String</code><code class="o">[]</code> <code class="n">results</code> <code class="o">=</code> <code class="k">new</code> <code class="n">String</code><code class="o">[</code><code class="n">MAXFIELDS</code><code class="o">];</code>&#13;
&#13;
        <code class="c1">// Unless you ask StringTokenizer to give you the tokens,</code>&#13;
        <code class="c1">// it silently discards multiple null tokens.</code>&#13;
        <code class="n">StringTokenizer</code> <code class="n">st</code> <code class="o">=</code> <code class="k">new</code> <code class="n">StringTokenizer</code><code class="o">(</code><code class="n">line</code><code class="o">,</code> <code class="n">DELIM</code><code class="o">,</code> <code class="kc">true</code><code class="o">);</code>&#13;
&#13;
        <code class="kt">int</code> <code class="n">i</code> <code class="o">=</code> <code class="mi">0</code><code class="o">;</code>&#13;
        <code class="c1">// Stuff each token into the current slot in the array.</code>&#13;
        <code class="k">while</code> <code class="o">(</code><code class="n">st</code><code class="o">.</code><code class="na">hasMoreTokens</code><code class="o">())</code> <code class="o">{</code>&#13;
            <code class="n">String</code> <code class="n">s</code> <code class="o">=</code> <code class="n">st</code><code class="o">.</code><code class="na">nextToken</code><code class="o">();</code>&#13;
            <code class="k">if</code> <code class="o">(</code><code class="n">s</code><code class="o">.</code><code class="na">equals</code><code class="o">(</code><code class="n">DELIM</code><code class="o">))</code> <code class="o">{</code>&#13;
                <code class="k">if</code> <code class="o">(</code><code class="n">i</code><code class="o">++&gt;=</code><code class="n">MAXFIELDS</code><code class="o">)</code>&#13;
                    <code class="c1">// This is messy: See StrTokDemo4b which uses</code>&#13;
                    <code class="c1">// a List to allow any number of fields.</code>&#13;
                    <code class="k">throw</code> <code class="k">new</code> <code class="nf">IllegalArgumentException</code><code class="o">(</code><code class="s">"Input line "</code> <code class="o">+</code>&#13;
                        <code class="n">line</code> <code class="o">+</code> <code class="s">" has too many fields"</code><code class="o">);</code>&#13;
                <code class="k">continue</code><code class="o">;</code>&#13;
            <code class="o">}</code>&#13;
            <code class="n">results</code><code class="o">[</code><code class="n">i</code><code class="o">]</code> <code class="o">=</code> <code class="n">s</code><code class="o">;</code>&#13;
        <code class="o">}</code>&#13;
        <code class="k">return</code> <code class="n">results</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">printResults</code><code class="o">(</code><code class="n">String</code> <code class="n">input</code><code class="o">,</code> <code class="n">String</code><code class="o">[]</code> <code class="n">outputs</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Input: "</code> <code class="o">+</code> <code class="n">input</code><code class="o">);</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="n">String</code> <code class="n">s</code> <code class="o">:</code> <code class="n">outputs</code><code class="o">)</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Output "</code> <code class="o">+</code> <code class="n">s</code> <code class="o">+</code> <code class="s">" was: "</code> <code class="o">+</code> <code class="n">s</code><code class="o">);</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">a</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">printResults</code><code class="o">(</code><code class="s">"A|B|C|D"</code><code class="o">,</code> <code class="n">process</code><code class="o">(</code><code class="s">"A|B|C|D"</code><code class="o">));</code>&#13;
        <code class="n">printResults</code><code class="o">(</code><code class="s">"A||C|D"</code><code class="o">,</code> <code class="n">process</code><code class="o">(</code><code class="s">"A||C|D"</code><code class="o">));</code>&#13;
        <code class="n">printResults</code><code class="o">(</code><code class="s">"A|||D|E"</code><code class="o">,</code> <code class="n">process</code><code class="o">(</code><code class="s">"A|||D|E"</code><code class="o">));</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre></div>&#13;
&#13;
<p>When you run this, you will see that <code>A</code> is always in Field 1, <code>B</code> (if present) is in Field 2, and so on. In other words, the null fields are being handled properly:</p>&#13;
&#13;
<pre data-type="programlisting">Input: A|B|C|D&#13;
Output 0 was: A&#13;
Output 1 was: B&#13;
Output 2 was: C&#13;
Output 3 was: D&#13;
Output 4 was: null&#13;
Input: A||C|D&#13;
Output 0 was: A&#13;
Output 1 was: null&#13;
Output 2 was: C&#13;
Output 3 was: D&#13;
Output 4 was: null&#13;
Input: A|||D|E&#13;
Output 0 was: A&#13;
Output 1 was: null&#13;
Output 2 was: null&#13;
Output 3 was: D&#13;
Output 4 was: E</pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="See Also" data-type="sect2"><div class="sect2" id="javacook-strings-SECT-2.3">&#13;
<h2>See Also</h2>&#13;
&#13;
<p>Many occurrences of <code>StringTokenizer</code> may be replaced with regular expressions (see <a data-type="xref" href="ch04.html#javacook-regex">Chapter 4</a>) with considerably more flexibility. For example, to extract all the numbers from a <code>String</code>, you can use this code:</p>&#13;
&#13;
<pre data-type="programlisting">Matcher tokenizer = Pattern.compile("\\d+").matcher(inputString);&#13;
while (tokenizer.find( )) {&#13;
        String courseString = tokenizer.group(0);&#13;
        int courseNumber = Integer.parseInt(courseString);&#13;
        ...</pre>&#13;
&#13;
<p>This allows user input to be more flexible than you could easily handle with a <code>StringTokenizer</code>. Assuming that the numbers represent course numbers at some educational institution, the inputs “471,472,570” or “Courses 471 and 472, 570” or just “471 472 570” should all give the same results.<a data-primary="" data-startref="str_sub" data-type="indexterm" id="idm45290703712664"/><a data-primary="" data-startref="str_tok" data-type="indexterm" id="idm45290703711688"/><a data-primary="" data-startref="sub_a" data-type="indexterm" id="idm45290703710744"/><a data-primary="" data-startref="tok_a" data-type="indexterm" id="idm45290703709800"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="3.2 Putting Strings Together with StringBuilder" data-type="sect1"><div class="sect1" id="javacook-strings-SECT-3">&#13;
<h1>3.2 Putting Strings Together with StringBuilder</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-strings-SECT-3.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="StringBuilder" data-type="indexterm" id="sb_str"/><a data-primary="strings" data-secondary="StringBuilder and" data-type="indexterm" id="str_sb"/>You need to put some <code>String</code> pieces (back) together.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-strings-SECT-3.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use string concatenation: the <a data-primary="+ operator" data-type="indexterm" id="idm45290703701144"/><code>+</code>  operator. The compiler implicitly constructs a <span class="keep-together"><code>StringBuilder</code></span> for you and uses its <a data-primary="append() methods" data-type="indexterm" id="idm45290703699144"/><code>append()</code> methods (unless all the string parts are known at compile time).</p>&#13;
&#13;
<p>Better yet, construct and use a <code>StringBuilder</code> yourself.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-strings-SECT-3.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>An object of one of the <code>StringBuilder</code> classes basically represents a collection of characters.&#13;
It is similar to a <code>String</code> object.<sup><a data-type="noteref" href="ch03.html#idm45290703693768" id="idm45290703693768-marker">4</a></sup>&#13;
However, as mentioned, <a data-primary="strings" data-secondary="immutability of" data-type="indexterm" id="idm45290703691896"/><code>String</code>s are immutable; <code>StringBuilder</code>s are mutable and designed for, well, building <code>String</code>s. You typically construct a <code>StringBuilder</code>, invoke the methods needed to get the character sequence just the way you want it, and then call <a data-primary="toString() method" data-type="indexterm" id="idm45290703689096"/><code>toString()</code> to generate a <code>String</code> representing the same character sequence for use in most of the Java API, which deals in <code>String</code>s.</p>&#13;
&#13;
<p><a data-primary="StringBuffer" data-type="indexterm" id="idm45290703687032"/><code>StringBuffer</code> is historical—it’s been around since the beginning of time. Some of its methods are synchronized (see <a data-type="xref" href="ch16.html#javacook-threads-SECT-5">Recipe 16.5</a>), which involves unneeded overhead in a single-threaded context. In Java 5, this class was split into <code>StringBuffer</code> (which is synchronized) and <code>StringBuilder</code> (which is not synchronized); thus, it is faster and preferable for single-threaded use. Another new class, <code>AbstractStringBuilder</code>, is the parent of both. In the following discussion, I’ll use “the <code>StringBuilder</code> classes” to refer to all three because they mostly have the same methods.</p>&#13;
&#13;
<p>The book’s example code provides a <code>StringBuilderDemo</code> and a <code>StringBufferDemo</code>. Except for the fact that <code>StringBuilder</code> is not thread-safe, these API classes are <span class="keep-together">identical</span> and can be used interchangeably, so my two demo programs are almost identical except that each one uses the appropriate builder class.</p>&#13;
&#13;
<p>The <code>StringBuilder</code> classes have a variety of methods for inserting,&#13;
replacing, and otherwise modifying a given <code>StringBuilder</code>. Conveniently,&#13;
the <a data-primary="append() methods" data-type="indexterm" id="idm45290703678840"/><code>append()</code> methods return a reference to the <code>StringBuilder</code> itself, so&#13;
stacked statements like <code>.append(…).append(…)</code> are fairly common.&#13;
This style of coding is referred to as a <em>fluent API</em> because&#13;
it reads smoothly, like prose from a native speaker of a human language.&#13;
You might even see this style of coding in a <a data-primary="toString() method" data-type="indexterm" id="idm45290703676264"/><code>toString()</code>  method, for example.&#13;
<a data-type="xref" href="#javacook-strings-EX-2">Example 3-2</a> shows three ways of concatenating strings.</p>&#13;
<div data-type="example" id="javacook-strings-EX-2">&#13;
<h5><span class="label">Example 3-2. </span>main/src/main/java/strings/StringBuilderDemo.java</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">StringBuilderDemo</code> <code class="o">{</code>&#13;
&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">argv</code><code class="o">)</code> <code class="o">{</code>&#13;
&#13;
        <code class="n">String</code> <code class="n">s1</code> <code class="o">=</code> <code class="s">"Hello"</code> <code class="o">+</code> <code class="s">", "</code> <code class="o">+</code> <code class="s">"World"</code><code class="o">;</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">s1</code><code class="o">);</code>&#13;
&#13;
        <code class="c1">// Build a StringBuilder, and append some things to it.</code>&#13;
        <code class="n">StringBuilder</code> <code class="n">sb2</code> <code class="o">=</code> <code class="k">new</code> <code class="n">StringBuilder</code><code class="o">();</code>&#13;
        <code class="n">sb2</code><code class="o">.</code><code class="na">append</code><code class="o">(</code><code class="s">"Hello"</code><code class="o">);</code>&#13;
        <code class="n">sb2</code><code class="o">.</code><code class="na">append</code><code class="o">(</code><code class="sc">','</code><code class="o">);</code>&#13;
        <code class="n">sb2</code><code class="o">.</code><code class="na">append</code><code class="o">(</code><code class="sc">' '</code><code class="o">);</code>&#13;
        <code class="n">sb2</code><code class="o">.</code><code class="na">append</code><code class="o">(</code><code class="s">"World"</code><code class="o">);</code>&#13;
&#13;
        <code class="c1">// Get the StringBuilder's value as a String, and print it.</code>&#13;
        <code class="n">String</code> <code class="n">s2</code> <code class="o">=</code> <code class="n">sb2</code><code class="o">.</code><code class="na">toString</code><code class="o">();</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">s2</code><code class="o">);</code>&#13;
&#13;
        <code class="c1">// Now do the above all over again, but in a more</code>&#13;
        <code class="c1">// concise (and typical "real-world" Java) fashion.</code>&#13;
&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code>&#13;
          <code class="k">new</code> <code class="nf">StringBuilder</code><code class="o">()</code>&#13;
            <code class="o">.</code><code class="na">append</code><code class="o">(</code><code class="s">"Hello"</code><code class="o">)</code>&#13;
            <code class="o">.</code><code class="na">append</code><code class="o">(</code><code class="sc">','</code><code class="o">)</code>&#13;
            <code class="o">.</code><code class="na">append</code><code class="o">(</code><code class="sc">' '</code><code class="o">)</code>&#13;
            <code class="o">.</code><code class="na">append</code><code class="o">(</code><code class="s">"World"</code><code class="o">));</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre></div>&#13;
&#13;
<p>In fact, all the methods that modify more than one character of a <code>StringBuilder</code>’s contents (i.e., <a data-primary="delete() method" data-type="indexterm" id="idm45290703669304"/><a data-primary="deleteCharAt() method" data-type="indexterm" id="idm45290703575304"/><a data-primary="insert() method" data-type="indexterm" id="idm45290703574664"/><a data-primary="replace() method" data-type="indexterm" id="idm45290703573992"/><a data-primary="reverse() method" data-type="indexterm" id="idm45290703573320"/><code>append()</code>, <code>delete()</code>, <code>deleteCharAt()</code>, <code>insert()</code>, <code>replace()</code>, and <code>reverse()</code>) return a reference to the builder object to facilitate this fluent API style of coding.</p>&#13;
&#13;
<p>As another example of using a <code>StringBuilder</code>, consider the need to convert a list of&#13;
items into a comma-separated list while avoiding getting an extra comma after the last element of the list.&#13;
This can be done using a <code>StringBuilder</code>, although in Java 8+ there&#13;
is a static <code>String</code> method to do the same.&#13;
Code for these are shown in <a data-type="xref" href="#javacook-strings-EX-3">Example 3-3</a>.</p>&#13;
<div data-type="example" id="javacook-strings-EX-3">&#13;
<h5><span class="label">Example 3-3. </span>main/src/main/java/strings/StringBuilderCommaList.java</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting">        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code>&#13;
            <code class="s">"Split using String.split; joined using 1.8 String join"</code><code class="o">);</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">String</code><code class="o">.</code><code class="na">join</code><code class="o">(</code><code class="s">", "</code><code class="o">,</code> <code class="n">SAMPLE_STRING</code><code class="o">.</code><code class="na">split</code><code class="o">(</code><code class="s">" "</code><code class="o">)));</code>&#13;
&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code>&#13;
            <code class="s">"Split using String.split; joined using StringBuilder"</code><code class="o">);</code>&#13;
        <code class="n">StringBuilder</code> <code class="n">sb1</code> <code class="o">=</code> <code class="k">new</code> <code class="n">StringBuilder</code><code class="o">();</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="n">String</code> <code class="n">word</code> <code class="o">:</code> <code class="n">SAMPLE_STRING</code><code class="o">.</code><code class="na">split</code><code class="o">(</code><code class="s">" "</code><code class="o">))</code> <code class="o">{</code>&#13;
            <code class="k">if</code> <code class="o">(</code><code class="n">sb1</code><code class="o">.</code><code class="na">length</code><code class="o">()</code> <code class="o">&gt;</code> <code class="mi">0</code><code class="o">)</code> <code class="o">{</code>&#13;
                <code class="n">sb1</code><code class="o">.</code><code class="na">append</code><code class="o">(</code><code class="s">", "</code><code class="o">);</code>&#13;
            <code class="o">}</code>&#13;
            <code class="n">sb1</code><code class="o">.</code><code class="na">append</code><code class="o">(</code><code class="n">word</code><code class="o">);</code>&#13;
        <code class="o">}</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">sb1</code><code class="o">);</code>&#13;
&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code>&#13;
            <code class="s">"Split using StringTokenizer; joined using StringBuilder"</code><code class="o">);</code>&#13;
        <code class="n">StringTokenizer</code> <code class="n">st</code> <code class="o">=</code> <code class="k">new</code> <code class="n">StringTokenizer</code><code class="o">(</code><code class="n">SAMPLE_STRING</code><code class="o">);</code>&#13;
        <code class="n">StringBuilder</code> <code class="n">sb2</code> <code class="o">=</code> <code class="k">new</code> <code class="n">StringBuilder</code><code class="o">();</code>&#13;
        <code class="k">while</code> <code class="o">(</code><code class="n">st</code><code class="o">.</code><code class="na">hasMoreElements</code><code class="o">())</code> <code class="o">{</code>&#13;
            <code class="n">sb2</code><code class="o">.</code><code class="na">append</code><code class="o">(</code><code class="n">st</code><code class="o">.</code><code class="na">nextToken</code><code class="o">());</code>&#13;
            <code class="k">if</code> <code class="o">(</code><code class="n">st</code><code class="o">.</code><code class="na">hasMoreElements</code><code class="o">())</code> <code class="o">{</code>&#13;
                <code class="n">sb2</code><code class="o">.</code><code class="na">append</code><code class="o">(</code><code class="s">", "</code><code class="o">);</code>&#13;
            <code class="o">}</code>&#13;
        <code class="o">}</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">sb2</code><code class="o">);</code></pre></div>&#13;
&#13;
<p>The first method is clearly the most compact; the static <a data-primary="String.join() method" data-type="indexterm" id="idm45290703515832"/><code>String.join()</code>&#13;
makes short work of this task.&#13;
The next method uses the <a data-primary="StringBuilder.length() method" data-type="indexterm" id="idm45290703514536"/><code>StringBuilder.length()</code> method, so it will only work correctly when you are starting with an empty <code>StringBuilder</code>.&#13;
The second method relies on calling the informational method <a data-primary="hasMoreElements() method" data-type="indexterm" id="idm45290703302264"/><code>hasMoreElements()</code> in the <code>Enumeration</code> (or <code>hasNext()</code> in an <code>Iterator</code>, as discussed in <a data-type="xref" href="ch07.html#javacook-structure-iterate">Recipe 7.6</a>) more than once on each element. An alternative method, particularly when you aren’t starting with an empty builder, would be to use a <code>boolean</code> flag variable to track whether you’re at the beginning of the list.<a data-primary="" data-startref="sb_str" data-type="indexterm" id="idm45290703298520"/><a data-primary="" data-startref="str_sb" data-type="indexterm" id="idm45290703297544"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="3.3 Processing a String One Character at a Time" data-type="sect1"><div class="sect1" id="javacook-strings-SECT-4">&#13;
<h1>3.3 Processing a String One Character at a Time</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-strings-SECT-4.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="processing strings" data-type="indexterm" id="pro_str"/><a data-primary="strings" data-secondary="characters, processing" data-type="indexterm" id="str_pro"/>You want to process the contents of a string, one character at a time.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-strings-SECT-4.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use a <a data-primary="for loop" data-type="indexterm" id="idm45290703289624"/><code>for</code> loop and the <code>String</code>’s <a data-primary="charAt() method" data-type="indexterm" id="idm45290703288056"/><code>charAt()</code>  or <a data-primary="codePointAt() method" data-type="indexterm" id="idm45290703286936"/><code>codePointAt()</code> method.&#13;
Or use a <a data-primary="for each loop" data-type="indexterm" id="idm45290703285816"/>“for each” loop and the <code>String</code>’s <a data-primary="toCharArray() method" data-type="indexterm" id="idm45290703284568"/><code>toCharArray</code> method.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-strings-SECT-4.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>A string’s <code>charAt()</code> method retrieves a given character by index number (starting at zero) from within the <code>String</code> object.&#13;
Since Unicode has had to expand beyond 16 bits, not all Unicode characters&#13;
can fit into a Java <code>char</code> variable.&#13;
There is thus an analogous <code>codePointAt()</code> method, whose return type is <code>int</code>.&#13;
To process all the characters in a <code>String</code>, one after another, use a <code>for</code> loop ranging from zero to <code>String.length()-1</code>. Here we process all the characters in a <code>String</code>:</p>&#13;
&#13;
<p><em>main/src/main/java/strings/strings/StrCharAt.java</em></p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">StrCharAt</code> <code class="o">{</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">av</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">String</code> <code class="n">a</code> <code class="o">=</code> <code class="s">"A quick bronze fox"</code><code class="o">;</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">i</code><code class="o">=</code><code class="mi">0</code><code class="o">;</code> <code class="n">i</code> <code class="o">&lt;</code> <code class="n">a</code><code class="o">.</code><code class="na">length</code><code class="o">();</code> <code class="n">i</code><code class="o">++)</code> <code class="o">{</code> <code class="c1">// no forEach, need the index</code>&#13;
            <code class="n">String</code> <code class="n">message</code> <code class="o">=</code> <code class="n">String</code><code class="o">.</code><code class="na">format</code><code class="o">(</code>&#13;
                <code class="s">"charAt is '%c', codePointAt is %3d, casted it's '%c'"</code><code class="o">,</code>&#13;
                     <code class="n">a</code><code class="o">.</code><code class="na">charAt</code><code class="o">(</code><code class="n">i</code><code class="o">),</code>&#13;
                     <code class="n">a</code><code class="o">.</code><code class="na">codePointAt</code><code class="o">(</code><code class="n">i</code><code class="o">),</code>&#13;
                     <code class="o">(</code><code class="kt">char</code><code class="o">)</code><code class="n">a</code><code class="o">.</code><code class="na">codePointAt</code><code class="o">(</code><code class="n">i</code><code class="o">));</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">message</code><code class="o">);</code>&#13;
        <code class="o">}</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p>Given that the “for each” loop has been in the language for ages,&#13;
you might be excused for expecting to be able to write something&#13;
like <code>for (char ch : myString) {…}</code>. Unfortunately, this does not&#13;
work. But you can use <code>myString.toCharArray()</code> as in the following:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">ForEachChar</code> <code class="o">{</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">args</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">String</code> <code class="n">mesg</code> <code class="o">=</code> <code class="s">"Hello world"</code><code class="o">;</code>&#13;
&#13;
        <code class="c1">// Does not compile, Strings are not iterable</code>&#13;
        <code class="c1">// for (char ch : mesg) {</code>&#13;
        <code class="c1">//        System.out.println(ch);</code>&#13;
        <code class="c1">// }</code>&#13;
&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Using toCharArray:"</code><code class="o">);</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="kt">char</code> <code class="n">ch</code> <code class="o">:</code> <code class="n">mesg</code><code class="o">.</code><code class="na">toCharArray</code><code class="o">())</code> <code class="o">{</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">ch</code><code class="o">);</code>&#13;
        <code class="o">}</code>&#13;
&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Using Streams:"</code><code class="o">);</code>&#13;
        <code class="n">mesg</code><code class="o">.</code><code class="na">chars</code><code class="o">().</code><code class="na">forEach</code><code class="o">(</code><code class="n">c</code> <code class="o">-&gt;</code> <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">((</code><code class="kt">char</code><code class="o">)</code><code class="n">c</code><code class="o">));</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p>A<a data-primary="checksum" data-type="indexterm" id="idm45290703235144"/> <em>checksum</em> is a numeric quantity representing and confirming the contents of a <span class="keep-together">file. If</span> you transmit the checksum of a file separately from the contents, a recipient can checksum the file—assuming the algorithm is known—and verify that the file was received intact. <a data-type="xref" href="#javacook-strings-EX-3a">Example 3-4</a> shows the simplest possible checksum, computed just by adding the numeric values of each character. Note that on files, it does not include <span class="keep-together">the values</span> of the newline characters; in order to fix this, retrieve <code>System​.getProp⁠erty("line.separator");</code> and add its character value(s) into the sum at the end of each line. Or give up on line mode and read the file a character at a time.<a data-primary="" data-startref="proc_str" data-type="indexterm" id="idm45290703019672"/><a data-primary="" data-startref="str_pro" data-type="indexterm" id="idm45290703018728"/></p>&#13;
<div data-type="example" id="javacook-strings-EX-3a">&#13;
<h5><span class="label">Example 3-4. </span>main/src/main/java/strings/CheckSum.java</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting">    <code class="cm">/** CheckSum one text file, given an open BufferedReader.</code>&#13;
<code class="cm">     * Checksum does not include line endings, so will give the</code>&#13;
<code class="cm">     * same value for given text on any platform. Do not use</code>&#13;
<code class="cm">     * on binary files!</code>&#13;
<code class="cm">     */</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">int</code> <code class="nf">process</code><code class="o">(</code><code class="n">BufferedReader</code> <code class="n">is</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="kt">int</code> <code class="n">sum</code> <code class="o">=</code> <code class="mi">0</code><code class="o">;</code>&#13;
        <code class="k">try</code> <code class="o">{</code>&#13;
            <code class="n">String</code> <code class="n">inputLine</code><code class="o">;</code>&#13;
&#13;
            <code class="k">while</code> <code class="o">((</code><code class="n">inputLine</code> <code class="o">=</code> <code class="n">is</code><code class="o">.</code><code class="na">readLine</code><code class="o">())</code> <code class="o">!=</code> <code class="kc">null</code><code class="o">)</code> <code class="o">{</code>&#13;
                <code class="k">for</code> <code class="o">(</code><code class="kt">char</code> <code class="n">c</code> <code class="o">:</code> <code class="n">inputLine</code><code class="o">.</code><code class="na">toCharArray</code><code class="o">())</code> <code class="o">{</code>&#13;
                    <code class="n">sum</code> <code class="o">+=</code> <code class="n">c</code><code class="o">;</code>&#13;
                <code class="o">}</code>&#13;
            <code class="o">}</code>&#13;
        <code class="o">}</code> <code class="k">catch</code> <code class="o">(</code><code class="n">IOException</code> <code class="n">e</code><code class="o">)</code> <code class="o">{</code>&#13;
            <code class="k">throw</code> <code class="k">new</code> <code class="nf">RuntimeException</code><code class="o">(</code><code class="s">"IOException: "</code> <code class="o">+</code> <code class="n">e</code><code class="o">);</code>&#13;
        <code class="o">}</code>&#13;
        <code class="k">return</code> <code class="n">sum</code><code class="o">;</code>&#13;
    <code class="o">}</code></pre></div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="3.4 Aligning, Indenting, and Unindenting Strings" data-type="sect1"><div class="sect1" id="javacook-strings-SECT-5">&#13;
<h1>3.4 Aligning, Indenting, and Unindenting Strings</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-strings-SECT-5.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="aligning strings" data-type="indexterm" id="al_str"/><a data-primary="indenting strings" data-type="indexterm" id="ind_str"/><a data-primary="strings" data-secondary="aligning" data-type="indexterm" id="str_al"/><a data-primary="strings" data-secondary="indenting" data-type="indexterm" id="str_ind"/><a data-primary="strings" data-secondary="un-indenting" data-type="indexterm" id="str_un"/><a data-primary="un-indenting strings" data-type="indexterm" id="un_str"/>You want to align strings to the left, right, or center.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-strings-SECT-5.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Do the math yourself, and use <code>substring</code> (see <a data-type="xref" href="#javacook-strings-SECT-1">Recipe 3.1</a>) and a <code>StringBuilder</code> (see <a data-type="xref" href="#javacook-strings-SECT-3">Recipe 3.2</a>). Or, use my <code>StringAlign</code>  class, which is based on the <code>java.text.Format</code> class.&#13;
For left or right alignment, use <a data-primary="String.format() method" data-type="indexterm" id="idm45290702886888"/><code>String.format()</code>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-strings-SECT-5.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>Centering and aligning text comes up fairly often. Suppose you want to print a simple report with centered page numbers. There doesn’t seem to be anything in the standard API that will do the job fully for you. But I have written a class called <a data-primary="StringAlign class" data-type="indexterm" id="idm45290702883368"/><code>String​A⁠lign</code> that will. Here’s how you might use it:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">StringAlignSimple</code> <code class="o">{</code>&#13;
&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">args</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="c1">// Construct a "formatter" to center strings.</code>&#13;
        <code class="n">StringAlign</code> <code class="n">formatter</code> <code class="o">=</code> <code class="k">new</code> <code class="n">StringAlign</code><code class="o">(</code><code class="mi">70</code><code class="o">,</code> <code class="n">StringAlign</code><code class="o">.</code><code class="na">Justify</code><code class="o">.</code><code class="na">CENTER</code><code class="o">);</code>&#13;
        <code class="c1">// Try it out, for page "i"</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">formatter</code><code class="o">.</code><code class="na">format</code><code class="o">(</code><code class="s">"- i -"</code><code class="o">));</code>&#13;
        <code class="c1">// Try it out, for page 4. Since this formatter is</code>&#13;
        <code class="c1">// optimized for Strings, not specifically for page numbers,</code>&#13;
        <code class="c1">// we have to convert the number to a String</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">formatter</code><code class="o">.</code><code class="na">format</code><code class="o">(</code><code class="n">Integer</code><code class="o">.</code><code class="na">toString</code><code class="o">(</code><code class="mi">4</code><code class="o">)));</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p>If you compile and run this class, it prints the two demonstration line numbers centered, as shown:</p>&#13;
<pre data-type="programlisting" id="I_3_tt79">&gt; <strong>javac -d . StringAlignSimple.java</strong>&#13;
&gt; <strong>java strings.StringAlignSimple</strong>&#13;
                                - i -&#13;
                                  4&#13;
&gt;</pre>&#13;
&#13;
<p><a data-type="xref" href="#javacook-strings-EX-4">Example 3-5</a> is the code for the <code>StringAlign</code> class. Note that this class extends the class <code>Format</code> in the package <code>java.text</code>. There is a series of <a data-primary="format() method" data-type="indexterm" id="idm45290702797608"/><code>Format</code> classes that all have at least one method called <code>format()</code>. It is thus in a family with numerous other formatters, such as <code>DateFormat</code> and <code>NumberFormat</code>, that we’ll take a look at in upcoming chapters.</p>&#13;
<div data-type="example" id="javacook-strings-EX-4">&#13;
<h5><span class="label">Example 3-5. </span>main/src/main/java/strings/StringAlign.java</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">StringAlign</code> <code class="kd">extends</code> <code class="n">Format</code> <code class="o">{</code>&#13;
&#13;
    <code class="kd">private</code> <code class="kd">static</code> <code class="kd">final</code> <code class="kt">long</code> <code class="n">serialVersionUID</code> <code class="o">=</code> <code class="mi">1L</code><code class="o">;</code>&#13;
&#13;
    <code class="kd">public</code> <code class="kd">enum</code> <code class="n">Justify</code> <code class="o">{</code>&#13;
        <code class="cm">/* Constant for left justification. */</code>&#13;
        <code class="n">LEFT</code><code class="o">,</code>&#13;
        <code class="cm">/* Constant for centering. */</code>&#13;
        <code class="n">CENTER</code><code class="o">,</code>&#13;
        <code class="cm">/** Constant for right-justified Strings. */</code>&#13;
        <code class="n">RIGHT</code><code class="o">,</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/** Current justification */</code>&#13;
    <code class="kd">private</code> <code class="n">Justify</code> <code class="n">just</code><code class="o">;</code>&#13;
    <code class="cm">/** Current max length */</code>&#13;
    <code class="kd">private</code> <code class="kt">int</code> <code class="n">maxChars</code><code class="o">;</code>&#13;
&#13;
    <code class="cm">/** Construct a StringAlign formatter; length and alignment are</code>&#13;
<code class="cm">     * passed to the Constructor instead of each format() call as the</code>&#13;
<code class="cm">     * expected common use is in repetitive formatting e.g., page numbers.</code>&#13;
<code class="cm">     * @param maxChars - the maximum length of the output</code>&#13;
<code class="cm">     * @param just - one of the enum values LEFT, CENTER or RIGHT</code>&#13;
<code class="cm">     */</code>&#13;
    <code class="kd">public</code> <code class="nf">StringAlign</code><code class="o">(</code><code class="kt">int</code> <code class="n">maxChars</code><code class="o">,</code> <code class="n">Justify</code> <code class="n">just</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="k">switch</code><code class="o">(</code><code class="n">just</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="k">case</code> <code class="nl">LEFT:</code>&#13;
        <code class="k">case</code> <code class="nl">CENTER:</code>&#13;
        <code class="k">case</code> <code class="nl">RIGHT:</code>&#13;
            <code class="k">this</code><code class="o">.</code><code class="na">just</code> <code class="o">=</code> <code class="n">just</code><code class="o">;</code>&#13;
            <code class="k">break</code><code class="o">;</code>&#13;
        <code class="k">default</code><code class="o">:</code>&#13;
            <code class="k">throw</code> <code class="k">new</code> <code class="nf">IllegalArgumentException</code><code class="o">(</code><code class="s">"invalid justification arg."</code><code class="o">);</code>&#13;
        <code class="o">}</code>&#13;
        <code class="k">if</code> <code class="o">(</code><code class="n">maxChars</code> <code class="o">&lt;</code> <code class="mi">0</code><code class="o">)</code> <code class="o">{</code>&#13;
            <code class="k">throw</code> <code class="k">new</code> <code class="nf">IllegalArgumentException</code><code class="o">(</code><code class="s">"maxChars must be positive."</code><code class="o">);</code>&#13;
        <code class="o">}</code>&#13;
        <code class="k">this</code><code class="o">.</code><code class="na">maxChars</code> <code class="o">=</code> <code class="n">maxChars</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/** Format a String.</code>&#13;
<code class="cm">     * @param input - the string to be aligned.</code>&#13;
<code class="cm">     * @parm where - the StringBuilder to append it to.</code>&#13;
<code class="cm">     * @param ignore - a FieldPosition (may be null, not used but</code>&#13;
<code class="cm">     * specified by the general contract of Format).</code>&#13;
<code class="cm">     */</code>&#13;
    <code class="nd">@Override</code>&#13;
    <code class="kd">public</code> <code class="n">StringBuffer</code> <code class="nf">format</code><code class="o">(</code>&#13;
        <code class="n">Object</code> <code class="n">input</code><code class="o">,</code> <code class="n">StringBuffer</code> <code class="n">where</code><code class="o">,</code> <code class="n">FieldPosition</code> <code class="n">ignore</code><code class="o">)</code>  <code class="o">{</code>&#13;
&#13;
        <code class="n">String</code> <code class="n">s</code> <code class="o">=</code> <code class="n">input</code><code class="o">.</code><code class="na">toString</code><code class="o">();</code>&#13;
        <code class="n">String</code> <code class="n">wanted</code> <code class="o">=</code> <code class="n">s</code><code class="o">.</code><code class="na">substring</code><code class="o">(</code><code class="mi">0</code><code class="o">,</code> <code class="n">Math</code><code class="o">.</code><code class="na">min</code><code class="o">(</code><code class="n">s</code><code class="o">.</code><code class="na">length</code><code class="o">(),</code> <code class="n">maxChars</code><code class="o">));</code>&#13;
&#13;
        <code class="c1">// Get the spaces in the right place.</code>&#13;
        <code class="k">switch</code> <code class="o">(</code><code class="n">just</code><code class="o">)</code> <code class="o">{</code>&#13;
            <code class="k">case</code> <code class="nl">RIGHT:</code>&#13;
                <code class="n">pad</code><code class="o">(</code><code class="n">where</code><code class="o">,</code> <code class="n">maxChars</code> <code class="o">-</code> <code class="n">wanted</code><code class="o">.</code><code class="na">length</code><code class="o">());</code>&#13;
                <code class="n">where</code><code class="o">.</code><code class="na">append</code><code class="o">(</code><code class="n">wanted</code><code class="o">);</code>&#13;
                <code class="k">break</code><code class="o">;</code>&#13;
            <code class="k">case</code> <code class="nl">CENTER:</code>&#13;
                <code class="kt">int</code> <code class="n">toAdd</code> <code class="o">=</code> <code class="n">maxChars</code> <code class="o">-</code> <code class="n">wanted</code><code class="o">.</code><code class="na">length</code><code class="o">();</code>&#13;
                <code class="n">pad</code><code class="o">(</code><code class="n">where</code><code class="o">,</code> <code class="n">toAdd</code><code class="o">/</code><code class="mi">2</code><code class="o">);</code>&#13;
                <code class="n">where</code><code class="o">.</code><code class="na">append</code><code class="o">(</code><code class="n">wanted</code><code class="o">);</code>&#13;
                <code class="n">pad</code><code class="o">(</code><code class="n">where</code><code class="o">,</code> <code class="n">toAdd</code> <code class="o">-</code> <code class="n">toAdd</code><code class="o">/</code><code class="mi">2</code><code class="o">);</code>&#13;
                <code class="k">break</code><code class="o">;</code>&#13;
            <code class="k">case</code> <code class="nl">LEFT:</code>&#13;
                <code class="n">where</code><code class="o">.</code><code class="na">append</code><code class="o">(</code><code class="n">wanted</code><code class="o">);</code>&#13;
                <code class="n">pad</code><code class="o">(</code><code class="n">where</code><code class="o">,</code> <code class="n">maxChars</code> <code class="o">-</code> <code class="n">wanted</code><code class="o">.</code><code class="na">length</code><code class="o">());</code>&#13;
                <code class="k">break</code><code class="o">;</code>&#13;
            <code class="o">}</code>&#13;
        <code class="k">return</code> <code class="n">where</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="kd">protected</code> <code class="kd">final</code> <code class="kt">void</code> <code class="nf">pad</code><code class="o">(</code><code class="n">StringBuffer</code> <code class="n">to</code><code class="o">,</code> <code class="kt">int</code> <code class="n">howMany</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">i</code><code class="o">=</code><code class="mi">0</code><code class="o">;</code> <code class="n">i</code><code class="o">&lt;</code><code class="n">howMany</code><code class="o">;</code> <code class="n">i</code><code class="o">++)</code>&#13;
            <code class="n">to</code><code class="o">.</code><code class="na">append</code><code class="o">(</code><code class="sc">' '</code><code class="o">);</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/** Convenience Routine */</code>&#13;
    <code class="n">String</code> <code class="nf">format</code><code class="o">(</code><code class="n">String</code> <code class="n">s</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="k">return</code> <code class="nf">format</code><code class="o">(</code><code class="n">s</code><code class="o">,</code> <code class="k">new</code> <code class="n">StringBuffer</code><code class="o">(),</code> <code class="kc">null</code><code class="o">).</code><code class="na">toString</code><code class="o">();</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/** ParseObject is required, but not useful here. */</code>&#13;
    <code class="kd">public</code> <code class="n">Object</code> <code class="nf">parseObject</code> <code class="o">(</code><code class="n">String</code> <code class="n">source</code><code class="o">,</code> <code class="n">ParsePosition</code> <code class="n">pos</code><code class="o">)</code>  <code class="o">{</code>&#13;
        <code class="k">return</code> <code class="n">source</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre></div>&#13;
&#13;
<p>Java 12 introduced a new method <code>public String indent(int n)</code> that prepends <em>n</em> spaces&#13;
to the string, which is treated as a sequence of lines with line separators.&#13;
This works well in conjunction with the Java 11 <code>Stream&lt;String&gt; lines()</code> method. For example, for the case where a series of lines, already stored in a single string,&#13;
 needs the same indent&#13;
(<code>Streams</code>, and the “::” notation, are explained in <a data-type="xref" href="ch09.html#javacook-fp-intro">Recipe 9.0</a>):</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">jshell</code><code class="o">&gt;</code> <code class="s">"abc\ndef"</code><code class="o">.</code><code class="na">indent</code><code class="o">(</code><code class="mi">30</code><code class="o">).</code><code class="na">lines</code><code class="o">().</code><code class="na">forEach</code><code class="o">(</code><code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">::</code><code class="n">println</code><code class="o">);</code>&#13;
                              <code class="n">abc</code>&#13;
                              <code class="n">def</code>&#13;
&#13;
<code class="n">jshell</code><code class="o">&gt;</code> <code class="s">"abc\ndef"</code><code class="o">.</code><code class="na">indent</code><code class="o">(</code><code class="mi">30</code><code class="o">).</code><code class="na">indent</code><code class="o">(-</code><code class="mi">10</code><code class="o">).</code><code class="na">lines</code><code class="o">().</code><code class="na">forEach</code><code class="o">(</code><code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">::</code><code class="n">println</code><code class="o">);</code>&#13;
                    <code class="n">abc</code>&#13;
                    <code class="n">def</code>&#13;
&#13;
<code class="n">jshell</code><code class="o">&gt;</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="See Also" data-type="sect2"><div class="sect2" id="javacook-strings-SECT-5.4">&#13;
<h2>See Also</h2>&#13;
&#13;
<p>The alignment of numeric columns is considered in <a data-type="xref" href="ch05.html#javacook-numbers">Chapter 5</a>.<a data-primary="" data-startref="al_str" data-type="indexterm" id="idm45290702305976"/><a data-primary="" data-startref="ind_str" data-type="indexterm" id="idm45290702305000"/><a data-primary="" data-startref="str_al" data-type="indexterm" id="idm45290702304056"/><a data-primary="" data-startref="str_ind" data-type="indexterm" id="idm45290702303112"/><a data-primary="" data-startref="str_un" data-type="indexterm" id="idm45290702302168"/><a data-primary="" data-startref="un_str" data-type="indexterm" id="idm45290702301224"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="3.5 Converting Between Unicode Characters and Strings" data-type="sect1"><div class="sect1" id="javacook-strings-SECT-6">&#13;
<h1>3.5 Converting Between Unicode Characters and Strings</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-strings-SECT-6.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="strings" data-secondary="converting to Unicode characters" data-type="indexterm" id="str_con"/><a data-primary="Unicode, converting between strings and" data-type="indexterm" id="uni_con"/>You want to convert between Unicode characters and <code>String</code>s.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-strings-SECT-6.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use Java <code>char</code> or <code>String</code> data types to deal with characters;&#13;
these intrinsically support Unicode.&#13;
Print characters as integers to display their <em>raw</em> value if needed.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="idm45290702290728">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>Unicode is an international standard that aims to represent all known characters used by&#13;
people in their various languages. Though the original ASCII character set is a subset, Unicode is huge.&#13;
At the time Java was created, Unicode was a 16-bit character set, so it seemed natural&#13;
to make Java <code>char</code> values be 16 bits in width, and for years a <code>char</code> could hold any Unicode character.&#13;
However, over time, Unicode has grown, to the point that it now includes over a million code points,&#13;
or characters, more than the 65,525 that could be represented in 16 bits.<sup><a data-type="noteref" href="ch03.html#idm45290702287384" id="idm45290702287384-marker">5</a></sup>&#13;
Not all possible 16-bit values were defined as characters in UCS-2, the 16-bit version of&#13;
Unicode originally used in Java. A few were reserved as escape characters, which allows&#13;
for multicharacter-length mappings to less common characters.&#13;
Fortunately, there is a go-between standard, called <a data-primary="UTF-16 (16-bit Unicode Transformation Format)" data-type="indexterm" id="idm45290702286152"/>UTF-16 (16-bit Unicode Transformation Format).&#13;
As the <code>String</code> class documentation puts it:</p>&#13;
<blockquote>&#13;
<p>A <code>String</code> represents a string in the UTF-16 format in which<a data-primary="supplementary characters" data-type="indexterm" id="idm45290702283528"/> <em>supplementary characters</em> are represented by<a data-primary="surrogate pairs" data-type="indexterm" id="idm45290702282264"/> <em>surrogate pairs</em> (see the section Unicode Character Representations in the <code>Character</code> class for more information). Index values refer to char code units, so a supplementary character uses two positions in a <code>String</code>.</p>&#13;
&#13;
<p>The <code>String</code> class provides methods for dealing with Unicode code points (i.e., characters), in addition to those for dealing with Unicode code units (i.e., <code>char values</code>).</p></blockquote>&#13;
&#13;
<p>The <a data-primary="charAt() method" data-type="indexterm" id="idm45290702278280"/><code>charAt()</code> method of <code>String</code> returns the <code>char</code> value for the character at the specified offset.&#13;
The<a data-primary="append() methods" data-type="indexterm" id="idm45290702275816"/> <code>StringBuilder append()</code> method has a form that accepts a <code>char</code>.&#13;
Because <code>char</code> is an integer type, you can even&#13;
do arithmetic on <code>char</code>s, though this is not needed as frequently as in, say, C. Nor&#13;
is it often recommended, because the <code>Character</code> class provides the methods for which these&#13;
operations were normally used in languages such as C. Here is a program that uses&#13;
arithmetic on <code>char</code>s to control a loop and that also appends the characters into a&#13;
<code>StringBuilder</code> (see <a data-type="xref" href="#javacook-strings-SECT-3">Recipe 3.2</a>):</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting">        <code class="c1">// UnicodeChars.java</code>&#13;
        <code class="n">StringBuilder</code> <code class="n">b</code> <code class="o">=</code> <code class="k">new</code> <code class="n">StringBuilder</code><code class="o">();</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="kt">char</code> <code class="n">c</code> <code class="o">=</code> <code class="sc">'a'</code><code class="o">;</code> <code class="n">c</code><code class="o">&lt;</code><code class="sc">'d'</code><code class="o">;</code> <code class="n">c</code><code class="o">++)</code> <code class="o">{</code>&#13;
            <code class="n">b</code><code class="o">.</code><code class="na">append</code><code class="o">(</code><code class="n">c</code><code class="o">);</code>&#13;
        <code class="o">}</code>&#13;
        <code class="n">b</code><code class="o">.</code><code class="na">append</code><code class="o">(</code><code class="sc">'\u00a5'</code><code class="o">);</code>    <code class="c1">// Japanese Yen symbol</code>&#13;
        <code class="n">b</code><code class="o">.</code><code class="na">append</code><code class="o">(</code><code class="sc">'\u01FC'</code><code class="o">);</code>    <code class="c1">// Roman AE with acute accent</code>&#13;
        <code class="n">b</code><code class="o">.</code><code class="na">append</code><code class="o">(</code><code class="sc">'\u0391'</code><code class="o">);</code>    <code class="c1">// GREEK Capital Alpha</code>&#13;
        <code class="n">b</code><code class="o">.</code><code class="na">append</code><code class="o">(</code><code class="sc">'\u03A9'</code><code class="o">);</code>    <code class="c1">// GREEK Capital Omega</code>&#13;
&#13;
        <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">i</code><code class="o">=</code><code class="mi">0</code><code class="o">;</code> <code class="n">i</code><code class="o">&lt;</code><code class="n">b</code><code class="o">.</code><code class="na">length</code><code class="o">();</code> <code class="n">i</code><code class="o">++)</code> <code class="o">{</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">printf</code><code class="o">(</code>&#13;
                <code class="s">"Character #%d (%04x) is %c%n"</code><code class="o">,</code>&#13;
                <code class="n">i</code><code class="o">,</code> <code class="o">(</code><code class="kt">int</code><code class="o">)</code><code class="n">b</code><code class="o">.</code><code class="na">charAt</code><code class="o">(</code><code class="n">i</code><code class="o">),</code> <code class="n">b</code><code class="o">.</code><code class="na">charAt</code><code class="o">(</code><code class="n">i</code><code class="o">));</code>&#13;
        <code class="o">}</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Accumulated characters are "</code> <code class="o">+</code> <code class="n">b</code><code class="o">);</code></pre>&#13;
&#13;
<p>When you run it, the expected results are printed for the ASCII characters. On Unix and <a data-primary="Mac" data-type="indexterm" id="idm45290702231176"/>characters in&#13;
<a data-primary="Unix" data-secondary="characters in" data-type="indexterm" id="idm45290702230440"/>Mac systems, the default fonts don’t include all the additional characters, so they are either omitted or mapped to irregular characters:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">$</code> <code class="n">java</code> <code class="o">-</code><code class="n">cp</code> <code class="n">target</code><code class="o">/</code><code class="n">classes</code> <code class="n">strings</code><code class="o">.</code><code class="na">UnicodeChars</code>&#13;
<code class="n">Character</code> <code class="err">#</code><code class="mi">0</code> <code class="o">(</code><code class="mi">0061</code><code class="o">)</code> <code class="n">is</code> <code class="n">a</code>&#13;
<code class="n">Character</code> <code class="err">#</code><code class="mi">1</code> <code class="o">(</code><code class="mi">0062</code><code class="o">)</code> <code class="n">is</code> <code class="n">b</code>&#13;
<code class="n">Character</code> <code class="err">#</code><code class="mi">2</code> <code class="o">(</code><code class="mi">0063</code><code class="o">)</code> <code class="n">is</code> <code class="n">c</code>&#13;
<code class="n">Character</code> <code class="err">#</code><code class="mi">3</code> <code class="o">(</code><code class="mi">00</code><code class="n">a5</code><code class="o">)</code> <code class="n">is</code> <code class="err">¥</code>&#13;
<code class="n">Character</code> <code class="err">#</code><code class="mi">4</code> <code class="o">(</code><code class="mi">01</code><code class="n">fc</code><code class="o">)</code> <code class="n">is</code> <code class="err">Ǽ</code>&#13;
<code class="n">Character</code> <code class="err">#</code><code class="mi">5</code> <code class="o">(</code><code class="mi">0391</code><code class="o">)</code> <code class="n">is</code> <code class="err">Α</code>&#13;
<code class="n">Character</code> <code class="err">#</code><code class="mi">6</code> <code class="o">(</code><code class="mi">03</code><code class="n">a9</code><code class="o">)</code> <code class="n">is</code> <code class="err">Ω</code>&#13;
<code class="n">Accumulated</code> <code class="n">characters</code> <code class="n">are</code> <code class="n">abc</code><code class="err">¥ǼΑΩ</code>&#13;
<code class="n">$</code></pre>&#13;
&#13;
<p>The <a data-primary="Windows" data-secondary="characters in" data-type="indexterm" id="idm45290702188968"/>Windows system used to try this doesn’t have most of those characters either, but at least it prints as question marks the ones it knows are lacking (Windows system fonts are more homogenous than those of the various Unix systems, so it is easier to know what won’t work). On the other hand, it tries to print the yen sign as an N with a tilde:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">Character</code> <code class="err">#</code><code class="mi">0</code> <code class="n">is</code> <code class="n">a</code>&#13;
<code class="n">Character</code> <code class="err">#</code><code class="mi">1</code> <code class="n">is</code> <code class="n">b</code>&#13;
<code class="n">Character</code> <code class="err">#</code><code class="mi">2</code> <code class="n">is</code> <code class="n">c</code>&#13;
<code class="n">Character</code> <code class="err">#</code><code class="mi">3</code> <code class="n">is</code> <code class="err">¥</code>&#13;
<code class="n">Character</code> <code class="err">#</code><code class="mi">4</code> <code class="n">is</code> <code class="o">?</code>&#13;
<code class="n">Character</code> <code class="err">#</code><code class="mi">5</code> <code class="n">is</code> <code class="o">?</code>&#13;
<code class="n">Character</code> <code class="err">#</code><code class="mi">6</code> <code class="n">is</code> <code class="o">?</code>&#13;
<code class="n">Accumulated</code> <code class="n">characters</code> <code class="n">are</code> <code class="n">abc</code><code class="err">¥</code><code class="n">___</code></pre>&#13;
&#13;
<p>The “_” characters are unprintable characters.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="See Also" data-type="sect2"><div class="sect2" id="javacook-strings-SECT-6.3">&#13;
<h2>See Also</h2>&#13;
&#13;
<p>The <code>Unicode</code> program in this book’s online source displays any 256-character section of&#13;
the Unicode character set. You can download documentation listing every character in the Unicode character&#13;
set from the <a href="http://www.unicode.org">Unicode Consortium</a>.<a data-primary="" data-startref="str_con" data-type="indexterm" id="idm45290701845112"/><a data-primary="" data-startref="uni_con" data-type="indexterm" id="idm45290701844104"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="3.6 Reversing a String by Word or by Character" data-type="sect1"><div class="sect1" id="javacook-strings-SECT-7">&#13;
<h1>3.6 Reversing a String by Word or by Character</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-strings-SECT-7.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="reversing strings by word or character" data-type="indexterm" id="idm45290701840040"/><a data-primary="strings" data-secondary="reversing" data-type="indexterm" id="idm45290701839368"/>You wish to reverse a  string, a character  at a time or a word at a time.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-strings-SECT-7.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>You can reverse a string by character easily, using a <code>StringBuilder</code>. There are several ways to reverse a string a word at a time. One natural way is to use a <code>StringTokenizer</code> and a stack. <code>Stack</code> is a class (defined in <code>java.util</code>; see <a data-type="xref" href="ch07.html#javacook-structure-SECT-14">Recipe 7.16</a>) that implements an easy-to-use last-in, first-out (LIFO)   stack of objects.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-strings-SECT-7.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>To reverse the characters in a string, use the<a data-primary="reverse() method" data-type="indexterm" id="idm45290701831640"/> <code>StringBuilder reverse()</code> method:</p>&#13;
&#13;
<p><em>main/src/main/java/strings/StringRevChar.java</em></p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">String</code> <code class="n">sh</code> <code class="o">=</code> <code class="s">"FCGDAEB"</code><code class="o">;</code>&#13;
<code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">sh</code> <code class="o">+</code> <code class="s">" -&gt; "</code> <code class="o">+</code> <code class="k">new</code> <code class="n">StringBuilder</code><code class="o">(</code><code class="n">sh</code><code class="o">).</code><code class="na">reverse</code><code class="o">());</code></pre>&#13;
&#13;
<p>The letters in this example list the order of the sharps in the key signatures of Western music; in reverse, it lists the order of flats. Alternatively, of course, you could reverse the characters yourself, using character-at-a-time mode (see <a data-type="xref" href="#javacook-strings-SECT-4">Recipe 3.3</a>).</p>&#13;
&#13;
<p>A popular mnemonic, or memory aid, to help music students remember the order of sharps and flats consists of one word for each sharp instead of just one letter. Let’s reverse this <em>one word at a time</em>. <a data-type="xref" href="#javacook-strings-EX-5">Example 3-6</a> adds each one to a <code>Stack</code> (see <a data-type="xref" href="ch07.html#javacook-structure-SECT-14">Recipe 7.16</a>), then processes the whole lot in LIFO order, which reverses the order.</p>&#13;
<div data-type="example" id="javacook-strings-EX-5">&#13;
<h5><span class="label">Example 3-6. </span>main/src/main/java/strings/StringReverse.java</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting">        <code class="n">String</code> <code class="n">s</code> <code class="o">=</code> <code class="s">"Father Charles Goes Down And Ends Battle"</code><code class="o">;</code>&#13;
&#13;
        <code class="c1">// Put it in the stack frontwards</code>&#13;
        <code class="n">Stack</code><code class="o">&lt;</code><code class="n">String</code><code class="o">&gt;</code> <code class="n">myStack</code> <code class="o">=</code> <code class="k">new</code> <code class="n">Stack</code><code class="o">&lt;&gt;();</code>&#13;
        <code class="n">StringTokenizer</code> <code class="n">st</code> <code class="o">=</code> <code class="k">new</code> <code class="n">StringTokenizer</code><code class="o">(</code><code class="n">s</code><code class="o">);</code>&#13;
        <code class="k">while</code> <code class="o">(</code><code class="n">st</code><code class="o">.</code><code class="na">hasMoreTokens</code><code class="o">())</code> <code class="o">{</code>&#13;
            <code class="n">myStack</code><code class="o">.</code><code class="na">push</code><code class="o">(</code><code class="n">st</code><code class="o">.</code><code class="na">nextToken</code><code class="o">());</code>&#13;
        <code class="o">}</code>&#13;
&#13;
        <code class="c1">// Print the stack backwards</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">print</code><code class="o">(</code><code class="sc">'"'</code> <code class="o">+</code> <code class="n">s</code> <code class="o">+</code> <code class="sc">'"'</code> <code class="o">+</code> <code class="s">" backwards by word is:\n\t\""</code><code class="o">);</code>&#13;
        <code class="k">while</code> <code class="o">(!</code><code class="n">myStack</code><code class="o">.</code><code class="na">empty</code><code class="o">())</code> <code class="o">{</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">print</code><code class="o">(</code><code class="n">myStack</code><code class="o">.</code><code class="na">pop</code><code class="o">());</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">print</code><code class="o">(</code><code class="sc">' '</code><code class="o">);</code>    <code class="c1">// inter-word spacing</code>&#13;
        <code class="o">}</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="sc">'"'</code><code class="o">);</code></pre></div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="3.7 Expanding and Compressing Tabs" data-type="sect1"><div class="sect1" id="javacook-strings-SECT-8">&#13;
<h1>3.7 Expanding and Compressing Tabs</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-strings-SECT-8.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="compressing tabs" data-type="indexterm" id="com_tab"/><a data-primary="expanding tabs" data-type="indexterm" id="exp_tab"/><a data-primary="strings" data-secondary="tabs, expanding/compressing" data-type="indexterm" id="str_tab"/><a data-primary="tabs, expanding and compressing" data-type="indexterm" id="tab_exp"/>You need to convert space characters to tab characters in a file, or vice versa. You might want to replace spaces with tabs to save space on disk or go the other way to deal with a device or program that can’t handle tabs.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-strings-SECT-8.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use my <code>Tabs</code> class or its subclass <code>EnTab</code>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-strings-SECT-8.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>Because programs that deal with tabbed text or data expect tab stops&#13;
to be at fixed positions, you cannot use a typical text editor to&#13;
replace tabs with spaces or vice versa.&#13;
<a data-type="xref" href="#javacook-strings-EX-6">Example 3-7</a> is a listing of <code>EnTab</code>, complete with a sample main program. The program works a line at a time. For each character on the line, if the character is a space, we see if we can coalesce it with previous spaces to output a single tab character. This program depends on the <a data-primary="Tabs class" data-type="indexterm" id="idm45290701649656"/><code>Tabs</code>  class, which we’ll come to shortly. The <code>Tabs</code> class is used to decide which column positions represent tab stops and which do not.</p>&#13;
<div data-type="example" id="javacook-strings-EX-6">&#13;
<h5><span class="label">Example 3-7. </span>main/src/main/java/strings/Entab.java</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">EnTab</code> <code class="o">{</code>&#13;
&#13;
    <code class="kd">private</code> <code class="kd">static</code> <code class="n">Logger</code> <code class="n">logger</code> <code class="o">=</code> <code class="n">Logger</code><code class="o">.</code><code class="na">getLogger</code><code class="o">(</code><code class="n">EnTab</code><code class="o">.</code><code class="na">class</code><code class="o">.</code><code class="na">getSimpleName</code><code class="o">());</code>&#13;
&#13;
    <code class="cm">/** The Tabs (tab logic handler) */</code>&#13;
    <code class="kd">protected</code> <code class="n">Tabs</code> <code class="n">tabs</code><code class="o">;</code>&#13;
&#13;
    <code class="cm">/**</code>&#13;
<code class="cm">     * Delegate tab spacing information to tabs.</code>&#13;
<code class="cm">     */</code>&#13;
    <code class="kd">public</code> <code class="kt">int</code> <code class="nf">getTabSpacing</code><code class="o">()</code> <code class="o">{</code>&#13;
        <code class="k">return</code> <code class="n">tabs</code><code class="o">.</code><code class="na">getTabSpacing</code><code class="o">();</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/**</code>&#13;
<code class="cm">     * Main program: just create an EnTab object, and pass the standard input</code>&#13;
<code class="cm">     * or the named file(s) through it.</code>&#13;
<code class="cm">     */</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">argv</code><code class="o">)</code> <code class="kd">throws</code> <code class="n">IOException</code> <code class="o">{</code>&#13;
        <code class="n">EnTab</code> <code class="n">et</code> <code class="o">=</code> <code class="k">new</code> <code class="n">EnTab</code><code class="o">(</code><code class="mi">8</code><code class="o">);</code>&#13;
        <code class="k">if</code> <code class="o">(</code><code class="n">argv</code><code class="o">.</code><code class="na">length</code> <code class="o">==</code> <code class="mi">0</code><code class="o">)</code> <code class="c1">// do standard input</code>&#13;
            <code class="n">et</code><code class="o">.</code><code class="na">entab</code><code class="o">(</code>&#13;
                <code class="k">new</code> <code class="nf">BufferedReader</code><code class="o">(</code><code class="k">new</code> <code class="n">InputStreamReader</code><code class="o">(</code><code class="n">System</code><code class="o">.</code><code class="na">in</code><code class="o">)),</code>&#13;
                <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">);</code>&#13;
        <code class="k">else</code>&#13;
            <code class="nf">for</code> <code class="o">(</code><code class="n">String</code> <code class="n">fileName</code> <code class="o">:</code> <code class="n">argv</code><code class="o">)</code> <code class="o">{</code> <code class="c1">// do each file</code>&#13;
                <code class="n">et</code><code class="o">.</code><code class="na">entab</code><code class="o">(</code>&#13;
                    <code class="k">new</code> <code class="nf">BufferedReader</code><code class="o">(</code><code class="k">new</code> <code class="n">FileReader</code><code class="o">(</code><code class="n">fileName</code><code class="o">)),</code>&#13;
                    <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">);</code>&#13;
            <code class="o">}</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/**</code>&#13;
<code class="cm">     * Constructor: just save the tab values.</code>&#13;
<code class="cm">     * @param n The number of spaces each tab is to replace.</code>&#13;
<code class="cm">     */</code>&#13;
    <code class="kd">public</code> <code class="nf">EnTab</code><code class="o">(</code><code class="kt">int</code> <code class="n">n</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">tabs</code> <code class="o">=</code> <code class="k">new</code> <code class="n">Tabs</code><code class="o">(</code><code class="n">n</code><code class="o">);</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="kd">public</code> <code class="nf">EnTab</code><code class="o">()</code> <code class="o">{</code>&#13;
        <code class="n">tabs</code> <code class="o">=</code> <code class="k">new</code> <code class="n">Tabs</code><code class="o">();</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/**</code>&#13;
<code class="cm">     * entab: process one file, replacing blanks with tabs.</code>&#13;
<code class="cm">     * @param is A BufferedReader opened to the file to be read.</code>&#13;
<code class="cm">     * @param out a PrintWriter to send the output to.</code>&#13;
<code class="cm">     */</code>&#13;
    <code class="kd">public</code> <code class="kt">void</code> <code class="nf">entab</code><code class="o">(</code><code class="n">BufferedReader</code> <code class="n">is</code><code class="o">,</code> <code class="n">PrintWriter</code> <code class="n">out</code><code class="o">)</code> <code class="kd">throws</code> <code class="n">IOException</code> <code class="o">{</code>&#13;
&#13;
        <code class="c1">// main loop: process entire file one line at a time.</code>&#13;
        <code class="n">is</code><code class="o">.</code><code class="na">lines</code><code class="o">().</code><code class="na">forEach</code><code class="o">(</code><code class="n">line</code> <code class="o">-&gt;</code> <code class="o">{</code>&#13;
            <code class="n">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">entabLine</code><code class="o">(</code><code class="n">line</code><code class="o">));</code>&#13;
        <code class="o">});</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/**</code>&#13;
<code class="cm">     * entab: process one file, replacing blanks with tabs.</code>&#13;
<code class="cm">     *</code>&#13;
<code class="cm">     * @param is A BufferedReader opened to the file to be read.</code>&#13;
<code class="cm">     * @param out A PrintStream to write the output to.</code>&#13;
<code class="cm">     */</code>&#13;
    <code class="kd">public</code> <code class="kt">void</code> <code class="nf">entab</code><code class="o">(</code><code class="n">BufferedReader</code> <code class="n">is</code><code class="o">,</code> <code class="n">PrintStream</code> <code class="n">out</code><code class="o">)</code> <code class="kd">throws</code> <code class="n">IOException</code> <code class="o">{</code>&#13;
        <code class="n">entab</code><code class="o">(</code><code class="n">is</code><code class="o">,</code> <code class="k">new</code> <code class="n">PrintWriter</code><code class="o">(</code><code class="n">out</code><code class="o">));</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/**</code>&#13;
<code class="cm">     * entabLine: process one line, replacing blanks with tabs.</code>&#13;
<code class="cm">     * @param line the string to be processed</code>&#13;
<code class="cm">     */</code>&#13;
    <code class="kd">public</code> <code class="n">String</code> <code class="nf">entabLine</code><code class="o">(</code><code class="n">String</code> <code class="n">line</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="kt">int</code> <code class="n">N</code> <code class="o">=</code> <code class="n">line</code><code class="o">.</code><code class="na">length</code><code class="o">(),</code> <code class="n">outCol</code> <code class="o">=</code> <code class="mi">0</code><code class="o">;</code>&#13;
        <code class="n">StringBuilder</code> <code class="n">sb</code> <code class="o">=</code> <code class="k">new</code> <code class="n">StringBuilder</code><code class="o">();</code>&#13;
        <code class="kt">char</code> <code class="n">ch</code><code class="o">;</code>&#13;
        <code class="kt">int</code> <code class="n">consumedSpaces</code> <code class="o">=</code> <code class="mi">0</code><code class="o">;</code>&#13;
&#13;
        <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">inCol</code> <code class="o">=</code> <code class="mi">0</code><code class="o">;</code> <code class="n">inCol</code> <code class="o">&lt;</code> <code class="n">N</code><code class="o">;</code> <code class="n">inCol</code><code class="o">++)</code> <code class="o">{</code> <code class="c1">// Cannot use foreach here</code>&#13;
            <code class="n">ch</code> <code class="o">=</code> <code class="n">line</code><code class="o">.</code><code class="na">charAt</code><code class="o">(</code><code class="n">inCol</code><code class="o">);</code>&#13;
            <code class="c1">// If we get a space, consume it, don't output it.</code>&#13;
            <code class="c1">// If this takes us to a tab stop, output a tab character.</code>&#13;
            <code class="k">if</code> <code class="o">(</code><code class="n">ch</code> <code class="o">==</code> <code class="sc">' '</code><code class="o">)</code> <code class="o">{</code>&#13;
                <code class="n">logger</code><code class="o">.</code><code class="na">info</code><code class="o">(</code><code class="s">"Got space at "</code> <code class="o">+</code> <code class="n">inCol</code><code class="o">);</code>&#13;
                <code class="k">if</code> <code class="o">(</code><code class="n">tabs</code><code class="o">.</code><code class="na">isTabStop</code><code class="o">(</code><code class="n">inCol</code><code class="o">))</code> <code class="o">{</code>&#13;
                    <code class="n">logger</code><code class="o">.</code><code class="na">info</code><code class="o">(</code><code class="s">"Got a Tab Stop "</code> <code class="o">+</code> <code class="n">inCol</code><code class="o">);</code>&#13;
                    <code class="n">sb</code><code class="o">.</code><code class="na">append</code><code class="o">(</code><code class="sc">'\t'</code><code class="o">);</code>&#13;
                    <code class="n">outCol</code> <code class="o">+=</code> <code class="n">consumedSpaces</code><code class="o">;</code>&#13;
                    <code class="n">consumedSpaces</code> <code class="o">=</code> <code class="mi">0</code><code class="o">;</code>&#13;
                <code class="o">}</code> <code class="k">else</code> <code class="o">{</code>&#13;
                    <code class="n">consumedSpaces</code><code class="o">++;</code>&#13;
                <code class="o">}</code>&#13;
                <code class="k">continue</code><code class="o">;</code>&#13;
            <code class="o">}</code>&#13;
&#13;
            <code class="c1">// We're at a non-space; if we're just past a tab stop, we need</code>&#13;
            <code class="c1">// to put the "leftover" spaces back out, since we consumed</code>&#13;
            <code class="c1">// them above.</code>&#13;
            <code class="k">while</code> <code class="o">(</code><code class="n">inCol</code><code class="o">-</code><code class="mi">1</code> <code class="o">&gt;</code> <code class="n">outCol</code><code class="o">)</code> <code class="o">{</code>&#13;
                <code class="n">logger</code><code class="o">.</code><code class="na">info</code><code class="o">(</code><code class="s">"Padding space at "</code> <code class="o">+</code> <code class="n">inCol</code><code class="o">);</code>&#13;
                <code class="n">sb</code><code class="o">.</code><code class="na">append</code><code class="o">(</code><code class="sc">' '</code><code class="o">);</code>&#13;
                <code class="n">outCol</code><code class="o">++;</code>&#13;
            <code class="o">}</code>&#13;
&#13;
            <code class="c1">// Now we have a plain character to output.</code>&#13;
            <code class="n">sb</code><code class="o">.</code><code class="na">append</code><code class="o">(</code><code class="n">ch</code><code class="o">);</code>&#13;
            <code class="n">outCol</code><code class="o">++;</code>&#13;
&#13;
        <code class="o">}</code>&#13;
        <code class="c1">// If line ended with trailing (or only!) spaces, preserve them.</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">i</code> <code class="o">=</code> <code class="mi">0</code><code class="o">;</code> <code class="n">i</code> <code class="o">&lt;</code> <code class="n">consumedSpaces</code><code class="o">;</code> <code class="n">i</code><code class="o">++)</code> <code class="o">{</code>&#13;
            <code class="n">logger</code><code class="o">.</code><code class="na">info</code><code class="o">(</code><code class="s">"Padding space at end # "</code> <code class="o">+</code> <code class="n">i</code><code class="o">);</code>&#13;
            <code class="n">sb</code><code class="o">.</code><code class="na">append</code><code class="o">(</code><code class="sc">' '</code><code class="o">);</code>&#13;
        <code class="o">}</code>&#13;
        <code class="k">return</code> <code class="n">sb</code><code class="o">.</code><code class="na">toString</code><code class="o">();</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre></div>&#13;
&#13;
<p>This code was patterned after a program in <a data-primary="Kernighan, Brian W." data-secondary="Software Tools" data-type="indexterm" id="idm45290690017080"/><a data-primary="Plauger, P. J." data-secondary="Software Tools" data-type="indexterm" id="idm45290690016344"/><a data-primary="Software Tools (Kernighan and Plauger)" data-type="indexterm" id="idm45290690015464"/><a data-primary="RatFor (Rational Fortran)" data-type="indexterm" id="idm45290690014728"/>Kernighan and Plauger’s classic work <em>Software&#13;
Tools</em>. While their version was in a language called RatFor (Rational Fortran), my version&#13;
has since been through several translations. Their version actually worked one character&#13;
at a time, and for a long time I tried to preserve this overall structure. Eventually, I&#13;
rewrote it to be a line-at-a-time program.</p>&#13;
&#13;
<p>The program that goes in the opposite direction—putting tabs in rather than taking them&#13;
out—is the <code>DeTab</code> class shown in <a data-type="xref" href="#javacook-strings-EX-7">Example 3-8</a>; only the core methods are&#13;
shown.</p>&#13;
<div data-type="example" id="javacook-strings-EX-7">&#13;
<h5><span class="label">Example 3-8. </span>main/src/main/java/strings/DeTab.java</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">DeTab</code> <code class="o">{</code>&#13;
    <code class="n">Tabs</code> <code class="n">ts</code><code class="o">;</code>&#13;
&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">argv</code><code class="o">)</code> <code class="kd">throws</code> <code class="n">IOException</code> <code class="o">{</code>&#13;
        <code class="n">DeTab</code> <code class="n">dt</code> <code class="o">=</code> <code class="k">new</code> <code class="n">DeTab</code><code class="o">(</code><code class="mi">8</code><code class="o">);</code>&#13;
        <code class="n">dt</code><code class="o">.</code><code class="na">detab</code><code class="o">(</code><code class="k">new</code> <code class="n">BufferedReader</code><code class="o">(</code><code class="k">new</code> <code class="n">InputStreamReader</code><code class="o">(</code><code class="n">System</code><code class="o">.</code><code class="na">in</code><code class="o">)),</code>&#13;
                <code class="k">new</code> <code class="nf">PrintWriter</code><code class="o">(</code><code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">));</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="kd">public</code> <code class="nf">DeTab</code><code class="o">(</code><code class="kt">int</code> <code class="n">n</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">ts</code> <code class="o">=</code> <code class="k">new</code> <code class="n">Tabs</code><code class="o">(</code><code class="n">n</code><code class="o">);</code>&#13;
    <code class="o">}</code>&#13;
    <code class="kd">public</code> <code class="nf">DeTab</code><code class="o">()</code> <code class="o">{</code>&#13;
        <code class="n">ts</code> <code class="o">=</code> <code class="k">new</code> <code class="n">Tabs</code><code class="o">();</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/** detab one file (replace tabs with spaces)</code>&#13;
<code class="cm">     * @param is - the file to be processed</code>&#13;
<code class="cm">     * @param out - the updated file</code>&#13;
<code class="cm">     */</code>&#13;
    <code class="kd">public</code> <code class="kt">void</code> <code class="nf">detab</code><code class="o">(</code><code class="n">BufferedReader</code> <code class="n">is</code><code class="o">,</code> <code class="n">PrintWriter</code> <code class="n">out</code><code class="o">)</code> <code class="kd">throws</code> <code class="n">IOException</code> <code class="o">{</code>&#13;
        <code class="n">is</code><code class="o">.</code><code class="na">lines</code><code class="o">().</code><code class="na">forEach</code><code class="o">(</code><code class="n">line</code> <code class="o">-&gt;</code> <code class="o">{</code>&#13;
            <code class="n">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">detabLine</code><code class="o">(</code><code class="n">line</code><code class="o">));</code>&#13;
        <code class="o">});</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/** detab one line (replace tabs with spaces)</code>&#13;
<code class="cm">     * @param line - the line to be processed</code>&#13;
<code class="cm">     * @return the updated line</code>&#13;
<code class="cm">     */</code>&#13;
    <code class="kd">public</code> <code class="n">String</code> <code class="nf">detabLine</code><code class="o">(</code><code class="n">String</code> <code class="n">line</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="kt">char</code> <code class="n">c</code><code class="o">;</code>&#13;
        <code class="kt">int</code> <code class="n">col</code><code class="o">;</code>&#13;
        <code class="n">StringBuilder</code> <code class="n">sb</code> <code class="o">=</code> <code class="k">new</code> <code class="n">StringBuilder</code><code class="o">();</code>&#13;
        <code class="n">col</code> <code class="o">=</code> <code class="mi">0</code><code class="o">;</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">i</code> <code class="o">=</code> <code class="mi">0</code><code class="o">;</code> <code class="n">i</code> <code class="o">&lt;</code> <code class="n">line</code><code class="o">.</code><code class="na">length</code><code class="o">();</code> <code class="n">i</code><code class="o">++)</code> <code class="o">{</code>&#13;
            <code class="c1">// Either ordinary character or tab.</code>&#13;
            <code class="k">if</code> <code class="o">((</code><code class="n">c</code> <code class="o">=</code> <code class="n">line</code><code class="o">.</code><code class="na">charAt</code><code class="o">(</code><code class="n">i</code><code class="o">))</code> <code class="o">!=</code> <code class="sc">'\t'</code><code class="o">)</code> <code class="o">{</code>&#13;
                <code class="n">sb</code><code class="o">.</code><code class="na">append</code><code class="o">(</code><code class="n">c</code><code class="o">);</code> <code class="c1">// Ordinary</code>&#13;
                <code class="o">++</code><code class="n">col</code><code class="o">;</code>&#13;
                <code class="k">continue</code><code class="o">;</code>&#13;
            <code class="o">}</code>&#13;
            <code class="k">do</code> <code class="o">{</code> <code class="c1">// Tab, expand it, must put &gt;=1 space</code>&#13;
                <code class="n">sb</code><code class="o">.</code><code class="na">append</code><code class="o">(</code><code class="sc">' '</code><code class="o">);</code>&#13;
            <code class="o">}</code> <code class="k">while</code> <code class="o">(!</code><code class="n">ts</code><code class="o">.</code><code class="na">isTabStop</code><code class="o">(++</code><code class="n">col</code><code class="o">));</code>&#13;
        <code class="o">}</code>&#13;
        <code class="k">return</code> <code class="n">sb</code><code class="o">.</code><code class="na">toString</code><code class="o">();</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre></div>&#13;
&#13;
<p>The <a data-primary="Tabs class" data-type="indexterm" id="idm45290689636488"/><code>Tabs</code> class provides two methods: <a data-primary="settabpos() method" data-type="indexterm" id="idm45290689635496"/><code>settabpos()</code> and <a data-primary="istabstop() method" data-type="indexterm" id="idm45290689634440"/><code>istabstop()</code>.&#13;
<a data-type="xref" href="#javacook-strings-EX-8">Example 3-9</a> is the source for the <code>Tabs</code> class.<a data-primary="" data-startref="com_tab" data-type="indexterm" id="idm45290689632040"/><a data-primary="" data-startref="exp_tab" data-type="indexterm" id="idm45290689550984"/><a data-primary="" data-startref="str_tab" data-type="indexterm" id="idm45290689550040"/><a data-primary="" data-startref="tab_exp" data-type="indexterm" id="idm45290689549096"/></p>&#13;
<div data-type="example" id="javacook-strings-EX-8">&#13;
<h5><span class="label">Example 3-9. </span>main/src/main/java/strings/Tabs.java</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">Tabs</code> <code class="o">{</code>&#13;
    <code class="cm">/** tabs every so often */</code>&#13;
    <code class="kd">public</code> <code class="kd">final</code> <code class="kd">static</code> <code class="kt">int</code> <code class="n">DEFTABSPACE</code> <code class="o">=</code>   <code class="mi">8</code><code class="o">;</code>&#13;
    <code class="cm">/** the current tab stop setting. */</code>&#13;
    <code class="kd">protected</code> <code class="kt">int</code> <code class="n">tabSpace</code> <code class="o">=</code> <code class="n">DEFTABSPACE</code><code class="o">;</code>&#13;
    <code class="cm">/** the longest line that we initially set tabs for */</code>&#13;
    <code class="kd">public</code> <code class="kd">final</code> <code class="kd">static</code> <code class="kt">int</code> <code class="n">MAXLINE</code>  <code class="o">=</code> <code class="mi">255</code><code class="o">;</code>&#13;
&#13;
    <code class="cm">/** Construct a Tabs object with a given tab stop settings */</code>&#13;
    <code class="kd">public</code> <code class="nf">Tabs</code><code class="o">(</code><code class="kt">int</code> <code class="n">n</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="k">if</code> <code class="o">(</code><code class="n">n</code> <code class="o">&lt;=</code> <code class="mi">0</code><code class="o">)</code> <code class="o">{</code>&#13;
            <code class="n">n</code> <code class="o">=</code> <code class="mi">1</code><code class="o">;</code>&#13;
        <code class="o">}</code>&#13;
        <code class="n">tabSpace</code> <code class="o">=</code> <code class="n">n</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/** Construct a Tabs object with a default tab stop settings */</code>&#13;
    <code class="kd">public</code> <code class="nf">Tabs</code><code class="o">()</code> <code class="o">{</code>&#13;
        <code class="k">this</code><code class="o">(</code><code class="n">DEFTABSPACE</code><code class="o">);</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/**</code>&#13;
<code class="cm">     * @return Returns the tabSpace.</code>&#13;
<code class="cm">     */</code>&#13;
    <code class="kd">public</code> <code class="kt">int</code> <code class="nf">getTabSpacing</code><code class="o">()</code> <code class="o">{</code>&#13;
        <code class="k">return</code> <code class="n">tabSpace</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/** isTabStop - returns true if given column is a tab stop.</code>&#13;
<code class="cm">     * @param col - the current column number</code>&#13;
<code class="cm">     */</code>&#13;
    <code class="kd">public</code> <code class="kt">boolean</code> <code class="nf">isTabStop</code><code class="o">(</code><code class="kt">int</code> <code class="n">col</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="k">if</code> <code class="o">(</code><code class="n">col</code> <code class="o">&lt;=</code> <code class="mi">0</code><code class="o">)</code>&#13;
            <code class="k">return</code> <code class="kc">false</code><code class="o">;</code>&#13;
        <code class="k">return</code> <code class="o">(</code><code class="n">col</code><code class="o">+</code><code class="mi">1</code><code class="o">)</code> <code class="o">%</code> <code class="n">tabSpace</code> <code class="o">==</code> <code class="mi">0</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre></div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="3.8 Controlling Case" data-type="sect1"><div class="sect1" id="javacook-strings-SECT-9">&#13;
<h1>3.8 Controlling Case</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-strings-SECT-9.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="case" data-type="indexterm" id="idm45290689494776"/><a data-primary="strings" data-secondary="controlling case in" data-type="indexterm" id="idm45290689494072"/>You need to either convert strings to uppercase or lowercase or compare strings without regard for case.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-strings-SECT-9.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>The <code>String</code> class has a number of methods for dealing with documents in a particular case.<a data-primary="toUpperCase() method" data-type="indexterm" id="idm45290689490120"/> <code>toUpperCase()</code> and <a data-primary="toLowerCase() method" data-type="indexterm" id="idm45290689488872"/><code>toLowerCase()</code> each return a new string that is a copy of the current string but converted, as the name implies. Each can be called either with no arguments or with a <code>Locale</code> argument specifying the conversion rules; this is necessary because of internationalization. Java’s API provides significant internationalization and localization features, as covered in&#13;
<a data-type="xref" href="#javacook-i18n-SIDEBAR-1">“Ian’s Basic Steps: Internationalization and Localization”</a>.&#13;
Whereas the <a data-primary="equals() method" data-type="indexterm" id="idm45290689486152"/><code>equals()</code> method tells you if another string is exactly the same, <a data-primary="equalsIgnoreCase() method" data-type="indexterm" id="idm45290689485064"/><code>equalsIgnoreCase()</code> tells you if all characters are the same regardless of case. Here, you can’t specify an alternative locale; the system’s default locale is used:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting">        <code class="n">String</code> <code class="n">name</code> <code class="o">=</code> <code class="s">"Java Cookbook"</code><code class="o">;</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Normal:\t"</code> <code class="o">+</code> <code class="n">name</code><code class="o">);</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Upper:\t"</code> <code class="o">+</code> <code class="n">name</code><code class="o">.</code><code class="na">toUpperCase</code><code class="o">());</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Lower:\t"</code> <code class="o">+</code> <code class="n">name</code><code class="o">.</code><code class="na">toLowerCase</code><code class="o">());</code>&#13;
        <code class="n">String</code> <code class="n">javaName</code> <code class="o">=</code> <code class="s">"java cookBook"</code><code class="o">;</code> <code class="c1">// If it were Java identifiers :-)</code>&#13;
        <code class="k">if</code> <code class="o">(!</code><code class="n">name</code><code class="o">.</code><code class="na">equals</code><code class="o">(</code><code class="n">javaName</code><code class="o">))</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">err</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"equals() correctly reports false"</code><code class="o">);</code>&#13;
        <code class="k">else</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">err</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"equals() incorrectly reports true"</code><code class="o">);</code>&#13;
        <code class="k">if</code> <code class="o">(</code><code class="n">name</code><code class="o">.</code><code class="na">equalsIgnoreCase</code><code class="o">(</code><code class="n">javaName</code><code class="o">))</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">err</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"equalsIgnoreCase() correctly reports true"</code><code class="o">);</code>&#13;
        <code class="k">else</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">err</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"equalsIgnoreCase() incorrectly reports false"</code><code class="o">);</code></pre>&#13;
&#13;
<p>If you run this, it prints the first name changed to uppercase and lowercase, then it reports that both methods work as expected:</p>&#13;
<pre data-type="programlisting" id="I_3_tt85">C:\javasrc\strings&gt;<strong>java strings.Case</strong>&#13;
Normal: Java Cookbook&#13;
Upper:  JAVA COOKBOOK&#13;
Lower:  java cookbook&#13;
equals( ) correctly reports false&#13;
equalsIgnoreCase( ) correctly reports true</pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="See Also" data-type="sect2"><div class="sect2" id="javacook-strings-SECT-9.3">&#13;
<h2>See Also</h2>&#13;
&#13;
<p><a data-primary="regular expressions (regex)" data-secondary="controlling case in" data-type="indexterm" id="idm45290689001272"/>Regular expressions make it simpler to ignore case in string searching (as we see in <a data-type="xref" href="ch04.html#javacook-regex">Chapter 4</a>).</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="3.9 Entering Nonprintable Characters" data-type="sect1"><div class="sect1" id="javacook-strings-SECT-11">&#13;
<h1>3.9 Entering Nonprintable Characters</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-strings-SECT-11.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="strings" data-secondary="nonprintable characters and" data-type="indexterm" id="idm45290688996136"/><a data-primary="nonprintable characters" data-type="indexterm" id="idm45290688995144"/>You need to put nonprintable characters into strings.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-strings-SECT-11.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use the backslash character and one of the Java string escapes.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-strings-SECT-11.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>The Java string escapes are listed in <a data-type="xref" href="#javacook-strings-TABLE-1">Table 3-1</a>.<a data-primary="escapes" data-type="indexterm" id="idm45290688989432"/></p>&#13;
<table id="javacook-strings-TABLE-1">&#13;
<caption><span class="label">Table 3-1. </span>String escapes</caption>&#13;
<thead>&#13;
<tr>&#13;
<th>To get</th>&#13;
<th>Use</th>&#13;
<th>Notes</th>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td><p>Tab</p></td>&#13;
<td><p><code>\t</code></p></td>&#13;
<td/>&#13;
</tr>&#13;
<tr>&#13;
<td><p>Linefeed (Unix newline)</p></td>&#13;
<td><p><code>\n</code></p></td>&#13;
<td><p>The call <code>System.getProperty("line.separator")</code> will give you the platform’s line end.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>Carriage return</p></td>&#13;
<td><p><code>\r</code></p></td>&#13;
<td/>&#13;
</tr>&#13;
<tr>&#13;
<td><p>Form feed</p></td>&#13;
<td><p><code>\f</code></p></td>&#13;
<td/>&#13;
</tr>&#13;
<tr>&#13;
<td><p>Backspace</p></td>&#13;
<td><p><code>\b</code></p></td>&#13;
<td/>&#13;
</tr>&#13;
<tr>&#13;
<td><p>Single quote</p></td>&#13;
<td><p><code>\</code>'</p></td>&#13;
<td/>&#13;
</tr>&#13;
<tr>&#13;
<td><p>Double quote</p></td>&#13;
<td><p><code>\</code>"</p></td>&#13;
<td/>&#13;
</tr>&#13;
<tr>&#13;
<td><p>Unicode character</p></td>&#13;
<td><p><code>\u</code> <em><code>NNNN</code></em></p></td>&#13;
<td><p>Four hexadecimal digits (no <code>\x</code> as in C/C++). See <a href="http://www.unicode.org"><em class="hyperlink">http://www.unicode.org</em></a> for codes.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>Octal(!) character</p></td>&#13;
<td><p>+\+<em><code>NNN</code></em></p></td>&#13;
<td><p>Who uses octal (base 8) these days?</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>Backslash</p></td>&#13;
<td><p><code>\\</code></p></td>&#13;
<td/>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
&#13;
<p>Here is a code example that shows most of these in action:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">StringEscapes</code> <code class="o">{</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">argv</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Java Strings in action:"</code><code class="o">);</code>&#13;
        <code class="c1">// System.out.println("An alarm or alert: \a");    // not supported</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"An alarm entered in Octal: \007"</code><code class="o">);</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"A tab key: \t(what comes after)"</code><code class="o">);</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"A newline: \n(what comes after)"</code><code class="o">);</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"A UniCode character: \u0207"</code><code class="o">);</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"A backslash character: \\"</code><code class="o">);</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p>If you have a lot of non-ASCII characters to enter, you may wish to consider using Java’s input methods, discussed briefly in the&#13;
<a href="https://docs.oracle.com/javase/8/docs/technotes/guides/imf/index.html">&#13;
online documentation</a>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="3.10 Trimming Blanks from the End of a String" data-type="sect1"><div class="sect1" id="javacook-strings-SECT-12">&#13;
<h1>3.10 Trimming Blanks from the End of a String</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-strings-SECT-12.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="trimming blanks from ends of strings" data-type="indexterm" id="idm45290688835048"/><a data-primary="strings" data-secondary="blanks, trimming" data-type="indexterm" id="idm45290688834328"/>You need to work on a string without regard for extra leading or trailing spaces a user may have typed.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-strings-SECT-12.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use the <code>String</code> class <a data-primary="strip() method" data-type="indexterm" id="idm45290688830856"/><code>strip()</code> or <a data-primary="trim() method" data-type="indexterm" id="idm45290688829736"/><code>trim()</code> methods.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-strings-SECT-12.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>There are four methods in the <code>String</code> class for this:</p>&#13;
<dl>&#13;
<dt><code>strip()</code></dt>&#13;
<dd>&#13;
<p>Returns a string with all leading and trailing whitespace removed</p>&#13;
</dd>&#13;
<dt><a data-primary="stripLeading() method" data-type="indexterm" id="idm45290688823752"/><code>stripLeading()</code></dt>&#13;
<dd>&#13;
<p>Returns a string whose value is this string, with all leading white space removed</p>&#13;
</dd>&#13;
<dt><a data-primary="stripTrailing() method" data-type="indexterm" id="idm45290688821640"/><code>stripTrailing()</code></dt>&#13;
<dd>&#13;
<p>Returns the string with all trailing whitespace removed</p>&#13;
</dd>&#13;
<dt><a data-primary="String trim() method" data-type="indexterm" id="idm45290688819528"/><code>String trim()</code></dt>&#13;
<dd>&#13;
<p>Returns the string with all leading and trailing spaces removed</p>&#13;
</dd>&#13;
</dl>&#13;
&#13;
<p>For the <code>strip()</code> methods, whitespace is as defined by <code>Character.isSpace()</code>.&#13;
For the <code>trim()</code> method, space includes any character whose numeric value&#13;
is less than or equal to 32, or <em>U+0020</em> (the space character).</p>&#13;
&#13;
<p><a data-type="xref" href="#javacook-strings-EX-9">Example 3-10</a> uses <code>trim()</code> to strip an arbitrary number of leading spaces and/or tabs from lines of Java source code in order to look for the characters <code>//+</code>  and <code>//-</code>. These strings are special Java comments I previously used to mark the parts of the programs in this book that I wanted to include in the printed copy.</p>&#13;
<div data-type="example" id="javacook-strings-EX-9">&#13;
<h5><span class="label">Example 3-10. </span>main/src/main/java/strings/GetMark.java (trimming and comparing strings)</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">GetMark</code> <code class="o">{</code>&#13;
    <code class="cm">/** the default starting mark */</code>&#13;
    <code class="kd">public</code> <code class="kd">final</code> <code class="n">String</code> <code class="n">START_MARK</code> <code class="o">=</code> <code class="s">"//+"</code><code class="o">;</code>&#13;
    <code class="cm">/** the default ending mark */</code>&#13;
    <code class="kd">public</code> <code class="kd">final</code> <code class="n">String</code> <code class="n">END_MARK</code> <code class="o">=</code> <code class="s">"//-"</code><code class="o">;</code>&#13;
    <code class="cm">/** Set this to TRUE for running in "exclude" mode (e.g., for</code>&#13;
<code class="cm">     * building exercises from solutions) and to FALSE for running</code>&#13;
<code class="cm">     * in "extract" mode (e.g., writing a book and omitting the</code>&#13;
<code class="cm">     * imports and "public class" stuff).</code>&#13;
<code class="cm">     */</code>&#13;
    <code class="kd">public</code> <code class="kd">final</code> <code class="kd">static</code> <code class="kt">boolean</code> <code class="n">START</code> <code class="o">=</code> <code class="kc">true</code><code class="o">;</code>&#13;
    <code class="cm">/** True if we are currently inside marks */</code>&#13;
    <code class="kd">protected</code> <code class="kt">boolean</code> <code class="n">printing</code> <code class="o">=</code> <code class="n">START</code><code class="o">;</code>&#13;
    <code class="cm">/** True if you want line numbers */</code>&#13;
    <code class="kd">protected</code> <code class="kd">final</code> <code class="kt">boolean</code> <code class="n">number</code> <code class="o">=</code> <code class="kc">false</code><code class="o">;</code>&#13;
&#13;
    <code class="cm">/** Get Marked parts of one file, given an open LineNumberReader.</code>&#13;
<code class="cm">     * This is the main operation of this class, and can be used</code>&#13;
<code class="cm">     * inside other programs or from the main() wrapper.</code>&#13;
<code class="cm">     */</code>&#13;
    <code class="kd">public</code> <code class="kt">void</code> <code class="nf">process</code><code class="o">(</code><code class="n">String</code> <code class="n">fileName</code><code class="o">,</code>&#13;
        <code class="n">LineNumberReader</code> <code class="n">is</code><code class="o">,</code>&#13;
        <code class="n">PrintStream</code> <code class="n">out</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="kt">int</code> <code class="n">nLines</code> <code class="o">=</code> <code class="mi">0</code><code class="o">;</code>&#13;
        <code class="k">try</code> <code class="o">{</code>&#13;
            <code class="n">String</code> <code class="n">inputLine</code><code class="o">;</code>&#13;
&#13;
            <code class="k">while</code> <code class="o">((</code><code class="n">inputLine</code> <code class="o">=</code> <code class="n">is</code><code class="o">.</code><code class="na">readLine</code><code class="o">())</code> <code class="o">!=</code> <code class="kc">null</code><code class="o">)</code> <code class="o">{</code>&#13;
                <code class="k">if</code> <code class="o">(</code><code class="n">inputLine</code><code class="o">.</code><code class="na">trim</code><code class="o">().</code><code class="na">equals</code><code class="o">(</code><code class="n">START_MARK</code><code class="o">))</code> <code class="o">{</code>&#13;
                    <code class="k">if</code> <code class="o">(</code><code class="n">printing</code><code class="o">)</code>&#13;
                        <code class="c1">// These go to stderr, so you can redirect the output</code>&#13;
                        <code class="n">System</code><code class="o">.</code><code class="na">err</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"ERROR: START INSIDE START, "</code> <code class="o">+</code>&#13;
                            <code class="n">fileName</code> <code class="o">+</code> <code class="sc">':'</code> <code class="o">+</code> <code class="n">is</code><code class="o">.</code><code class="na">getLineNumber</code><code class="o">());</code>&#13;
                    <code class="n">printing</code> <code class="o">=</code> <code class="kc">true</code><code class="o">;</code>&#13;
                <code class="o">}</code> <code class="k">else</code> <code class="k">if</code> <code class="o">(</code><code class="n">inputLine</code><code class="o">.</code><code class="na">trim</code><code class="o">().</code><code class="na">equals</code><code class="o">(</code><code class="n">END_MARK</code><code class="o">))</code> <code class="o">{</code>&#13;
                    <code class="k">if</code> <code class="o">(!</code><code class="n">printing</code><code class="o">)</code>&#13;
                        <code class="n">System</code><code class="o">.</code><code class="na">err</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"ERROR: STOP WHILE STOPPED, "</code> <code class="o">+</code>&#13;
                            <code class="n">fileName</code> <code class="o">+</code> <code class="sc">':'</code> <code class="o">+</code> <code class="n">is</code><code class="o">.</code><code class="na">getLineNumber</code><code class="o">());</code>&#13;
                    <code class="n">printing</code> <code class="o">=</code> <code class="kc">false</code><code class="o">;</code>&#13;
                <code class="o">}</code> <code class="k">else</code> <code class="k">if</code> <code class="o">(</code><code class="n">printing</code><code class="o">)</code> <code class="o">{</code>&#13;
                    <code class="k">if</code> <code class="o">(</code><code class="n">number</code><code class="o">)</code> <code class="o">{</code>&#13;
                        <code class="n">out</code><code class="o">.</code><code class="na">print</code><code class="o">(</code><code class="n">nLines</code><code class="o">);</code>&#13;
                        <code class="n">out</code><code class="o">.</code><code class="na">print</code><code class="o">(</code><code class="s">": "</code><code class="o">);</code>&#13;
                    <code class="o">}</code>&#13;
                    <code class="n">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">inputLine</code><code class="o">);</code>&#13;
                    <code class="o">++</code><code class="n">nLines</code><code class="o">;</code>&#13;
                <code class="o">}</code>&#13;
            <code class="o">}</code>&#13;
            <code class="n">is</code><code class="o">.</code><code class="na">close</code><code class="o">();</code>&#13;
            <code class="n">out</code><code class="o">.</code><code class="na">flush</code><code class="o">();</code> <code class="c1">// Must not close - caller may still need it.</code>&#13;
            <code class="k">if</code> <code class="o">(</code><code class="n">nLines</code> <code class="o">==</code> <code class="mi">0</code><code class="o">)</code>&#13;
                <code class="n">System</code><code class="o">.</code><code class="na">err</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"ERROR: No marks in "</code> <code class="o">+</code> <code class="n">fileName</code> <code class="o">+</code>&#13;
                    <code class="s">"; no output generated!"</code><code class="o">);</code>&#13;
        <code class="o">}</code> <code class="k">catch</code> <code class="o">(</code><code class="n">IOException</code> <code class="n">e</code><code class="o">)</code> <code class="o">{</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"IOException: "</code> <code class="o">+</code> <code class="n">e</code><code class="o">);</code>&#13;
        <code class="o">}</code>&#13;
    <code class="o">}</code></pre></div>&#13;
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="javacook-i18n-SIDEBAR-1">&#13;
<h5>Ian’s Basic Steps: Internationalization and Localization</h5>&#13;
<p><a data-primary="internationalization" data-type="indexterm" id="idm45290688801496"/>Internationalization and <a data-primary="localization" data-type="indexterm" id="idm45290688800648"/>localization consist of the following:</p>&#13;
<dl>&#13;
<dt><a data-primary="sensitivity training" data-type="indexterm" id="idm45290688799000"/>Sensitivity training (Internationalization, or I18N)</dt>&#13;
<dd>&#13;
<p>Making your software sensitive to these issues</p>&#13;
</dd>&#13;
<dt><a data-primary="language lessons" data-type="indexterm" id="idm45290688467896"/>Language lessons (Localization, or L10N)</dt>&#13;
<dd>&#13;
<p>Writing configuration files for each language</p>&#13;
</dd>&#13;
<dt><a data-primary="culture lessons" data-type="indexterm" id="idm45290688465816"/>Culture lessons (optional)</dt>&#13;
<dd>&#13;
<p>Customizing the presentation of numbers, fractions, dates, and message <span class="keep-together">formatting</span></p>&#13;
</dd>&#13;
</dl>&#13;
&#13;
<p>For more information, see <a data-primary="Java Internationalization (Deitsch and Czarnecki)" data-type="indexterm" id="idm45290688463176"/><a data-primary="Deitsch, Andy" data-secondary="Java Internationalization" data-type="indexterm" id="idm45290688462376"/><a data-primary="Czarnecki, David" data-secondary="Java Internationalization" data-type="indexterm" id="idm45290688461416"/><em><a class="orm:hideurl" href="http://shop.oreilly.com/product/9780596000196.do">Java Internationalization</a></em> by Andy Deitsch and David Czarnecki (O’Reilly).</p>&#13;
</div></aside>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="3.11 Creating a Message with I18N Resources" data-type="sect1"><div class="sect1" id="javacook-i18n-SECT-1">&#13;
<h1>3.11 Creating a Message with I18N Resources</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-i18n-SECT-1.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="I18N" data-type="indexterm" id="ione_cr"/><a data-primary="strings" data-secondary="creating messages with I18N resources" data-type="indexterm" id="str_crme"/>You want your program to take sensitivity training so that it can communicate well internationally.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-i18n-SECT-1.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Your program must obtain all control and message strings via the internationalization software.&#13;
Here’s how:</p>&#13;
<ol>&#13;
<li>&#13;
<p>Get a <code>ResourceBundle</code>:</p>&#13;
&#13;
<pre data-type="programlisting">ResourceBundle rb = ResourceBundle.getBundle("Menus");</pre>&#13;
&#13;
<p>I’ll talk about <a data-primary="ResourceBundle" data-type="indexterm" id="idm45290688449240"/><code>ResourceBundle</code> in <a data-type="xref" href="#javacook-i18n-SECT-6">Recipe 3.13</a>, but briefly, a <code>ResourceBundle</code> represents a collection of name-value pairs (resources). The names are names you assign to each GUI control or other user interface text, and the values are the text to assign to each control in a given language.</p>&#13;
</li>&#13;
<li>&#13;
<p>Use this <code>ResourceBundle</code> to fetch the localized version of each control name.</p>&#13;
&#13;
<p>Old way:</p>&#13;
&#13;
<pre data-type="programlisting">String label = "Exit";&#13;
// Create the control, e.g., new JButton(label);</pre>&#13;
&#13;
<p>New way:</p>&#13;
&#13;
<pre data-type="programlisting">try { label = rb.getString("exit.label"); }&#13;
catch (MissingResourceException e) { label="Exit"; } // fallback&#13;
// Create the control, e.g., new JButton(label);</pre>&#13;
</li>&#13;
&#13;
</ol>&#13;
&#13;
<p>This may seem quite a bit of code for one control, but&#13;
you can write a convenience routine to simplify it, like this:</p>&#13;
&#13;
<pre data-type="programlisting">JButton exitButton = I18NUtil.getButton("exit.label", "Exit");</pre>&#13;
&#13;
<p>The file <em>I18NUtil.java</em> is included in the book’s code distribution.</p>&#13;
&#13;
<p>While the example is a <a data-primary="Swing JButton" data-type="indexterm" id="idm45290688439704"/>Swing <code>JButton</code>, the same approach goes with other UIs, such as the web tier.&#13;
In JSF, for example, you might place your strings in a properties file called <em>resources.properties</em>&#13;
and store it in <em>src/main/resources</em>. You would load this in <em>faces-config.xml</em>:</p>&#13;
&#13;
<pre data-code-language="xml" data-type="programlisting">  <code class="nt">&lt;application&gt;</code>&#13;
    <code class="nt">&lt;locale-config&gt;</code>&#13;
        <code class="nt">&lt;default-locale&gt;</code>en<code class="nt">&lt;/default-locale&gt;</code>&#13;
        <code class="nt">&lt;supported-locale&gt;</code>en<code class="nt">&lt;/supported-locale&gt;</code>&#13;
        <code class="nt">&lt;supported-locale&gt;</code>es<code class="nt">&lt;/supported-locale&gt;</code>&#13;
        <code class="nt">&lt;supported-locale&gt;</code>fr<code class="nt">&lt;/supported-locale&gt;</code>&#13;
    <code class="nt">&lt;/locale-config&gt;</code>&#13;
    <code class="nt">&lt;resource-bundle&gt;</code>&#13;
        <code class="nt">&lt;base-name&gt;</code>resources<code class="nt">&lt;/base-name&gt;</code>&#13;
        <code class="nt">&lt;var&gt;</code>msg<code class="nt">&lt;/var&gt;</code>&#13;
    <code class="nt">&lt;/resource-bundle&gt;</code>&#13;
  <code class="nt">&lt;/application&gt;</code></pre>&#13;
&#13;
<p>Then in each web page that needs these strings, refer to the resource using the <code>msg</code> variable&#13;
in an expression:</p>&#13;
&#13;
<pre data-code-language="xml" data-type="programlisting">// In signup.xhtml:&#13;
<code class="nt">&lt;h:outputText</code> <code class="na">value=</code><code class="s">"#{msg.prompt_firstname}"</code><code class="nt">/&gt;</code>&#13;
<code class="nt">&lt;h:inputText</code> <code class="na">required=</code><code class="s">"true"</code> <code class="na">id=</code><code class="s">"firstName"</code> <code class="na">value=</code><code class="s">"#{person.firstName}"</code> <code class="nt">/&gt;</code></pre>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="What happens at runtime?" data-type="sect3"><div class="sect3" id="javacook-i18n-SECT-1.2.1">&#13;
<h3>What happens at runtime?</h3>&#13;
&#13;
<p>The default locale is used, because we didn’t specify one. The default locale is platform dependent:</p>&#13;
<dl>&#13;
<dt><a data-primary="Unix" data-secondary="default locale in" data-type="indexterm" id="idm45290688400600"/>Unix/POSIX</dt>&#13;
<dd>&#13;
<p>LANG environment variable (per user)</p>&#13;
</dd>&#13;
<dt><a data-primary="Windows" data-secondary="default locale in" data-type="indexterm" id="idm45290688398344"/>Windows</dt>&#13;
<dd>&#13;
<p>Control Panel→Regional Settings</p>&#13;
</dd>&#13;
<dt><a data-primary="macOS" data-type="indexterm" id="idm45290688396088"/>macOS</dt>&#13;
<dd>&#13;
<p>System Preferences→Language &amp; Text</p>&#13;
</dd>&#13;
<dt>Others</dt>&#13;
<dd>&#13;
<p>See platform documentation</p>&#13;
</dd>&#13;
</dl>&#13;
&#13;
<p><a data-primary="ResourceBundle.getBundle() method" data-type="indexterm" id="idm45290688359608"/><code>ResourceBundle.getBundle()</code> locates a file with the named resource&#13;
bundle name (<code>Menus</code>, in the previous example), plus an underscore&#13;
and the locale name (if a non-default locale is set), plus another underscore&#13;
and the locale variation (if any variation is set), plus the extension&#13;
<em>.properties</em>. If a variation is set but the file can’t be found,&#13;
it falls back to just the country code. If that can’t be found, it&#13;
falls back to the original default. <a data-type="xref" href="#javacook-i18n-TABLE-1">Table 3-2</a> shows&#13;
some examples for various locales.</p>&#13;
&#13;
<p>Note that <a data-primary="Android" data-secondary="locales and" data-type="indexterm" id="idm45290688355976"/>Android apps—usually written in Java or Kotlin—use a similar mechanism&#13;
but with the files in XML format instead of Java Properties and with&#13;
some small changes in the name of the file in which the properties files are found.</p>&#13;
<table id="javacook-i18n-TABLE-1">&#13;
<caption><span class="label">Table 3-2. </span>Property filenames for different locales</caption>&#13;
<thead>&#13;
<tr>&#13;
<th>Locale</th>&#13;
<th>Filename</th>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td><p>Default locale</p></td>&#13;
<td><p><em>Menus.Properties</em></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>Swedish</p></td>&#13;
<td><p><em>Menus_sv.properties</em></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>Spanish</p></td>&#13;
<td><p><em>Menus_es.properties</em></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>French</p></td>&#13;
<td><p><em>Menus_fr.properties</em></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>French-Canadian</p></td>&#13;
<td><p><em>Menus_fr_CA.properties</em></p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
&#13;
<p><a data-primary="locales" data-type="indexterm" id="idm45290688327464"/>Locale names are two-letter ISO-639 language codes (lowercase), and they normally abbreviate the country’s<a data-primary="endonym" data-type="indexterm" id="idm45290688326312"/> <em>endonym</em> (the name its language speakers refer to it by); thus, Sweden is <em>sv</em> for <em>Sverige</em>, Spain is <em>es</em> for <em>Espanol</em>, etc.&#13;
Locale variations are two-letter ISO country codes (uppercase); for example, e.g., CA for Canada, US for the United States, SV for Sweden, ES for Spain, etc.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Setting the locale" data-type="sect3"><div class="sect3" id="javacook-i18n-SECT-1.2.2">&#13;
<h3>Setting the locale</h3>&#13;
&#13;
<p>On <a data-primary="Windows" data-secondary="locales in" data-type="indexterm" id="idm45290688321352"/>Windows, go into Regional Settings in the Control Panel. Changing this setting may entail a reboot, so exit any editor windows.</p>&#13;
&#13;
<p>On <a data-primary="Unix" data-secondary="locales in" data-type="indexterm" id="idm45290688319688"/>Unix, set your <code>LANG</code> environment variable. For example, a Korn shell user in Mexico might have this line in her <em>.profile</em>:</p>&#13;
&#13;
<pre data-type="programlisting">export LANG=es_MX</pre>&#13;
&#13;
<p>On either system, for testing a different locale, you need only define the locale in the System Properties at runtime using the command-line option <code>-D</code>, as in:</p>&#13;
<pre data-type="programlisting" id="I_15_tt464"><strong>java -Duser.language=es i18n.Browser</strong></pre>&#13;
&#13;
<p>This runs the Java program named <code>Browser</code> in package <code>i18n</code> in the Spanish locale.</p>&#13;
&#13;
<p id="javacook-i18n-SECT-2">You can get a list of the available locales with a call to<a data-primary="Locale.getAvailableLocales() method" data-type="indexterm" id="idm45290688312744"/>&#13;
<code>Locale.getAvailable​Lo⁠cales()</code>.<a data-primary="" data-startref="ione_cr" data-type="indexterm" id="idm45290688311432"/><a data-primary="" data-startref="str_crme" data-type="indexterm" id="idm45290688310456"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="3.12 Using a Particular Locale" data-type="sect1"><div class="sect1" id="javacook-i18n-SECT-8">&#13;
<h1>3.12 Using a Particular Locale</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-i18n-SECT-8.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="strings" data-secondary="using locales" data-type="indexterm" id="idm45290688306552"/><a data-primary="locales" data-type="indexterm" id="idm45290688305576"/>You want to use a locale other than the default in a particular operation.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-i18n-SECT-8.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Obtain a <code>Locale</code> by using a predefined instance or the <code>Locale</code> constructor.&#13;
Optionally make it global to your application by using&#13;
<code>Locale.setDefault(newLocale)</code>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-i18n-SECT-8.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>Classes that provide formatting services, such as <code>DateTimeFormatter</code> and <code>NumberFormat</code>,&#13;
provide overloads so they can be called either with or without a <code>Locale</code>-related argument.</p>&#13;
&#13;
<p>To obtain a <code>Locale</code> object, you can employ one of the predefined locale variables provided by the <code>Locale</code> class, or you can construct your own <code>Locale</code> object giving a language code and a country code:</p>&#13;
&#13;
<pre data-type="programlisting">Locale locale1 = Locale.FRANCE;    // predefined&#13;
Locale locale2 = new Locale("en", "UK");    // English, UK version</pre>&#13;
&#13;
<p>These can then be used in the various formatting operations:</p>&#13;
&#13;
<pre data-type="programlisting">DateFormat frDateFormatter = DateFormat.getDateInstance(&#13;
		DateFormat.MEDIUM, frLocale);&#13;
DateFormat ukDateFormatter = DateFormat.getDateInstance(&#13;
		DateFormat.MEDIUM, ukLocale);</pre>&#13;
&#13;
<p>Either of these can be used to format a date or a number, as shown in class <code>Use​Lo⁠cales</code>:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kn">package</code> <code class="n">i18n</code><code class="o">;</code>&#13;
&#13;
<code class="kn">import</code> <code class="nn">java.time.LocalDateTime</code><code class="o">;</code>&#13;
<code class="kn">import</code> <code class="nn">java.time.format.DateTimeFormatter</code><code class="o">;</code>&#13;
<code class="kn">import</code> <code class="nn">java.time.format.FormatStyle</code><code class="o">;</code>&#13;
<code class="kn">import</code> <code class="nn">java.util.Locale</code><code class="o">;</code>&#13;
&#13;
<code class="cm">/** Use some locales; based on user's OS "settings"</code>&#13;
<code class="cm"> * choices or -Duser.lang= or -Duser.region=.</code>&#13;
<code class="cm"> */</code>&#13;
<code class="kd">public</code> <code class="kd">class</code> <code class="nc">UseLocales</code> <code class="o">{</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">args</code><code class="o">)</code> <code class="o">{</code>&#13;
&#13;
        <code class="n">Locale</code> <code class="n">frLocale</code> <code class="o">=</code> <code class="n">Locale</code><code class="o">.</code><code class="na">FRANCE</code><code class="o">;</code>    <code class="c1">// predefined</code>&#13;
        <code class="n">Locale</code> <code class="n">ukLocale</code> <code class="o">=</code> <code class="k">new</code> <code class="n">Locale</code><code class="o">(</code><code class="s">"en"</code><code class="o">,</code> <code class="s">"UK"</code><code class="o">);</code>    <code class="c1">// English, UK version</code>&#13;
&#13;
        <code class="n">DateTimeFormatter</code> <code class="n">defaultDateFormatter</code> <code class="o">=</code>&#13;
            <code class="n">DateTimeFormatter</code><code class="o">.</code><code class="na">ofLocalizedDateTime</code><code class="o">(</code>&#13;
                <code class="n">FormatStyle</code><code class="o">.</code><code class="na">MEDIUM</code><code class="o">);</code>&#13;
        <code class="n">DateTimeFormatter</code> <code class="n">frDateFormatter</code> <code class="o">=</code>&#13;
            <code class="n">DateTimeFormatter</code><code class="o">.</code><code class="na">ofLocalizedDateTime</code><code class="o">(</code>&#13;
                <code class="n">FormatStyle</code><code class="o">.</code><code class="na">MEDIUM</code><code class="o">).</code><code class="na">localizedBy</code><code class="o">(</code><code class="n">frLocale</code><code class="o">);</code>&#13;
        <code class="n">DateTimeFormatter</code> <code class="n">ukDateFormatter</code> <code class="o">=</code>&#13;
            <code class="n">DateTimeFormatter</code><code class="o">.</code><code class="na">ofLocalizedDateTime</code><code class="o">(</code>&#13;
                <code class="n">FormatStyle</code><code class="o">.</code><code class="na">MEDIUM</code><code class="o">).</code><code class="na">localizedBy</code><code class="o">(</code><code class="n">ukLocale</code><code class="o">);</code>&#13;
&#13;
        <code class="n">LocalDateTime</code> <code class="n">now</code> <code class="o">=</code> <code class="n">LocalDateTime</code><code class="o">.</code><code class="na">now</code><code class="o">();</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Default: "</code> <code class="o">+</code> <code class="sc">' '</code> <code class="o">+</code>&#13;
            <code class="n">now</code><code class="o">.</code><code class="na">format</code><code class="o">(</code><code class="n">defaultDateFormatter</code><code class="o">));</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">frLocale</code><code class="o">.</code><code class="na">getDisplayName</code><code class="o">()</code> <code class="o">+</code> <code class="sc">' '</code> <code class="o">+</code>&#13;
            <code class="n">now</code><code class="o">.</code><code class="na">format</code><code class="o">(</code><code class="n">frDateFormatter</code><code class="o">));</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">ukLocale</code><code class="o">.</code><code class="na">getDisplayName</code><code class="o">()</code> <code class="o">+</code> <code class="sc">' '</code> <code class="o">+</code>&#13;
            <code class="n">now</code><code class="o">.</code><code class="na">format</code><code class="o">(</code><code class="n">ukDateFormatter</code><code class="o">));</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p>The program prints the locale name and formats the date in each of the locales:</p>&#13;
<pre data-type="programlisting">&#13;
$ <strong>java i18n.UseLocales</strong>&#13;
Default:  Oct 16, 2019, 4:41:45 PM&#13;
French (France) 16 oct. 2019 à 16:41:45&#13;
English (UK) Oct 16, 2019, 4:41:45 PM$&#13;
</pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="3.13 Creating a Resource Bundle" data-type="sect1"><div class="sect1" id="javacook-i18n-SECT-6">&#13;
<h1>3.13 Creating a Resource Bundle</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-i18n-SECT-6.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="resource bundles" data-type="indexterm" id="idm45290688090280"/><a data-primary="strings" data-secondary="resource bundles" data-type="indexterm" id="idm45290688089576"/>You need to create a resource bundle for use with I18N.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-i18n-SECT-6.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>A resource bundle is simply a collection of names and values. You could write&#13;
a <code>java.util.ResourceBundle</code> subclass, but it is easier to create textual&#13;
<code>Properties</code> files (see <a data-type="xref" href="ch07.html#javacook-structure-SECT-7">Recipe 7.10</a>) that you then load with&#13;
<a data-primary="ResourceBundle.getBundle() method" data-type="indexterm" id="idm45290688084920"/><code>ResourceBundle.getBundle()</code>. The files can be created using any plain text&#13;
editor. Leaving it in a text file format also allows user customization in&#13;
desktop applications; a user whose language is not provided for, or who&#13;
wishes to change the wording somewhat due to local variations in dialect,&#13;
should be able to edit the file.</p>&#13;
&#13;
<p>Note that the resource bundle text file should not have the same name as any&#13;
of your Java classes. The reason is that the <code>ResourceBundle</code> constructs a&#13;
class dynamically with the same name as the resource files.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-i18n-SECT-6.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>Here is a sample properties file for a few menu items:</p>&#13;
&#13;
<pre data-type="programlisting"># Default Menu properties&#13;
# The File Menu&#13;
file.label=File Menu&#13;
file.new.label=New File&#13;
file.new.key=N&#13;
file.save.label=Save&#13;
file.new.key=S</pre>&#13;
&#13;
<p>Creating the default properties file is usually not a problem, but creating&#13;
properties files for other languages might be. Unless you are a large&#13;
multinational corporation, you will probably not have the resources (pardon&#13;
the pun) to create resource files in-house. If you are shipping commercial&#13;
software or using the web for global reach, you need to identify your target markets&#13;
and understand which of these are most sensitive to wanting menus and the like in their own&#13;
languages. Then, hire a professional translation service that has expertise&#13;
in the required languages to prepare the files. Test them well before you&#13;
ship, as you would any other part of your software.</p>&#13;
&#13;
<p>If you need special characters, multiline text, or other complex entry, remember that a <code>ResourceBundle</code> is also a <code>Properties</code> file, so see the documentation for <code>java.util.Properties</code>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="3.14 Program: A Simple Text Formatter" data-type="sect1"><div class="sect1" id="javacook-strings-SECT-14">&#13;
<h1>3.14 Program: A Simple Text Formatter</h1>&#13;
&#13;
<p><a data-primary="Text Formatter program" data-type="indexterm" id="tf_p"/>This program is a primitive text formatter, representative of what people used on most computing platforms before the rise of standalone graphics-based word processors, laser printers, and, eventually, desktop publishing and office suites. It simply reads words from a file, previously created with a text editor, and outputs them until it reaches the right margin, when it calls<a data-primary="println() method" data-type="indexterm" id="idm45290688073368"/> <code>println()</code> to append a line ending. For example, here is an input file:</p>&#13;
&#13;
<pre data-type="programlisting">It's a nice&#13;
day, isn't it, Mr. Mxyzzptllxy?&#13;
I think we should&#13;
go for a walk.</pre>&#13;
&#13;
<p>Given that file as the input, the <code>Fmt</code> program prints the lines formatted neatly:</p>&#13;
&#13;
<pre data-type="programlisting">It's a nice day, isn't it, Mr. Mxyzzptllxy? I think we should go for a&#13;
walk.</pre>&#13;
&#13;
<p>As you can see, it fits the text we gave it to the margin and discards all the line breaks present in the original. Here’s the code:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">Fmt</code> <code class="o">{</code>&#13;
    <code class="cm">/** The maximum column width */</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kd">final</code> <code class="kt">int</code> <code class="n">COLWIDTH</code><code class="o">=</code><code class="mi">72</code><code class="o">;</code>&#13;
    <code class="cm">/** The file that we read and format */</code>&#13;
    <code class="kd">final</code> <code class="n">BufferedReader</code> <code class="n">in</code><code class="o">;</code>&#13;
    <code class="cm">/** Where the output goes */</code>&#13;
    <code class="n">PrintWriter</code> <code class="n">out</code><code class="o">;</code>&#13;
&#13;
    <code class="cm">/** If files present, format each one, else format the standard input. */</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">av</code><code class="o">)</code> <code class="kd">throws</code> <code class="n">IOException</code> <code class="o">{</code>&#13;
        <code class="k">if</code> <code class="o">(</code><code class="n">av</code><code class="o">.</code><code class="na">length</code> <code class="o">==</code> <code class="mi">0</code><code class="o">)</code>&#13;
            <code class="k">new</code> <code class="nf">Fmt</code><code class="o">(</code><code class="n">System</code><code class="o">.</code><code class="na">in</code><code class="o">).</code><code class="na">format</code><code class="o">();</code>&#13;
        <code class="k">else</code> <code class="nf">for</code> <code class="o">(</code><code class="n">String</code> <code class="n">name</code> <code class="o">:</code> <code class="n">av</code><code class="o">)</code> <code class="o">{</code>&#13;
            <code class="k">new</code> <code class="nf">Fmt</code><code class="o">(</code><code class="n">name</code><code class="o">).</code><code class="na">format</code><code class="o">();</code>&#13;
        <code class="o">}</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="kd">public</code> <code class="nf">Fmt</code><code class="o">(</code><code class="n">BufferedReader</code> <code class="n">inFile</code><code class="o">,</code> <code class="n">PrintWriter</code> <code class="n">outFile</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="k">this</code><code class="o">.</code><code class="na">in</code> <code class="o">=</code> <code class="n">inFile</code><code class="o">;</code>&#13;
        <code class="k">this</code><code class="o">.</code><code class="na">out</code> <code class="o">=</code> <code class="n">outFile</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="kd">public</code> <code class="nf">Fmt</code><code class="o">(</code><code class="n">PrintWriter</code> <code class="n">out</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="k">this</code><code class="o">(</code><code class="k">new</code> <code class="n">BufferedReader</code><code class="o">(</code><code class="k">new</code> <code class="n">InputStreamReader</code><code class="o">(</code><code class="n">System</code><code class="o">.</code><code class="na">in</code><code class="o">)),</code> <code class="n">out</code><code class="o">);</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/** Construct a Formatter given an open Reader */</code>&#13;
    <code class="kd">public</code> <code class="nf">Fmt</code><code class="o">(</code><code class="n">BufferedReader</code> <code class="n">file</code><code class="o">)</code> <code class="kd">throws</code> <code class="n">IOException</code> <code class="o">{</code>&#13;
        <code class="k">this</code><code class="o">(</code><code class="n">file</code><code class="o">,</code> <code class="k">new</code> <code class="n">PrintWriter</code><code class="o">(</code><code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">));</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/** Construct a Formatter given a filename */</code>&#13;
    <code class="kd">public</code> <code class="nf">Fmt</code><code class="o">(</code><code class="n">String</code> <code class="n">fname</code><code class="o">)</code> <code class="kd">throws</code> <code class="n">IOException</code> <code class="o">{</code>&#13;
        <code class="k">this</code><code class="o">(</code><code class="k">new</code> <code class="n">BufferedReader</code><code class="o">(</code><code class="k">new</code> <code class="n">FileReader</code><code class="o">(</code><code class="n">fname</code><code class="o">)));</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/** Construct a Formatter given an open Stream */</code>&#13;
    <code class="kd">public</code> <code class="nf">Fmt</code><code class="o">(</code><code class="n">InputStream</code> <code class="n">file</code><code class="o">)</code> <code class="kd">throws</code> <code class="n">IOException</code> <code class="o">{</code>&#13;
        <code class="k">this</code><code class="o">(</code><code class="k">new</code> <code class="n">BufferedReader</code><code class="o">(</code><code class="k">new</code> <code class="n">InputStreamReader</code><code class="o">(</code><code class="n">file</code><code class="o">)));</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/** Format the File contained in a constructed Fmt object */</code>&#13;
    <code class="kd">public</code> <code class="kt">void</code> <code class="nf">format</code><code class="o">()</code> <code class="kd">throws</code> <code class="n">IOException</code> <code class="o">{</code>&#13;
        <code class="n">format</code><code class="o">(</code><code class="n">in</code><code class="o">.</code><code class="na">lines</code><code class="o">(),</code> <code class="n">out</code><code class="o">);</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/** Format a Stream of lines, e.g., bufReader.lines() */</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">format</code><code class="o">(</code><code class="n">Stream</code><code class="o">&lt;</code><code class="n">String</code><code class="o">&gt;</code> <code class="n">s</code><code class="o">,</code> <code class="n">PrintWriter</code> <code class="n">out</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">StringBuilder</code> <code class="n">outBuf</code> <code class="o">=</code> <code class="k">new</code> <code class="n">StringBuilder</code><code class="o">();</code>&#13;
        <code class="n">s</code><code class="o">.</code><code class="na">forEachOrdered</code><code class="o">((</code><code class="n">line</code> <code class="o">-&gt;</code> <code class="o">{</code>&#13;
            <code class="k">if</code> <code class="o">(</code><code class="n">line</code><code class="o">.</code><code class="na">length</code><code class="o">()</code> <code class="o">==</code> <code class="mi">0</code><code class="o">)</code> <code class="o">{</code>    <code class="c1">// null line</code>&#13;
                <code class="n">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">outBuf</code><code class="o">);</code>    <code class="c1">// end current line</code>&#13;
                <code class="n">out</code><code class="o">.</code><code class="na">println</code><code class="o">();</code>    <code class="c1">// output blank line</code>&#13;
                <code class="n">outBuf</code><code class="o">.</code><code class="na">setLength</code><code class="o">(</code><code class="mi">0</code><code class="o">);</code>&#13;
            <code class="o">}</code> <code class="k">else</code> <code class="o">{</code>&#13;
                <code class="c1">// otherwise it's text, so format it.</code>&#13;
                <code class="n">StringTokenizer</code> <code class="n">st</code> <code class="o">=</code> <code class="k">new</code> <code class="n">StringTokenizer</code><code class="o">(</code><code class="n">line</code><code class="o">);</code>&#13;
                <code class="k">while</code> <code class="o">(</code><code class="n">st</code><code class="o">.</code><code class="na">hasMoreTokens</code><code class="o">())</code> <code class="o">{</code>&#13;
                    <code class="n">String</code> <code class="n">word</code> <code class="o">=</code> <code class="n">st</code><code class="o">.</code><code class="na">nextToken</code><code class="o">();</code>&#13;
&#13;
                    <code class="c1">// If this word would go past the margin,</code>&#13;
                    <code class="c1">// first dump out anything previous.</code>&#13;
                    <code class="k">if</code> <code class="o">(</code><code class="n">outBuf</code><code class="o">.</code><code class="na">length</code><code class="o">()</code> <code class="o">+</code> <code class="n">word</code><code class="o">.</code><code class="na">length</code><code class="o">()</code> <code class="o">&gt;</code> <code class="n">COLWIDTH</code><code class="o">)</code> <code class="o">{</code>&#13;
                        <code class="n">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">outBuf</code><code class="o">);</code>&#13;
                        <code class="n">outBuf</code><code class="o">.</code><code class="na">setLength</code><code class="o">(</code><code class="mi">0</code><code class="o">);</code>&#13;
                    <code class="o">}</code>&#13;
                    <code class="n">outBuf</code><code class="o">.</code><code class="na">append</code><code class="o">(</code><code class="n">word</code><code class="o">).</code><code class="na">append</code><code class="o">(</code><code class="sc">' '</code><code class="o">);</code>&#13;
                <code class="o">}</code>&#13;
            <code class="o">}</code>&#13;
        <code class="o">}));</code>&#13;
        <code class="k">if</code> <code class="o">(</code><code class="n">outBuf</code><code class="o">.</code><code class="na">length</code><code class="o">()</code> <code class="o">&gt;</code> <code class="mi">0</code><code class="o">)</code> <code class="o">{</code>&#13;
            <code class="n">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">outBuf</code><code class="o">);</code>&#13;
        <code class="o">}</code> <code class="k">else</code> <code class="o">{</code>&#13;
            <code class="n">out</code><code class="o">.</code><code class="na">println</code><code class="o">();</code>&#13;
        <code class="o">}</code>&#13;
    <code class="o">}</code>&#13;
&#13;
&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p>A slightly fancier version of this program, <code>Fmt2</code>, is in the online source for this book. It uses<a data-primary="dot commands" data-type="indexterm" id="idm45290688059320"/> <em>dot commands</em>—lines beginning with periods—to give limited control over the formatting. A family of dot-command formatters includes <a data-primary="Unix" data-secondary="groff" data-type="indexterm" id="idm45290688058024"/><a data-primary="groff" data-type="indexterm" id="idm45290688057048"/><a data-primary="Unix" data-secondary="roff" data-type="indexterm" id="idm45290688056376"/><a data-primary="Unix" data-secondary="nroff" data-type="indexterm" id="idm45290688055432"/><a data-primary="nroff" data-type="indexterm" id="idm45290687670568"/><a data-primary="Unix" data-secondary="troff" data-type="indexterm" id="idm45290687669896"/><a data-primary="troff" data-type="indexterm" id="idm45290687668952"/>Unix’s <em>roff</em>, <em>nroff, troff</em>, and <em>groff</em>, which are in the same family with programs called <em>runoff</em> on Digital Equipment systems. The original for this is <a data-primary="Saltzer, J." data-type="indexterm" id="idm45290687666360"/>J. Saltzer’s <em>runoff</em>, which first appeared on Multics and from there made its way into various OSes. To save trees, I did not include <code>Fmt2</code> here; it subclasses <code>Fmt</code> and overrides the <a data-primary="format() method" data-type="indexterm" id="idm45290687664120"/><code>format()</code> method to include additional functionality (the source code is in the full<a data-primary="javasrc repository" data-type="indexterm" id="idm45290687663000"/> <em>javasrc</em> repository for the book).<a data-primary="" data-startref="tf_p" data-type="indexterm" id="idm45290687661752"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="3.15 Program: Soundex Name Comparisons" data-type="sect1"><div class="sect1" id="javacook-strings-SECT-15">&#13;
<h1>3.15 Program: Soundex Name Comparisons</h1>&#13;
&#13;
<p><a data-primary="Soundex Name Comparisons program" data-type="indexterm" id="sndx_p"/>The difficulties in comparing American-style names inspired the US Census Bureau to develop the Soundex algorithm in the early 1900s. Each of a given set of consonants maps to a particular number, the effect being to map similar-sounding names together, on the grounds that in those days many people were illiterate and could not spell their family names consistently. But it is still useful today, for example, in a company-wide telephone book application. The names Darwin and Derwin map to D650, and Darwent maps to D653, which puts it adjacent to D650. All of these are believed to be historical variants of the same name. Suppose we needed to sort lines containing these names together: if we could output the Soundex numbers at the beginning of each line, this would be easy. Here is a simple demonstration of the <span class="keep-together"><code>Soundex</code></span> class:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">SoundexSimple</code> <code class="o">{</code>&#13;
&#13;
    <code class="cm">/** main */</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">args</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">String</code><code class="o">[]</code> <code class="n">names</code> <code class="o">=</code> <code class="o">{</code>&#13;
            <code class="s">"Darwin, Ian"</code><code class="o">,</code>&#13;
            <code class="s">"Davidson, Greg"</code><code class="o">,</code>&#13;
            <code class="s">"Darwent, William"</code><code class="o">,</code>&#13;
            <code class="s">"Derwin, Daemon"</code>&#13;
        <code class="o">};</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="n">String</code> <code class="n">name</code> <code class="o">:</code> <code class="n">names</code><code class="o">)</code> <code class="o">{</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">Soundex</code><code class="o">.</code><code class="na">soundex</code><code class="o">(</code><code class="n">name</code><code class="o">)</code> <code class="o">+</code> <code class="sc">' '</code> <code class="o">+</code> <code class="n">name</code><code class="o">);</code>&#13;
        <code class="o">}</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p>Let’s run it:</p>&#13;
<pre data-type="programlisting" id="I_3_tt98">&gt; <strong>javac -d . SoundexSimple.java</strong>&#13;
&gt; <strong>java strings.SoundexSimple | sort</strong>&#13;
D132 Davidson, Greg&#13;
D650 Darwin, Ian&#13;
D650 Derwin, Daemon&#13;
D653 Darwent, William&#13;
&gt;</pre>&#13;
&#13;
<p>As you can see, the Darwin-variant names (including Daemon Derwin<a data-primary="daemon" data-type="indexterm" id="idm45290687592168"/><sup><a data-type="noteref" href="ch03.html#idm45290687591464" id="idm45290687591464-marker">6</a></sup>) all sort together and are distinct from the Davidson (and Davis, Davies, etc.) names that normally appear between Darwin and Derwin when using a simple alphabetic sort. The Soundex algorithm has done its work.</p>&#13;
&#13;
<p>Here is the <code>Soundex</code> class itself—it uses <code>String</code>s and <code>StringBuilder</code>s to convert names into Soundex codes:</p>&#13;
&#13;
<p><em>main/src/main/java/strings/Soundex.java</em></p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">Soundex</code> <code class="o">{</code>&#13;
&#13;
    <code class="kd">static</code> <code class="kt">boolean</code> <code class="n">debug</code> <code class="o">=</code> <code class="kc">false</code><code class="o">;</code>&#13;
&#13;
    <code class="cm">/* Implements the mapping</code>&#13;
<code class="cm">     * from: AEHIOUWYBFPVCGJKQSXZDTLMNR</code>&#13;
<code class="cm">     * to:   00000000111122222222334556</code>&#13;
<code class="cm">     */</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kd">final</code> <code class="kt">char</code><code class="o">[]</code> <code class="n">MAP</code> <code class="o">=</code> <code class="o">{</code>&#13;
        <code class="c1">//A  B   C   D   E   F   G   H   I   J   K   L   M</code>&#13;
        <code class="sc">'0'</code><code class="o">,</code><code class="sc">'1'</code><code class="o">,</code><code class="sc">'2'</code><code class="o">,</code><code class="sc">'3'</code><code class="o">,</code><code class="sc">'0'</code><code class="o">,</code><code class="sc">'1'</code><code class="o">,</code><code class="sc">'2'</code><code class="o">,</code><code class="sc">'0'</code><code class="o">,</code><code class="sc">'0'</code><code class="o">,</code><code class="sc">'2'</code><code class="o">,</code><code class="sc">'2'</code><code class="o">,</code><code class="sc">'4'</code><code class="o">,</code><code class="sc">'5'</code><code class="o">,</code>&#13;
        <code class="c1">//N  O   P   W   R   S   T   U   V   W   X   Y   Z</code>&#13;
        <code class="sc">'5'</code><code class="o">,</code><code class="sc">'0'</code><code class="o">,</code><code class="sc">'1'</code><code class="o">,</code><code class="sc">'2'</code><code class="o">,</code><code class="sc">'6'</code><code class="o">,</code><code class="sc">'2'</code><code class="o">,</code><code class="sc">'3'</code><code class="o">,</code><code class="sc">'0'</code><code class="o">,</code><code class="sc">'1'</code><code class="o">,</code><code class="sc">'0'</code><code class="o">,</code><code class="sc">'2'</code><code class="o">,</code><code class="sc">'0'</code><code class="o">,</code><code class="sc">'2'</code>&#13;
    <code class="o">};</code>&#13;
&#13;
    <code class="cm">/** Convert the given String to its Soundex code.</code>&#13;
<code class="cm">     * @return null If the given string can't be mapped to Soundex.</code>&#13;
<code class="cm">     */</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="n">String</code> <code class="nf">soundex</code><code class="o">(</code><code class="n">String</code> <code class="n">s</code><code class="o">)</code> <code class="o">{</code>&#13;
&#13;
        <code class="c1">// Algorithm works on uppercase (mainframe era).</code>&#13;
        <code class="n">String</code> <code class="n">t</code> <code class="o">=</code> <code class="n">s</code><code class="o">.</code><code class="na">toUpperCase</code><code class="o">();</code>&#13;
&#13;
        <code class="n">StringBuilder</code> <code class="n">res</code> <code class="o">=</code> <code class="k">new</code> <code class="n">StringBuilder</code><code class="o">();</code>&#13;
        <code class="kt">char</code> <code class="n">c</code><code class="o">,</code> <code class="n">prev</code> <code class="o">=</code> <code class="sc">'?'</code><code class="o">,</code> <code class="n">prevOutput</code> <code class="o">=</code> <code class="sc">'?'</code><code class="o">;</code>&#13;
&#13;
        <code class="c1">// Main loop: find up to 4 chars that map.</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">i</code><code class="o">=</code><code class="mi">0</code><code class="o">;</code> <code class="n">i</code><code class="o">&lt;</code><code class="n">t</code><code class="o">.</code><code class="na">length</code><code class="o">()</code> <code class="o">&amp;&amp;</code> <code class="n">res</code><code class="o">.</code><code class="na">length</code><code class="o">()</code> <code class="o">&lt;</code> <code class="mi">4</code> <code class="o">&amp;&amp;</code>&#13;
            <code class="o">(</code><code class="n">c</code> <code class="o">=</code> <code class="n">t</code><code class="o">.</code><code class="na">charAt</code><code class="o">(</code><code class="n">i</code><code class="o">))</code> <code class="o">!=</code> <code class="sc">','</code><code class="o">;</code> <code class="n">i</code><code class="o">++)</code> <code class="o">{</code>&#13;
&#13;
            <code class="c1">// Check to see if the given character is alphabetic.</code>&#13;
            <code class="c1">// Text is already converted to uppercase. Algorithm</code>&#13;
            <code class="c1">// only handles ASCII letters, do NOT use Character.isLetter()!</code>&#13;
            <code class="c1">// Also, skip double letters.</code>&#13;
            <code class="k">if</code> <code class="o">(</code><code class="n">c</code><code class="o">&gt;=</code><code class="sc">'A'</code> <code class="o">&amp;&amp;</code> <code class="n">c</code><code class="o">&lt;=</code><code class="sc">'Z'</code> <code class="o">&amp;&amp;</code> <code class="n">c</code> <code class="o">!=</code> <code class="n">prev</code><code class="o">)</code> <code class="o">{</code>&#13;
                <code class="n">prev</code> <code class="o">=</code> <code class="n">c</code><code class="o">;</code>&#13;
&#13;
                <code class="c1">// First char is installed unchanged, for sorting.</code>&#13;
                <code class="k">if</code> <code class="o">(</code><code class="n">i</code><code class="o">==</code><code class="mi">0</code><code class="o">)</code> <code class="o">{</code>&#13;
                    <code class="n">res</code><code class="o">.</code><code class="na">append</code><code class="o">(</code><code class="n">c</code><code class="o">);</code>&#13;
                <code class="o">}</code> <code class="k">else</code> <code class="o">{</code>&#13;
                    <code class="kt">char</code> <code class="n">m</code> <code class="o">=</code> <code class="n">MAP</code><code class="o">[</code><code class="n">c</code><code class="o">-</code><code class="sc">'A'</code><code class="o">];</code>&#13;
                    <code class="k">if</code> <code class="o">(</code><code class="n">debug</code><code class="o">)</code> <code class="o">{</code>&#13;
                        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">c</code> <code class="o">+</code> <code class="s">" --&gt; "</code> <code class="o">+</code> <code class="n">m</code><code class="o">);</code>&#13;
                    <code class="o">}</code>&#13;
                    <code class="k">if</code> <code class="o">(</code><code class="n">m</code> <code class="o">!=</code> <code class="sc">'0'</code> <code class="o">&amp;&amp;</code> <code class="n">m</code> <code class="o">!=</code> <code class="n">prevOutput</code><code class="o">)</code> <code class="o">{</code>&#13;
                        <code class="n">res</code><code class="o">.</code><code class="na">append</code><code class="o">(</code><code class="n">m</code><code class="o">);</code>&#13;
                        <code class="n">prevOutput</code> <code class="o">=</code> <code class="n">m</code><code class="o">;</code>&#13;
                    <code class="o">}</code>&#13;
                <code class="o">}</code>&#13;
            <code class="o">}</code>&#13;
        <code class="o">}</code>&#13;
        <code class="k">if</code> <code class="o">(</code><code class="n">res</code><code class="o">.</code><code class="na">length</code><code class="o">()</code> <code class="o">==</code> <code class="mi">0</code><code class="o">)</code>&#13;
            <code class="k">return</code> <code class="kc">null</code><code class="o">;</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">i</code><code class="o">=</code><code class="n">res</code><code class="o">.</code><code class="na">length</code><code class="o">();</code> <code class="n">i</code><code class="o">&lt;</code><code class="mi">4</code><code class="o">;</code> <code class="n">i</code><code class="o">++)</code>&#13;
            <code class="n">res</code><code class="o">.</code><code class="na">append</code><code class="o">(</code><code class="sc">'0'</code><code class="o">);</code>&#13;
        <code class="k">return</code> <code class="n">res</code><code class="o">.</code><code class="na">toString</code><code class="o">();</code>&#13;
    <code class="o">}</code></pre>&#13;
&#13;
<p>There are apparently some nuances of the full Soundex algorithm that are not implemented by this application.&#13;
A more complete test using JUnit (see <a data-type="xref" href="ch01.html#javacook-getstarted-junit">Recipe 1.10</a>) is also online as <em>SoundexTest.java</em>,&#13;
in the <em>src/tests/java/strings</em> directory.&#13;
The dedicated reader may use this to provoke failures of such nuances&#13;
and send a pull request with updated versions of the test and the code.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="See Also" data-type="sect2"><div class="sect2" id="idm45290687576808">&#13;
<h2>See Also</h2>&#13;
&#13;
<p>The <a data-primary="Levenshtein string edit distance algorithm" data-type="indexterm" id="idm45290687575256"/>Levenshtein string edit distance algorithm can be used for doing approximate string comparisons in a different fashion. You can find this in<a data-primary="Apache Commons StringUtils" data-type="indexterm" id="idm45290687574136"/> <a href="http://commons.apache.org/proper/commons-lang">Apache Commons StringUtils</a>. I show a non-Java (Perl) implementation of this algorithm in <a data-type="xref" href="ch18.html#javacook-otherlang-SECT-4">Recipe 18.5</a>. <a data-primary="" data-startref="sndx_p" data-type="indexterm" id="idm45290687191016"/><a data-primary="" data-startref="str_ch" data-type="indexterm" id="idm45290687190040"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<div data-type="footnotes"><p data-type="footnote" id="idm45290704847128"><sup><a href="ch03.html#idm45290704847128-marker">1</a></sup> The two <code>.equals()</code> calls are equivalent with the exception that the first can throw a <code>NullPointerException</code> while the second cannot.</p><p data-type="footnote" id="idm45290704715928"><sup><a href="ch03.html#idm45290704715928-marker">2</a></sup> <code>StringBuilder</code> was added in Java 5. It is functionally equivalent to the older <span class="keep-together"><code>StringBuffer</code>.</span> We will delve into the details in <a data-type="xref" href="#javacook-strings-SECT-3">Recipe 3.2</a>.</p><p data-type="footnote" id="idm45290704071000"><sup><a href="ch03.html#idm45290704071000-marker">3</a></sup> Unless, perhaps, you’re as slow at updating personal records as I am.</p><p data-type="footnote" id="idm45290703693768"><sup><a href="ch03.html#idm45290703693768-marker">4</a></sup> <code>String</code> and <code>StringBuilder</code> have several methods that are forced to be identical by their implementation of the <code>CharSequence</code> interface.</p><p data-type="footnote" id="idm45290702287384"><sup><a href="ch03.html#idm45290702287384-marker">5</a></sup> Indeed, there are so many characters in Unicode that a fad has emerged of displaying your name upside down using characters that approximate upside-down versions of the Latin alphabet. Do a web search for “upside-down Unicode.”</p><p data-type="footnote" id="idm45290687591464"><sup><a href="ch03.html#idm45290687591464-marker">6</a></sup> In Unix terminology, a daemon is a server. The old English word has nothing to do with satanic demons but refers to a helper or assistant. Derwin Daemon was actually a character in Susannah Coleman’s <em>Source Wars</em> online comic strip, which long ago was online at a now-departed site called <em>darby.daemonnews.org</em>.</p></div></div></section></body></html>