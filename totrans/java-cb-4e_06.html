<html><head></head><body><section data-pdf-bookmark="Chapter 6. Dates and Times" data-type="chapter" epub:type="chapter"><div class="chapter" id="javacook-dates">&#13;
<h1><span class="label">Chapter 6. </span>Dates and Times</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="6.0 Introduction" data-type="sect1"><div class="sect1" id="javacook-dates-intro">&#13;
<h1>6.0 Introduction</h1>&#13;
&#13;
<p><a data-primary="Date/Time API" data-type="indexterm" id="dta_ch"/><a data-primary="Date/Time API" data-secondary="about" data-type="indexterm" id="idm45290675940616"/>Developers suffered for a decade and a half under the inconsistencies and ambiguities of the <code>Date</code> class from Java 1.0 and its&#13;
replacement wannabe, the <code>Calendar</code> class from Java 1.1. Several alternative <code>Date</code> replacement packages emerged, including the <span class="keep-together">&#13;
simple and sensible</span> <a href="http://date4j.net">Date4J</a> and the more comprehensive<a data-primary="Joda-Time package" data-type="indexterm" id="idm45290675936760"/> <a href="http://www.joda.org/joda-time">Joda-Time package</a>. Java 8 introduced a new, consistent, and well-thought-out package for date and time handling under the aegis of the Java Community Process, JSR-310, shepherded by developer <a data-primary="Colebourne, Stephen" data-type="indexterm" id="idm45290675934984"/>Stephen Colebourne, based on his earlier package Joda-Time, but with several important design changes.<sup><a data-type="noteref" href="ch06.html#idm45290675934040" id="idm45290675934040-marker">1</a></sup> This package is biased toward ISO 8601 dates; the default format is, for example, 2015-10-23T10:22:45. But it can, of course, work with other calendar schemes.</p>&#13;
&#13;
<p>One of the key benefits of the new API is that it provides&#13;
<a data-primary="useful operations" data-type="indexterm" id="idm45290675932424"/><em>useful operations</em> such as adding/subtracting dates/times. Much time was wasted by developers reimplementing these useful operations again and again. With the new APIs, one can use the built-in functionality.&#13;
That said, millions of lines of code are based on the old APIs, so&#13;
we’ll review them briefly, and consider interfacing the new API to&#13;
legacy code in the final recipe of this chapter,&#13;
<a data-type="xref" href="#javacook-dates-legacy">Recipe 6.9</a>.</p>&#13;
&#13;
<p>Another advantage of the new API is that almost all objects are immutable and&#13;
thus thread-safe. This can be of considerable benefit as we move&#13;
headlong into the massively parallel era.</p>&#13;
&#13;
<p>Because there are no <code>set</code> methods, and thus the getter method paradigm doesn’t always make sense,&#13;
the API provides a series of new methods to replace such methods, listed in <a data-type="xref" href="#javacook-dates-intro-METHODS">Table 6-1</a>.<a data-primary="Date/Time API" data-secondary="methods" data-type="indexterm" id="idm45290675927720"/></p>&#13;
<table id="javacook-dates-intro-METHODS">&#13;
<caption><span class="label">Table 6-1. </span>New date/time API: common methods</caption>&#13;
<thead>&#13;
<tr>&#13;
<th>Name</th>&#13;
<th>Description</th>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td><p><code>at</code></p></td>&#13;
<td><p>Combines with another object</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>format</code></p></td>&#13;
<td><p>Use provided formatter to produce a formatted string</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>from</code></p></td>&#13;
<td><p>Factory: convert input parameters to instance of target</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>get</code></p></td>&#13;
<td><p>Retrieve one field from the instance</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>is</code></p></td>&#13;
<td><p>Examine the state of the given object</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>minus</code></p></td>&#13;
<td><p>Return a copy with the given amount subtracted</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>now</code></p></td>&#13;
<td><p>BuilderFactory: get the current time, date, etc.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>of</code></p></td>&#13;
<td><p>Factory: create new method by parsing inputs</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>parse</code></p></td>&#13;
<td><p>Factory: parse single input string to produce instance of target</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>plus</code></p></td>&#13;
<td><p>Return a copy with the given amount added</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>to</code></p></td>&#13;
<td><p>Convert this object to another type</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>with</code></p></td>&#13;
<td><p>Return a copy with the given field changed; replaces <code>set</code> methods</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
&#13;
<p>The JSR 310 API specifies a dozen or so main classes. Those representing&#13;
times are either <a data-primary="continuous time" data-type="indexterm" id="idm45290675901336"/>continuous time or human time. <em>Continuous time</em> is&#13;
based on <a data-primary="Unix" data-secondary="time in" data-type="indexterm" id="idm45290675900072"/>Unix time, a deeper truth from the dawn of (computer)&#13;
time, and is represented as a single monotonically increasing number.&#13;
The time value of 0 in Unix represented the first second of&#13;
January 1, 1970 UTC—about the time Unix was invented. Each unit of&#13;
increment there represented one second of time. This has been&#13;
used as a time base in most operating systems developed since.&#13;
However, a 32-bit integer representing the number of seconds&#13;
since 1970 runs out fairly soon—in the year 2038 AD.&#13;
Most Unix systems have, in the aftermath of the Y2K frenzy,&#13;
quietly and well in advance headed off a possible Y2038 frenzy by&#13;
converting the time value from a 32-bit quantity to a 64-bit quantity.&#13;
Java also used this time base, but used 64 bits, and stored its time in&#13;
milliseconds,&#13;
because a 64-bit time in milliseconds since 1970 will not overlow&#13;
until quite a few years into the future&#13;
(keep this date open in your calendar—August 17, 292,278,994 CE). Here is a calculation that shows how I got that date:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting">        <code class="n">Date</code> <code class="n">endOfTime</code> <code class="o">=</code> <code class="k">new</code> <code class="n">Date</code><code class="o">(</code><code class="n">Long</code><code class="o">.</code><code class="na">MAX_VALUE</code><code class="o">);</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Java time overflows on "</code> <code class="o">+</code> <code class="n">endOfTime</code><code class="o">);</code></pre>&#13;
&#13;
<p>The new API is in five packages, as shown in <a data-type="xref" href="#table_0602">Table 6-2</a>; as usual, the top-level one contains&#13;
the most commonly used pieces.<a data-primary="Date/Time API" data-secondary="packages" data-type="indexterm" id="idm45290675887608"/></p>&#13;
<table id="table_0602">&#13;
<caption><span class="label">Table 6-2. </span>New date/time API: packages</caption>&#13;
<thead>&#13;
<tr>&#13;
<th>Name</th>&#13;
<th>Description</th>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td><p><code>java.time</code></p></td>&#13;
<td><p>Common classes for dates, times, instants, and durations</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>java.time.chrono</code></p></td>&#13;
<td><p>API for non-ISO calendar systems</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>java.time.format</code></p></td>&#13;
<td><p>Formatting classes (see <a data-type="xref" href="#javacook-dates-format">Recipe 6.2</a>)</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>java.time.temporal</code></p></td>&#13;
<td><p>Date and time access using fields, units, and adjusters</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>java.time.zone</code></p></td>&#13;
<td><p>Support for time zones and their rules</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
&#13;
<p>The basic <code>java.time</code> package contains a dozen or so classes, as&#13;
well as a couple of enums and one general-purpose exception (shown in Tables <a data-type="xref" data-xrefstyle="select: labelnumber" href="#table_0603">6-3</a>, <a data-type="xref" data-xrefstyle="select: labelnumber" href="#table_0604">6-4</a>, and <a data-type="xref" data-xrefstyle="select: labelnumber" href="#table_0605">6-5</a>).<a data-primary="Date/Time API" data-secondary="basics of" data-type="indexterm" id="idm45290675855784"/></p>&#13;
<table id="table_0603">&#13;
<caption><span class="label">Table 6-3. </span>New date/time API: basics</caption>&#13;
<thead>&#13;
<tr>&#13;
<th>Class</th>&#13;
<th>Description</th>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td><p><code>Clock</code></p></td>&#13;
<td><p>Replaceable factory for getting current time</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>Instant</code></p></td>&#13;
<td><p>A point in time since January 1, 1970, expressed in nanoseconds</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>Duration</code></p></td>&#13;
<td><p>A length of time, also expressed in nanoseconds</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
&#13;
<p><a data-primary="human time" data-type="indexterm" id="idm45290675823896"/>Human time represents times and dates as we use them in our everyday life.&#13;
These classes are listed in <a data-type="xref" href="#table_0604">Table 6-4</a>.<a data-primary="Date/Time API" data-secondary="human time" data-type="indexterm" id="idm45290675822152"/></p>&#13;
<table id="table_0604">&#13;
<caption><span class="label">Table 6-4. </span>New date/time API: human time</caption>&#13;
<thead>&#13;
<tr>&#13;
<th>Class</th>&#13;
<th>Description</th>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td><p><code>Calendrical</code></p></td>&#13;
<td><p>Connects to the low-level API</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>DateTimeFields</code></p></td>&#13;
<td><p>Stores a map of field-value pairs, which are not required to be consistent</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>DayOfWeek</code></p></td>&#13;
<td><p>A day of the week (e.g., Tuesday)</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>LocalDate</code></p></td>&#13;
<td><p>A bare date (day, month, and year) with no adjustments</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>LocalTime</code></p></td>&#13;
<td><p>A bare time (hour, minute, seconds) with no adjustments</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>LocalDateTime</code></p></td>&#13;
<td><p>The combination of the above</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>MonthDay</code></p></td>&#13;
<td><p>Month and day</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>OffsetTime</code></p></td>&#13;
<td><p>A time of day with a time zone offset like –04:00, with no date or zone</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>OffsetDateTime</code></p></td>&#13;
<td><p>A date and time with a time zone offset like –04:00, with no time zone</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>Period</code></p></td>&#13;
<td><p>A descriptive amount of time, such as “2 months and 3 days”</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>ZonedDateTime</code></p></td>&#13;
<td><p>The date and time with a time zone and an offset</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>Year</code></p></td>&#13;
<td><p>A year by itself</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>YearMonth</code></p></td>&#13;
<td><p>A year and month</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
&#13;
<p>Almost all the top-level classes directly extend <code>java.lang.Object</code> and&#13;
are held to consistency by a variety of interfaces, which are&#13;
declared in the subpackages. The date and time classes&#13;
mostly implement <code>Comparable</code>, which makes sense.</p>&#13;
&#13;
<p><a data-type="xref" href="#table_0605">Table 6-5</a> shows the two time-zone-specific classes used with <code>ZonedDateTime</code>, <code>OffsetDateTime</code>, and <code>OffsetTime</code>.<a data-primary="Date/Time API" data-secondary="support" data-type="indexterm" id="idm45290675791240"/></p>&#13;
<table id="table_0605">&#13;
<caption><span class="label">Table 6-5. </span>New date/time API: support</caption>&#13;
<thead>&#13;
<tr>&#13;
<th>Class</th>&#13;
<th>Description</th>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td><p><code>ZoneOffset</code></p></td>&#13;
<td><p>A time offset from UTC (hours, minutes, seconds)</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>ZoneId</code></p></td>&#13;
<td><p>Defines a time zone such as <em>Canada/Eastern</em> and its conversion rules</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
&#13;
<p>The new API is a <a data-primary="fluent API" data-type="indexterm" id="idm45290675782360"/><em>fluent API</em>, in which most operations return the object they have&#13;
operated upon, so that you can chain multiple calls without the need for tedious&#13;
and annoying temporary variables:</p>&#13;
&#13;
<pre data-type="programlisting">LocalTime time = LocalTime.now().minusHours(5); // the time 5 hours ago</pre>&#13;
&#13;
<p>This results in a more natural and convenient coding style, in my opinion.&#13;
You can always write code with lots of temporary variables if you want;&#13;
you’re the one who will have to read through it later.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="6.1 Finding Today’s Date" data-type="sect1"><div class="sect1" id="javacook-dates-SECT-1">&#13;
<h1>6.1 Finding Today’s Date</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-dates-SECT-1.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="Date/Time API" data-secondary="current date/time, finding" data-type="indexterm" id="idm45290675777080"/>You want to find today’s date and/or time.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-dates-SECT-1.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Invoke the appropriate builder to obtain a <code>LocalDate</code>, <code>LocalTime</code>, or <code>LocalDateTime</code> object&#13;
and call its <a data-primary="toString() method" data-type="indexterm" id="idm45290675772648"/><code>toString()</code>  method.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-dates-SECT-1.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>These classes do not provide public constructors, so you will need to call one of its factory methods&#13;
to get an instance. They all provide a <a data-primary="now() method" data-type="indexterm" id="idm45290675769080"/><code>now()</code> method, which does what its name implies.&#13;
The <code>CurrentDateTime</code> demo program shows simple use of all three:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">CurrentDateTime</code> <code class="o">{</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">args</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">LocalDate</code> <code class="n">dNow</code> <code class="o">=</code> <code class="n">LocalDate</code><code class="o">.</code><code class="na">now</code><code class="o">();</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">dNow</code><code class="o">);</code>&#13;
        <code class="n">LocalTime</code> <code class="n">tNow</code> <code class="o">=</code> <code class="n">LocalTime</code><code class="o">.</code><code class="na">now</code><code class="o">();</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">tNow</code><code class="o">);</code>&#13;
        <code class="n">LocalDateTime</code> <code class="n">now</code> <code class="o">=</code> <code class="n">LocalDateTime</code><code class="o">.</code><code class="na">now</code><code class="o">();</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">now</code><code class="o">);</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p>Running it produces this output:</p>&#13;
&#13;
<pre data-type="programlisting">2013-10-28&#13;
22:23:55.641&#13;
2013-10-28T22:23:55.642</pre>&#13;
&#13;
<p>The formatting is nothing spectacular, but it’s adequate.&#13;
We’ll deal with fancier formatting in&#13;
<a data-type="xref" href="#javacook-dates-format">Recipe 6.2</a>.</p>&#13;
&#13;
<p>While this works, in full-scale applications, it’s recommended to pass a <code>Clock</code> instance&#13;
into all the <code>now()</code> methods.&#13;
<code>Clock</code> is a factory object that is used internally to find the current time.&#13;
In testing, you often want to have a known date or time used so you can compare&#13;
against known output. The <code>Clock</code> class makes this easy. <a data-type="xref" href="#javacook-datetime-EX-clock">Example 6-1</a>&#13;
uses a <code>Clock</code> and allows replacing the default <code>Clock</code> by calling a setter.&#13;
Alternately you could use a dependency injection framework like CDI or Spring&#13;
to provide the correct version of the <code>Clock</code> class.</p>&#13;
<div data-type="example" id="javacook-datetime-EX-clock">&#13;
<h5><span class="label">Example 6-1. </span>main/src/main/java/datetime/TestableDateTime</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kn">package</code> <code class="n">datetime</code><code class="o">;</code>&#13;
&#13;
<code class="kn">import</code> <code class="nn">java.time.Clock</code><code class="o">;</code>&#13;
<code class="kn">import</code> <code class="nn">java.time.LocalDateTime</code><code class="o">;</code>&#13;
&#13;
<code class="cm">/**</code>&#13;
<code class="cm"> * TestableDateTime allows test code to plug in a Fixed clock</code>&#13;
<code class="cm"> */</code>&#13;
<code class="kd">public</code> <code class="kd">class</code> <code class="nc">TestableDateTime</code> <code class="o">{</code>&#13;
    <code class="kd">private</code> <code class="kd">static</code> <code class="n">Clock</code> <code class="n">clock</code> <code class="o">=</code> <code class="n">Clock</code><code class="o">.</code><code class="na">systemDefaultZone</code><code class="o">();</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">args</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"It is now "</code> <code class="o">+</code> <code class="n">LocalDateTime</code><code class="o">.</code><code class="na">now</code><code class="o">(</code><code class="n">clock</code><code class="o">));</code>&#13;
    <code class="o">}</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">setClock</code><code class="o">(</code><code class="n">Clock</code> <code class="n">clock</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">TestableDateTime</code><code class="o">.</code><code class="na">clock</code> <code class="o">=</code> <code class="n">clock</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre></div>&#13;
&#13;
<p>In normal operation this would get the current date and time.&#13;
In testing you would call the <a data-primary="setClock() method" data-type="indexterm" id="idm45290675726984"/><code>setClock()</code> method with a <code>Clock</code> instance&#13;
obtained from the static method <code>Clock.fixed(Instant fixedInstant, ZoneId zone)</code>,&#13;
passing in the time that your testing code expects.&#13;
The fixed clock does not tick, so don’t worry about the milliseconds between&#13;
setting the clock to fixed and the invocation of your tests.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="6.2 Formatting Dates and Times" data-type="sect1"><div class="sect1" id="javacook-dates-format">&#13;
<h1>6.2 Formatting Dates and Times</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-dates-format.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="Date/Time API" data-secondary="formatting with" data-type="indexterm" id="dta_fw"/><a data-primary="formatting" data-secondary="dates/times" data-type="indexterm" id="f_dt"/><a data-primary="times" data-type="indexterm" id="ti_fo"/>You want to provide better formatting for date and time objects.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-dates-format.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use <code>java.time.format.DateTimeFormatter</code>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-dates-format.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>The <code>DateTimeFormatter</code> class provides an amazing number of possible formatting styles.&#13;
If you don’t want to use one of the provided 20 or so predefined formats, you&#13;
can define your own using <code>DateTimeFormatter.ofPattern(String pattern)</code>.&#13;
The <code>pattern</code> string can contain any characters, but almost every letter of the alphabet has been defined&#13;
to mean something, in addition to the obvious <em>Y</em>, <em>M</em>, <em>D</em>, <em>h</em>, <em>m</em>, and <em>s</em>.&#13;
In addition, the quote character and square bracket characters are defined,&#13;
and the sharp sign (<em>#</em>) and curly braces are reserved for future use.</p>&#13;
&#13;
<p>As is common with date formatting languages, the number of repetitions of a letter in the&#13;
pattern gives a clue to its intended length of detail. Thus, for example, “MMM” gives “Jan,”&#13;
whereas “MMMM” gives “January.”</p>&#13;
&#13;
<p><a data-type="xref" href="#javacook-dates-format-chars">Table 6-6</a> is an attempt at a complete list of the formatting characters, adapted from the javadoc&#13;
for JSR-310.<a data-primary="DateFormatter" data-type="indexterm" id="idm45290675510136"/></p>&#13;
<table id="javacook-dates-format-chars">&#13;
<caption><span class="label">Table 6-6. </span>DateFormatter format characters</caption>&#13;
<thead>&#13;
<tr>&#13;
<th>Symbol</th>&#13;
<th>Meaning</th>&#13;
<th>Presentation</th>&#13;
<th>Examples</th>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td><p><code>G</code></p></td>&#13;
<td><p>Era</p></td>&#13;
<td><p>Text</p></td>&#13;
<td><p>AD; Anno Domini</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>y</code></p></td>&#13;
<td><p>Year of era</p></td>&#13;
<td><p>Year</p></td>&#13;
<td><p>2004; 04</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>u</code></p></td>&#13;
<td><p>Year of era</p></td>&#13;
<td><p>Year</p></td>&#13;
<td><p>See note.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>D</code></p></td>&#13;
<td><p>Day of year</p></td>&#13;
<td><p>Number</p></td>&#13;
<td><p>189</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>M/L</code></p></td>&#13;
<td><p>Month of year</p></td>&#13;
<td><p>Number/text</p></td>&#13;
<td><p>7; 07; Jul; July; J</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>d</code></p></td>&#13;
<td><p>Day of month</p></td>&#13;
<td><p>Number</p></td>&#13;
<td><p>10</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>Q/q</code></p></td>&#13;
<td><p>Quarter of year</p></td>&#13;
<td><p>Number/text</p></td>&#13;
<td><p>3; 03; Q3, 3rd quarter</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>Y</code></p></td>&#13;
<td><p>Week based year</p></td>&#13;
<td><p>Year</p></td>&#13;
<td><p>1996; 96</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>w</code></p></td>&#13;
<td><p>Week of week based year</p></td>&#13;
<td><p>Number</p></td>&#13;
<td><p>27</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>W</code></p></td>&#13;
<td><p>Week of month</p></td>&#13;
<td><p>Number</p></td>&#13;
<td><p>4</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>e/c</code></p></td>&#13;
<td><p>Localized day of week</p></td>&#13;
<td><p>Number/text</p></td>&#13;
<td><p>2; 02; Tue; Tuesday; T</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>E</code></p></td>&#13;
<td><p>Day of week</p></td>&#13;
<td><p>Text</p></td>&#13;
<td><p>Tue; Tuesday; T</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>F</code></p></td>&#13;
<td><p>Week of month</p></td>&#13;
<td><p>Number</p></td>&#13;
<td><p>3</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>a</code></p></td>&#13;
<td><p>am pm of day</p></td>&#13;
<td><p>Text</p></td>&#13;
<td><p>PM</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>h</code></p></td>&#13;
<td><p>Clock hour of am pm (1-12)</p></td>&#13;
<td><p>Number</p></td>&#13;
<td><p>12</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>K</code></p></td>&#13;
<td><p>Hour of am pm (0-11)</p></td>&#13;
<td><p>Number</p></td>&#13;
<td><p>0</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>k</code></p></td>&#13;
<td><p>Clock hour of am pm (1-24)</p></td>&#13;
<td><p>Number</p></td>&#13;
<td><p>0</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>H</code></p></td>&#13;
<td><p>Hour of day (0-23)</p></td>&#13;
<td><p>Number</p></td>&#13;
<td><p>0</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>m</code></p></td>&#13;
<td><p>Minute of hour</p></td>&#13;
<td><p>Number</p></td>&#13;
<td><p>30</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>s</code></p></td>&#13;
<td><p>Second of minute</p></td>&#13;
<td><p>Number</p></td>&#13;
<td><p>55</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>S</code></p></td>&#13;
<td><p>Fraction of second</p></td>&#13;
<td><p>Fraction</p></td>&#13;
<td><p>978</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>A</code></p></td>&#13;
<td><p>Millisecond of day</p></td>&#13;
<td><p>Number</p></td>&#13;
<td><p>1234</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>n</code></p></td>&#13;
<td><p>Nanosecond of second</p></td>&#13;
<td><p>Number</p></td>&#13;
<td><p>987654321</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>N</code></p></td>&#13;
<td><p>Nanosecond of day</p></td>&#13;
<td><p>Number</p></td>&#13;
<td><p>1234000000</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>V</code></p></td>&#13;
<td><p>Time zone ID</p></td>&#13;
<td><p>Zone-id</p></td>&#13;
<td><p>America/Los_Angeles; Z; –08:30</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>z</code></p></td>&#13;
<td><p>Time zone name</p></td>&#13;
<td><p>Zone-name</p></td>&#13;
<td><p>Pacific Standard Time; PST</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>X</code></p></td>&#13;
<td><p>Zone offset <em>Z</em> for zero</p></td>&#13;
<td><p>Offset-X</p></td>&#13;
<td><p>Z; –08; –0830; –08:30; –083015; –08:30:15;</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>x</code></p></td>&#13;
<td><p>Zone offset</p></td>&#13;
<td><p>Offset-x</p></td>&#13;
<td><p>+0000; –08; –0830; –08:30; –083015; –08:30:15;</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>Z</code></p></td>&#13;
<td><p>Zone offset</p></td>&#13;
<td><p>Offset-Z</p></td>&#13;
<td><p>+0000; –0800; –08:00;</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>O</code></p></td>&#13;
<td><p>Localized zone offset</p></td>&#13;
<td><p>Offset-O</p></td>&#13;
<td><p>GMT+8; GMT+08:00; UTC–08:00;</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>p</code></p></td>&#13;
<td><p>Pad next</p></td>&#13;
<td><p>Pad modifier</p></td>&#13;
<td><p>1</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p><em>y</em> and <em>u</em> work the same for AD years; however, for a year of 3 BC, the <em>y</em> pattern returns 3, whereas the <em>u</em> pattern returns –2 (a.k.a. proleptic year).</p>&#13;
</div>&#13;
&#13;
<p><a data-type="xref" href="#javacook-dates-dateformatter">Example 6-2</a> contains some examples of converting in both directions between strings and dates.<a data-primary="" data-startref="dta_fw" data-type="indexterm" id="idm45290675381496"/><a data-primary="" data-startref="f_dt" data-type="indexterm" id="idm45290675380552"/><a data-primary="" data-startref="ti_fo" data-type="indexterm" id="idm45290675379608"/></p>&#13;
<div data-type="example" id="javacook-dates-dateformatter">&#13;
<h5><span class="label">Example 6-2. </span>main/src/main/java/datetime/DateFormatter.java (example date formatting and parsing)</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">DateFormatter</code> <code class="o">{</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">args</code><code class="o">)</code> <code class="o">{</code>&#13;
&#13;
        <code class="c1">// Format a date ISO8601-like but with slashes instead of dashes</code>&#13;
        <code class="n">DateTimeFormatter</code> <code class="n">df</code> <code class="o">=</code> <code class="n">DateTimeFormatter</code><code class="o">.</code><code class="na">ofPattern</code><code class="o">(</code><code class="s">"yyyy/LL/dd"</code><code class="o">);</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">df</code><code class="o">.</code><code class="na">format</code><code class="o">(</code><code class="n">LocalDate</code><code class="o">.</code><code class="na">now</code><code class="o">()));</code>&#13;
&#13;
        <code class="c1">// Parse a String to a date using the same formatter</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">LocalDate</code><code class="o">.</code><code class="na">parse</code><code class="o">(</code><code class="s">"2014/04/01"</code><code class="o">,</code> <code class="n">df</code><code class="o">));</code>&#13;
&#13;
        <code class="c1">// Format a Date and Time without timezone information</code>&#13;
        <code class="n">DateTimeFormatter</code> <code class="n">nTZ</code> <code class="o">=</code>&#13;
            <code class="n">DateTimeFormatter</code><code class="o">.</code><code class="na">ofPattern</code><code class="o">(</code><code class="s">"d MMMM, yyyy h:mm a"</code><code class="o">);</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">ZonedDateTime</code><code class="o">.</code><code class="na">now</code><code class="o">().</code><code class="na">format</code><code class="o">(</code><code class="n">nTZ</code><code class="o">));</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre></div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="6.3 Converting Among Dates/Times, YMDHMS, and Epoch Seconds" data-type="sect1"><div class="sect1" id="javacook-dates-convert">&#13;
<h1>6.3 Converting Among Dates/Times, YMDHMS, and <span class="keep-together">Epoch Seconds</span></h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-dates-convert.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="Date/Time API" data-secondary="converting" data-type="indexterm" id="idm45290675288168"/><a data-primary="times" data-type="indexterm" id="idm45290675287192"/><a data-primary="epoch seconds" data-type="indexterm" id="idm45290675286520"/><a data-primary="YMDHMS" data-type="indexterm" id="idm45290675285848"/>You need to convert among dates/times, YMDHMS, epoch seconds, or some other numeric value.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-dates-convert.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use the appropriate date/time factory or retrieval methods.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-dates-convert.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>The epoch is the beginning of time as far as modern&#13;
operating systems go.  Unix time, and some versions of Windows time,&#13;
count off inexorably the seconds since the epoch.&#13;
When <a data-primary="Thompson, Ken" data-type="indexterm" id="idm45290675280888"/><a data-primary="Ritchie, Dennis" data-type="indexterm" id="idm45290675280184"/>Ken Thompson and Dennis Ritchie came up with this format in 1970,&#13;
seconds seemed like a fine measure, and 32 bits’ worth of seconds seemed nearly infinite.&#13;
On operating systems that store the epoch in a 32-bit integer, however, time is running out.&#13;
Older versions of most operating systems stored this as a 32-bit signed integer,&#13;
which unfortunately will overflow in the year 2038.</p>&#13;
&#13;
<p>When Java first came out, it featured a method called <a data-primary="System.currentTimeMillis() method" data-type="indexterm" id="idm45290675278600"/><code>System.currentTimeMillis()</code>,&#13;
presenting epoch seconds with millisecond accuracy.&#13;
The new Java API uses epoch nanoseconds that are still on the same time base&#13;
and can be obtained with a call to <a data-primary="System.nanoTime() method" data-type="indexterm" id="idm45290675277368"/><code>System.nanoTime()</code>.</p>&#13;
&#13;
<p>Any of these epoch-related numbers can be converted into, or obtained from,&#13;
a local date/time. Other numbers can also be used, such as integer years, months, and days.&#13;
As usual, there are factory methods that create new objects where a change is requested.&#13;
Here is a program that shows some of these conversions in action:</p>&#13;
&#13;
<p><em>main/src/main/java/datetime/DateConversions.java</em></p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting">        <code class="c1">// Convert a number of seconds since the epoch to a local date/time</code>&#13;
        <code class="n">Instant</code> <code class="n">epochSec</code> <code class="o">=</code> <code class="n">Instant</code><code class="o">.</code><code class="na">ofEpochSecond</code><code class="o">(</code><code class="mi">1000000000L</code><code class="o">);</code>&#13;
        <code class="n">ZoneId</code> <code class="n">zId</code> <code class="o">=</code> <code class="n">ZoneId</code><code class="o">.</code><code class="na">systemDefault</code><code class="o">();</code>&#13;
        <code class="n">ZonedDateTime</code> <code class="n">then</code> <code class="o">=</code> <code class="n">ZonedDateTime</code><code class="o">.</code><code class="na">ofInstant</code><code class="o">(</code><code class="n">epochSec</code><code class="o">,</code> <code class="n">zId</code><code class="o">);</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"The epoch was a billion seconds old on "</code> <code class="o">+</code> <code class="n">then</code><code class="o">);</code>&#13;
&#13;
        <code class="c1">// Convert a date/time to epoch seconds</code>&#13;
        <code class="kt">long</code> <code class="n">epochSecond</code> <code class="o">=</code> <code class="n">ZonedDateTime</code><code class="o">.</code><code class="na">now</code><code class="o">().</code><code class="na">toInstant</code><code class="o">().</code><code class="na">getEpochSecond</code><code class="o">();</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Current epoch seconds = "</code> <code class="o">+</code> <code class="n">epochSecond</code><code class="o">);</code>&#13;
&#13;
        <code class="n">LocalDateTime</code> <code class="n">now</code> <code class="o">=</code> <code class="n">LocalDateTime</code><code class="o">.</code><code class="na">now</code><code class="o">();</code>&#13;
        <code class="n">ZonedDateTime</code> <code class="n">there</code> <code class="o">=</code> <code class="n">now</code><code class="o">.</code><code class="na">atZone</code><code class="o">(</code><code class="n">ZoneId</code><code class="o">.</code><code class="na">of</code><code class="o">(</code><code class="s">"Canada/Pacific"</code><code class="o">));</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">printf</code><code class="o">(</code><code class="s">"When it's %s here, it's %s in Vancouver%n"</code><code class="o">,</code>&#13;
            <code class="n">now</code><code class="o">,</code> <code class="n">there</code><code class="o">);</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="6.4 Parsing Strings into Dates" data-type="sect1"><div class="sect1" id="javacook-dates-SECT-5">&#13;
<h1>6.4 Parsing Strings into Dates</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-dates-SECT-5.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="Date/Time API" data-secondary="parsing strings" data-type="indexterm" id="idm45290675151736"/><a data-primary="parsing strings into dates" data-type="indexterm" id="idm45290675150760"/><a data-primary="strings" data-secondary="parsing into dates" data-type="indexterm" id="idm45290675150072"/>You need to convert user input into <code>java.time</code> objects.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-dates-SECT-5.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use a<a data-primary="parse() method" data-type="indexterm" id="idm45290675146728"/> <code>parse()</code> method.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-dates-SECT-5.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>Many of the date/time classes have a  <code>parse()</code> factory method, which tries to parse a&#13;
string into an object of that class. For example, <code>LocalDate.parse(String)</code>&#13;
returns a <code>LocalDate</code> object for the date given in the input <code>String</code>:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">DateParse</code> <code class="o">{</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">args</code><code class="o">)</code> <code class="o">{</code>&#13;
&#13;
        <code class="n">String</code> <code class="n">armisticeDate</code> <code class="o">=</code> <code class="s">"1914-11-11"</code><code class="o">;</code>&#13;
        <code class="n">LocalDate</code> <code class="n">aLD</code> <code class="o">=</code> <code class="n">LocalDate</code><code class="o">.</code><code class="na">parse</code><code class="o">(</code><code class="n">armisticeDate</code><code class="o">);</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Date: "</code> <code class="o">+</code> <code class="n">aLD</code><code class="o">);</code>&#13;
&#13;
        <code class="n">String</code> <code class="n">armisticeDateTime</code> <code class="o">=</code> <code class="s">"1914-11-11T11:11"</code><code class="o">;</code>&#13;
        <code class="n">LocalDateTime</code> <code class="n">aLDT</code> <code class="o">=</code> <code class="n">LocalDateTime</code><code class="o">.</code><code class="na">parse</code><code class="o">(</code><code class="n">armisticeDateTime</code><code class="o">);</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Date/Time: "</code> <code class="o">+</code> <code class="n">aLDT</code><code class="o">);</code></pre>&#13;
&#13;
<p>As you probably expect by now, the default format is the ISO8601 date format.&#13;
However, we often have to deal with dates in other formats.&#13;
For this, the <code>DateTimeFormatter</code> allows you to specify a particular pattern.&#13;
For example, “dd MMM uuuu” represents the day of the month (two digits),&#13;
three letters of the name of the month (Jan, Feb, Mar, …), and a four-digit year:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting">        <code class="n">DateTimeFormatter</code> <code class="n">df</code> <code class="o">=</code> <code class="n">DateTimeFormatter</code><code class="o">.</code><code class="na">ofPattern</code><code class="o">(</code><code class="s">"dd MMM uuuu"</code><code class="o">);</code>&#13;
        <code class="n">String</code> <code class="n">anotherDate</code> <code class="o">=</code> <code class="s">"27 Jan 2011"</code><code class="o">;</code>&#13;
        <code class="n">LocalDate</code> <code class="n">random</code> <code class="o">=</code> <code class="n">LocalDate</code><code class="o">.</code><code class="na">parse</code><code class="o">(</code><code class="n">anotherDate</code><code class="o">,</code> <code class="n">df</code><code class="o">);</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">anotherDate</code> <code class="o">+</code> <code class="s">" parses as "</code> <code class="o">+</code> <code class="n">random</code><code class="o">);</code></pre>&#13;
&#13;
<p>The <code>DateTimeFormatter</code> object is bidirectional; it can both&#13;
parse input and format output. We could add this line to the <code>DateParse</code> example:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">aLD</code> <code class="o">+</code> <code class="s">" formats as "</code> <code class="o">+</code> <code class="n">df</code><code class="o">.</code><code class="na">format</code><code class="o">(</code><code class="n">aLD</code><code class="o">));</code></pre>&#13;
&#13;
<p>When we run the program, we see the output as follows:</p>&#13;
&#13;
<pre data-type="programlisting">Date: 1914-11-11&#13;
Date/Time: 1914-11-11T11:11&#13;
27 Jan 2011 parses as 2011-01-27&#13;
1914-11-11 formats as 11 Nov 1914</pre>&#13;
&#13;
<p>The <code>DateTimeFormatter</code> is also localized (see <a data-type="xref" href="ch03.html#javacook-i18n-SECT-8">Recipe 3.12</a>), and can be configured by calling&#13;
<a data-primary="withLocale() method" data-type="indexterm" id="idm45290674871832"/><code>withLocale()</code> after calling <a data-primary="ofPettern() method" data-type="indexterm" id="idm45290674987592"/><code>ofPattern()</code>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="6.5 Difference Between Two Dates" data-type="sect1"><div class="sect1" id="javacook-dates-diff">&#13;
<h1>6.5 Difference Between Two Dates</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-dates-diff.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="Date/Time API" data-secondary="computing periods between dates with" data-type="indexterm" id="idm45290674983608"/>You need to compute the difference between two dates.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-dates-diff.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use the static method <a data-primary="Period.between() method" data-type="indexterm" id="idm45290674980712"/><code>Period.between()</code> to find the difference between two <code>LocalDates</code>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-dates-diff.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>Given two <code>LocalDate</code> objects, you can find the difference between them,&#13;
as a <code>Period</code>, simply using the static <code>Period.between()</code> method.&#13;
You can <a data-primary="toString() method" data-type="indexterm" id="idm45290674969944"/><code>toString()</code> the <code>Period</code> or,&#13;
if its default format isn’t good enough, format the result yourself:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kn">import</code> <code class="nn">java.time.LocalDate</code><code class="o">;</code>&#13;
<code class="kn">import</code> <code class="nn">java.time.Period</code><code class="o">;</code>&#13;
&#13;
<code class="cm">/**</code>&#13;
<code class="cm"> * Tutorial/Example of LocalDate date difference subtraction</code>&#13;
<code class="cm"> */</code>&#13;
<code class="kd">public</code> <code class="kd">class</code> <code class="nc">DateDiff</code> <code class="o">{</code>&#13;
&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">args</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="cm">/** The date at the end of the last century */</code>&#13;
        <code class="n">LocalDate</code> <code class="n">endof20thCentury</code> <code class="o">=</code> <code class="n">LocalDate</code><code class="o">.</code><code class="na">of</code><code class="o">(</code><code class="mi">2000</code><code class="o">,</code> <code class="mi">12</code><code class="o">,</code> <code class="mi">31</code><code class="o">);</code>&#13;
        <code class="n">LocalDate</code> <code class="n">now</code> <code class="o">=</code> <code class="n">LocalDate</code><code class="o">.</code><code class="na">now</code><code class="o">();</code>&#13;
        <code class="k">if</code> <code class="o">(</code><code class="n">now</code><code class="o">.</code><code class="na">getYear</code><code class="o">()</code> <code class="o">&gt;</code> <code class="mi">2100</code><code class="o">)</code> <code class="o">{</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"The 21st century is over!"</code><code class="o">);</code>&#13;
            <code class="k">return</code><code class="o">;</code>&#13;
        <code class="o">}</code>&#13;
&#13;
        <code class="n">Period</code> <code class="n">diff</code> <code class="o">=</code> <code class="n">Period</code><code class="o">.</code><code class="na">between</code><code class="o">(</code><code class="n">endof20thCentury</code><code class="o">,</code> <code class="n">now</code><code class="o">);</code>&#13;
&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">printf</code><code class="o">(</code><code class="s">"The 21st century (up to %s) is %s old%n"</code><code class="o">,</code> <code class="n">now</code><code class="o">,</code> <code class="n">diff</code><code class="o">);</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">printf</code><code class="o">(</code>&#13;
                <code class="s">"The 21st century is %d years, %d months and %d days old"</code><code class="o">,</code>&#13;
                <code class="n">diff</code><code class="o">.</code><code class="na">getYears</code><code class="o">(),</code> <code class="n">diff</code><code class="o">.</code><code class="na">getMonths</code><code class="o">(),</code> <code class="n">diff</code><code class="o">.</code><code class="na">getDays</code><code class="o">());</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p>I wrote this recipe at the end of October 2013;&#13;
the 20th century AD ended at the end of 2000,&#13;
so the value should be about 12 <sup>10</sup>/<sub>12</sub> years, and it is:</p>&#13;
&#13;
<pre data-type="programlisting">$ java datetime.DateDiff&#13;
The 21st century (up to 2013-10-28) is P12Y9M28D old&#13;
The 21st century is 12 years, 9 months and 28 days old</pre>&#13;
&#13;
<p>Because of the APIs regularity, you can use the same technique with <code>LocalTime</code> or <code>LocalDateTime</code>.</p>&#13;
&#13;
<p>There is also <code>ChronoUnit</code>, which has numerous range values such as <code>DAYS</code>, <code>HOURS</code>, <code>MINUTES</code>, etc.&#13;
(actually ranging from <code>NANOS</code> for nanoseconds up to <code>MILLENIA</code>, <code>ERAS</code>, and even <code>FOREVER</code>).&#13;
If you want difference information in a certain unit:</p>&#13;
&#13;
<pre data-type="programlisting">jshell&gt; import java.time.temporal.*;&#13;
&#13;
jshell&gt; ChronoUnit.DAYS.between(LocalDate.now(), LocalDate.parse("2022-02-22"))&#13;
$6 ==&gt; 786&#13;
&#13;
jshell&gt; ChronoUnit.DECADES.between(LocalDate.of(1970,01,01),&#13;
  LocalDate.of(2020,01,01));&#13;
$7 ==&gt; 5</pre>&#13;
&#13;
<p>Unix is on its fifth decade!</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="See Also" data-type="sect2"><div class="sect2" id="idm45290674978424">&#13;
<h2>See Also</h2>&#13;
&#13;
<p>A higher-level way of formatting date/time values is discussed in <a data-type="xref" href="#javacook-dates-format">Recipe 6.2</a>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="6.6 Adding to or Subtracting from a Date" data-type="sect1"><div class="sect1" id="javacook-dates-SECT-7">&#13;
<h1>6.6 Adding to or Subtracting from a Date</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-dates-SECT-7.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="calendars, adding to/subtracting from" data-type="indexterm" id="idm45290674738536"/><a data-primary="Date/Time API" data-secondary="adding to" data-type="indexterm" id="idm45290674737864"/><a data-primary="Date/Time API" data-secondary="periods, adding or subtracting" data-type="indexterm" id="idm45290674736920"/>You need to add or subtract a fixed period to or from a date.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-dates-SECT-7.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Create a past or future date by using a locution such as <code>Local⁠Date.plus​(Period.ofDays(N));</code>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-dates-SECT-7.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p><code>java.time</code> offers a <code>Period</code> class to represent a length of time, such as a number&#13;
of days or hours and minutes.&#13;
<code>LocalDate</code> and friends offer <a data-primary="plus() method" data-type="indexterm" id="idm45290674730088"/><a data-primary="minus() method" data-type="indexterm" id="idm45290674729352"/><code>plus()</code> and <code>minus()</code> <span class="keep-together">methods</span> to add or subtract&#13;
a <code>Period</code> or other time-related object.&#13;
<code>Period</code> offers factory methods such as <a data-primary="ofDays() method" data-type="indexterm" id="idm45290674726264"/><code>ofDays()</code>. The following code computes what the date will be 700 days from now:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kn">import</code> <code class="nn">java.time.LocalDate</code><code class="o">;</code>&#13;
<code class="kn">import</code> <code class="nn">java.time.Period</code><code class="o">;</code>&#13;
&#13;
<code class="cm">/** DateAdd -- compute the difference between two dates</code>&#13;
<code class="cm"> * (e.g., today and 700 days from now).</code>&#13;
<code class="cm"> */</code>&#13;
<code class="kd">public</code> <code class="kd">class</code> <code class="nc">DateAdd</code> <code class="o">{</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">av</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="cm">/** Today's date */</code>&#13;
        <code class="n">LocalDate</code> <code class="n">now</code> <code class="o">=</code>  <code class="n">LocalDate</code><code class="o">.</code><code class="na">now</code><code class="o">();</code>&#13;
&#13;
        <code class="n">Period</code> <code class="n">p</code> <code class="o">=</code> <code class="n">Period</code><code class="o">.</code><code class="na">ofDays</code><code class="o">(</code><code class="mi">700</code><code class="o">);</code>&#13;
        <code class="n">LocalDate</code> <code class="n">then</code> <code class="o">=</code> <code class="n">now</code><code class="o">.</code><code class="na">plus</code><code class="o">(</code><code class="n">p</code><code class="o">);</code>&#13;
&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">printf</code><code class="o">(</code><code class="s">"Seven hundred days from %s is %s%n"</code><code class="o">,</code> <code class="n">now</code><code class="o">,</code> <code class="n">then</code><code class="o">);</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p>Running this program reports the current date and time and what the date and time&#13;
will be 700 days from now:</p>&#13;
&#13;
<pre data-type="programlisting">Seven hundred days from 2013-11-09 is 2015-10-10</pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="6.7 Handling Recurring Events" data-type="sect1"><div class="sect1" id="javacook-dates-recurring">&#13;
<h1>6.7 Handling Recurring Events</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="idm45290674593160">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="Date/Time API" data-secondary="recurring events" data-type="indexterm" id="dta_re"/><a data-primary="events, recurring" data-type="indexterm" id="ev_re"/><a data-primary="recurring events" data-type="indexterm" id="re_ev"/>You need to deal with recurring dates, for example, the third Wednesday of every month.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="idm45290674588440">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use the <code>TemporalAdjusters</code> class.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="idm45290674586440">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>The <code>TemporalAdjuster</code> interface and the <code>TemporalAdjusters</code> factory class provide&#13;
most of what you need for recurring events. There are many interesting and&#13;
powerful adjusters available, shown in <a data-type="xref" href="#javacook-dates-recurring-temporalAdjusters">Table 6-7</a>, and you can, of course, develop your own.</p>&#13;
<table class="less_space pagebreak-before" id="javacook-dates-recurring-temporalAdjusters">&#13;
<caption><span class="label">Table 6-7. </span>New date/time API: TemporalAdjusters factory methods</caption>&#13;
<thead>&#13;
<tr>&#13;
<th>Method signature</th>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td><p>public static TemporalAdjuster firstDayOfMonth();</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>public static TemporalAdjuster lastDayOfMonth();</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>public static TemporalAdjuster firstDayOfNextMonth();</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>public static TemporalAdjuster firstDayOfYear();</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>public static TemporalAdjuster lastDayOfYear();</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>public static TemporalAdjuster firstDayOfNextYear();</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>public static TemporalAdjuster firstInMonth(java.time.DayOfWeek);</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>public static TemporalAdjuster lastInMonth(java.time.DayOfWeek);</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>public static TemporalAdjuster dayOfWeekInMonth(int, java.time.DayOfWeek);</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>public static TemporalAdjuster next(java.time.DayOfWeek);</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>public static TemporalAdjuster nextOrSame(java.time.DayOfWeek);</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>public static TemporalAdjuster previous(java.time.DayOfWeek);</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>public static TemporalAdjuster previousOrSame(java.time.DayOfWeek);</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>public static TemporalAdjuster ofDateAdjuster(&#13;
    java.util.function.UnaryOperator&lt;java.time.LocalDate&gt;);</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
&#13;
<p>The names of most of these tell you directly what they do.&#13;
The last one will make sense after reading about functional interfaces&#13;
such as <code>UnaryOperator</code> in <a data-type="xref" href="ch09.html#javacook-fp">Chapter 9</a>.</p>&#13;
&#13;
<p>These are used with the <a data-primary="with() method" data-type="indexterm" id="idm45290674562568"/><code>with()</code> method of a date/time object.&#13;
For example, the <span class="keep-together">GTABUG</span> group (<a href="http://gtabug.org"><em class="hyperlink">http://gtabug.org</em></a>) meets on the third Wednesday of every month.&#13;
<span class="keep-together">I have a</span> <code>RecurringEventDatePicker</code> class in the <code>darwinsys-api</code> library; the core <span class="keep-together">of it started</span>&#13;
as the method <code>getMeetingDateInMonth(LocalDate dateContainingMonth)</code>,&#13;
which in our case picks the third Wednesday of a given month (given that <em><code>dayOfWeek</code></em> and <em><code>weekOfMonth</code></em>&#13;
are both set in the constructor).&#13;
We take the month (<code>dateContainingMonth</code>), adjust it to the first Wednesday in the month&#13;
using the <a data-primary="firstInMonth() method" data-type="indexterm" id="idm45290674554808"/><code>firstInMonth()</code> factory method to get a temporal adjuster, then add the number of weeks&#13;
to get the Wednesday in the correct week:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="c1">// Variant versions from older version of RecurringDatePicker.java</code>&#13;
<code class="c1">// First version, not for production use!</code>&#13;
<code class="kd">private</code> <code class="n">LocalDate</code> <code class="nf">getMeetingForMonth</code><code class="o">(</code><code class="n">LocalDate</code> <code class="n">dateContainingMonth</code><code class="o">)</code> <code class="o">{</code>&#13;
    <code class="k">return</code>&#13;
        <code class="n">dateContainingMonth</code><code class="o">.</code><code class="na">with</code><code class="o">(</code><code class="n">TemporalAdjusters</code><code class="o">.</code><code class="na">firstInMonth</code><code class="o">(</code><code class="n">dayOfWeek</code><code class="o">))</code>&#13;
            <code class="o">.</code><code class="na">plusWeeks</code><code class="o">(</code><code class="n">Math</code><code class="o">.</code><code class="na">max</code><code class="o">(</code><code class="mi">0</code><code class="o">,</code> <code class="n">weekOfMonth</code> <code class="o">-</code> <code class="mi">1</code><code class="o">));</code>&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p>The second version simplified it to better use the existing API:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">private</code> <code class="n">LocalDate</code> <code class="nf">getMeetingForMonth</code><code class="o">(</code><code class="n">LocalDate</code> <code class="n">dateContainingMonth</code><code class="o">)</code> <code class="o">{</code>&#13;
    <code class="k">return</code> <code class="n">dateWithMonth</code><code class="o">.</code><code class="na">with</code><code class="o">(</code>&#13;
        <code class="n">TemporalAdjusters</code><code class="o">.</code><code class="na">dayOfWeekInMonth</code><code class="o">(</code><code class="n">weekOfMonth</code><code class="o">,</code><code class="n">dayOfWeek</code><code class="o">)</code>&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p>Since this version was only one statement and is only used twice, we inlined it&#13;
into the <a data-primary="getNextMeeting() method" data-type="indexterm" id="idm45290674483368"/><code>getNextMeeting(int howManyMonthsAway)</code> method,&#13;
which returns a <code>LocalDate</code> for the correct day of the given month.&#13;
Its only complexity is that, for the current month, the meeting might be before or after&#13;
today’s date, so we adjust accordingly:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="n">LocalDate</code> <code class="nf">getEventLocalDate</code><code class="o">(</code><code class="kt">int</code> <code class="n">meetingsAway</code><code class="o">)</code> <code class="o">{</code>&#13;
    <code class="n">LocalDate</code> <code class="n">thisMeeting</code> <code class="o">=</code> <code class="n">now</code><code class="o">.</code><code class="na">with</code><code class="o">(</code>&#13;
        <code class="n">TemporalAdjusters</code><code class="o">.</code><code class="na">dayOfWeekInMonth</code><code class="o">(</code><code class="n">weekOfMonth</code><code class="o">,</code><code class="n">dayOfWeek</code><code class="o">));</code>&#13;
    <code class="c1">// Has the meeting already happened this month?</code>&#13;
    <code class="k">if</code> <code class="o">(</code><code class="n">thisMeeting</code><code class="o">.</code><code class="na">isBefore</code><code class="o">(</code><code class="n">now</code><code class="o">))</code> <code class="o">{</code>&#13;
        <code class="c1">// start from next month</code>&#13;
        <code class="n">meetingsAway</code><code class="o">++;</code>&#13;
    <code class="o">}</code>&#13;
    <code class="k">if</code> <code class="o">(</code><code class="n">meetingsAway</code> <code class="o">&gt;</code> <code class="mi">0</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">thisMeeting</code> <code class="o">=</code> <code class="n">thisMeeting</code><code class="o">.</code><code class="na">plusMonths</code><code class="o">(</code><code class="n">meetingsAway</code><code class="o">).</code>&#13;
            <code class="n">with</code><code class="o">(</code><code class="n">TemporalAdjusters</code><code class="o">.</code><code class="na">dayOfWeekInMonth</code><code class="o">(</code><code class="n">weekOfMonth</code><code class="o">,</code><code class="n">dayOfWeek</code><code class="o">));</code>&#13;
    <code class="o">}</code>&#13;
    <code class="k">return</code> <code class="n">thisMeeting</code><code class="o">;</code>&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p>This in turn is called within a JavaServer Page (JSP) web view&#13;
(somewhat simplified; the real code has the complexities of an Add To Calendar&#13;
API done in JavaScript). If you’ve not used JSPs, plain HTML code is <em>outputted</em>&#13;
directly, the contents of <code>&lt;% %&gt;</code> tags are <em>executed</em>, and the contents&#13;
of <code>&lt;%= %&gt;</code> tags are <em>evaluated and printed</em> into the HTML page, like this:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">Upcoming</code> <code class="nl">Meetings:</code>&#13;
<code class="o">&lt;</code><code class="n">ul</code><code class="o">&gt;</code>&#13;
    <code class="o">&lt;%</code>&#13;
    <code class="n">RecurringEventDatePicker</code> <code class="n">mp</code> <code class="o">=</code>&#13;
      <code class="k">new</code> <code class="nf">RecurringEventDatePicker</code><code class="o">(</code><code class="mi">3</code><code class="o">,</code> <code class="n">DayOfWeek</code><code class="o">.</code><code class="na">WEDNESDAY</code><code class="o">);</code>&#13;
    <code class="n">DateTimeFormatter</code> <code class="n">dfm</code> <code class="o">=</code> <code class="n">DateTimeFormatter</code><code class="o">.</code><code class="na">ofPattern</code><code class="o">(</code><code class="s">"MMMM dd, yyyy"</code><code class="o">);</code>&#13;
    <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">i</code> <code class="o">=</code> <code class="mi">0</code><code class="o">;</code> <code class="n">i</code> <code class="o">&lt;=</code> <code class="mi">2</code><code class="o">;</code> <code class="n">i</code><code class="o">++)</code> <code class="o">{</code>&#13;
        <code class="n">LocalDateTime</code> <code class="n">dt</code> <code class="o">=</code> <code class="n">mp</code><code class="o">.</code><code class="na">getEventLocalDateTime</code><code class="o">(</code><code class="n">i</code><code class="o">);</code>&#13;
    <code class="o">%&gt;</code>&#13;
    <code class="o">&lt;</code><code class="n">li</code><code class="o">&gt;</code>&#13;
        <code class="o">&lt;%=</code> <code class="n">dt</code><code class="o">.</code><code class="na">format</code><code class="o">(</code><code class="n">dfm</code><code class="o">)</code> <code class="o">%&gt;</code>&#13;
    <code class="o">&lt;/</code><code class="n">li</code><code class="o">&gt;</code>&#13;
    <code class="o">&lt;%</code>&#13;
    <code class="o">}</code>&#13;
    <code class="o">%&gt;</code>&#13;
<code class="o">&lt;/</code><code class="n">ul</code><code class="o">&gt;</code></pre>&#13;
&#13;
<p>When visiting this site in June or July of 2015, you would have seen something like this:<a data-primary="" data-startref="ev_re" data-type="indexterm" id="idm45290674326344"/><a data-primary="" data-startref="re_ev" data-type="indexterm" id="idm45290674325496"/><a data-primary="" data-startref="dta_re" data-type="indexterm" id="idm45290674219912"/></p>&#13;
&#13;
<pre data-type="programlisting">Upcoming Meetings:&#13;
&#13;
* July 15, 2015&#13;
* August 19, 2015&#13;
* September 16, 2015</pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="6.8 Computing Dates Involving Time Zones" data-type="sect1"><div class="sect1" id="javacook-datetime-flight">&#13;
<h1>6.8 Computing Dates Involving Time Zones</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="idm45290674216920">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="Date/Time API" data-secondary="time zones and" data-type="indexterm" id="idm45290674215720"/><a data-primary="time zones" data-type="indexterm" id="idm45290674214744"/>Imagine a problem like “Your kids are traveling on a trans-Atlantic flight&#13;
from Toronto to London that takes 5 hours 10 minutes from the actual time of departure from YYZ.&#13;
Your in-laws need one hour to get to LHR and find parking. What time should&#13;
you phone them to leave for the airport?”</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="idm45290674213384">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>The solution needs to take account of time zone differences.&#13;
It can be solved using the <code>ZonedDateTime</code> class and methods such as&#13;
<a data-primary="plus() method" data-type="indexterm" id="idm45290674211560"/><code>plus()</code> and <a data-primary="minus() method" data-type="indexterm" id="idm45290674210472"/><code>minus()</code> from that class.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="idm45290674209096">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>The basic steps are shown in <a data-type="xref" href="#javacook-datetime-flight-1">Example 6-3</a>.</p>&#13;
<div data-type="example" id="javacook-datetime-flight-1">&#13;
<h5><span class="label">Example 6-3. </span>main/src/main/java/datetime/FlightArrivalTimeCalc.java</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code><code> </code><code class="kd">class</code><code> </code><code class="nc">FlightArrivalTimeCalc</code><code> </code><code class="o">{</code><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="kd">static</code><code> </code><code class="n">Duration</code><code> </code><code class="n">driveTime</code><code> </code><code class="o">=</code><code> </code><code class="n">Duration</code><code class="o">.</code><code class="na">ofHours</code><code class="o">(</code><code class="mi">1</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="kd">public</code><code> </code><code class="kd">static</code><code> </code><code class="kt">void</code><code> </code><code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[</code><code class="o">]</code><code> </code><code class="n">args</code><code class="o">)</code><code> </code><code class="o">{</code><code>&#13;
</code><code>        </code><code class="n">LocalDateTime</code><code> </code><code class="n">when</code><code> </code><code class="o">=</code><code> </code><code class="kc">null</code><code class="o">;</code><code>&#13;
</code><code>        </code><code class="k">if</code><code> </code><code class="o">(</code><code class="n">args</code><code class="o">.</code><code class="na">length</code><code> </code><code class="o">=</code><code class="o">=</code><code> </code><code class="mi">0</code><code class="o">)</code><code> </code><code class="o">{</code><code>&#13;
</code><code>            </code><code class="n">when</code><code> </code><code class="o">=</code><code> </code><code class="n">LocalDateTime</code><code class="o">.</code><code class="na">now</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code>                                        </code><a class="co" href="#callout_dates_and_times_CO1-1" id="co_dates_and_times_CO1-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>        </code><code class="o">}</code><code> </code><code class="k">else</code><code> </code><code class="o">{</code><code>&#13;
</code><code>            </code><code class="n">String</code><code> </code><code class="n">time</code><code> </code><code class="o">=</code><code> </code><code class="n">args</code><code class="o">[</code><code class="mi">0</code><code class="o">]</code><code class="o">;</code><code>&#13;
</code><code>            </code><code class="n">LocalTime</code><code> </code><code class="n">localTime</code><code> </code><code class="o">=</code><code> </code><code class="n">LocalTime</code><code class="o">.</code><code class="na">parse</code><code class="o">(</code><code class="n">time</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>            </code><code class="n">when</code><code> </code><code class="o">=</code><code> </code><code class="n">LocalDateTime</code><code class="o">.</code><code class="na">of</code><code class="o">(</code><code class="n">LocalDate</code><code class="o">.</code><code class="na">now</code><code class="o">(</code><code class="o">)</code><code class="o">,</code><code> </code><code class="n">localTime</code><code class="o">)</code><code class="o">;</code><code>               </code><a class="co" href="#callout_dates_and_times_CO1-1" id="co_dates_and_times_CO1-2"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>        </code><code class="o">}</code><code>&#13;
</code><code>        </code><code class="n">calulateArrivalTime</code><code class="o">(</code><code class="n">when</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="o">}</code><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="kd">public</code><code> </code><code class="kd">static</code><code> </code><code class="n">ZonedDateTime</code><code> </code><code class="nf">calulateArrivalTime</code><code class="o">(</code><code class="n">LocalDateTime</code><code> </code><code class="n">takeOffTime</code><code class="o">)</code><code> </code><code class="o">{</code><code>&#13;
</code><code>        </code><code class="n">ZoneId</code><code> </code><code class="n">torontoZone</code><code> </code><code class="o">=</code><code> </code><code class="n">ZoneId</code><code class="o">.</code><code class="na">of</code><code class="o">(</code><code class="s">"America/Toronto"</code><code class="o">)</code><code class="o">,</code><code>&#13;
</code><code>                </code><code class="n">londonZone</code><code> </code><code class="o">=</code><code> </code><code class="n">ZoneId</code><code class="o">.</code><code class="na">of</code><code class="o">(</code><code class="s">"Europe/London"</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>        </code><code class="n">ZonedDateTime</code><code> </code><code class="n">takeOffTimeZoned</code><code> </code><code class="o">=</code><code>&#13;
</code><code>            </code><code class="n">ZonedDateTime</code><code class="o">.</code><code class="na">of</code><code class="o">(</code><code class="n">takeOffTime</code><code class="o">,</code><code> </code><code class="n">torontoZone</code><code class="o">)</code><code class="o">;</code><code>                        </code><a class="co" href="#callout_dates_and_times_CO1-2" id="co_dates_and_times_CO1-3"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>        </code><code class="n">Duration</code><code> </code><code class="n">flightTime</code><code> </code><code class="o">=</code><code>&#13;
</code><code>            </code><code class="n">Duration</code><code class="o">.</code><code class="na">ofHours</code><code class="o">(</code><code class="mi">5</code><code class="o">)</code><code class="o">.</code><code class="na">plus</code><code class="o">(</code><code class="mi">10</code><code class="o">,</code><code> </code><code class="n">ChronoUnit</code><code class="o">.</code><code class="na">MINUTES</code><code class="o">)</code><code class="o">;</code><code>                  </code><a class="co" href="#callout_dates_and_times_CO1-3" id="co_dates_and_times_CO1-4"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>        </code><code class="n">ZonedDateTime</code><code> </code><code class="n">arrivalTimeUnZoned</code><code> </code><code class="o">=</code><code> </code><code class="n">takeOffTimeZoned</code><code class="o">.</code><code class="na">plus</code><code class="o">(</code><code class="n">flightTime</code><code class="o">)</code><code class="o">;</code><code>  </code><a class="co" href="#callout_dates_and_times_CO1-4" id="co_dates_and_times_CO1-5"><img alt="4" src="assets/4.png"/></a><code>&#13;
</code><code>        </code><code class="n">ZonedDateTime</code><code> </code><code class="n">arrivalTimeZoned</code><code> </code><code class="o">=</code><code>&#13;
</code><code>            </code><code class="n">arrivalTimeUnZoned</code><code class="o">.</code><code class="na">toInstant</code><code class="o">(</code><code class="o">)</code><code class="o">.</code><code class="na">atZone</code><code class="o">(</code><code class="n">londonZone</code><code class="o">)</code><code class="o">;</code><code>                 </code><a class="co" href="#callout_dates_and_times_CO1-5" id="co_dates_and_times_CO1-6"><img alt="5" src="assets/5.png"/></a><code>&#13;
</code><code>        </code><code class="n">ZonedDateTime</code><code> </code><code class="n">phoneTimeHere</code><code> </code><code class="o">=</code><code> </code><code class="n">arrivalTimeUnZoned</code><code class="o">.</code><code class="na">minus</code><code class="o">(</code><code class="n">driveTime</code><code class="o">)</code><code class="o">;</code><code>     </code><a class="co" href="#callout_dates_and_times_CO1-6" id="co_dates_and_times_CO1-7"><img alt="6" src="assets/6.png"/></a><code>&#13;
</code><code>&#13;
</code><code>        </code><code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Flight departure time "</code><code> </code><code class="o">+</code><code> </code><code class="n">takeOffTimeZoned</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>        </code><code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Flight expected length: "</code><code> </code><code class="o">+</code><code> </code><code class="n">flightTime</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>        </code><code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code>&#13;
</code><code>            </code><code class="s">"Flight arrives there at "</code><code> </code><code class="o">+</code><code> </code><code class="n">arrivalTimeZoned</code><code> </code><code class="o">+</code><code> </code><code class="s">" London time."</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>        </code><code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"You should phone at "</code><code> </code><code class="o">+</code><code> </code><code class="n">phoneTimeHere</code><code> </code><code class="o">+</code><code> </code><code class="s">" Toronto time"</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>        </code><code class="k">return</code><code> </code><code class="n">arrivalTimeZoned</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="o">}</code><code>&#13;
</code><code class="o">}</code></pre></div>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_dates_and_times_CO1-1" id="callout_dates_and_times_CO1-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Get the departure time as a <code>LocalDateTime</code> (defaulting to <code>now()</code> if no arguments&#13;
passed into <a data-primary="main() method" data-type="indexterm" id="idm45290674185000"/><code>main()</code>, on the assumption that we run the app when the flight takes off).</p></dd>&#13;
<dt><a class="co" href="#co_dates_and_times_CO1-3" id="callout_dates_and_times_CO1-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Convert departure time to <code>ZonedDateTime</code>.</p></dd>&#13;
<dt><a class="co" href="#co_dates_and_times_CO1-4" id="callout_dates_and_times_CO1-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>Convert flight time to a <code>Duration</code>.</p></dd>&#13;
<dt><a class="co" href="#co_dates_and_times_CO1-5" id="callout_dates_and_times_CO1-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>Get the arrival time by adding the departure time to the flight duration.</p></dd>&#13;
<dt><a class="co" href="#co_dates_and_times_CO1-6" id="callout_dates_and_times_CO1-5"><img alt="5" src="assets/5.png"/></a></dt>&#13;
<dd><p>Convert the arrival time to London time with <a data-primary="atZone() method" data-type="indexterm" id="idm45290673796216"/><code>atZone()</code>.</p></dd>&#13;
<dt><a class="co" href="#co_dates_and_times_CO1-7" id="callout_dates_and_times_CO1-6"><img alt="6" src="assets/6.png"/></a></dt>&#13;
<dd><p>Since the family takes an hour to get to the airport, subtract that from the arrival time. This yields the time when you should phone them.</p></dd>&#13;
</dl>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="6.9 Interfacing with Legacy Date and Calendar Classes" data-type="sect1"><div class="sect1" id="javacook-dates-legacy">&#13;
<h1>6.9 Interfacing with Legacy Date and Calendar Classes</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-dates-legacy.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="Calendar classes" data-type="indexterm" id="ca_cl"/><a data-primary="Date/Time API" data-secondary="Calendar classes" data-type="indexterm" id="dta_cc"/><a data-primary="Date/Time API" data-secondary="legacy code and" data-type="indexterm" id="dta_lc"/><a data-primary="legacy dates" data-type="indexterm" id="ld_a"/>You need to deal with the old <code>Date</code> and <code>Calendar</code> classes.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-dates-legacy.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Assuming you have code using the original <code>java.util.Date</code> and <code>java.util.Calendar</code>, you can&#13;
convert values as needed using conversion methods.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-dates-legacy.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>All the classes and interfaces in the new API were chosen to avoid conflicting with the&#13;
traditional API. It is thus possible, and will be common for a while, to have imports from&#13;
both packages into the same code.</p>&#13;
&#13;
<p>To keep the new API clean, most of the necessary conversion routines were added <em>to the old API</em>.&#13;
<a data-type="xref" href="#javacook-dates-legacytable">Table 6-8</a> summarizes these conversion routines; note that the&#13;
methods are static if they are shown being invoked with a capitalized class name, otherwise they are instance methods.</p>&#13;
<table id="javacook-dates-legacytable">&#13;
<caption><span class="label">Table 6-8. </span>Legacy date/time interchange</caption>&#13;
<thead>&#13;
<tr>&#13;
<th>Legacy class</th>&#13;
<th>Convert to legacy</th>&#13;
<th>Convert to modern</th>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td><p><code>java.util.Date</code></p></td>&#13;
<td><p><code>date.from(Instant)</code></p></td>&#13;
<td><p><code>Date.toInstant()</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>java.util.Calendar</code></p></td>&#13;
<td><p><code>calendar.toInstant()</code></p></td>&#13;
<td><p>-</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>java.util.GregorianCalendar</code></p></td>&#13;
<td><p><code>GregorianCalendar.from(ZonedDateTime)</code></p></td>&#13;
<td><p><code>calendar.toZonedDateTime()</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>java.util.TimeZone</code></p></td>&#13;
<td><p>-</p></td>&#13;
<td><p><code>timeZone.toZoneId()</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>java.time.DateTimeFormatter</code></p></td>&#13;
<td><p>-</p></td>&#13;
<td><p><code>dateTimeFormatter.toFormat()</code></p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
&#13;
<p><a data-type="xref" href="#example_6_4">Example 6-4</a> shows some of these APIs in action.</p>&#13;
<div data-type="example" id="example_6_4">&#13;
<h5><span class="label">Example 6-4. </span>main/src/main/java/datetime/LegacyDates.java</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">LegacyDates</code> <code class="o">{</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">args</code><code class="o">)</code> <code class="o">{</code>&#13;
&#13;
        <code class="c1">// There and back again, via Date</code>&#13;
        <code class="n">Date</code> <code class="n">legacyDate</code> <code class="o">=</code> <code class="k">new</code> <code class="n">Date</code><code class="o">();</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">legacyDate</code><code class="o">);</code>&#13;
&#13;
        <code class="n">LocalDateTime</code> <code class="n">newDate</code> <code class="o">=</code>&#13;
            <code class="n">LocalDateTime</code><code class="o">.</code><code class="na">ofInstant</code><code class="o">(</code><code class="n">legacyDate</code><code class="o">.</code><code class="na">toInstant</code><code class="o">(),</code>&#13;
            <code class="n">ZoneId</code><code class="o">.</code><code class="na">systemDefault</code><code class="o">());</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">newDate</code><code class="o">);</code>&#13;
&#13;
        <code class="n">Date</code> <code class="n">backAgain</code> <code class="o">=</code>&#13;
            <code class="n">Date</code><code class="o">.</code><code class="na">from</code><code class="o">(</code><code class="n">newDate</code><code class="o">.</code><code class="na">atZone</code><code class="o">(</code><code class="n">ZoneId</code><code class="o">.</code><code class="na">systemDefault</code><code class="o">()).</code><code class="na">toInstant</code><code class="o">());</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Converted back as "</code> <code class="o">+</code> <code class="n">backAgain</code><code class="o">);</code>&#13;
&#13;
        <code class="c1">// And via Calendar</code>&#13;
        <code class="n">Calendar</code> <code class="n">c</code> <code class="o">=</code> <code class="n">Calendar</code><code class="o">.</code><code class="na">getInstance</code><code class="o">();</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">c</code><code class="o">);</code>&#13;
        <code class="n">LocalDateTime</code> <code class="n">newCal</code> <code class="o">=</code>&#13;
            <code class="n">LocalDateTime</code><code class="o">.</code><code class="na">ofInstant</code><code class="o">(</code><code class="n">c</code><code class="o">.</code><code class="na">toInstant</code><code class="o">(),</code>&#13;
            <code class="n">ZoneId</code><code class="o">.</code><code class="na">systemDefault</code><code class="o">());</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">newCal</code><code class="o">);</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre></div>&#13;
&#13;
<p>Of course you do not have to use these legacy converters; you are free to write your own.&#13;
The file <em>LegacyDatesDIY.java</em> in the <a data-primary="javasrc repository" data-type="indexterm" id="idm45290673741832"/><em>javasrc</em> repository explores this option in the unlikely&#13;
event you wish to pursue it.</p>&#13;
&#13;
<p>Given the amount of code written before Java 8, it is likely that the legacy <code>Date</code> and <code>Calendar</code>&#13;
will be around until the end of Java time.</p>&#13;
&#13;
<p>The new date/time API has many capabilities that we have not explored.&#13;
Almost enough for a small book on the subject, in fact.&#13;
Meanwhile, you can study the API details at&#13;
<a href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/time/package-summary.html">Oracle</a>.<a data-primary="" data-startref="ca_cl" data-type="indexterm" id="idm45290673628104"/><a data-primary="" data-startref="dta_cc" data-type="indexterm" id="idm45290673627208"/><a data-primary="" data-startref="dta_lc" data-type="indexterm" id="idm45290673626264"/><a data-primary="" data-startref="ld_a" data-type="indexterm" id="idm45290673625320"/><a data-primary="" data-startref="dta_ch" data-type="indexterm" id="idm45290673624376"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<div data-type="footnotes"><p data-type="footnote" id="idm45290675934040"><sup><a href="ch06.html#idm45290675934040-marker">1</a></sup> For those with an interest in historical arcana, the differences are documented on his <a href="http://blog.joda.org/2009/11/why-jsr-310-isn-joda-time_4941.html">blog</a>.</p></div></div></section></body></html>