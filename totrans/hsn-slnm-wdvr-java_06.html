<html><head></head><body><section data-pdf-bookmark="Chapter 4. Browser-Agnostic Features" data-type="chapter" epub:type="chapter"><div class="chapter" id="ch04">&#13;
<h1><span class="label">Chapter 4. </span>Browser-Agnostic Features</h1>&#13;
&#13;
&#13;
<p>This chapter reviews those <a data-primary="browsers, interoperable features of" data-secondary="summary of" data-type="indexterm" id="idm45849731774128"/>features of Selenium WebDriver that are interoperable in different web browsers. In this group, a relevant multipurpose characteristic is executing JavaScript. Also, the Selenium WebDriver API allows configuring timeouts for page and script loading. Another convenient feature is making screenshots of the browser screen, or only the portion corresponding to a given element. Then, we can manage different aspects of the controlled browser using WebDriver, such as browser size and position, history, or cookies. Then, WebDriver provides various assets for controlling specific web elements, such as dropdown lists (i.e., HTML select fields and data lists), navigation targets (i.e., windows, tabs, frames, and iframes), or dialog boxes (i.e., alerts, prompts, confirmations, and modal dialogs). Finally, we discover how to handle local and session data using web storage, implement event listeners, and use the exceptions provided by the Selenium WebDriver API.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Executing JavaScript" data-type="sect1"><div class="sect1" id="js">&#13;
<h1>Executing JavaScript</h1>&#13;
&#13;
<p>JavaScript is a <a data-primary="browsers, interoperable features of" data-secondary="JavaScript execution" data-type="indexterm" id="ch4_term1"/><a data-primary="JavaScript" data-secondary="interoperability of" data-type="indexterm" id="idm45849731769808"/>high-level programming language supported by all major browsers. We can use JavaScript in the client side of web applications for a wide variety of operations, such as DOM manipulation, user interaction, handling requests-responses from remote servers, or working with regular expressions, among many other functions. <a data-primary="JavascriptExecutor methods" data-secondary="about" data-type="indexterm" id="ch4_term2"/>Luckily for test automation, Selenium WebDriver allows injecting and executing arbitrary pieces of JavaScript. To that aim, Selenium WebDriver API provides the interface <code>JavascriptExecutor</code>. <a data-type="xref" href="#js-methods">Table 4-1</a> introduces the available public methods in this interface grouped into three categories: synchronous, pinned, and asynchronous scripts. The subsections following provide more details and illustrate their use through different examples.</p>&#13;
<table id="js-methods">&#13;
<caption><span class="label">Table 4-1. </span>JavascriptExecutor methods</caption>&#13;
<thead>&#13;
<tr>&#13;
<th>Category</th>&#13;
<th>Method</th>&#13;
<th>Return</th>&#13;
<th>Description</th>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td><p>Synchronous scripts</p></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">executeScript</code><code class="o">(</code>&#13;
    <code class="n">String</code> <code class="n">script</code><code class="o">,</code>&#13;
    <code class="n">Object</code><code class="o">...</code> <code class="n">args</code><code class="o">)</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">Object</code></pre></div></td>&#13;
<td><p>Execute JavaScript <a data-primary="synchronous JavascriptExecutor scripts" data-type="indexterm" id="ch4_term4"/><a data-primary="JavascriptExecutor methods" data-secondary="synchronous scripts" data-type="indexterm" id="ch4_term5"/>code on the current page.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td rowspan="4"><p>Pinned scripts</p></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">pin</code><code class="o">(</code><code class="n">String</code>&#13;
    <code class="n">script</code><code class="o">)</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">ScriptKey</code></pre></div></td>&#13;
<td><p>Attach a piece of <a data-primary="pin() method" data-type="indexterm" id="idm45849731730576"/><a data-primary="JavascriptExecutor methods" data-secondary="pinned scripts" data-type="indexterm" id="idm45849731691392"/><a data-primary="pinned JavascriptExecutor scripts" data-type="indexterm" id="idm45849731690544"/>JavaScript to a WebDriver session. The <em>pinned</em> scripts can be used multiple times while the WebDriver session is alive.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">unpin</code><code class="o">(</code><code class="n">ScriptKey</code>&#13;
    <code class="n">key</code><code class="o">)</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kt">void</code></pre></div></td>&#13;
<td><p>Detach a previously <a data-primary="unpin() method" data-type="indexterm" id="idm45849731665408"/>pinned script to the WebDriver session.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">getPinnedScripts</code><code class="o">()</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">Set</code><code class="o">&lt;</code><code class="n">ScriptKey</code><code class="o">&gt;</code></pre></div></td>&#13;
<td><p>Collect all pinned <a data-primary="getpinnedScripts() method" data-type="indexterm" id="idm45849731574752"/>scripts (each one identified by a unique <code>ScriptKey</code>).</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">executeScript</code><code class="o">(</code>&#13;
    <code class="n">ScriptKey</code> <code class="n">key</code><code class="o">,</code>&#13;
    <code class="n">Object</code><code class="o">...</code> <code class="n">args</code><code class="o">)</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">Object</code></pre></div></td>&#13;
<td><p>Call previously pinned script (identified with its <code>ScriptKey</code>).</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>Asynchronous scripts</p></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">executeAsyncScript</code><code class="o">(</code>&#13;
    <code class="n">String</code> <code class="n">script</code><code class="o">,</code>&#13;
    <code class="n">Object</code><code class="o">...</code> <code class="n">args</code><code class="o">)</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">Object</code></pre></div></td>&#13;
<td><p>Execute JavaScript code (typically an asynchronous operation) on <a data-primary="asynchronous JavascriptExecutor scripts" data-type="indexterm" id="idm45849731491536"/><a data-primary="JavascriptExecutor methods" data-secondary="asynchronous scripts" data-type="indexterm" id="idm45849731490928"/><a data-primary="executeAsyncScript() method" data-type="indexterm" id="idm45849731490032"/><a data-primary="executeScript() method" data-type="indexterm" id="ch4_term3"/>the current page. The difference with <code>executeScript()</code> is that scripts executed with <code>executeAsyncScript()</code> must explicitly signal their termination by invoking a callback function. By convention, this callback is injected into the script as its last argument.</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
&#13;
<p>Any driver object <a data-primary="RemoteWebDriver class" data-secondary="JavascriptExecutor interface and" data-type="indexterm" id="idm45849731494368"/>that inherits from the class <code>RemoteWebDriver</code> also implements the <code>JavascriptExecutor</code> interface. Therefore, <a data-primary="FirefoxDriver" data-type="indexterm" id="idm45849731492528"/><a data-primary="ChromeDriver" data-type="indexterm" id="idm45849731468560"/>when using a major browser (e.g., <code>ChromeDriver</code>, <code>FirefoxDriver</code>, etc.) declared using the generic <code>WebDriver</code> interface, we can cast it to <code>JavascriptExecutor</code> as shown in the following snippet. Then, we can use the executor (using variable <code>js</code> in the example) to invoke the methods presented in <a data-type="xref" href="#js-methods">Table 4-1</a>.</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">WebDriver</code> <code class="n">driver</code> <code class="o">=</code> <code class="k">new</code> <code class="n">ChromeDriver</code><code class="o">();</code>&#13;
<code class="n">JavascriptExecutor</code> <code class="n">js</code> <code class="o">=</code> <code class="o">(</code><code class="n">JavascriptExecutor</code><code class="o">)</code> <code class="n">driver</code><code class="o">;</code></pre>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Synchronous Scripts" data-type="sect2"><div class="sect2" id="idm45849731463984">&#13;
<h2>Synchronous Scripts</h2>&#13;
&#13;
<p>The method <code>executeScript()</code> of a <code>JavascriptExecutor</code> object allows executing a piece of JavaScript in the context of the current web page in a WebDriver session. The invocation of this method (in Java) blocks the control flow until the script terminates. Therefore, we typically use this method for executing synchronous scripts in a web page under test. The method <code>executeScript()</code> allows two arguments:</p>&#13;
<dl>&#13;
<dt><code>String script</code></dt>&#13;
<dd>&#13;
<p>Mandatory <a data-primary="string script argument" data-type="indexterm" id="idm45849731437184"/>JavaScript fragment to be executed. This code is executed in the body of the current page as an anonymous function (i.e., a JavaScript function without a name).</p>&#13;
</dd>&#13;
<dt><code>Object... args</code></dt>&#13;
<dd>&#13;
<p>Optional <a data-primary="object script argument" data-type="indexterm" id="idm45849731434912"/>arguments script. These arguments must be one of the following types: number, boolean, string, <code>WebElement</code>, or a <code>List</code> of these types (otherwise, WebDriver throws an exception). These arguments are available in the injected script using the <code>arguments</code> built-in JavaScript variable.</p>&#13;
</dd>&#13;
</dl>&#13;
&#13;
<p>When the script returns some value (i.e., the code contains a <code>return</code> statement), the Selenium WebDriver <code>executeScript()</code> method also returns a value in Java (otherwise, <code>executeScript()</code> returns <code>null</code>). The possible returned types are:</p>&#13;
<dl>&#13;
<dt><code>WebElement</code></dt>&#13;
<dd>&#13;
<p>When returning an HTML element</p>&#13;
</dd>&#13;
<dt><code>Double</code></dt>&#13;
<dd>&#13;
<p>For decimals</p>&#13;
</dd>&#13;
<dt><code>Long</code></dt>&#13;
<dd>&#13;
<p>For nondecimal numbers</p>&#13;
</dd>&#13;
<dt><code>Boolean</code></dt>&#13;
<dd>&#13;
<p>For boolean values</p>&#13;
</dd>&#13;
<dt><code>List&lt;Object&gt;</code></dt>&#13;
<dd>&#13;
<p>For arrays</p>&#13;
</dd>&#13;
<dt><code>Map&lt;String, Object&gt;</code></dt>&#13;
<dd>&#13;
<p>For key-value collections</p>&#13;
</dd>&#13;
<dt><code>String</code></dt>&#13;
<dd>&#13;
<p>For all other cases</p>&#13;
</dd>&#13;
</dl>&#13;
&#13;
<p>The situations that require executing JavaScript with Selenium WebDriver are very <a data-startref="ch4_term2" data-type="indexterm" id="idm45849731388480"/><a data-startref="ch4_term3" data-type="indexterm" id="idm45849731387744"/>heterogeneous. The following subsections review two cases where the Selenium WebDriver does not provide built-in features, and instead, we need to use JavaScript to automate them: scrolling a web page and handling a color picker in a web form.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Scrolling" data-type="sect3"><div class="sect3" id="idm45849731386816">&#13;
<h3>Scrolling</h3>&#13;
&#13;
<p>As explained in <a data-type="xref" href="ch03.html#ch03">Chapter 3</a>, Selenium WebDriver <a data-primary="scrolling, mouse" data-type="indexterm" id="ch4_term6"/><a data-primary="mouse actions" data-type="indexterm" id="ch4_term7"/>allows impersonating different mouse actions, including click, right-click, or double-click, among others. Nevertheless, scrolling down or up a web page is not possible using the Selenium WebDriver API. Instead, we can achieve this automation easily by executing a simple JavaScript line. <a data-type="xref" href="#scrolling-example-1">Example 4-1</a> shows a basic example using a practice web page (see the URL of this page in the first line of the test method).</p>&#13;
<div data-type="example" id="scrolling-example-1">&#13;
<h5><span class="label">Example 4-1. </span>Test executing JavaScript to scroll down a pixels amount</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="nd">@Test</code><code>&#13;
</code><code class="kt">void</code><code> </code><code class="nf">testScrollBy</code><code class="o">(</code><code class="o">)</code><code> </code><code class="o">{</code><code>&#13;
</code><code>    </code><code class="n">driver</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code>&#13;
</code><code>            </code><code class="s">"https://bonigarcia.dev/selenium-webdriver-java/long-page.html"</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO1-1" id="co_browser_agnostic_features_CO1-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>    </code><code class="n">JavascriptExecutor</code><code> </code><code class="n">js</code><code> </code><code class="o">=</code><code> </code><code class="o">(</code><code class="n">JavascriptExecutor</code><code class="o">)</code><code> </code><code class="n">driver</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO1-2" id="co_browser_agnostic_features_CO1-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">String</code><code> </code><code class="n">script</code><code> </code><code class="o">=</code><code> </code><code class="s">"window.scrollBy(0, 1000);"</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="n">js</code><code class="o">.</code><code class="na">executeScript</code><code class="o">(</code><code class="n">script</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO1-3" id="co_browser_agnostic_features_CO1-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code class="o">}</code></pre></div>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO1-1" id="callout_browser_agnostic_features_CO1-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Open a practice <a data-primary="pixels, scrolling by" data-type="indexterm" id="idm45849731331440"/>web page containing very long text (see <a data-type="xref" href="#long-page">Figure 4-1</a>).</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO1-2" id="callout_browser_agnostic_features_CO1-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Cast the <code>driver</code> object to <code>JavascriptExecutor</code>. We will use the variable <code>js</code> to execute JavaScript in the browser.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO1-3" id="callout_browser_agnostic_features_CO1-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>Execute a piece of JavaScript code. In this case, we <a data-primary="scrollBy() function" data-type="indexterm" id="idm45849731289600"/>call the JavaScript function <code>scrollBy()</code> to scroll the document by a given amount (in this case, 1,000 px down). Notice that this fragment does not use <code>return</code>, and therefore, we do not receive any returned object in the Java logic. In addition, we are not passing any argument to the script.</p></dd>&#13;
</dl>&#13;
&#13;
<figure><div class="figure" id="long-page">&#13;
<img alt="hosw 0401" src="assets/hosw_0401.png"/>&#13;
<h6><span class="label">Figure 4-1. </span>Practice web page with long content</h6>&#13;
</div></figure>&#13;
&#13;
<p><a data-type="xref" href="#scrolling-example-2">Example 4-2</a> shows another test using scrolling and the same example web page as before. This time, instead of moving a fixed number of pixels, we move the document scroll until the last paragraph in the web page.</p>&#13;
<div data-type="example" id="scrolling-example-2">&#13;
<h5><span class="label">Example 4-2. </span>Test executing JavaScript to scroll down to a given element</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="nd">@Test</code><code>&#13;
</code><code class="kt">void</code><code> </code><code class="nf">testScrollIntoView</code><code class="o">(</code><code class="o">)</code><code> </code><code class="o">{</code><code>&#13;
</code><code>    </code><code class="n">driver</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code>&#13;
</code><code>            </code><code class="s">"https://bonigarcia.dev/selenium-webdriver-java/long-page.html"</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="n">JavascriptExecutor</code><code> </code><code class="n">js</code><code> </code><code class="o">=</code><code> </code><code class="o">(</code><code class="n">JavascriptExecutor</code><code class="o">)</code><code> </code><code class="n">driver</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="n">driver</code><code class="o">.</code><code class="na">manage</code><code class="o">(</code><code class="o">)</code><code class="o">.</code><code class="na">timeouts</code><code class="o">(</code><code class="o">)</code><code class="o">.</code><code class="na">implicitlyWait</code><code class="o">(</code><code class="n">Duration</code><code class="o">.</code><code class="na">ofSeconds</code><code class="o">(</code><code class="mi">10</code><code class="o">)</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO2-1" id="co_browser_agnostic_features_CO2-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">WebElement</code><code> </code><code class="n">lastElememt</code><code> </code><code class="o">=</code><code> </code><code class="n">driver</code><code>&#13;
</code><code>            </code><code class="o">.</code><code class="na">findElement</code><code class="o">(</code><code class="n">By</code><code class="o">.</code><code class="na">cssSelector</code><code class="o">(</code><code class="s">"p:last-child"</code><code class="o">)</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO2-2" id="co_browser_agnostic_features_CO2-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>    </code><code class="n">String</code><code> </code><code class="n">script</code><code> </code><code class="o">=</code><code> </code><code class="s">"arguments[0].scrollIntoView();"</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO2-3" id="co_browser_agnostic_features_CO2-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>    </code><code class="n">js</code><code class="o">.</code><code class="na">executeScript</code><code class="o">(</code><code class="n">script</code><code class="o">,</code><code> </code><code class="n">lastElememt</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO2-4" id="co_browser_agnostic_features_CO2-4"><img alt="4" src="assets/4.png"/></a><code>&#13;
</code><code class="o">}</code></pre></div>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO2-1" id="callout_browser_agnostic_features_CO2-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>To make this test robust, we <a data-primary="implicit waits" data-type="indexterm" id="idm45849731196480"/>specify an implicit timeout. Otherwise, the test might fail if the page is not entirely loaded when executing the subsequent <span class="keep-together">commands</span>.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO2-2" id="callout_browser_agnostic_features_CO2-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>We locate the last paragraph in the web page <a data-primary="CSS" data-secondary="selectors" data-type="indexterm" id="idm45849731192464"/><a data-primary="WebElements, locating" data-secondary="CSS selectors for" data-type="indexterm" id="idm45849731191488"/>using a CSS selector.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO2-3" id="callout_browser_agnostic_features_CO2-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>We define the <a data-primary="scrollIntoView() function" data-type="indexterm" id="idm45849731143168"/>script to be injected into the page. Notice the script does not return any value, but as a novelty, it uses the first function argument to invoke the JavaScript function <code>scrollIntoView()</code>.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO2-4" id="callout_browser_agnostic_features_CO2-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>We execute the previous script, passing the located <code>WebElement</code> as an argument. This element will be the first argument for the script (i.e., <code>arguments[0]</code>).</p></dd>&#13;
</dl>&#13;
&#13;
<p>The last example of <a data-primary="infinite scroll page" data-type="indexterm" id="idm45849731138192"/>scrolling is <em>infinite scroll</em>. This technique enables the dynamic loading of more content when the user reaches the end of the web page. Automating this kind of web page is an instructive use case since it involves different aspects of the Selenium WebDriver API. For example, you can use a similar approach to crawl web pages using Selenium WebDriver. <a data-type="xref" href="#scrolling-example-3">Example 4-3</a> shows a test using an infinite scroll page.</p>&#13;
<div data-type="example" id="scrolling-example-3">&#13;
<h5><span class="label">Example 4-3. </span>Test executing JavaScript in an infinite scroll page</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="nd">@Test</code><code>&#13;
</code><code class="kt">void</code><code> </code><code class="nf">testInfiniteScroll</code><code class="o">(</code><code class="o">)</code><code> </code><code class="o">{</code><code>&#13;
</code><code>    </code><code class="n">driver</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code>&#13;
</code><code>            </code><code class="s">"https://bonigarcia.dev/selenium-webdriver-java/infinite-scroll.html"</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="n">JavascriptExecutor</code><code> </code><code class="n">js</code><code> </code><code class="o">=</code><code> </code><code class="o">(</code><code class="n">JavascriptExecutor</code><code class="o">)</code><code> </code><code class="n">driver</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="n">WebDriverWait</code><code> </code><code class="n">wait</code><code> </code><code class="o">=</code><code> </code><code class="k">new</code><code> </code><code class="n">WebDriverWait</code><code class="o">(</code><code class="n">driver</code><code class="o">,</code><code> </code><code class="n">Duration</code><code class="o">.</code><code class="na">ofSeconds</code><code class="o">(</code><code class="mi">10</code><code class="o">)</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO3-1" id="co_browser_agnostic_features_CO3-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">By</code><code> </code><code class="n">pLocator</code><code> </code><code class="o">=</code><code> </code><code class="n">By</code><code class="o">.</code><code class="na">tagName</code><code class="o">(</code><code class="s">"p"</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="n">List</code><code class="o">&lt;</code><code class="n">WebElement</code><code class="o">&gt;</code><code> </code><code class="n">paragraphs</code><code> </code><code class="o">=</code><code> </code><code class="n">wait</code><code class="o">.</code><code class="na">until</code><code class="o">(</code><code>&#13;
</code><code>            </code><code class="n">ExpectedConditions</code><code class="o">.</code><code class="na">numberOfElementsToBeMoreThan</code><code class="o">(</code><code class="n">pLocator</code><code class="o">,</code><code> </code><code class="mi">0</code><code class="o">)</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="kt">int</code><code> </code><code class="n">initParagraphsNumber</code><code> </code><code class="o">=</code><code> </code><code class="n">paragraphs</code><code class="o">.</code><code class="na">size</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO3-2" id="co_browser_agnostic_features_CO3-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">WebElement</code><code> </code><code class="n">lastParagraph</code><code> </code><code class="o">=</code><code> </code><code class="n">driver</code><code class="o">.</code><code class="na">findElement</code><code class="o">(</code><code>&#13;
</code><code>            </code><code class="n">By</code><code class="o">.</code><code class="na">xpath</code><code class="o">(</code><code class="n">String</code><code class="o">.</code><code class="na">format</code><code class="o">(</code><code class="s">"//p[%d]"</code><code class="o">,</code><code> </code><code class="n">initParagraphsNumber</code><code class="o">)</code><code class="o">)</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO3-3" id="co_browser_agnostic_features_CO3-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>    </code><code class="n">String</code><code> </code><code class="n">script</code><code> </code><code class="o">=</code><code> </code><code class="s">"arguments[0].scrollIntoView();"</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="n">js</code><code class="o">.</code><code class="na">executeScript</code><code class="o">(</code><code class="n">script</code><code class="o">,</code><code> </code><code class="n">lastParagraph</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO3-4" id="co_browser_agnostic_features_CO3-4"><img alt="4" src="assets/4.png"/></a><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">wait</code><code class="o">.</code><code class="na">until</code><code class="o">(</code><code class="n">ExpectedConditions</code><code class="o">.</code><code class="na">numberOfElementsToBeMoreThan</code><code class="o">(</code><code class="n">pLocator</code><code class="o">,</code><code>&#13;
</code><code>            </code><code class="n">initParagraphsNumber</code><code class="o">)</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO3-5" id="co_browser_agnostic_features_CO3-5"><img alt="5" src="assets/5.png"/></a><code>&#13;
</code><code class="o">}</code></pre></div>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO3-1" id="callout_browser_agnostic_features_CO3-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>We define an <a data-primary="explicit waits" data-type="indexterm" id="idm45849730958736"/>explicit wait since we need to pause the test until the new content is loaded.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO3-2" id="callout_browser_agnostic_features_CO3-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>We find the initial number of paragraphs on the page.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO3-3" id="callout_browser_agnostic_features_CO3-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>We locate the last paragraph of the page.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO3-4" id="callout_browser_agnostic_features_CO3-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>We scroll down into this element.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO3-5" id="callout_browser_agnostic_features_CO3-5"><img alt="5" src="assets/5.png"/></a></dt>&#13;
<dd><p>We wait until more paragraphs are available <a data-startref="ch4_term6" data-type="indexterm" id="idm45849730910896"/><a data-startref="ch4_term7" data-type="indexterm" id="idm45849730910288"/>on the page.</p></dd>&#13;
</dl>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Color picker" data-type="sect3"><div class="sect3" id="idm45849731386352">&#13;
<h3>Color picker</h3>&#13;
&#13;
<p>A <em>color picker</em> in <a data-primary="HTML" data-secondary="color picker in" data-type="indexterm" id="idm45849730907872"/><a data-primary="color picker" data-type="indexterm" id="ch4_term8"/>HTML is an input type that allows users to select a color by clicking and dragging the cursor using a graphical area. The practice web form contains one of these elements (see <a data-type="xref" href="#color-picker">Figure 4-2</a>).</p>&#13;
&#13;
<figure><div class="figure" id="color-picker">&#13;
<img alt="hosw 0402" src="assets/hosw_0402.png"/>&#13;
<h6><span class="label">Figure 4-2. </span>Color picker in the practice web form</h6>&#13;
</div></figure>&#13;
&#13;
<p>The following code shows the HTML markup for the color picker. Notice that it sets an initial color value (otherwise, the default color is black).</p>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">input</code> <code class="na">type</code><code class="o">=</code><code class="s">"color"</code> <code class="na">class</code><code class="o">=</code><code class="s">"form-control form-control-color"</code> <code class="na">name</code><code class="o">=</code><code class="s">"my-colors"</code>&#13;
        <code class="na">value</code><code class="o">=</code><code class="s">"#563d7c"</code><code class="p">&gt;</code></pre>&#13;
&#13;
<p><a data-type="xref" href="#color-picker-example">Example 4-4</a> illustrates how to interact with this color picker. Because the Selenium WebDriver API does not provide any asset to control color pickers, we use JavaScript. In addition, this test also <a data-primary="Color class" data-type="indexterm" id="idm45849730897408"/>illustrates the use of <code>Color</code>, a support class available in the Selenium WebDriver API for working with colors.</p>&#13;
<div data-type="example" id="color-picker-example">&#13;
<h5><span class="label">Example 4-4. </span>Test executing JavaScript to interact with a color picker</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="nd">@Test</code><code>&#13;
</code><code class="kt">void</code><code> </code><code class="nf">testColorPicker</code><code class="o">(</code><code class="o">)</code><code> </code><code class="o">{</code><code>&#13;
</code><code>    </code><code class="n">driver</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code>&#13;
</code><code>            </code><code class="s">"https://bonigarcia.dev/selenium-webdriver-java/web-form.html"</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="n">JavascriptExecutor</code><code> </code><code class="n">js</code><code> </code><code class="o">=</code><code> </code><code class="o">(</code><code class="n">JavascriptExecutor</code><code class="o">)</code><code> </code><code class="n">driver</code><code class="o">;</code><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">WebElement</code><code> </code><code class="n">colorPicker</code><code> </code><code class="o">=</code><code> </code><code class="n">driver</code><code class="o">.</code><code class="na">findElement</code><code class="o">(</code><code class="n">By</code><code class="o">.</code><code class="na">name</code><code class="o">(</code><code class="s">"my-colors"</code><code class="o">)</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO4-1" id="co_browser_agnostic_features_CO4-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>    </code><code class="n">String</code><code> </code><code class="n">initColor</code><code> </code><code class="o">=</code><code> </code><code class="n">colorPicker</code><code class="o">.</code><code class="na">getAttribute</code><code class="o">(</code><code class="s">"value"</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO4-2" id="co_browser_agnostic_features_CO4-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>    </code><code class="n">log</code><code class="o">.</code><code class="na">debug</code><code class="o">(</code><code class="s">"The initial color is {}"</code><code class="o">,</code><code> </code><code class="n">initColor</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">Color</code><code> </code><code class="n">red</code><code> </code><code class="o">=</code><code> </code><code class="k">new</code><code> </code><code class="n">Color</code><code class="o">(</code><code class="mi">255</code><code class="o">,</code><code> </code><code class="mi">0</code><code class="o">,</code><code> </code><code class="mi">0</code><code class="o">,</code><code> </code><code class="mi">1</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO4-3" id="co_browser_agnostic_features_CO4-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>    </code><code class="n">String</code><code> </code><code class="n">script</code><code> </code><code class="o">=</code><code> </code><code class="n">String</code><code class="o">.</code><code class="na">format</code><code class="o">(</code><code>&#13;
</code><code>            </code><code class="s">"arguments[0].setAttribute('value', '%s');"</code><code class="o">,</code><code> </code><code class="n">red</code><code class="o">.</code><code class="na">asHex</code><code class="o">(</code><code class="o">)</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="n">js</code><code class="o">.</code><code class="na">executeScript</code><code class="o">(</code><code class="n">script</code><code class="o">,</code><code> </code><code class="n">colorPicker</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO4-4" id="co_browser_agnostic_features_CO4-4"><img alt="4" src="assets/4.png"/></a><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">String</code><code> </code><code class="n">finalColor</code><code> </code><code class="o">=</code><code> </code><code class="n">colorPicker</code><code class="o">.</code><code class="na">getAttribute</code><code class="o">(</code><code class="s">"value"</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO4-5" id="co_browser_agnostic_features_CO4-5"><img alt="5" src="assets/5.png"/></a><code>&#13;
</code><code>    </code><code class="n">log</code><code class="o">.</code><code class="na">debug</code><code class="o">(</code><code class="s">"The final color is {}"</code><code class="o">,</code><code> </code><code class="n">finalColor</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="n">assertThat</code><code class="o">(</code><code class="n">finalColor</code><code class="o">)</code><code class="o">.</code><code class="na">isNotEqualTo</code><code class="o">(</code><code class="n">initColor</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO4-6" id="co_browser_agnostic_features_CO4-6"><img alt="6" src="assets/6.png"/></a><code>&#13;
</code><code>    </code><code class="n">assertThat</code><code class="o">(</code><code class="n">Color</code><code class="o">.</code><code class="na">fromString</code><code class="o">(</code><code class="n">finalColor</code><code class="o">)</code><code class="o">)</code><code class="o">.</code><code class="na">isEqualTo</code><code class="o">(</code><code class="n">red</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code class="o">}</code></pre></div>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO4-1" id="callout_browser_agnostic_features_CO4-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>We locate the color picker by name.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO4-2" id="callout_browser_agnostic_features_CO4-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>We read the initial value of the color picker (it should be <code>#563d7c</code>).</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO4-3" id="callout_browser_agnostic_features_CO4-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>We define a color to work with using the following RGBA components: red=255 (maximum value), green=0 (minimum value), blue=0 (minimum value), and alpha=1 (maximum value, i.e., fully opaque).</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO4-4" id="callout_browser_agnostic_features_CO4-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>We use JavaScript to change the value selected in the color picker. Alternatively, we can <a data-primary="colorPicker.send Keys()" data-type="indexterm" id="idm45849730690928"/>change the selected color invoking the statement <code>colorPicker.sendKeys(red.asHex());</code>.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO4-5" id="callout_browser_agnostic_features_CO4-5"><img alt="5" src="assets/5.png"/></a></dt>&#13;
<dd><p>We read the resulting value of the color picker  (it should be <code>#ff0000</code>).</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO4-6" id="callout_browser_agnostic_features_CO4-6"><img alt="6" src="assets/6.png"/></a></dt>&#13;
<dd><p>We assert that the color is different from the initial <a data-startref="ch4_term4" data-type="indexterm" id="idm45849730617040"/><a data-startref="ch4_term5" data-type="indexterm" id="idm45849730616400"/><a data-startref="ch4_term8" data-type="indexterm" id="idm45849730615728"/>value, but as expected.</p></dd>&#13;
</dl>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Pinned Scripts" data-type="sect2"><div class="sect2" id="pinned-scripts">&#13;
<h2>Pinned Scripts</h2>&#13;
&#13;
<p>The Selenium WebDriver API <a data-primary="Selenium WebDriver 4 (version)" data-secondary="pinned scripts in" data-type="indexterm" id="ch4_term9"/><a data-primary="JavascriptExecutor methods" data-secondary="pinned scripts" data-type="indexterm" id="ch4_term10"/><a data-primary="pin() method" data-type="indexterm" id="ch4_term11"/><a data-primary="pinned JavascriptExecutor scripts" data-type="indexterm" id="ch4_term12"/><a data-primary="unpin() method" data-type="indexterm" id="ch4_term13"/>allows you to <em>pin</em> scripts in Selenium WebDriver 4. This feature enables attaching JavaScript fragments to a WebDriver session, assigning a unique key to each snippet, and executing these snippets on demand (even on different web pages). <a data-type="xref" href="#pinned-script-example">Example 4-5</a> shows a test using <em>pinned</em> scripts.</p>&#13;
<div data-type="example" id="pinned-script-example">&#13;
<h5><span class="label">Example 4-5. </span>Test executing JavaScript as pinned scripts</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="nd">@Test</code><code>&#13;
</code><code class="kt">void</code><code> </code><code class="nf">testPinnedScripts</code><code class="o">(</code><code class="o">)</code><code> </code><code class="o">{</code><code>&#13;
</code><code>    </code><code class="n">String</code><code> </code><code class="n">initPage</code><code> </code><code class="o">=</code><code> </code><code class="s">"https://bonigarcia.dev/selenium-webdriver-java/"</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="n">driver</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code class="n">initPage</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="n">JavascriptExecutor</code><code> </code><code class="n">js</code><code> </code><code class="o">=</code><code> </code><code class="o">(</code><code class="n">JavascriptExecutor</code><code class="o">)</code><code> </code><code class="n">driver</code><code class="o">;</code><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">ScriptKey</code><code> </code><code class="n">linkKey</code><code> </code><code class="o">=</code><code> </code><code class="n">js</code><code>&#13;
</code><code>            </code><code class="o">.</code><code class="na">pin</code><code class="o">(</code><code class="s">"return document.getElementsByTagName('a')[2];"</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO5-1" id="co_browser_agnostic_features_CO5-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>    </code><code class="n">ScriptKey</code><code> </code><code class="n">firstArgKey</code><code> </code><code class="o">=</code><code> </code><code class="n">js</code><code class="o">.</code><code class="na">pin</code><code class="o">(</code><code class="s">"return arguments[0];"</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO5-2" id="co_browser_agnostic_features_CO5-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">Set</code><code class="o">&lt;</code><code class="n">ScriptKey</code><code class="o">&gt;</code><code> </code><code class="n">pinnedScripts</code><code> </code><code class="o">=</code><code> </code><code class="n">js</code><code class="o">.</code><code class="na">getPinnedScripts</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO5-3" id="co_browser_agnostic_features_CO5-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>    </code><code class="n">assertThat</code><code class="o">(</code><code class="n">pinnedScripts</code><code class="o">)</code><code class="o">.</code><code class="na">hasSize</code><code class="o">(</code><code class="mi">2</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO5-4" id="co_browser_agnostic_features_CO5-4"><img alt="4" src="assets/4.png"/></a><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">WebElement</code><code> </code><code class="n">formLink</code><code> </code><code class="o">=</code><code> </code><code class="o">(</code><code class="n">WebElement</code><code class="o">)</code><code> </code><code class="n">js</code><code class="o">.</code><code class="na">executeScript</code><code class="o">(</code><code class="n">linkKey</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO5-5" id="co_browser_agnostic_features_CO5-5"><img alt="5" src="assets/5.png"/></a><code>&#13;
</code><code>    </code><code class="n">formLink</code><code class="o">.</code><code class="na">click</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO5-6" id="co_browser_agnostic_features_CO5-6"><img alt="6" src="assets/6.png"/></a><code>&#13;
</code><code>    </code><code class="n">assertThat</code><code class="o">(</code><code class="n">driver</code><code class="o">.</code><code class="na">getCurrentUrl</code><code class="o">(</code><code class="o">)</code><code class="o">)</code><code class="o">.</code><code class="na">isNotEqualTo</code><code class="o">(</code><code class="n">initPage</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO5-7" id="co_browser_agnostic_features_CO5-7"><img alt="7" src="assets/7.png"/></a><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">String</code><code> </code><code class="n">message</code><code> </code><code class="o">=</code><code> </code><code class="s">"Hello world!"</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="n">String</code><code> </code><code class="n">executeScript</code><code> </code><code class="o">=</code><code> </code><code class="o">(</code><code class="n">String</code><code class="o">)</code><code> </code><code class="n">js</code><code class="o">.</code><code class="na">executeScript</code><code class="o">(</code><code class="n">firstArgKey</code><code class="o">,</code><code> </code><code class="n">message</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO5-8" id="co_browser_agnostic_features_CO5-8"><img alt="8" src="assets/8.png"/></a><code>&#13;
</code><code>    </code><code class="n">assertThat</code><code class="o">(</code><code class="n">executeScript</code><code class="o">)</code><code class="o">.</code><code class="na">isEqualTo</code><code class="o">(</code><code class="n">message</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO5-9" id="co_browser_agnostic_features_CO5-9"><img alt="9" src="assets/9.png"/></a><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">js</code><code class="o">.</code><code class="na">unpin</code><code class="o">(</code><code class="n">linkKey</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO5-10" id="co_browser_agnostic_features_CO5-10"><img alt="10" src="assets/10.png"/></a><code>&#13;
</code><code>    </code><code class="n">assertThat</code><code class="o">(</code><code class="n">js</code><code class="o">.</code><code class="na">getPinnedScripts</code><code class="o">(</code><code class="o">)</code><code class="o">)</code><code class="o">.</code><code class="na">hasSize</code><code class="o">(</code><code class="mi">1</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO5-11" id="co_browser_agnostic_features_CO5-11"><img alt="11" src="assets/11.png"/></a><code>&#13;
</code><code class="o">}</code></pre></div>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO5-1" id="callout_browser_agnostic_features_CO5-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>We attach a JavaScript fragment to locate an element in the web page. Notice that we could do the same with the standard WebDriver API. Nevertheless, we use this approach for demo purposes.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO5-2" id="callout_browser_agnostic_features_CO5-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>We attach another piece of JavaScript that returns whatever we pass to it as a first parameter.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO5-3" id="callout_browser_agnostic_features_CO5-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>We read the set of pinned scripts.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO5-4" id="callout_browser_agnostic_features_CO5-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>We assert the number of pinned scripts is as expected (i.e., <code>2</code>).</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO5-5" id="callout_browser_agnostic_features_CO5-5"><img alt="5" src="assets/5.png"/></a></dt>&#13;
<dd><p>We execute the first pinned script. As a result, we get the third link in the web page as a <code>WebElement</code> in Java.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO5-6" id="callout_browser_agnostic_features_CO5-6"><img alt="6" src="assets/6.png"/></a></dt>&#13;
<dd><p>We click on this link, which should correspond to the practice web link. As a result, the browser should navigate to that page.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO5-7" id="callout_browser_agnostic_features_CO5-7"><img alt="7" src="assets/7.png"/></a></dt>&#13;
<dd><p>We assert the current URL is different from the initial one.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO5-8" id="callout_browser_agnostic_features_CO5-8"><img alt="8" src="assets/8.png"/></a></dt>&#13;
<dd><p>We execute the second pinned script. Notice that it is possible to run the pinned script even though the page has changed in the browser (since the script is attached to the session and not to a single page).</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO5-9" id="callout_browser_agnostic_features_CO5-9"><img alt="9" src="assets/9.png"/></a></dt>&#13;
<dd><p>We assert the returned message is as expected.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO5-10" id="callout_browser_agnostic_features_CO5-10"><img alt="10" src="assets/10.png"/></a></dt>&#13;
<dd><p>We unpin one of the scripts.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO5-11" id="callout_browser_agnostic_features_CO5-11"><img alt="11" src="assets/11.png"/></a></dt>&#13;
<dd><p>We verify the number of pinned scripts is as <a data-primary="getpinnedScripts() method" data-type="indexterm" id="idm45849730313040"/><a data-startref="ch4_term9" data-type="indexterm" id="idm45849730312432"/><a data-startref="ch4_term10" data-type="indexterm" id="idm45849730311824"/><a data-startref="ch4_term11" data-type="indexterm" id="idm45849730311216"/><a data-startref="ch4_term12" data-type="indexterm" id="idm45849730310608"/><a data-startref="ch4_term13" data-type="indexterm" id="idm45849730310000"/>expected (i.e., <code>1</code> at this point).</p></dd>&#13;
</dl>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Asynchronous Scripts" data-type="sect2"><div class="sect2" id="idm45849730375744">&#13;
<h2>Asynchronous Scripts</h2>&#13;
&#13;
<p>The method <code>executeAsyncScript()</code> of the <code>JavascriptExecutor</code> interface allows executing <a data-primary="asynchronous JavascriptExecutor scripts" data-type="indexterm" id="ch4_term14"/><a data-primary="executeAsyncScript() method" data-type="indexterm" id="ch4_term15"/><a data-primary="JavascriptExecutor methods" data-secondary="asynchronous scripts" data-type="indexterm" id="ch4_term16"/>JavaScript scripts in the context of a web page using Selenium WebDriver. In the same way that <code>executeScript()</code> explained previously, <code>executeAsyncScript()</code> executes an anonymous function with the provided JavaScript code in the body of the current page. The execution of this function blocks the Selenium WebDriver control flow. The difference is that in <code>executeAsyncScript()</code>, we must <a data-primary="callbacks" data-type="indexterm" id="idm45849730301808"/><a data-primary="done callback" data-type="indexterm" id="idm45849730301072"/>explicitly signal the script termination by invoking a <em>done</em> callback. This callback is injected into the executed script as the last argument (i.e., <code>arguments[arguments.length - 1]</code>) in the corresponding anonymous function. <a data-type="xref" href="#async-script-example">Example 4-6</a> shows a test using this mechanism.</p>&#13;
<div data-type="example" id="async-script-example">&#13;
<h5><span class="label">Example 4-6. </span>Test executing asynchronous JavaScript</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="nd">@Test</code><code>&#13;
</code><code class="kt">void</code><code> </code><code class="nf">testAsyncScript</code><code class="o">(</code><code class="o">)</code><code> </code><code class="o">{</code><code>&#13;
</code><code>    </code><code class="n">driver</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code class="s">"https://bonigarcia.dev/selenium-webdriver-java/"</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="n">JavascriptExecutor</code><code> </code><code class="n">js</code><code> </code><code class="o">=</code><code> </code><code class="o">(</code><code class="n">JavascriptExecutor</code><code class="o">)</code><code> </code><code class="n">driver</code><code class="o">;</code><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">Duration</code><code> </code><code class="n">pause</code><code> </code><code class="o">=</code><code> </code><code class="n">Duration</code><code class="o">.</code><code class="na">ofSeconds</code><code class="o">(</code><code class="mi">2</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO6-1" id="co_browser_agnostic_features_CO6-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>    </code><code class="n">String</code><code> </code><code class="n">script</code><code> </code><code class="o">=</code><code> </code><code class="s">"const callback = arguments[arguments.length - 1];"</code><code>&#13;
</code><code>            </code><code class="o">+</code><code> </code><code class="s">"window.setTimeout(callback, "</code><code> </code><code class="o">+</code><code> </code><code class="n">pause</code><code class="o">.</code><code class="na">toMillis</code><code class="o">(</code><code class="o">)</code><code> </code><code class="o">+</code><code> </code><code class="s">");"</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO6-2" id="co_browser_agnostic_features_CO6-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="kt">long</code><code> </code><code class="n">initMillis</code><code> </code><code class="o">=</code><code> </code><code class="n">System</code><code class="o">.</code><code class="na">currentTimeMillis</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO6-3" id="co_browser_agnostic_features_CO6-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>    </code><code class="n">js</code><code class="o">.</code><code class="na">executeAsyncScript</code><code class="o">(</code><code class="n">script</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO6-4" id="co_browser_agnostic_features_CO6-4"><img alt="4" src="assets/4.png"/></a><code>&#13;
</code><code>    </code><code class="n">Duration</code><code> </code><code class="n">elapsed</code><code> </code><code class="o">=</code><code> </code><code class="n">Duration</code><code>&#13;
</code><code>            </code><code class="o">.</code><code class="na">ofMillis</code><code class="o">(</code><code class="n">System</code><code class="o">.</code><code class="na">currentTimeMillis</code><code class="o">(</code><code class="o">)</code><code> </code><code class="o">-</code><code> </code><code class="n">initMillis</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO6-5" id="co_browser_agnostic_features_CO6-5"><img alt="5" src="assets/5.png"/></a><code>&#13;
</code><code>    </code><code class="n">log</code><code class="o">.</code><code class="na">debug</code><code class="o">(</code><code class="s">"The script took {} ms to be executed"</code><code class="o">,</code><code> </code><code class="n">elapsed</code><code class="o">.</code><code class="na">toMillis</code><code class="o">(</code><code class="o">)</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="n">assertThat</code><code class="o">(</code><code class="n">elapsed</code><code class="o">)</code><code class="o">.</code><code class="na">isGreaterThanOrEqualTo</code><code class="o">(</code><code class="n">pause</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO6-6" id="co_browser_agnostic_features_CO6-6"><img alt="6" src="assets/6.png"/></a><code>&#13;
</code><code class="o">}</code></pre></div>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO6-1" id="callout_browser_agnostic_features_CO6-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>We define a pause time of <code>2</code> seconds.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO6-2" id="callout_browser_agnostic_features_CO6-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>We define the script to be executed. In the first line, we define a constant for the callback (i.e., the last script argument). After that, we use the JavaScript function <code>window.setTimeout()</code> to pause the script execution for a given amount of time.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO6-3" id="callout_browser_agnostic_features_CO6-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>We get the current system time (in milliseconds).</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO6-4" id="callout_browser_agnostic_features_CO6-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>We execute the script. If everything works as expected, the test execution blocks in this line for second seconds (as defined in step 1).</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO6-5" id="callout_browser_agnostic_features_CO6-5"><img alt="5" src="assets/5.png"/></a></dt>&#13;
<dd><p>We calculate the time required to execute the previous line.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO6-6" id="callout_browser_agnostic_features_CO6-6"><img alt="6" src="assets/6.png"/></a></dt>&#13;
<dd><p>We assert the elapsed time is as expected (typically, some milliseconds above the defined pause time).</p></dd>&#13;
</dl>&#13;
<div data-type="tip"><h6>Tip</h6>&#13;
<p>You can find an additional example that executes an asynchronous <a data-startref="ch4_term1" data-type="indexterm" id="idm45849730099120"/><a data-startref="ch4_term14" data-type="indexterm" id="idm45849730098416"/><a data-startref="ch4_term15" data-type="indexterm" id="idm45849730097744"/><a data-startref="ch4_term16" data-type="indexterm" id="idm45849730097072"/>script on <a data-type="xref" href="ch05.html#push_notifications">“Notifications”</a>.</p>&#13;
</div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Timeouts" data-type="sect1"><div class="sect1" id="timeouts">&#13;
<h1>Timeouts</h1>&#13;
&#13;
<p>Selenium WebDriver allows specifying three types of timeouts. We <a data-primary="manage().timeouts() method" data-type="indexterm" id="idm45849730093056"/><a data-primary="browsers, interoperable features of" data-secondary="timeouts" data-type="indexterm" id="ch4_term17"/><a data-primary="timeouts" data-type="indexterm" id="ch4_term18"/>can use them by invoking the method <code>manage().timeouts()</code> in the Selenium WebDriver API. The first <a data-primary="implicit waits" data-type="indexterm" id="idm45849730089680"/>timeout is the implicit wait, already explained in <a data-type="xref" href="ch03.html#implicit_wait">“Implicit Wait”</a> (as part of waiting strategies). The other options are page loading and script loading timeouts, explained next.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Page Loading Timeout" data-type="sect2"><div class="sect2" id="idm45849730087856">&#13;
<h2>Page Loading Timeout</h2>&#13;
&#13;
<p>The <em>page loading timeout</em> provides a <a data-primary="web pages" data-secondary="loading timeouts for" data-type="indexterm" id="idm45849730085744"/><a data-primary="page loading" data-type="indexterm" id="idm45849730084736"/>time limit to interrupt a navigation attempt. In other words, this timeout limits the time in which a web page is loaded. When this timeout (which has a default value of 30 seconds) is exceeded, an exception is thrown. <a data-type="xref" href="#page-loading-timeout">Example 4-7</a> shows an example of this timeout. As you can see, this <a data-primary="negative testing" data-type="indexterm" id="idm45849730083136"/>piece of code is a dummy implementation of a <em>negative</em> test. In other words, it checks unexpected conditions in the SUT.</p>&#13;
<div data-type="example" id="page-loading-timeout">&#13;
<h5><span class="label">Example 4-7. </span>Test using a page loading timeout</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="nd">@Test</code><code>&#13;
</code><code class="kt">void</code><code> </code><code class="nf">testPageLoadTimeout</code><code class="o">(</code><code class="o">)</code><code> </code><code class="o">{</code><code>&#13;
</code><code>    </code><code class="n">driver</code><code class="o">.</code><code class="na">manage</code><code class="o">(</code><code class="o">)</code><code class="o">.</code><code class="na">timeouts</code><code class="o">(</code><code class="o">)</code><code class="o">.</code><code class="na">pageLoadTimeout</code><code class="o">(</code><code class="n">Duration</code><code class="o">.</code><code class="na">ofMillis</code><code class="o">(</code><code class="mi">1</code><code class="o">)</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO7-1" id="co_browser_agnostic_features_CO7-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">assertThatThrownBy</code><code class="o">(</code><code class="o">(</code><code class="o">)</code><code> </code><code class="o">-</code><code class="o">&gt;</code><code> </code><code class="n">driver</code><code>&#13;
</code><code>            </code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code class="s">"https://bonigarcia.dev/selenium-webdriver-java/"</code><code class="o">)</code><code class="o">)</code><code>&#13;
</code><code>                    </code><code class="o">.</code><code class="na">isInstanceOf</code><code class="o">(</code><code class="n">TimeoutException</code><code class="o">.</code><code class="na">class</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO7-2" id="co_browser_agnostic_features_CO7-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code class="o">}</code></pre></div>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO7-1" id="callout_browser_agnostic_features_CO7-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>We specify the minimum possible page loading timeout, which is one <span class="keep-together">millisecond</span>.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO7-2" id="callout_browser_agnostic_features_CO7-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>We load a web page. This invocation (implemented as Java lambda) will fail since it is impossible to load that web page in less than one millisecond. For this reason, <a data-primary="AssertJ assertions" data-type="indexterm" id="idm45849730024512"/><a data-primary="assertThatThrownBy() method" data-type="indexterm" id="idm45849730023808"/><a data-primary="TimeoutException exception" data-type="indexterm" id="idm45849730023120"/>the exception <code>TimeoutException</code> is expected to be thrown in the lambda, using the AssertJ method <code>assertThatThrownBy</code>.</p></dd>&#13;
</dl>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>You can play with this test by removing the timeout declaration (i.e., step 1). If you do that, the test will fail since an exception is expected but not thrown.</p>&#13;
</div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Script Loading Timeout" data-type="sect2"><div class="sect2" id="idm45849729984272">&#13;
<h2>Script Loading Timeout</h2>&#13;
&#13;
<p>The <em>script loading timeout</em> provides a <a data-primary="timeout, script loading" data-type="indexterm" id="idm45849729982496"/><a data-primary="script loading timeout" data-type="indexterm" id="idm45849729981760"/>time limit to interrupt a script that is being evaluated. This timeout has a default value of three hundred seconds. <a data-type="xref" href="#script-timeout">Example 4-8</a> shows a test using a script loading timeout.</p>&#13;
<div data-type="example" id="script-timeout">&#13;
<h5><span class="label">Example 4-8. </span>Test using a script loading timeout</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="nd">@Test</code><code>&#13;
</code><code class="kt">void</code><code> </code><code class="nf">testScriptTimeout</code><code class="o">(</code><code class="o">)</code><code> </code><code class="o">{</code><code>&#13;
</code><code>    </code><code class="n">driver</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code class="s">"https://bonigarcia.dev/selenium-webdriver-java/"</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="n">JavascriptExecutor</code><code> </code><code class="n">js</code><code> </code><code class="o">=</code><code> </code><code class="o">(</code><code class="n">JavascriptExecutor</code><code class="o">)</code><code> </code><code class="n">driver</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="n">driver</code><code class="o">.</code><code class="na">manage</code><code class="o">(</code><code class="o">)</code><code class="o">.</code><code class="na">timeouts</code><code class="o">(</code><code class="o">)</code><code class="o">.</code><code class="na">scriptTimeout</code><code class="o">(</code><code class="n">Duration</code><code class="o">.</code><code class="na">ofSeconds</code><code class="o">(</code><code class="mi">3</code><code class="o">)</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO8-1" id="co_browser_agnostic_features_CO8-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">assertThatThrownBy</code><code class="o">(</code><code class="o">(</code><code class="o">)</code><code> </code><code class="o">-</code><code class="o">&gt;</code><code> </code><code class="o">{</code><code>&#13;
</code><code>        </code><code class="kt">long</code><code> </code><code class="n">waitMillis</code><code> </code><code class="o">=</code><code> </code><code class="n">Duration</code><code class="o">.</code><code class="na">ofSeconds</code><code class="o">(</code><code class="mi">5</code><code class="o">)</code><code class="o">.</code><code class="na">toMillis</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>        </code><code class="n">String</code><code> </code><code class="n">script</code><code> </code><code class="o">=</code><code> </code><code class="s">"const callback = arguments[arguments.length - 1];"</code><code>&#13;
</code><code>                </code><code class="o">+</code><code> </code><code class="s">"window.setTimeout(callback, "</code><code> </code><code class="o">+</code><code> </code><code class="n">waitMillis</code><code> </code><code class="o">+</code><code> </code><code class="s">");"</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO8-2" id="co_browser_agnostic_features_CO8-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>        </code><code class="n">js</code><code class="o">.</code><code class="na">executeAsyncScript</code><code class="o">(</code><code class="n">script</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="o">}</code><code class="o">)</code><code class="o">.</code><code class="na">isInstanceOf</code><code class="o">(</code><code class="n">ScriptTimeoutException</code><code class="o">.</code><code class="na">class</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO8-3" id="co_browser_agnostic_features_CO8-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code class="o">}</code></pre></div>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO8-1" id="callout_browser_agnostic_features_CO8-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>We define a script timeout of three seconds. This means that a script lasting for more than that time will throw an exception.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO8-2" id="callout_browser_agnostic_features_CO8-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>We execute an <a data-primary="asynchronous JavascriptExecutor scripts" data-type="indexterm" id="idm45849729870912"/><a data-primary="JavascriptExecutor methods" data-secondary="asynchronous scripts" data-type="indexterm" id="idm45849729870160"/>asynchronous script that pauses the execution of five seconds.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO8-3" id="callout_browser_agnostic_features_CO8-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>The script execution time is <a data-primary="ScriptTimeoutException exception" data-type="indexterm" id="idm45849729866624"/><a data-primary="negative testing" data-type="indexterm" id="idm45849729865856"/>greater than the configured script timeout, resulting in a <code>ScriptTimeoutException</code>. Again, this example is a negative test, i.e., designed to expect this <a data-startref="ch4_term17" data-type="indexterm" id="idm45849729816032"/><a data-startref="ch4_term18" data-type="indexterm" id="idm45849729815424"/>exception.</p></dd>&#13;
</dl>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Screenshots" data-type="sect1"><div class="sect1" id="screenshots">&#13;
<h1>Screenshots</h1>&#13;
&#13;
<p>Selenium WebDriver is used mainly to <a data-primary="functional testing" data-type="indexterm" id="idm45849729812208"/><a data-primary="testing" data-secondary="functional" data-type="indexterm" id="idm45849729811504"/><a data-primary="browsers, interoperable features of" data-secondary="screenshots" data-type="indexterm" id="ch4_term19"/><a data-primary="screenshots" data-secondary="with Selenium WebDriver" data-secondary-sortas="Selenium WebDriver" data-type="indexterm" id="ch4_term20"/>carry out end-to-end functional testing of web applications. In other words, we use it to verify that web applications behave as expected by interacting with their user interface (i.e., using a web browser). This approach is very convenient to automate high-level user scenarios, but it also presents different difficulties. One of the <a data-primary="end-to-end (E2E) testing" data-secondary="challenges with" data-type="indexterm" id="idm45849729807760"/><a data-primary="end-to-end (E2E) testing" data-secondary="failure analysis in" data-type="indexterm" id="idm45849729806848"/><a data-primary="failure analysis" data-type="indexterm" id="idm45849729805936"/><a data-primary="screenshots" data-secondary="for failure analysis" data-secondary-sortas="failure analysis" data-type="indexterm" id="idm45849729805264"/><a data-primary="testing" data-secondary="failure analysis and" data-type="indexterm" id="idm45849729804048"/><a data-primary="troubleshooting" data-type="indexterm" id="idm45849729803104"/>main challenges in end-to-end testing is to diagnose the underlying cause of a failed test. Supposing the failure is legitimate (i.e., not induced by a poorly implemented test), the root cause might be diverse: the client side (e.g., incorrect JavaScript logic), the server side (e.g., internal exception), or the integration with other components (e.g., inadequate access to the database), among other reasons. One of the most pervasive mechanisms used in Selenium WebDriver for failure analysis is making browser screenshots. This section presents the mechanisms provided by the Selenium WebDriver API.</p>&#13;
<div data-type="tip"><h6>Tip</h6>&#13;
<p><a data-type="xref" href="ch08.html#failure_analysis">“Failure Analysis”</a> reviews the framework-specific techniques to determine when a test has failed to carry out different failure analysis techniques, such as screenshots, recordings, and log gathering.</p>&#13;
</div>&#13;
&#13;
<p>Selenium WebDriver <a data-primary="TakesScreenshot interface" data-type="indexterm" id="idm45849729800048"/>provides the interface <code>TakesScreenshot</code> for making browser screenshots. Any <a data-primary="objects" data-secondary="RemoteWebDriver and" data-type="indexterm" id="idm45849729798752"/><a data-primary="RemoteWebDriver class" data-secondary="objects and" data-type="indexterm" id="idm45849729797776"/>driver object inheriting from <code>RemoteWebDriver</code> (see <a data-type="xref" href="ch02.html#webdriver-hierarchy">Figure 2-2</a>) also implements this interface. Thus, we can cast a <code>WebDriver</code> object that instantiates one of the major browsers (e.g., <code>ChromeDriver</code>, <code>FirefoxDriver</code>, etc.) as follows:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">WebDriver</code> <code class="n">driver</code> <code class="o">=</code> <code class="k">new</code> <code class="n">ChromeDriver</code><code class="o">();</code>&#13;
<code class="n">TakesScreenshot</code> <code class="n">ts</code> <code class="o">=</code> <code class="o">(</code><code class="n">TakesScreenshot</code><code class="o">)</code> <code class="n">driver</code><code class="o">;</code></pre>&#13;
&#13;
<p class="pagebreak-before">The interface <code>TakesScreenshot</code> only provides a <a data-primary="getScreenshotAs() method" data-type="indexterm" id="idm45849729788352"/>method called <code>getScreenshotAs(OutputType&lt;X&gt; target)</code> to make screenshots. The <a data-primary="OutputType parameters" data-type="indexterm" id="idm45849729787168"/>parameter <code>OutputType&lt;X&gt; target</code> determines the screenshot type and the returned value. <a data-type="xref" href="#output-types-for-screenshots">Table 4-2</a> shows the available alternatives for this parameter.</p>&#13;
<table id="output-types-for-screenshots">&#13;
<caption><span class="label">Table 4-2. </span>OutputType parameters</caption>&#13;
<thead>&#13;
<tr>&#13;
<th>Parameter</th>&#13;
<th>Description</th>&#13;
<th>Return</th>&#13;
<th>Example</th>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">OutputType</code><code class="o">.</code><code class="na">FILE</code></pre></div></td>&#13;
<td><p>Make screenshot as a PNG file (located in a temporary system directory)</p></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">File</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">File</code> <code class="n">screenshot</code> <code class="o">=</code>&#13;
    <code class="n">ts</code><code class="o">.</code><code class="na">getScreenshotAs</code><code class="o">(</code>&#13;
    <code class="n">OutputType</code><code class="o">.</code><code class="na">FILE</code><code class="o">);</code></pre></div></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">OutputType</code><code class="o">.</code><code class="na">BASE64</code></pre></div></td>&#13;
<td><p>Make a screenshot in <a data-primary="Base64" data-type="indexterm" id="ch4_term21"/>Base64 format (i.e., encoded as an ASCII string)</p></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">String</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">String</code> <code class="n">screenshot</code> <code class="o">=</code>&#13;
    <code class="n">ts</code><code class="o">.</code><code class="na">getScreenshotAs</code><code class="o">(</code>&#13;
    <code class="n">OutputType</code><code class="o">.</code><code class="na">BASE64</code><code class="o">);</code></pre></div></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">OutputType</code><code class="o">.</code><code class="na">BYTES</code></pre></div></td>&#13;
<td><p>Make a screenshot as a raw byte array</p></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kt">byte</code><code class="o">[]</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kt">byte</code><code class="o">[]</code> <code class="n">screenshot</code> <code class="o">=</code>&#13;
    <code class="n">ts</code><code class="o">.</code><code class="na">getScreenshotAs</code><code class="o">(</code>&#13;
    <code class="n">OutputType</code><code class="o">.</code><code class="na">BYTES</code><code class="o">);</code></pre></div></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
<div data-type="tip"><h6>Tip</h6>&#13;
<p>The method <code>getScreenshotAs()</code> allows making screenshots of the browser viewport. In addition, <a data-primary="Selenium WebDriver 4 (version)" data-secondary="screenshots in" data-type="indexterm" id="idm45849729536544"/><a data-primary="screenshots" data-secondary="full page" data-type="indexterm" id="idm45849729535664"/>Selenium WebDriver 4 allows creating full-page screenshots using different mechanisms (see <a data-type="xref" href="ch05.html#fullpage-screenshot">“Full-page screenshot”</a>).</p>&#13;
</div>&#13;
&#13;
<p><a data-type="xref" href="#screenshots-example-1">Example 4-9</a> shows a test for taking a <a data-primary="PNG format, screenshots with" data-type="indexterm" id="idm45849729532432"/>browser screenshot in PNG format. <a data-type="xref" href="#screenshots-example-2">Example 4-10</a> shows another test for creating a screenshot as a Base64 string. The resulting screenshot is shown in <a data-type="xref" href="#screenshot">Figure 4-3</a>.</p>&#13;
<div data-type="example" id="screenshots-example-1">&#13;
<h5><span class="label">Example 4-9. </span>Test making a screenshot as a PNG file</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="nd">@Test</code><code>&#13;
</code><code class="kt">void</code><code> </code><code class="nf">testScreenshotPng</code><code class="o">(</code><code class="o">)</code><code> </code><code class="kd">throws</code><code> </code><code class="n">IOException</code><code> </code><code class="o">{</code><code>&#13;
</code><code>    </code><code class="n">driver</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code class="s">"https://bonigarcia.dev/selenium-webdriver-java/"</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="n">TakesScreenshot</code><code> </code><code class="n">ts</code><code> </code><code class="o">=</code><code> </code><code class="o">(</code><code class="n">TakesScreenshot</code><code class="o">)</code><code> </code><code class="n">driver</code><code class="o">;</code><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">File</code><code> </code><code class="n">screenshot</code><code> </code><code class="o">=</code><code> </code><code class="n">ts</code><code class="o">.</code><code class="na">getScreenshotAs</code><code class="o">(</code><code class="n">OutputType</code><code class="o">.</code><code class="na">FILE</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO9-1" id="co_browser_agnostic_features_CO9-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>    </code><code class="n">log</code><code class="o">.</code><code class="na">debug</code><code class="o">(</code><code class="s">"Screenshot created on {}"</code><code class="o">,</code><code> </code><code class="n">screenshot</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">Path</code><code> </code><code class="n">destination</code><code> </code><code class="o">=</code><code> </code><code class="n">Paths</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code class="s">"screenshot.png"</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO9-2" id="co_browser_agnostic_features_CO9-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>    </code><code class="n">Files</code><code class="o">.</code><code class="na">move</code><code class="o">(</code><code class="n">screenshot</code><code class="o">.</code><code class="na">toPath</code><code class="o">(</code><code class="o">)</code><code class="o">,</code><code> </code><code class="n">destination</code><code class="o">,</code><code> </code><code class="n">REPLACE_EXISTING</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO9-3" id="co_browser_agnostic_features_CO9-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>    </code><code class="n">log</code><code class="o">.</code><code class="na">debug</code><code class="o">(</code><code class="s">"Screenshot moved to {}"</code><code class="o">,</code><code> </code><code class="n">destination</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">assertThat</code><code class="o">(</code><code class="n">destination</code><code class="o">)</code><code class="o">.</code><code class="na">exists</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO9-4" id="co_browser_agnostic_features_CO9-4"><img alt="4" src="assets/4.png"/></a><code>&#13;
</code><code class="o">}</code></pre></div>&#13;
<dl class="calloutlist pagebreak-before">&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO9-1" id="callout_browser_agnostic_features_CO9-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>We make the browser screen a PNG file.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO9-2" id="callout_browser_agnostic_features_CO9-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>This file is located in a temporary folder by default, so we move it to a new file called <code>screenshot.png</code> (in the root project folder).</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO9-3" id="callout_browser_agnostic_features_CO9-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>We use standard Java to move the screenshot file to the new location.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO9-4" id="callout_browser_agnostic_features_CO9-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>We use assertions to verify that the target file exists.</p></dd>&#13;
</dl>&#13;
&#13;
<figure><div class="figure" id="screenshot">&#13;
<img alt="hosw 0403" src="assets/hosw_0403.png"/>&#13;
<h6><span class="label">Figure 4-3. </span>Browser screenshot of the practice site index page</h6>&#13;
</div></figure>&#13;
<div class="pagebreak-before less_space" data-type="example" id="screenshots-example-2">&#13;
<h5><span class="label">Example 4-10. </span>Test making a screenshot as Base64</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="nd">@Test</code><code>&#13;
</code><code class="kt">void</code><code> </code><code class="nf">testScreenshotBase64</code><code class="o">(</code><code class="o">)</code><code> </code><code class="o">{</code><code>&#13;
</code><code>    </code><code class="n">driver</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code class="s">"https://bonigarcia.dev/selenium-webdriver-java/"</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="n">TakesScreenshot</code><code> </code><code class="n">ts</code><code> </code><code class="o">=</code><code> </code><code class="o">(</code><code class="n">TakesScreenshot</code><code class="o">)</code><code> </code><code class="n">driver</code><code class="o">;</code><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">String</code><code> </code><code class="n">screenshot</code><code> </code><code class="o">=</code><code> </code><code class="n">ts</code><code class="o">.</code><code class="na">getScreenshotAs</code><code class="o">(</code><code class="n">OutputType</code><code class="o">.</code><code class="na">BASE64</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO10-1" id="co_browser_agnostic_features_CO10-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>    </code><code class="n">log</code><code class="o">.</code><code class="na">debug</code><code class="o">(</code><code class="s">"Screenshot in base64 "</code><code>&#13;
</code><code>          </code><code class="o">+</code><code> </code><code class="s">"(you can copy and paste it into a browser navigation bar to watch it)\n"</code><code>&#13;
</code><code>          </code><code class="o">+</code><code> </code><code class="s">"data:image/png;base64,{}"</code><code class="o">,</code><code> </code><code class="n">screenshot</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO10-2" id="co_browser_agnostic_features_CO10-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>    </code><code class="n">assertThat</code><code class="o">(</code><code class="n">screenshot</code><code class="o">)</code><code class="o">.</code><code class="na">isNotEmpty</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO10-3" id="co_browser_agnostic_features_CO10-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code class="o">}</code></pre></div>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO10-1" id="callout_browser_agnostic_features_CO10-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>We make the browser screen in Base64 format.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO10-2" id="callout_browser_agnostic_features_CO10-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>We append the prefix <code>data:image/png;base64,</code> to the Base64 string and log it in the standard output. You can copy and paste this resulting string in a browser navigation bar to display the picture.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO10-3" id="callout_browser_agnostic_features_CO10-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>We assert that the screenshot string has content.</p></dd>&#13;
</dl>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>Logging the <a data-primary="Continuous Integration (CI) environment" data-type="indexterm" id="idm45849729266640"/><a data-primary="CI (Continuous Integration) environment" data-type="indexterm" id="idm45849729265888"/>screenshot in Base64 as presented in the previous example could be very useful for diagnosing failures when running tests in CI servers in which we do not have access to the file <a data-startref="ch4_term21" data-type="indexterm" id="idm45849729226048"/>system (e.g., GitHub Actions).</p>&#13;
</div>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="WebElement Screenshots" data-type="sect2"><div class="sect2" id="webelements-screenshots">&#13;
<h2>WebElement Screenshots</h2>&#13;
&#13;
<p>The <code>WebElement</code> interface <a data-primary="TakesScreenshot interface" data-type="indexterm" id="idm45849729222576"/><a data-primary="WebElement screenshots" data-type="indexterm" id="idm45849729221824"/>extends the <code>TakesScreenshot</code> interface. This way, it is possible to make partial screenshots of the visible content of a given web element. (See <a data-type="xref" href="#screenshots-example-3">Example 4-11</a>.) Notice that this test is very similar to the <a data-primary="PNG format, screenshots with" data-type="indexterm" id="idm45849729219584"/>previous one using PNG files, but in this case, <a data-primary="getScreenshotAs() method" data-type="indexterm" id="idm45849729218704"/>we invoke the method <code>getScreenshotAs()</code> directly using a web element. <a data-type="xref" href="#webelement-screenshot">Figure 4-4</a> shows the resulting screenshot.</p>&#13;
<div data-type="example" id="screenshots-example-3">&#13;
<h5><span class="label">Example 4-11. </span>Test making a partial screenshot as a PNG file</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="nd">@Test</code>&#13;
<code class="kt">void</code> <code class="nf">testWebElementScreenshot</code><code class="o">()</code> <code class="kd">throws</code> <code class="n">IOException</code> <code class="o">{</code>&#13;
    <code class="n">driver</code><code class="o">.</code><code class="na">get</code><code class="o">(</code>&#13;
            <code class="s">"https://bonigarcia.dev/selenium-webdriver-java/web-form.html"</code><code class="o">);</code>&#13;
&#13;
    <code class="n">WebElement</code> <code class="n">form</code> <code class="o">=</code> <code class="n">driver</code><code class="o">.</code><code class="na">findElement</code><code class="o">(</code><code class="n">By</code><code class="o">.</code><code class="na">tagName</code><code class="o">(</code><code class="s">"form"</code><code class="o">));</code>&#13;
    <code class="n">File</code> <code class="n">screenshot</code> <code class="o">=</code> <code class="n">form</code><code class="o">.</code><code class="na">getScreenshotAs</code><code class="o">(</code><code class="n">OutputType</code><code class="o">.</code><code class="na">FILE</code><code class="o">);</code>&#13;
    <code class="n">Path</code> <code class="n">destination</code> <code class="o">=</code> <code class="n">Paths</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code class="s">"webelement-screenshot.png"</code><code class="o">);</code>&#13;
    <code class="n">Files</code><code class="o">.</code><code class="na">move</code><code class="o">(</code><code class="n">screenshot</code><code class="o">.</code><code class="na">toPath</code><code class="o">(),</code> <code class="n">destination</code><code class="o">,</code> <code class="n">REPLACE_EXISTING</code><code class="o">);</code>&#13;
&#13;
    <code class="n">assertThat</code><code class="o">(</code><code class="n">destination</code><code class="o">).</code><code class="na">exists</code><code class="o">();</code>&#13;
<code class="o">}</code></pre></div>&#13;
&#13;
<figure><div class="figure" id="webelement-screenshot">&#13;
<img alt="hosw 0404" src="assets/hosw_0404.png"/>&#13;
<h6><span class="label">Figure 4-4. </span>Partial screenshot of the practice web form</h6>&#13;
</div></figure>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Window Size and Position" data-type="sect1"><div class="sect1" id="idm45849729813776">&#13;
<h1>Window Size and Position</h1>&#13;
&#13;
<p>The Selenium WebDriver <a data-startref="ch4_term19" data-type="indexterm" id="idm45849729190496"/><a data-startref="ch4_term20" data-type="indexterm" id="idm45849729189760"/><a data-primary="Window interface" data-type="indexterm" id="idm45849729189088"/><a data-primary="window methods" data-type="indexterm" id="idm45849729188416"/><a data-primary="browsers, interoperable features of" data-secondary="window size and position" data-type="indexterm" id="ch4_term22"/><a data-primary="window size and position, browser" data-type="indexterm" id="ch4_term23"/>API allows manipulating browser size and position very easily using the <code>Window</code> interface. This type is accessible from a driver object using the following statement. <a data-type="xref" href="#window-methods">Table 4-3</a> shows the available methods in this interface. Then, <a data-type="xref" href="#window-example-1">Example 4-12</a> shows a basic test about this feature.</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">Window</code> <code class="n">window</code> <code class="o">=</code> <code class="n">driver</code><code class="o">.</code><code class="na">manage</code><code class="o">().</code><code class="na">window</code><code class="o">();</code></pre>&#13;
<table id="window-methods">&#13;
<caption><span class="label">Table 4-3. </span>Window methods</caption>&#13;
<thead>&#13;
<tr>&#13;
<th>Method</th>&#13;
<th>Return</th>&#13;
<th>Description</th>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">getSize</code><code class="o">()</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">Dimension</code></pre></div></td>&#13;
<td><p>Get the current window size. It returns the  outer window dimension, not just the <em>viewport</em> (i.e., the visible area of a web page for end users).</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">setSize</code><code class="o">(</code><code class="n">Dimension</code>&#13;
    <code class="n">targetSize</code><code class="o">)</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kt">void</code></pre></div></td>&#13;
<td><p>Change the current window size (again, its outer dimension, and not the viewport).</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">getPosition</code><code class="o">()</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">Point</code></pre></div></td>&#13;
<td><p>Get current window position (relative to the upper left corner of the screen).</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">setPosition</code><code class="o">(</code><code class="n">Point</code>&#13;
    <code class="n">targetPosition</code><code class="o">)</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kt">void</code></pre></div></td>&#13;
<td><p>Change the current window position (again, relative to the screen’s upper left corner).</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">maximize</code><code class="o">()</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kt">void</code></pre></div></td>&#13;
<td><p>Maximize the current window.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">minimize</code><code class="o">()</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kt">void</code></pre></div></td>&#13;
<td><p>Minimize the current window.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">fullscreen</code><code class="o">()</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kt">void</code></pre></div></td>&#13;
<td><p>Fullscreen the current window.</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
<div data-type="example" id="window-example-1">&#13;
<h5><span class="label">Example 4-12. </span>Test reading and changing the browser size and position</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="nd">@Test</code><code>&#13;
</code><code class="kt">void</code><code> </code><code class="nf">testWindow</code><code class="o">(</code><code class="o">)</code><code> </code><code class="o">{</code><code>&#13;
</code><code>    </code><code class="n">driver</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code class="s">"https://bonigarcia.dev/selenium-webdriver-java/"</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="n">Window</code><code> </code><code class="n">window</code><code> </code><code class="o">=</code><code> </code><code class="n">driver</code><code class="o">.</code><code class="na">manage</code><code class="o">(</code><code class="o">)</code><code class="o">.</code><code class="na">window</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">Point</code><code> </code><code class="n">initialPosition</code><code> </code><code class="o">=</code><code> </code><code class="n">window</code><code class="o">.</code><code class="na">getPosition</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO11-1" id="co_browser_agnostic_features_CO11-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>    </code><code class="n">Dimension</code><code> </code><code class="n">initialSize</code><code> </code><code class="o">=</code><code> </code><code class="n">window</code><code class="o">.</code><code class="na">getSize</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO11-2" id="co_browser_agnostic_features_CO11-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>    </code><code class="n">log</code><code class="o">.</code><code class="na">debug</code><code class="o">(</code><code class="s">"Initial window: position {} -- size {}"</code><code class="o">,</code><code> </code><code class="n">initialPosition</code><code class="o">,</code><code>&#13;
</code><code>            </code><code class="n">initialSize</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">window</code><code class="o">.</code><code class="na">maximize</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO11-3" id="co_browser_agnostic_features_CO11-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">Point</code><code> </code><code class="n">maximizedPosition</code><code> </code><code class="o">=</code><code> </code><code class="n">window</code><code class="o">.</code><code class="na">getPosition</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="n">Dimension</code><code> </code><code class="n">maximizedSize</code><code> </code><code class="o">=</code><code> </code><code class="n">window</code><code class="o">.</code><code class="na">getSize</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="n">log</code><code class="o">.</code><code class="na">debug</code><code class="o">(</code><code class="s">"Maximized window: position {} -- size {}"</code><code class="o">,</code><code> </code><code class="n">maximizedPosition</code><code class="o">,</code><code>&#13;
</code><code>            </code><code class="n">maximizedSize</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">assertThat</code><code class="o">(</code><code class="n">initialPosition</code><code class="o">)</code><code class="o">.</code><code class="na">isNotEqualTo</code><code class="o">(</code><code class="n">maximizedPosition</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO11-4" id="co_browser_agnostic_features_CO11-4"><img alt="4" src="assets/4.png"/></a><code>&#13;
</code><code>    </code><code class="n">assertThat</code><code class="o">(</code><code class="n">initialSize</code><code class="o">)</code><code class="o">.</code><code class="na">isNotEqualTo</code><code class="o">(</code><code class="n">maximizedSize</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code class="o">}</code></pre></div>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO11-1" id="callout_browser_agnostic_features_CO11-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>We read the window position.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO11-2" id="callout_browser_agnostic_features_CO11-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>We read the window size.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO11-3" id="callout_browser_agnostic_features_CO11-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>We maximize the browser window.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO11-4" id="callout_browser_agnostic_features_CO11-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>We verify that the maximized position (and size, in the following line) is different from the original <a data-startref="ch4_term22" data-type="indexterm" id="idm45849728628048"/><a data-startref="ch4_term23" data-type="indexterm" id="idm45849728627344"/>window.</p></dd>&#13;
</dl>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Browser History" data-type="sect1"><div class="sect1" id="idm45849728626416">&#13;
<h1>Browser History</h1>&#13;
&#13;
<p>Selenium WebDriver allows <a data-primary="browsers" data-secondary="history with" data-type="indexterm" id="idm45849728567376"/><a data-primary="browsers, interoperable features of" data-secondary="browser history" data-type="indexterm" id="idm45849728566528"/><a data-primary="history, browser" data-type="indexterm" id="idm45849728565680"/>manipulating the browser history through the <code>Navigation</code> interface. The following statement illustrates how to access this interface from a <code>WebDriver</code> object. Using this <a data-primary="Navigation interface and methods" data-type="indexterm" id="idm45849728564176"/>interface is quite simple. <a data-type="xref" href="#navigation-methods">Table 4-4</a> shows its public methods, and <a data-type="xref" href="#navigation-example-1">Example 4-13</a> shows a basic example. Notice that this test navigates into different web pages using these methods, and at the end of the test, it verifies the web page URL is as expected.</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">Navigation</code> <code class="n">navigation</code> <code class="o">=</code> <code class="n">driver</code><code class="o">.</code><code class="na">navigate</code><code class="o">();</code></pre>&#13;
<table id="navigation-methods">&#13;
<caption><span class="label">Table 4-4. </span>Navigation methods</caption>&#13;
<thead>&#13;
<tr>&#13;
<th>Method</th>&#13;
<th>Return</th>&#13;
<th>Description</th>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">back</code><code class="o">()</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kt">void</code></pre></div></td>&#13;
<td><p>Go back in the browser history</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">forward</code><code class="o">()</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kt">void</code></pre></div></td>&#13;
<td><p>Go forward in the browser history</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">to</code><code class="o">(</code><code class="n">String</code> <code class="n">url</code><code class="o">)</code>&#13;
<code class="n">to</code><code class="o">(</code><code class="n">URL</code> <code class="n">url</code><code class="o">)</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kt">void</code></pre></div></td>&#13;
<td><p>Load a new web page in the current window</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">refresh</code><code class="o">()</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kt">void</code></pre></div></td>&#13;
<td><p>Refresh the current page</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
<div data-type="example" id="navigation-example-1">&#13;
<h5><span class="label">Example 4-13. </span>Test using navigation methods</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="nd">@Test</code>&#13;
<code class="kt">void</code> <code class="nf">testHistory</code><code class="o">()</code> <code class="o">{</code>&#13;
    <code class="n">String</code> <code class="n">baseUrl</code> <code class="o">=</code> <code class="s">"https://bonigarcia.dev/selenium-webdriver-java/"</code><code class="o">;</code>&#13;
    <code class="n">String</code> <code class="n">firstPage</code> <code class="o">=</code> <code class="n">baseUrl</code> <code class="o">+</code> <code class="s">"navigation1.html"</code><code class="o">;</code>&#13;
    <code class="n">String</code> <code class="n">secondPage</code> <code class="o">=</code> <code class="n">baseUrl</code> <code class="o">+</code> <code class="s">"navigation2.html"</code><code class="o">;</code>&#13;
    <code class="n">String</code> <code class="n">thirdPage</code> <code class="o">=</code> <code class="n">baseUrl</code> <code class="o">+</code> <code class="s">"navigation3.html"</code><code class="o">;</code>&#13;
&#13;
    <code class="n">driver</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code class="n">firstPage</code><code class="o">);</code>&#13;
&#13;
    <code class="n">driver</code><code class="o">.</code><code class="na">navigate</code><code class="o">().</code><code class="na">to</code><code class="o">(</code><code class="n">secondPage</code><code class="o">);</code>&#13;
    <code class="n">driver</code><code class="o">.</code><code class="na">navigate</code><code class="o">().</code><code class="na">to</code><code class="o">(</code><code class="n">thirdPage</code><code class="o">);</code>&#13;
    <code class="n">driver</code><code class="o">.</code><code class="na">navigate</code><code class="o">().</code><code class="na">back</code><code class="o">();</code>&#13;
    <code class="n">driver</code><code class="o">.</code><code class="na">navigate</code><code class="o">().</code><code class="na">forward</code><code class="o">();</code>&#13;
    <code class="n">driver</code><code class="o">.</code><code class="na">navigate</code><code class="o">().</code><code class="na">refresh</code><code class="o">();</code>&#13;
&#13;
    <code class="n">assertThat</code><code class="o">(</code><code class="n">driver</code><code class="o">.</code><code class="na">getCurrentUrl</code><code class="o">()).</code><code class="na">isEqualTo</code><code class="o">(</code><code class="n">thirdPage</code><code class="o">);</code>&#13;
<code class="o">}</code></pre></div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="The Shadow DOM" data-type="sect1"><div class="sect1" id="shadow-dom">&#13;
<h1>The Shadow DOM</h1>&#13;
&#13;
<p>As introduced in <a data-type="xref" href="ch03.html#dom">“The Document Object Model (DOM)”</a>, the DOM is a <a data-primary="DOM (Document Object Model)" data-secondary="shadow DOM in" data-type="indexterm" id="ch4_term24"/><a data-primary="browsers, interoperable features of" data-secondary="shadow DOM" data-type="indexterm" id="ch4_term25"/><a data-primary="shadow DOM" data-type="indexterm" id="ch4_term26"/>programming interface that allows us to represent and manipulate a web page using a tree structure. The <em>shadow DOM</em> is a feature of this programming interface that enables the creation of scoped subtrees inside the regular DOM tree. The shadow DOM allows the encapsulation of a group of a DOM subtree (called <em>shadow tree</em>, as represented in <a data-type="xref" href="#shadow-dom-representation">Figure 4-5</a>) that can specify different CSS styles from the original DOM. The <a data-primary="shadow host" data-type="indexterm" id="idm45849728221024"/><a data-primary="shadow root" data-type="indexterm" id="idm45849728220416"/>node in the regular DOM in which the shadow tree is attached is called the <em>shadow host</em>. The root node of the shadow tree is called the <em>shadow root</em>. As represented in <a data-type="xref" href="#shadow-dom-representation">Figure 4-5</a>, the shadow tree is flattened into the original DOM in a single composed tree to be rendered in the browser.</p>&#13;
&#13;
<figure><div class="figure" id="shadow-dom-representation">&#13;
<img alt="hosw 0405" src="assets/hosw_0405.png"/>&#13;
<h6><span class="label">Figure 4-5. </span>Schematic representation of the shadow DOM</h6>&#13;
</div></figure>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>The shadow DOM is part of the standard suite (together with HTML templates or custom elements) that <a data-primary="Web Components" data-type="indexterm" id="idm45849728215184"/>allows the implementation of <a href="https://github.com/WICG/webcomponents">web components</a> (i.e., reusable custom elements for web applications).</p>&#13;
</div>&#13;
&#13;
<p>The shadow DOM allows the creation of self-contained components. In other words, the shadow tree is isolated from the original DOM. This feature is useful for web design and composition, but it can be challenging for automated testing with <a data-primary="Selenium WebDriver 4 (version)" data-secondary="shadow DOM access in" data-type="indexterm" id="idm45849728213136"/><a data-primary="WebElement method" data-type="indexterm" id="idm45849728212144"/><a data-primary="WebElements, locating" data-secondary="in shadow DOM" data-secondary-sortas="shadow DOM" data-type="indexterm" id="idm45849728211472"/>Selenium WebDriver (since the regular location strategies cannot find web elements within the shadow tree). Luckily, Selenium WebDriver 4 provides a <code>WebElement</code> method that allows access to the shadow DOM. <a data-type="xref" href="#shadow_dom_example">Example 4-14</a> demonstrates this use.</p>&#13;
<div data-type="example" id="shadow_dom_example">&#13;
<h5><span class="label">Example 4-14. </span>Test reading the shadow DOM</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="nd">@Test</code><code>&#13;
</code><code class="kt">void</code><code> </code><code class="nf">testShadowDom</code><code class="o">(</code><code class="o">)</code><code> </code><code class="o">{</code><code>&#13;
</code><code>    </code><code class="n">driver</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code>&#13;
</code><code>            </code><code class="s">"https://bonigarcia.dev/selenium-webdriver-java/shadow-dom.html"</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO12-1" id="co_browser_agnostic_features_CO12-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">WebElement</code><code> </code><code class="n">content</code><code> </code><code class="o">=</code><code> </code><code class="n">driver</code><code class="o">.</code><code class="na">findElement</code><code class="o">(</code><code class="n">By</code><code class="o">.</code><code class="na">id</code><code class="o">(</code><code class="s">"content"</code><code class="o">)</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO12-2" id="co_browser_agnostic_features_CO12-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>    </code><code class="n">SearchContext</code><code> </code><code class="n">shadowRoot</code><code> </code><code class="o">=</code><code> </code><code class="n">content</code><code class="o">.</code><code class="na">getShadowRoot</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO12-3" id="co_browser_agnostic_features_CO12-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>    </code><code class="n">WebElement</code><code> </code><code class="n">textElement</code><code> </code><code class="o">=</code><code> </code><code class="n">shadowRoot</code><code class="o">.</code><code class="na">findElement</code><code class="o">(</code><code class="n">By</code><code class="o">.</code><code class="na">cssSelector</code><code class="o">(</code><code class="s">"p"</code><code class="o">)</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO12-4" id="co_browser_agnostic_features_CO12-4"><img alt="4" src="assets/4.png"/></a><code>&#13;
</code><code>    </code><code class="n">assertThat</code><code class="o">(</code><code class="n">textElement</code><code class="o">.</code><code class="na">getText</code><code class="o">(</code><code class="o">)</code><code class="o">)</code><code class="o">.</code><code class="na">contains</code><code class="o">(</code><code class="s">"Hello Shadow DOM"</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO12-5" id="co_browser_agnostic_features_CO12-5"><img alt="5" src="assets/5.png"/></a><code>&#13;
</code><code class="o">}</code></pre></div>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO12-1" id="callout_browser_agnostic_features_CO12-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>We open the practice web page that contains a shadow tree. You can inspect the source code of this page to check the JavaScript method used to create a shadow tree.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO12-2" id="callout_browser_agnostic_features_CO12-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>We locate the <a data-primary="shadow host" data-type="indexterm" id="idm45849728122544"/>shadow host element.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO12-3" id="callout_browser_agnostic_features_CO12-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>We get the <a data-primary="shadow root" data-type="indexterm" id="idm45849728118832"/><a data-primary="SearchContext interface" data-type="indexterm" id="idm45849728118096"/><a data-primary="findElement() method" data-type="indexterm" id="idm45849728072272"/><a data-primary="findElements() method" data-type="indexterm" id="idm45849728071744"/>shadow root from the host element. As a result, we get an instance <span class="keep-together">of <code>SearchContext</code></span>, an interface implemented by <code>WebDriver</code> and <code>WebElement</code>, that allows us to find elements using the methods <code>findElement()</code> and <code>find​Ele⁠ments()</code>.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO12-4" id="callout_browser_agnostic_features_CO12-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>We find the first paragraph element in the shadow tree.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO12-5" id="callout_browser_agnostic_features_CO12-5"><img alt="5" src="assets/5.png"/></a></dt>&#13;
<dd><p>We verify the text content of the shadow element is as expected.</p></dd>&#13;
</dl>&#13;
<div data-type="warning" epub:type="warning"><h6>Warning</h6>&#13;
<p>This feature of the <a data-primary="W3C specifications" data-secondary="WebDriver and" data-type="indexterm" id="idm45849728062464"/><a data-primary="drivers" data-secondary="versions of" data-type="indexterm" id="idm45849728061456"/>W3C WebDriver specification is recent at the time of this writing, and therefore might not be implemented in all drivers (e.g., chromedriver, geckodriver). For instance, it is available <a data-startref="ch4_term24" data-type="indexterm" id="idm45849728060384"/><a data-startref="ch4_term25" data-type="indexterm" id="idm45849728059712"/><a data-startref="ch4_term26" data-type="indexterm" id="idm45849728059040"/>starting with version 96 of both Chrome and Edge.</p>&#13;
</div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Cookies" data-type="sect1"><div class="sect1" id="idm45849728057984">&#13;
<h1>Cookies</h1>&#13;
&#13;
<p>HTTP 1.x is a stateless protocol, meaning that the server does not track the user state. In other words, web servers do not remember users across different requests. The <a data-primary="HTTP" data-secondary="cookies and" data-type="indexterm" id="idm45849728056320"/><a data-primary="browsers, interoperable features of" data-secondary="cookies" data-type="indexterm" id="ch4_term27"/><a data-primary="cookies, management of" data-type="indexterm" id="ch4_term28"/><a data-primary="tracking users" data-type="indexterm" id="ch4_term29"/>cookies mechanism is an extension to HTTP that allows tracking users by sending small pieces of text called <em>cookies</em> from server to client. These cookies must be sent back by clients, and this way, servers remember their clients. Cookies allow you to maintain web sessions or personalize the user experience on the website, among other functions.</p>&#13;
&#13;
<p>Web browsers allow managing the browser cookies manually. Selenium WebDriver enables an <a data-primary="automation of browsers" data-secondary="with cookies" data-secondary-sortas="cookies" data-type="indexterm" id="idm45849728050880"/>equivalent manipulation, but programmatically. The Selenium WebDriver API provides the methods shown in <a data-type="xref" href="#cookies-methods">Table 4-5</a> to accomplish this. They are <a data-primary="manage() method" data-type="indexterm" id="idm45849728048576"/>accessible through the <code>manage()</code> function of a <code>WebDriver</code> object.</p>&#13;
<table id="cookies-methods">&#13;
<caption><span class="label">Table 4-5. </span>Cookies management methods</caption>&#13;
<thead>&#13;
<tr>&#13;
<th>Method</th>&#13;
<th>Return</th>&#13;
<th>Description</th>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">addCookie</code><code class="o">(</code><code class="n">Cookie</code> <code class="n">cookie</code><code class="o">)</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kt">void</code></pre></div></td>&#13;
<td><p>Add a new cookie</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">deleteCookieNamed</code><code class="o">(</code><code class="n">String</code> <code class="n">name</code><code class="o">)</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kt">void</code></pre></div></td>&#13;
<td><p>Delete an existing cookie by name</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">deleteCookie</code><code class="o">(</code><code class="n">Cookie</code> <code class="n">cookie</code><code class="o">)</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kt">void</code></pre></div></td>&#13;
<td><p>Delete an existing cookie by instance</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">deleteAllCookies</code><code class="o">()</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kt">void</code></pre></div></td>&#13;
<td><p>Delete all cookies</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">getCookies</code><code class="o">()</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">Set</code><code class="o">&lt;</code><code class="n">Cookie</code><code class="o">&gt;</code></pre></div></td>&#13;
<td><p>Get all cookies</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">getCookieNamed</code><code class="o">(</code><code class="n">String</code> <code class="n">name</code><code class="o">)</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">Cookie</code></pre></div></td>&#13;
<td><p>Get a cookie by name</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
&#13;
<p>As this table <a data-primary="Cookie class and methods" data-type="indexterm" id="idm45849727801456"/>shows, the <code>Cookie</code> class provides an abstraction to a single cookie in Java. <a data-type="xref" href="#cookie-methods">Table 4-6</a> summarizes the methods available in this class. In addition, this class has several constructors, which positionally accept the following parameters:</p>&#13;
<dl>&#13;
<dt><code>String name</code></dt>&#13;
<dd>&#13;
<p>Cookie name (mandatory)</p>&#13;
</dd>&#13;
<dt><code>String value</code></dt>&#13;
<dd>&#13;
<p>Cookie value (mandatory)</p>&#13;
</dd>&#13;
<dt><code>String domain</code></dt>&#13;
<dd>&#13;
<p>Domain in which the cookie is visible (optional)</p>&#13;
</dd>&#13;
<dt><code>String path</code></dt>&#13;
<dd>&#13;
<p>Path in which the cookie is visible (optional)</p>&#13;
</dd>&#13;
<dt><code>Date expiry</code></dt>&#13;
<dd>&#13;
<p>Cookie expiration date (optional)</p>&#13;
</dd>&#13;
<dt><code>boolean isSecure</code></dt>&#13;
<dd>&#13;
<p>Whether the cookie requires a secure connection (optional)</p>&#13;
</dd>&#13;
<dt><code>boolean isHttpOnly</code></dt>&#13;
<dd>&#13;
<p>Whether this cookie is an HTTP-only cookie, i.e., the cookie is not accessible through a client-side script (optional)</p>&#13;
</dd>&#13;
<dt><code>String sameSite</code></dt>&#13;
<dd>&#13;
<p>Whether this cookie is a same-site cookie, i.e., the cookie is restricted to a first-party or same-site context (optional)</p>&#13;
</dd>&#13;
</dl>&#13;
<table class="pagebreak-before less_space" id="cookie-methods">&#13;
<caption><span class="label">Table 4-6. </span>Cookie methods</caption>&#13;
<thead>&#13;
<tr>&#13;
<th>Method</th>&#13;
<th>Return</th>&#13;
<th>Description</th>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">getName</code><code class="o">()</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">String</code></pre></div></td>&#13;
<td><p>Read cookie name</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">getValue</code><code class="o">()</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">String</code></pre></div></td>&#13;
<td><p>Read cookie value</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">getDomain</code><code class="o">()</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">String</code></pre></div></td>&#13;
<td><p>Read cookie domain</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">getPath</code><code class="o">()</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">String</code></pre></div></td>&#13;
<td><p>Read cookie path</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">isSecure</code><code class="o">()</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kt">boolean</code></pre></div></td>&#13;
<td><p>Read if cookie requires a secure connection</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">isHttpOnly</code><code class="o">()</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kt">boolean</code></pre></div></td>&#13;
<td><p>Read if cookie is HTTP-only</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">getExpiry</code><code class="o">()</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">Date</code></pre></div></td>&#13;
<td><p>Read cookie expiry date</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">getSameSite</code><code class="o">()</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">String</code></pre></div></td>&#13;
<td><p>Read cookie same-site context</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">validate</code><code class="o">()</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kt">void</code></pre></div></td>&#13;
<td><p>Check the different fields of the cookie and throw an <code>IllegalArgumen⁠t​Exception</code> if it encounters any problem</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">toJson</code><code class="o">()</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">Map</code><code class="o">&lt;</code><code class="n">String</code><code class="o">,</code> <code class="n">Object</code><code class="o">&gt;</code></pre></div></td>&#13;
<td><p>Map cookie values as a key-value map</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
&#13;
<p>The following examples show different tests managing web cookies with the Selenium WebDriver API. These examples use a practice web page that shows the site cookies on the GUI (see <a data-type="xref" href="#cookies">Figure 4-6</a>):</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p><a data-type="xref" href="#read-cookies">Example 4-15</a> illustrates how to read the existing cookies of a website.</p>&#13;
</li>&#13;
<li>&#13;
<p><a data-type="xref" href="#add-cookies">Example 4-16</a> shows how to add new cookies.</p>&#13;
</li>&#13;
<li>&#13;
<p><a data-type="xref" href="#edit-cookies">Example 4-17</a> explains how to edit existing cookies.</p>&#13;
</li>&#13;
<li>&#13;
<p><a data-type="xref" href="#delete-cookies">Example 4-18</a> demonstrates how to delete cookies.</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<figure><div class="figure" id="cookies">&#13;
<img alt="hosw 0406" src="assets/hosw_0406.png"/>&#13;
<h6><span class="label">Figure 4-6. </span>Practice web page for web cookies</h6>&#13;
</div></figure>&#13;
<div data-type="example" id="read-cookies">&#13;
<h5><span class="label">Example 4-15. </span>Test reading existing cookies</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="nd">@Test</code><code>&#13;
</code><code class="kt">void</code><code> </code><code class="nf">testReadCookies</code><code class="o">(</code><code class="o">)</code><code> </code><code class="o">{</code><code>&#13;
</code><code>    </code><code class="n">driver</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code>&#13;
</code><code>            </code><code class="s">"https://bonigarcia.dev/selenium-webdriver-java/cookies.html"</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">Options</code><code> </code><code class="n">options</code><code> </code><code class="o">=</code><code> </code><code class="n">driver</code><code class="o">.</code><code class="na">manage</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO13-1" id="co_browser_agnostic_features_CO13-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>    </code><code class="n">Set</code><code class="o">&lt;</code><code class="n">Cookie</code><code class="o">&gt;</code><code> </code><code class="n">cookies</code><code> </code><code class="o">=</code><code> </code><code class="n">options</code><code class="o">.</code><code class="na">getCookies</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO13-2" id="co_browser_agnostic_features_CO13-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>    </code><code class="n">assertThat</code><code class="o">(</code><code class="n">cookies</code><code class="o">)</code><code class="o">.</code><code class="na">hasSize</code><code class="o">(</code><code class="mi">2</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">Cookie</code><code> </code><code class="n">username</code><code> </code><code class="o">=</code><code> </code><code class="n">options</code><code class="o">.</code><code class="na">getCookieNamed</code><code class="o">(</code><code class="s">"username"</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO13-3" id="co_browser_agnostic_features_CO13-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>    </code><code class="n">assertThat</code><code class="o">(</code><code class="n">username</code><code class="o">.</code><code class="na">getValue</code><code class="o">(</code><code class="o">)</code><code class="o">)</code><code class="o">.</code><code class="na">isEqualTo</code><code class="o">(</code><code class="s">"John Doe"</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO13-4" id="co_browser_agnostic_features_CO13-4"><img alt="4" src="assets/4.png"/></a><code>&#13;
</code><code>    </code><code class="n">assertThat</code><code class="o">(</code><code class="n">username</code><code class="o">.</code><code class="na">getPath</code><code class="o">(</code><code class="o">)</code><code class="o">)</code><code class="o">.</code><code class="na">isEqualTo</code><code class="o">(</code><code class="s">"/"</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">driver</code><code class="o">.</code><code class="na">findElement</code><code class="o">(</code><code class="n">By</code><code class="o">.</code><code class="na">id</code><code class="o">(</code><code class="s">"refresh-cookies"</code><code class="o">)</code><code class="o">)</code><code class="o">.</code><code class="na">click</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO13-5" id="co_browser_agnostic_features_CO13-5"><img alt="5" src="assets/5.png"/></a><code>&#13;
</code><code class="o">}</code></pre></div>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO13-1" id="callout_browser_agnostic_features_CO13-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>We get the <code>Options</code> object used to manage cookies.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO13-2" id="callout_browser_agnostic_features_CO13-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>We read all the cookies available on this page. It should contain two cookies.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO13-3" id="callout_browser_agnostic_features_CO13-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>We read the cookie with the name <code>username</code>.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO13-4" id="callout_browser_agnostic_features_CO13-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>The value of the previous cookie should be <code>John Doe</code>.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO13-5" id="callout_browser_agnostic_features_CO13-5"><img alt="5" src="assets/5.png"/></a></dt>&#13;
<dd><p>The last statement does not affect the test. We invoke this command to check the cookies in the browser GUI.</p></dd>&#13;
</dl>&#13;
<div data-type="example" id="add-cookies">&#13;
<h5><span class="label">Example 4-16. </span>Test adding new cookies</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="nd">@Test</code><code>&#13;
</code><code class="kt">void</code><code> </code><code class="nf">testAddCookies</code><code class="o">(</code><code class="o">)</code><code> </code><code class="o">{</code><code>&#13;
</code><code>    </code><code class="n">driver</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code>&#13;
</code><code>            </code><code class="s">"https://bonigarcia.dev/selenium-webdriver-java/cookies.html"</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">Options</code><code> </code><code class="n">options</code><code> </code><code class="o">=</code><code> </code><code class="n">driver</code><code class="o">.</code><code class="na">manage</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="n">Cookie</code><code> </code><code class="n">newCookie</code><code> </code><code class="o">=</code><code> </code><code class="k">new</code><code> </code><code class="n">Cookie</code><code class="o">(</code><code class="s">"new-cookie-key"</code><code class="o">,</code><code> </code><code class="s">"new-cookie-value"</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO14-1" id="co_browser_agnostic_features_CO14-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>    </code><code class="n">options</code><code class="o">.</code><code class="na">addCookie</code><code class="o">(</code><code class="n">newCookie</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO14-2" id="co_browser_agnostic_features_CO14-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>    </code><code class="n">String</code><code> </code><code class="n">readValue</code><code> </code><code class="o">=</code><code> </code><code class="n">options</code><code class="o">.</code><code class="na">getCookieNamed</code><code class="o">(</code><code class="n">newCookie</code><code class="o">.</code><code class="na">getName</code><code class="o">(</code><code class="o">)</code><code class="o">)</code><code>&#13;
</code><code>            </code><code class="o">.</code><code class="na">getValue</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO14-3" id="co_browser_agnostic_features_CO14-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>    </code><code class="n">assertThat</code><code class="o">(</code><code class="n">newCookie</code><code class="o">.</code><code class="na">getValue</code><code class="o">(</code><code class="o">)</code><code class="o">)</code><code class="o">.</code><code class="na">isEqualTo</code><code class="o">(</code><code class="n">readValue</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO14-4" id="co_browser_agnostic_features_CO14-4"><img alt="4" src="assets/4.png"/></a><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">driver</code><code class="o">.</code><code class="na">findElement</code><code class="o">(</code><code class="n">By</code><code class="o">.</code><code class="na">id</code><code class="o">(</code><code class="s">"refresh-cookies"</code><code class="o">)</code><code class="o">)</code><code class="o">.</code><code class="na">click</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code class="o">}</code></pre></div>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO14-1" id="callout_browser_agnostic_features_CO14-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>We create a new cookie.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO14-2" id="callout_browser_agnostic_features_CO14-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>We add the cookie to the current page.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO14-3" id="callout_browser_agnostic_features_CO14-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>We read the value of the cookie just added.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO14-4" id="callout_browser_agnostic_features_CO14-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>We verify this value is as expected.</p></dd>&#13;
</dl>&#13;
<div data-type="example" id="edit-cookies">&#13;
<h5><span class="label">Example 4-17. </span>Test editing existing cookies</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="nd">@Test</code><code>&#13;
</code><code class="kt">void</code><code> </code><code class="nf">testEditCookie</code><code class="o">(</code><code class="o">)</code><code> </code><code class="o">{</code><code>&#13;
</code><code>    </code><code class="n">driver</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code>&#13;
</code><code>            </code><code class="s">"https://bonigarcia.dev/selenium-webdriver-java/cookies.html"</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">Options</code><code> </code><code class="n">options</code><code> </code><code class="o">=</code><code> </code><code class="n">driver</code><code class="o">.</code><code class="na">manage</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="n">Cookie</code><code> </code><code class="n">username</code><code> </code><code class="o">=</code><code> </code><code class="n">options</code><code class="o">.</code><code class="na">getCookieNamed</code><code class="o">(</code><code class="s">"username"</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO15-1" id="co_browser_agnostic_features_CO15-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>    </code><code class="n">Cookie</code><code> </code><code class="n">editedCookie</code><code> </code><code class="o">=</code><code> </code><code class="k">new</code><code> </code><code class="n">Cookie</code><code class="o">(</code><code class="n">username</code><code class="o">.</code><code class="na">getName</code><code class="o">(</code><code class="o">)</code><code class="o">,</code><code> </code><code class="s">"new-value"</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO15-2" id="co_browser_agnostic_features_CO15-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>    </code><code class="n">options</code><code class="o">.</code><code class="na">addCookie</code><code class="o">(</code><code class="n">editedCookie</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO15-3" id="co_browser_agnostic_features_CO15-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">Cookie</code><code> </code><code class="n">readCookie</code><code> </code><code class="o">=</code><code> </code><code class="n">options</code><code class="o">.</code><code class="na">getCookieNamed</code><code class="o">(</code><code class="n">username</code><code class="o">.</code><code class="na">getName</code><code class="o">(</code><code class="o">)</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO15-4" id="co_browser_agnostic_features_CO15-4"><img alt="4" src="assets/4.png"/></a><code>&#13;
</code><code>    </code><code class="n">assertThat</code><code class="o">(</code><code class="n">editedCookie</code><code class="o">)</code><code class="o">.</code><code class="na">isEqualTo</code><code class="o">(</code><code class="n">readCookie</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO15-5" id="co_browser_agnostic_features_CO15-5"><img alt="5" src="assets/5.png"/></a><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">driver</code><code class="o">.</code><code class="na">findElement</code><code class="o">(</code><code class="n">By</code><code class="o">.</code><code class="na">id</code><code class="o">(</code><code class="s">"refresh-cookies"</code><code class="o">)</code><code class="o">)</code><code class="o">.</code><code class="na">click</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code class="o">}</code></pre></div>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO15-1" id="callout_browser_agnostic_features_CO15-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>We read an existing cookie.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO15-2" id="callout_browser_agnostic_features_CO15-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>We create a new cookie reusing the previous cookie name.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO15-3" id="callout_browser_agnostic_features_CO15-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>We add the new cookie to the web page.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO15-4" id="callout_browser_agnostic_features_CO15-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>We read the cookie just added.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO15-5" id="callout_browser_agnostic_features_CO15-5"><img alt="5" src="assets/5.png"/></a></dt>&#13;
<dd><p>We verify the cookie has been correctly edited.</p></dd>&#13;
</dl>&#13;
<div data-type="example" id="delete-cookies">&#13;
<h5><span class="label">Example 4-18. </span>Test deleting existing cookies</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="nd">@Test</code><code>&#13;
</code><code class="kt">void</code><code> </code><code class="nf">testDeleteCookies</code><code class="o">(</code><code class="o">)</code><code> </code><code class="o">{</code><code>&#13;
</code><code>    </code><code class="n">driver</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code>&#13;
</code><code>            </code><code class="s">"https://bonigarcia.dev/selenium-webdriver-java/cookies.html"</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">Options</code><code> </code><code class="n">options</code><code> </code><code class="o">=</code><code> </code><code class="n">driver</code><code class="o">.</code><code class="na">manage</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="n">Set</code><code class="o">&lt;</code><code class="n">Cookie</code><code class="o">&gt;</code><code> </code><code class="n">cookies</code><code> </code><code class="o">=</code><code> </code><code class="n">options</code><code class="o">.</code><code class="na">getCookies</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO16-1" id="co_browser_agnostic_features_CO16-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>    </code><code class="n">Cookie</code><code> </code><code class="n">username</code><code> </code><code class="o">=</code><code> </code><code class="n">options</code><code class="o">.</code><code class="na">getCookieNamed</code><code class="o">(</code><code class="s">"username"</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO16-2" id="co_browser_agnostic_features_CO16-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>    </code><code class="n">options</code><code class="o">.</code><code class="na">deleteCookie</code><code class="o">(</code><code class="n">username</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO16-3" id="co_browser_agnostic_features_CO16-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">assertThat</code><code class="o">(</code><code class="n">options</code><code class="o">.</code><code class="na">getCookies</code><code class="o">(</code><code class="o">)</code><code class="o">)</code><code class="o">.</code><code class="na">hasSize</code><code class="o">(</code><code class="n">cookies</code><code class="o">.</code><code class="na">size</code><code class="o">(</code><code class="o">)</code><code> </code><code class="o">-</code><code> </code><code class="mi">1</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO16-4" id="co_browser_agnostic_features_CO16-4"><img alt="4" src="assets/4.png"/></a><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">driver</code><code class="o">.</code><code class="na">findElement</code><code class="o">(</code><code class="n">By</code><code class="o">.</code><code class="na">id</code><code class="o">(</code><code class="s">"refresh-cookies"</code><code class="o">)</code><code class="o">)</code><code class="o">.</code><code class="na">click</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code class="o">}</code></pre></div>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO16-1" id="callout_browser_agnostic_features_CO16-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>We read all cookies.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO16-2" id="callout_browser_agnostic_features_CO16-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>We read the cookie with the name <code>username</code>.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO16-3" id="callout_browser_agnostic_features_CO16-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>We delete the previous cookie.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO16-4" id="callout_browser_agnostic_features_CO16-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>We verify the size of the cookies is as <a data-startref="ch4_term27" data-type="indexterm" id="idm45849726691856"/><a data-startref="ch4_term28" data-type="indexterm" id="idm45849726641952"/><a data-startref="ch4_term29" data-type="indexterm" id="idm45849726641344"/>expected.</p></dd>&#13;
</dl>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Dropdown Lists" data-type="sect1"><div class="sect1" id="idm45849728057392">&#13;
<h1>Dropdown Lists</h1>&#13;
&#13;
<p>A typical element in <a data-primary="browsers, interoperable features of" data-secondary="dropdown lists" data-type="indexterm" id="ch4_term30"/><a data-primary="dropdown lists" data-type="indexterm" id="ch4_term31"/>web forms is dropdown lists. These fields allow users to select one or more elements within an option list. The <a data-primary="HTML" data-secondary="tags" data-type="indexterm" id="idm45849726636496"/>classical HTML tags used to render these fields are <code>&lt;select&gt;</code> and <code>&lt;options&gt;</code>. As usual, the practice web form contains one of these elements (see <a data-type="xref" href="#select">Figure 4-7</a>), defined in HTML as follows:</p>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">select</code> <code class="na">class</code><code class="o">=</code><code class="s">"form-select"</code> <code class="na">name</code><code class="o">=</code><code class="s">"my-select"</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">option</code> <code class="na">selected</code><code class="p">&gt;</code>Open this select menu<code class="p">&lt;/</code><code class="nt">option</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">option</code> <code class="na">value</code><code class="o">=</code><code class="s">"1"</code><code class="p">&gt;</code>One<code class="p">&lt;/</code><code class="nt">option</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">option</code> <code class="na">value</code><code class="o">=</code><code class="s">"2"</code><code class="p">&gt;</code>Two<code class="p">&lt;/</code><code class="nt">option</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">option</code> <code class="na">value</code><code class="o">=</code><code class="s">"3"</code><code class="p">&gt;</code>Three<code class="p">&lt;/</code><code class="nt">option</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">select</code><code class="p">&gt;</code></pre>&#13;
&#13;
<figure><div class="figure" id="select">&#13;
<img alt="hosw 0407" src="assets/hosw_0407.png"/>&#13;
<h6><span class="label">Figure 4-7. </span>Select field in the practice web form</h6>&#13;
</div></figure>&#13;
&#13;
<p>These elements are very spread out in web forms. For this reason, Selenium WebDriver provides a <a data-primary="Select class" data-type="indexterm" id="idm45849726609552"/>helper class called <code>Select</code> to simplify their manipulation. This class wraps a select <code>WebElement</code> and provides a wide variety of features. <a data-type="xref" href="#select-methods">Table 4-7</a> summarizes the <a data-primary="select methods" data-type="indexterm" id="idm45849726607056"/>public methods available in the <code>Select</code> class. After that, <a data-type="xref" href="#select_test">Example 4-19</a> shows a basic test using this class.</p>&#13;
<table id="select-methods">&#13;
<caption><span class="label">Table 4-7. </span>Select methods</caption>&#13;
<thead>&#13;
<tr>&#13;
<th>Method</th>&#13;
<th>Return</th>&#13;
<th>Description</th>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">Select</code><code class="o">(</code><code class="n">WebElement</code> <code class="n">element</code><code class="o">)</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">Select</code></pre></div></td>&#13;
<td><p>Constructor using a <code>WebElement</code> as parameter (it must be a <code>&lt;select&gt;</code> element); otherwise it throws an <code>UnexpectedTagNameException</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">getWrappedElement</code><code class="o">()</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">WebElement</code></pre></div></td>&#13;
<td><p>Get wrapped <code>WebElement</code> (i.e., the one used in the constructor)</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">isMultiple</code><code class="o">()</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kt">boolean</code></pre></div></td>&#13;
<td><p>Whether the select element supports selecting multiple options</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">getOptions</code><code class="o">()</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">List</code><code class="o">&lt;</code><code class="n">WebElement</code><code class="o">&gt;</code></pre></div></td>&#13;
<td><p>Read all options that belong to the select element</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">getAllSelectedOptions</code><code class="o">()</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">List</code><code class="o">&lt;</code><code class="n">WebElement</code><code class="o">&gt;</code></pre></div></td>&#13;
<td><p>Read all selected options</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">getFirstSelectedOption</code><code class="o">()</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">WebElement</code></pre></div></td>&#13;
<td><p>Read first <a data-primary="getFirstSelectedOption()" data-type="indexterm" id="idm45849726328720"/>selected option</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">selectByVisibleText</code><code class="o">(</code><code class="n">String</code> <code class="n">text</code><code class="o">)</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kt">void</code></pre></div></td>&#13;
<td><p>Select all options <a data-primary="selectByVisibleText() method" data-type="indexterm" id="idm45849726234832"/>that match a given displayed text</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">selectByIndex</code><code class="o">(</code><code class="kt">int</code> <code class="n">index</code><code class="o">)</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kt">void</code></pre></div></td>&#13;
<td><p>Select an option by index number</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">selectByValue</code><code class="o">(</code><code class="n">String</code> <code class="n">value</code><code class="o">)</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kt">void</code></pre></div></td>&#13;
<td><p>Select option(s) by value attribute</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">deselectAll</code><code class="o">()</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kt">void</code></pre></div></td>&#13;
<td><p>Deselect all options</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">deselectByValue</code><code class="o">(</code><code class="n">String</code> <code class="n">value</code><code class="o">)</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kt">void</code></pre></div></td>&#13;
<td><p>Deselect option(s) by value attribute</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">deselectByIndex</code><code class="o">(</code><code class="kt">int</code> <code class="n">index</code><code class="o">)</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kt">void</code></pre></div></td>&#13;
<td><p>Deselect by index number</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">deselectByVisibleText</code><code class="o">(</code><code class="n">String</code> <code class="n">text</code><code class="o">)</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kt">void</code></pre></div></td>&#13;
<td><p>Deselect options that match a given displayed text</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
<div data-type="example" id="select_test">&#13;
<h5><span class="label">Example 4-19. </span>Test interacting with a select field</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="nd">@Test</code><code>&#13;
</code><code class="kt">void</code><code> </code><code class="nf">test</code><code class="o">(</code><code class="o">)</code><code> </code><code class="o">{</code><code>&#13;
</code><code>    </code><code class="n">driver</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code>&#13;
</code><code>            </code><code class="s">"https://bonigarcia.dev/selenium-webdriver-java/web-form.html"</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">Select</code><code> </code><code class="n">select</code><code> </code><code class="o">=</code><code> </code><code class="k">new</code><code> </code><code class="n">Select</code><code class="o">(</code><code class="n">driver</code><code class="o">.</code><code class="na">findElement</code><code class="o">(</code><code class="n">By</code><code class="o">.</code><code class="na">name</code><code class="o">(</code><code class="s">"my-select"</code><code class="o">)</code><code class="o">)</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO17-1" id="co_browser_agnostic_features_CO17-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>    </code><code class="n">String</code><code> </code><code class="n">optionLabel</code><code> </code><code class="o">=</code><code> </code><code class="s">"Three"</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="n">select</code><code class="o">.</code><code class="na">selectByVisibleText</code><code class="o">(</code><code class="n">optionLabel</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO17-2" id="co_browser_agnostic_features_CO17-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">assertThat</code><code class="o">(</code><code class="n">select</code><code class="o">.</code><code class="na">getFirstSelectedOption</code><code class="o">(</code><code class="o">)</code><code class="o">.</code><code class="na">getText</code><code class="o">(</code><code class="o">)</code><code class="o">)</code><code>&#13;
</code><code>            </code><code class="o">.</code><code class="na">isEqualTo</code><code class="o">(</code><code class="n">optionLabel</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO17-3" id="co_browser_agnostic_features_CO17-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code class="o">}</code></pre></div>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO17-1" id="callout_browser_agnostic_features_CO17-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>We find the select element by name and use the resulting <code>WebElement</code> to instantiate a <code>Select</code> object.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO17-2" id="callout_browser_agnostic_features_CO17-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>We select one of the options available in this select, using a by-text strategy.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO17-3" id="callout_browser_agnostic_features_CO17-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>We verify the selected option text is as expected.</p></dd>&#13;
</dl>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Data List Elements" data-type="sect2"><div class="sect2" id="idm45849725878912">&#13;
<h2>Data List Elements</h2>&#13;
&#13;
<p>Another way to implement <a data-primary="data list elements" data-type="indexterm" id="ch4_term32"/>dropdown lists in HTML is using <em>data lists</em>. Although <a data-primary="select elements versus data lists" data-type="indexterm" id="idm45849725834192"/>data lists are very similar to select elements from a graphical point of view, there is a clear distinction between them. On the one hand, select fields display an options list, and users choose one (or several) of the available options. On the other hand, data lists show a list of suggested options associated with an input form (text) field, and users are free to select one of those suggested values or type a custom value. The practice web form contains one of these data lists. You can find its markup in the following snippet and a screenshot in <a data-type="xref" href="#datalist">Figure 4-8</a>.</p>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">input</code> <code class="na">class</code><code class="o">=</code><code class="s">"form-control"</code> <code class="na">list</code><code class="o">=</code><code class="s">"my-options"</code> <code class="na">name</code><code class="o">=</code><code class="s">"my-datalist"</code>&#13;
        <code class="na">placeholder</code><code class="o">=</code><code class="s">"Type to search..."</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">datalist</code> <code class="na">id</code><code class="o">=</code><code class="s">"my-options"</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">option</code> <code class="na">value</code><code class="o">=</code><code class="s">"San Francisco"</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">option</code> <code class="na">value</code><code class="o">=</code><code class="s">"New York"</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">option</code> <code class="na">value</code><code class="o">=</code><code class="s">"Seattle"</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">option</code> <code class="na">value</code><code class="o">=</code><code class="s">"Los Angeles"</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">option</code> <code class="na">value</code><code class="o">=</code><code class="s">"Chicago"</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">datalist</code><code class="p">&gt;</code></pre>&#13;
&#13;
<figure><div class="figure" id="datalist">&#13;
<img alt="hosw 0408" src="assets/hosw_0408.png"/>&#13;
<h6><span class="label">Figure 4-8. </span>Data list field in the practice web form</h6>&#13;
</div></figure>&#13;
&#13;
<p>Selenium WebDriver does not provide a custom helper class to manipulate data lists. Instead, we need to <a data-primary="input elements/data" data-type="indexterm" id="idm45849725798208"/>interact with them as standard input texts, with the distinction that their options are displayed when clicking on the input field. <a data-type="xref" href="#datalist_test">Example 4-20</a> shows a test illustrating this.</p>&#13;
<div data-type="example" id="datalist_test">&#13;
<h5><span class="label">Example 4-20. </span>Test interacting with a data list field</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="nd">@Test</code><code>&#13;
</code><code class="kt">void</code><code> </code><code class="nf">testDatalist</code><code class="o">(</code><code class="o">)</code><code> </code><code class="o">{</code><code>&#13;
</code><code>    </code><code class="n">driver</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code>&#13;
</code><code>            </code><code class="s">"https://bonigarcia.dev/selenium-webdriver-java/web-form.html"</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">WebElement</code><code> </code><code class="n">datalist</code><code> </code><code class="o">=</code><code> </code><code class="n">driver</code><code class="o">.</code><code class="na">findElement</code><code class="o">(</code><code class="n">By</code><code class="o">.</code><code class="na">name</code><code class="o">(</code><code class="s">"my-datalist"</code><code class="o">)</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO18-1" id="co_browser_agnostic_features_CO18-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>    </code><code class="n">datalist</code><code class="o">.</code><code class="na">click</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO18-2" id="co_browser_agnostic_features_CO18-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">WebElement</code><code> </code><code class="n">option</code><code> </code><code class="o">=</code><code> </code><code class="n">driver</code><code>&#13;
</code><code>            </code><code class="o">.</code><code class="na">findElement</code><code class="o">(</code><code class="n">By</code><code class="o">.</code><code class="na">xpath</code><code class="o">(</code><code class="s">"//datalist/option[2]"</code><code class="o">)</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO18-3" id="co_browser_agnostic_features_CO18-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>    </code><code class="n">String</code><code> </code><code class="n">optionValue</code><code> </code><code class="o">=</code><code> </code><code class="n">option</code><code class="o">.</code><code class="na">getAttribute</code><code class="o">(</code><code class="s">"value"</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO18-4" id="co_browser_agnostic_features_CO18-4"><img alt="4" src="assets/4.png"/></a><code>&#13;
</code><code>    </code><code class="n">datalist</code><code class="o">.</code><code class="na">sendKeys</code><code class="o">(</code><code class="n">optionValue</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO18-5" id="co_browser_agnostic_features_CO18-5"><img alt="5" src="assets/5.png"/></a><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">assertThat</code><code class="o">(</code><code class="n">optionValue</code><code class="o">)</code><code class="o">.</code><code class="na">isEqualTo</code><code class="o">(</code><code class="s">"New York"</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO18-6" id="co_browser_agnostic_features_CO18-6"><img alt="6" src="assets/6.png"/></a><code>&#13;
</code><code class="o">}</code></pre></div>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO18-1" id="callout_browser_agnostic_features_CO18-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>We locate the input field used for the data list.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO18-2" id="callout_browser_agnostic_features_CO18-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>We click on it to display its options.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO18-3" id="callout_browser_agnostic_features_CO18-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>We find the <a data-primary="findElement() method" data-type="indexterm" id="idm45849725639264"/>second option.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO18-4" id="callout_browser_agnostic_features_CO18-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>We read the value of the located option.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO18-5" id="callout_browser_agnostic_features_CO18-5"><img alt="5" src="assets/5.png"/></a></dt>&#13;
<dd><p>We type that <a data-primary="sendKeys() method" data-type="indexterm" id="idm45849725584368"/>value in the input field.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO18-6" id="callout_browser_agnostic_features_CO18-6"><img alt="6" src="assets/6.png"/></a></dt>&#13;
<dd><p>We assert the option value is as <a data-startref="ch4_term30" data-type="indexterm" id="idm45849725580928"/><a data-startref="ch4_term31" data-type="indexterm" id="idm45849725580224"/><a data-startref="ch4_term32" data-type="indexterm" id="idm45849725579552"/>expected.</p></dd>&#13;
</dl>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Navigation Targets" data-type="sect1"><div class="sect1" id="idm45849725624224">&#13;
<h1>Navigation Targets</h1>&#13;
&#13;
<p>When navigating web pages using a browser, by default, we use a single page corresponding to the URL in the navigation bar. Then, we <a data-primary="browsers, interoperable features of" data-secondary="navigation targets" data-type="indexterm" id="ch4_term33"/><a data-primary="navigation targets" data-type="indexterm" id="ch4_term34"/><a data-primary="tabs, navigating web pages with" data-type="indexterm" id="idm45849725574800"/>can open another page in a new browser tab. This second tab can be explicitly opened when a link defines the attribute <code>target</code>, or the user can force navigation to a new tab, typically by using the modifier key Ctrl (or Cmd in macOS) together with the mouse click into a web link. Another possibility is <a data-primary="window.open(url) command" data-type="indexterm" id="idm45849725573520"/><a data-primary="windows, navigating web pages with" data-type="indexterm" id="idm45849725572800"/>opening web pages in new windows. For this, web pages typically use the JavaScript command <code>window.open(url)</code>. Another way of <a data-primary="frames, navigating web pages with" data-type="indexterm" id="idm45849725571488"/><a data-primary="HTML" data-secondary="frames and iframes in" data-type="indexterm" id="idm45849725570736"/><a data-primary="iframes, navigating web pages with" data-type="indexterm" id="idm45849725569792"/>displaying different pages at the same time is using <em>frames</em> and <em>iframes</em>. A frame is an HTML element type that defines a particular area (into a set called <em>frameset</em>) where a web page can be displayed. An iframe is another HTML element that allows embedding an HTML page into the current one.</p>&#13;
<div data-type="warning" epub:type="warning"><h6>Warning</h6>&#13;
<p>Using frames is not encouraged since these elements have many drawbacks, such as performance and accessibility problems. I explain how to use them through Selenium WebDriver for compatibility reasons. Nevertheless, I strongly recommend avoiding frames on brand-new web applications.</p>&#13;
</div>&#13;
&#13;
<p>The Selenium WebDriver API <a data-primary="TargetLocator interface and methods" data-type="indexterm" id="idm45849725566272"/>provides the interface <code>TargetLocator</code> to deal with the previously mentioned targets (i.e., tabs, windows, frames, and iframes). This interface allows changing the focus of the future commands of a <code>WebDriver</code> object (to a new tab, windows, etc.). This interface is accessible by invoking the <a data-primary="switchTo() method" data-type="indexterm" id="ch4_term35"/>method <code>switchTo()</code> in a <code>WebDriver</code> object.&#13;
<a data-type="xref" href="#targetlocator-methods">Table 4-8</a> describes its public methods.</p>&#13;
<table id="targetlocator-methods">&#13;
<caption><span class="label">Table 4-8. </span>TargetLocator methods</caption>&#13;
<thead>&#13;
<tr>&#13;
<th>Method</th>&#13;
<th>Return</th>&#13;
<th>Description</th>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">frame</code><code class="o">(</code><code class="kt">int</code> <code class="n">index</code><code class="o">)</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">WebDriver</code></pre></div></td>&#13;
<td><p>Change focus to a <a data-primary="frame() method" data-type="indexterm" id="idm45849725522752"/>frame (or iframe) by index number.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">frame</code><code class="o">(</code><code class="n">String</code>&#13;
    <code class="n">nameOrId</code><code class="o">)</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">WebDriver</code></pre></div></td>&#13;
<td><p>Change focus to a frame (or iframe) by name or id.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">frame</code><code class="o">(</code><code class="n">WebElement</code>&#13;
    <code class="n">frameElement</code><code class="o">)</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">WebDriver</code></pre></div></td>&#13;
<td><p>Change focus to a frame (or iframe) previously located as a WebElement.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">parentFrame</code><code class="o">()</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">WebDriver</code></pre></div></td>&#13;
<td><p>Change focus to the parent context.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">window</code><code class="o">(</code><code class="n">String</code>&#13;
    <code class="n">nameOrHandle</code><code class="o">)</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">WebDriver</code></pre></div></td>&#13;
<td><p>Switch the focus to <a data-primary="window() method" data-type="indexterm" id="idm45849725356016"/>another window, by name or <em>handle</em>. A window handle is a hexadecimal string that univocally identifies a window or tab.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">newWindow</code><code class="o">(</code><code class="n">WindowType</code>&#13;
    <code class="n">typeHint</code><code class="o">)</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">WebDriver</code></pre></div></td>&#13;
<td><p>Creates a new <a data-primary="newWindow() method" data-type="indexterm" id="idm45849725288368"/>browser window (using <code>WindowType.WINDOW</code>) or tab (<span class="keep-together"><code>WindowType.TAB</code></span>) and switches the focus to it.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">defaultContent</code><code class="o">()</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">WebDriver</code></pre></div></td>&#13;
<td><p>Select the main document (when using iframes) or the first frame on the page (when using a frameset).</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">activeElement</code><code class="o">()</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">WebElement</code></pre></div></td>&#13;
<td><p>Get the element currently selected.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">alert</code><code class="o">()</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">Alert</code></pre></div></td>&#13;
<td><p>Change focus to a window alert (see <a data-type="xref" href="#dialog_boxes_sect">“Dialog Boxes”</a> for further details).</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Tabs and Windows" data-type="sect2"><div class="sect2" id="tabs-and-windows">&#13;
<h2>Tabs and Windows</h2>&#13;
&#13;
<p><a data-type="xref" href="#tabs_example">Example 4-21</a> shows a test where we <a data-primary="tabs, navigating web pages with" data-type="indexterm" id="idm45849725195328"/><a data-primary="windows, navigating web pages with" data-type="indexterm" id="ch4_term36"/><a data-primary="WindowType parameter" data-type="indexterm" id="ch4_term37"/>open a new tab for navigating a second web page. <a data-type="xref" href="#window_example">Example 4-22</a> shows an equivalent case but for opening a new window for the second web page. Notice that the difference between these examples is only the parameter <code>WindowType.TAB</code> and <code>WindowType.WINDOW</code>.</p>&#13;
<div data-type="example" id="tabs_example">&#13;
<h5><span class="label">Example 4-21. </span>Test opening a new tab</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="nd">@Test</code><code>&#13;
</code><code class="kt">void</code><code> </code><code class="nf">testNewTab</code><code class="o">(</code><code class="o">)</code><code> </code><code class="o">{</code><code>&#13;
</code><code>    </code><code class="n">driver</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code class="s">"https://bonigarcia.dev/selenium-webdriver-java/"</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO19-1" id="co_browser_agnostic_features_CO19-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>    </code><code class="n">String</code><code> </code><code class="n">initHandle</code><code> </code><code class="o">=</code><code> </code><code class="n">driver</code><code class="o">.</code><code class="na">getWindowHandle</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO19-2" id="co_browser_agnostic_features_CO19-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">driver</code><code class="o">.</code><code class="na">switchTo</code><code class="o">(</code><code class="o">)</code><code class="o">.</code><code class="na">newWindow</code><code class="o">(</code><code class="n">WindowType</code><code class="o">.</code><code class="na">TAB</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO19-3" id="co_browser_agnostic_features_CO19-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>    </code><code class="n">driver</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code>&#13;
</code><code>            </code><code class="s">"https://bonigarcia.dev/selenium-webdriver-java/web-form.html"</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO19-4" id="co_browser_agnostic_features_CO19-4"><img alt="4" src="assets/4.png"/></a><code>&#13;
</code><code>    </code><code class="n">assertThat</code><code class="o">(</code><code class="n">driver</code><code class="o">.</code><code class="na">getWindowHandles</code><code class="o">(</code><code class="o">)</code><code class="o">.</code><code class="na">size</code><code class="o">(</code><code class="o">)</code><code class="o">)</code><code class="o">.</code><code class="na">isEqualTo</code><code class="o">(</code><code class="mi">2</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO19-5" id="co_browser_agnostic_features_CO19-5"><img alt="5" src="assets/5.png"/></a><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">driver</code><code class="o">.</code><code class="na">switchTo</code><code class="o">(</code><code class="o">)</code><code class="o">.</code><code class="na">window</code><code class="o">(</code><code class="n">initHandle</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO19-6" id="co_browser_agnostic_features_CO19-6"><img alt="6" src="assets/6.png"/></a><code>&#13;
</code><code>    </code><code class="n">driver</code><code class="o">.</code><code class="na">close</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO19-7" id="co_browser_agnostic_features_CO19-7"><img alt="7" src="assets/7.png"/></a><code>&#13;
</code><code>    </code><code class="n">assertThat</code><code class="o">(</code><code class="n">driver</code><code class="o">.</code><code class="na">getWindowHandles</code><code class="o">(</code><code class="o">)</code><code class="o">.</code><code class="na">size</code><code class="o">(</code><code class="o">)</code><code class="o">)</code><code class="o">.</code><code class="na">isEqualTo</code><code class="o">(</code><code class="mi">1</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO19-8" id="co_browser_agnostic_features_CO19-8"><img alt="8" src="assets/8.png"/></a><code>&#13;
</code><code class="o">}</code></pre></div>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO19-1" id="callout_browser_agnostic_features_CO19-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>We navigate to a web page.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO19-2" id="callout_browser_agnostic_features_CO19-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>We get the current window handle.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO19-3" id="callout_browser_agnostic_features_CO19-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>We open a new tab and <a data-primary="newWindow() method" data-type="indexterm" id="idm45849725005872"/>change the focus to it.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO19-4" id="callout_browser_agnostic_features_CO19-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>We open another web page (since the focus is in the second tab, the page is opened in the second tab).</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO19-5" id="callout_browser_agnostic_features_CO19-5"><img alt="5" src="assets/5.png"/></a></dt>&#13;
<dd><p>We verify that the number of window handles at this point is 2.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO19-6" id="callout_browser_agnostic_features_CO19-6"><img alt="6" src="assets/6.png"/></a></dt>&#13;
<dd><p>We change the <a data-primary="window() method" data-type="indexterm" id="idm45849724940512"/>focus to the initial window (using its handle).</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO19-7" id="callout_browser_agnostic_features_CO19-7"><img alt="7" src="assets/7.png"/></a></dt>&#13;
<dd><p>We close only the current window. The second tab remains open.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO19-8" id="callout_browser_agnostic_features_CO19-8"><img alt="8" src="assets/8.png"/></a></dt>&#13;
<dd><p>We verify that the number of window handles now is 1.</p></dd>&#13;
</dl>&#13;
<div data-type="example" id="window_example">&#13;
<h5><span class="label">Example 4-22. </span>Test opening a new window</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="nd">@Test</code><code>&#13;
</code><code class="kt">void</code><code> </code><code class="nf">testNewWindow</code><code class="o">(</code><code class="o">)</code><code> </code><code class="o">{</code><code>&#13;
</code><code>    </code><code class="n">driver</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code class="s">"https://bonigarcia.dev/selenium-webdriver-java/"</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="n">String</code><code> </code><code class="n">initHandle</code><code> </code><code class="o">=</code><code> </code><code class="n">driver</code><code class="o">.</code><code class="na">getWindowHandle</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">driver</code><code class="o">.</code><code class="na">switchTo</code><code class="o">(</code><code class="o">)</code><code class="o">.</code><code class="na">newWindow</code><code class="o">(</code><code class="n">WindowType</code><code class="o">.</code><code class="na">WINDOW</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO20-1" id="co_browser_agnostic_features_CO20-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>    </code><code class="n">driver</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code>&#13;
</code><code>            </code><code class="s">"https://bonigarcia.dev/selenium-webdriver-java/web-form.html"</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="n">assertThat</code><code class="o">(</code><code class="n">driver</code><code class="o">.</code><code class="na">getWindowHandles</code><code class="o">(</code><code class="o">)</code><code class="o">.</code><code class="na">size</code><code class="o">(</code><code class="o">)</code><code class="o">)</code><code class="o">.</code><code class="na">isEqualTo</code><code class="o">(</code><code class="mi">2</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">driver</code><code class="o">.</code><code class="na">switchTo</code><code class="o">(</code><code class="o">)</code><code class="o">.</code><code class="na">window</code><code class="o">(</code><code class="n">initHandle</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="n">driver</code><code class="o">.</code><code class="na">close</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="n">assertThat</code><code class="o">(</code><code class="n">driver</code><code class="o">.</code><code class="na">getWindowHandles</code><code class="o">(</code><code class="o">)</code><code class="o">.</code><code class="na">size</code><code class="o">(</code><code class="o">)</code><code class="o">)</code><code class="o">.</code><code class="na">isEqualTo</code><code class="o">(</code><code class="mi">1</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code class="o">}</code></pre></div>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO20-1" id="callout_browser_agnostic_features_CO20-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>This line is different in the examples. In this case, we open a new window (instead of a tab) and focus <a data-startref="ch4_term35" data-type="indexterm" id="idm45849724816752"/><a data-startref="ch4_term36" data-type="indexterm" id="idm45849724836896"/><a data-startref="ch4_term37" data-type="indexterm" id="idm45849724836224"/>on it.</p></dd>&#13;
</dl>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Frames and Iframes" data-type="sect2"><div class="sect2" id="idm45849724835168">&#13;
<h2>Frames and Iframes</h2>&#13;
&#13;
<p><a data-type="xref" href="#iframe_example">Example 4-23</a> shows a test in which the web page under test contains an iframe. <a data-type="xref" href="#frame_example">Example 4-24</a> shows the <a data-primary="iframes, navigating web pages with" data-type="indexterm" id="idm45849724832128"/>equivalent case but using a frameset.</p>&#13;
<div data-type="example" id="iframe_example">&#13;
<h5><span class="label">Example 4-23. </span>Test handling iframes</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="nd">@Test</code><code>&#13;
</code><code class="kt">void</code><code> </code><code class="nf">testIFrames</code><code class="o">(</code><code class="o">)</code><code> </code><code class="o">{</code><code>&#13;
</code><code>    </code><code class="n">driver</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code>&#13;
</code><code>            </code><code class="s">"https://bonigarcia.dev/selenium-webdriver-java/iframes.html"</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO21-1" id="co_browser_agnostic_features_CO21-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">WebDriverWait</code><code> </code><code class="n">wait</code><code> </code><code class="o">=</code><code> </code><code class="k">new</code><code> </code><code class="n">WebDriverWait</code><code class="o">(</code><code class="n">driver</code><code class="o">,</code><code> </code><code class="n">Duration</code><code class="o">.</code><code class="na">ofSeconds</code><code class="o">(</code><code class="mi">10</code><code class="o">)</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="n">wait</code><code class="o">.</code><code class="na">until</code><code class="o">(</code><code class="n">ExpectedConditions</code><code>&#13;
</code><code>            </code><code class="o">.</code><code class="na">frameToBeAvailableAndSwitchToIt</code><code class="o">(</code><code class="s">"my-iframe"</code><code class="o">)</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO21-2" id="co_browser_agnostic_features_CO21-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">By</code><code> </code><code class="n">pName</code><code> </code><code class="o">=</code><code> </code><code class="n">By</code><code class="o">.</code><code class="na">tagName</code><code class="o">(</code><code class="s">"p"</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="n">wait</code><code class="o">.</code><code class="na">until</code><code class="o">(</code><code class="n">ExpectedConditions</code><code class="o">.</code><code class="na">numberOfElementsToBeMoreThan</code><code class="o">(</code><code class="n">pName</code><code class="o">,</code><code> </code><code class="mi">0</code><code class="o">)</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO21-3" id="co_browser_agnostic_features_CO21-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>    </code><code class="n">List</code><code class="o">&lt;</code><code class="n">WebElement</code><code class="o">&gt;</code><code> </code><code class="n">paragraphs</code><code> </code><code class="o">=</code><code> </code><code class="n">driver</code><code class="o">.</code><code class="na">findElements</code><code class="o">(</code><code class="n">pName</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="n">assertThat</code><code class="o">(</code><code class="n">paragraphs</code><code class="o">)</code><code class="o">.</code><code class="na">hasSize</code><code class="o">(</code><code class="mi">20</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO21-4" id="co_browser_agnostic_features_CO21-4"><img alt="4" src="assets/4.png"/></a><code>&#13;
</code><code class="o">}</code></pre></div>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO21-1" id="callout_browser_agnostic_features_CO21-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>We open a web page that contains an iframe (see <a data-type="xref" href="#iframes">Figure 4-9</a>).</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO21-2" id="callout_browser_agnostic_features_CO21-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>We use an <a data-primary="explicit waits" data-type="indexterm" id="idm45849724677520"/>explicit wait for waiting for the frame and switching to it.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO21-3" id="callout_browser_agnostic_features_CO21-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>We use another explicit wait to pause until the paragraphs contained in the iframe are available.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO21-4" id="callout_browser_agnostic_features_CO21-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>We assert the number of paragraphs is as expected.</p></dd>&#13;
</dl>&#13;
&#13;
<figure><div class="figure" id="iframes">&#13;
<img alt="hosw 0409" src="assets/hosw_0409.png"/>&#13;
<h6><span class="label">Figure 4-9. </span>Practice web page using an iframe</h6>&#13;
</div></figure>&#13;
<div data-type="example" id="frame_example">&#13;
<h5><span class="label">Example 4-24. </span>Test handling frames</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="nd">@Test</code><code>&#13;
</code><code class="kt">void</code><code> </code><code class="nf">testFrames</code><code class="o">(</code><code class="o">)</code><code> </code><code class="o">{</code><code>&#13;
</code><code>    </code><code class="n">driver</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code>&#13;
</code><code>            </code><code class="s">"https://bonigarcia.dev/selenium-webdriver-java/frames.html"</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO22-1" id="co_browser_agnostic_features_CO22-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">WebDriverWait</code><code> </code><code class="n">wait</code><code> </code><code class="o">=</code><code> </code><code class="k">new</code><code> </code><code class="n">WebDriverWait</code><code class="o">(</code><code class="n">driver</code><code class="o">,</code><code> </code><code class="n">Duration</code><code class="o">.</code><code class="na">ofSeconds</code><code class="o">(</code><code class="mi">10</code><code class="o">)</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="n">String</code><code> </code><code class="n">frameName</code><code> </code><code class="o">=</code><code> </code><code class="s">"frame-body"</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="n">wait</code><code class="o">.</code><code class="na">until</code><code class="o">(</code><code class="n">ExpectedConditions</code><code>&#13;
</code><code>            </code><code class="o">.</code><code class="na">presenceOfElementLocated</code><code class="o">(</code><code class="n">By</code><code class="o">.</code><code class="na">name</code><code class="o">(</code><code class="n">frameName</code><code class="o">)</code><code class="o">)</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO22-2" id="co_browser_agnostic_features_CO22-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>    </code><code class="n">driver</code><code class="o">.</code><code class="na">switchTo</code><code class="o">(</code><code class="o">)</code><code class="o">.</code><code class="na">frame</code><code class="o">(</code><code class="n">frameName</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO22-3" id="co_browser_agnostic_features_CO22-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">By</code><code> </code><code class="n">pName</code><code> </code><code class="o">=</code><code> </code><code class="n">By</code><code class="o">.</code><code class="na">tagName</code><code class="o">(</code><code class="s">"p"</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="n">wait</code><code class="o">.</code><code class="na">until</code><code class="o">(</code><code class="n">ExpectedConditions</code><code class="o">.</code><code class="na">numberOfElementsToBeMoreThan</code><code class="o">(</code><code class="n">pName</code><code class="o">,</code><code> </code><code class="mi">0</code><code class="o">)</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="n">List</code><code class="o">&lt;</code><code class="n">WebElement</code><code class="o">&gt;</code><code> </code><code class="n">paragraphs</code><code> </code><code class="o">=</code><code> </code><code class="n">driver</code><code class="o">.</code><code class="na">findElements</code><code class="o">(</code><code class="n">pName</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="n">assertThat</code><code class="o">(</code><code class="n">paragraphs</code><code class="o">)</code><code class="o">.</code><code class="na">hasSize</code><code class="o">(</code><code class="mi">20</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code class="o">}</code></pre></div>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO22-1" id="callout_browser_agnostic_features_CO22-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>We open a <a data-primary="frames, navigating web pages with" data-type="indexterm" id="idm45849724474144"/>web page that contains a frameset (see <a data-type="xref" href="#frames">Figure 4-10</a>).</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO22-2" id="callout_browser_agnostic_features_CO22-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>We wait for the <a data-primary="frame() method" data-type="indexterm" id="idm45849724494592"/>frame to be available. Note that steps 2 and 3 in <a data-type="xref" href="#iframe_example">Example 4-23</a> are equivalent to this step.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO22-3" id="callout_browser_agnostic_features_CO22-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>We change the focus to this frame.</p></dd>&#13;
</dl>&#13;
&#13;
<figure><div class="figure" id="frames">&#13;
<img alt="hosw 0410" src="assets/hosw_0410.png"/>&#13;
<h6><span class="label">Figure 4-10. </span>Practice web page using frames</h6>&#13;
</div></figure>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Dialog Boxes" data-type="sect1"><div class="sect1" id="dialog_boxes_sect">&#13;
<h1>Dialog Boxes</h1>&#13;
&#13;
<p>JavaScript provides <a data-startref="ch4_term33" data-type="indexterm" id="idm45849724432352"/><a data-startref="ch4_term34" data-type="indexterm" id="idm45849724431616"/><a data-primary="pop-ups (dialog boxes)" data-type="indexterm" id="idm45849724430944"/><a data-primary="browsers, interoperable features of" data-secondary="dialog boxes" data-type="indexterm" id="ch4_term39"/><a data-primary="dialog boxes" data-type="indexterm" id="ch4_term40"/>different dialog boxes (sometimes called <em>pop-ups</em>) to interact with the user, namely:</p>&#13;
<dl>&#13;
<dt>Alert</dt>&#13;
<dd>&#13;
<p>To show a <a data-primary="alert dialog boxes" data-type="indexterm" id="ch4_term38"/>message and wait for the user to press the button OK (only choice in the dialog). For instance, the following code will open a dialog that displays “Hello world!” and waits for the user to press the OK button.</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="nx">alert</code><code class="p">(</code><code class="s2">"Hello world!"</code><code class="p">);</code></pre>&#13;
</dd>&#13;
<dt>Confirm</dt>&#13;
<dd>&#13;
<p>To show a <a data-primary="confirm dialog boxes" data-type="indexterm" id="idm45849724421760"/>dialog box with a question and two buttons: OK and Cancel. For instance, the following code will open a dialog showing the message “Is this correct?” and prompting the user to click on OK or Cancel.</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kd">let</code> <code class="nx">correct</code> <code class="o">=</code> <code class="nx">confirm</code><code class="p">(</code><code class="s2">"Is this correct?"</code><code class="p">);</code></pre>&#13;
</dd>&#13;
<dt>Prompt</dt>&#13;
<dd>&#13;
<p>To show a <a data-primary="prompt dialog boxes" data-type="indexterm" id="idm45849724396384"/>dialog box with a text message, an input text field, and the buttons OK and Cancel. For example, the following code shows a pop-up displaying “Please enter your name,” a dialog box in which the user can type, and two buttons (OK and Cancel).</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kd">let</code> <code class="nx">username</code> <code class="o">=</code> <code class="nx">prompt</code><code class="p">(</code><code class="s2">"Please enter your name"</code><code class="p">);</code></pre>&#13;
</dd>&#13;
</dl>&#13;
&#13;
<p>In addition, CSS allows implementing <a data-primary="CSS" data-secondary="modal window dialog boxes" data-type="indexterm" id="idm45849724381776"/><a data-primary="modal window dialog boxes" data-type="indexterm" id="idm45849724380928"/>another type of dialog box called <em>modal window</em>. This dialog disables the main window (but keeps it visible) while overlaying a child pop-up, typically showing a message and some buttons. You can find a sample page on the practice web page containing all these dialog boxes (alert, confirm, prompt, and modal). <a data-type="xref" href="#dialog-boxes">Figure 4-11</a> shows a screenshot of this page when the modal dialog is active.</p>&#13;
&#13;
<figure><div class="figure" id="dialog-boxes">&#13;
<img alt="hosw 0411" src="assets/hosw_0411.png"/>&#13;
<h6><span class="label">Figure 4-11. </span>Practice web page with dialog boxes (alert, confirm, prompt, and modal)</h6>&#13;
</div></figure>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Alerts, Confirms, and Prompts" data-type="sect2"><div class="sect2" id="idm45849724328992">&#13;
<h2>Alerts, Confirms, and Prompts</h2>&#13;
&#13;
<p>The Selenium WebDriver API <a data-primary="Alert interface and methods" data-type="indexterm" id="idm45849724327296"/>provides the interface <code>Alert</code> to manipulate JavaScript dialogs (i.e., alerts, confirms, and prompts). <a data-type="xref" href="#alert-methods">Table 4-9</a> describes the methods provided by this interface. Then, <a data-type="xref" href="#alert_example">Example 4-25</a> shows a basic test interacting with an alert.</p>&#13;
<table id="alert-methods">&#13;
<caption><span class="label">Table 4-9. </span>Alert methods</caption>&#13;
<thead>&#13;
<tr>&#13;
<th>Method</th>&#13;
<th>Return</th>&#13;
<th>Description</th>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">accept</code><code class="o">()</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kt">void</code></pre></div></td>&#13;
<td><p>To <a data-primary="accept() method" data-type="indexterm" id="idm45849724263632"/>click OK</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">getText</code><code class="o">()</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">String</code></pre></div></td>&#13;
<td><p>To read the <a data-primary="getText() method" data-type="indexterm" id="idm45849724295920"/>dialog message</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">dismiss</code><code class="o">()</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kt">void</code></pre></div></td>&#13;
<td><p>To click Cancel (not <a data-primary="dismiss() method" data-type="indexterm" id="idm45849724177728"/>available in alerts)</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">sendKeys</code><code class="o">(</code><code class="n">String</code> <code class="n">text</code><code class="o">)</code></pre></div></td>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kt">void</code></pre></div></td>&#13;
<td><p>To type some <a data-primary="sendKeys() method" data-type="indexterm" id="idm45849724152848"/>string in the input text (only available in prompts)</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
<div data-type="example" id="alert_example">&#13;
<h5><span class="label">Example 4-25. </span>Test handling an alert dialog</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="nd">@Test</code><code>&#13;
</code><code class="kt">void</code><code> </code><code class="nf">testAlert</code><code class="o">(</code><code class="o">)</code><code> </code><code class="o">{</code><code>&#13;
</code><code>    </code><code class="n">driver</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code>&#13;
</code><code>            </code><code class="s">"https://bonigarcia.dev/selenium-webdriver-java/dialog-boxes.html"</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO23-1" id="co_browser_agnostic_features_CO23-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>    </code><code class="n">WebDriverWait</code><code> </code><code class="n">wait</code><code> </code><code class="o">=</code><code> </code><code class="k">new</code><code> </code><code class="n">WebDriverWait</code><code class="o">(</code><code class="n">driver</code><code class="o">,</code><code> </code><code class="n">Duration</code><code class="o">.</code><code class="na">ofSeconds</code><code class="o">(</code><code class="mi">5</code><code class="o">)</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">driver</code><code class="o">.</code><code class="na">findElement</code><code class="o">(</code><code class="n">By</code><code class="o">.</code><code class="na">id</code><code class="o">(</code><code class="s">"my-alert"</code><code class="o">)</code><code class="o">)</code><code class="o">.</code><code class="na">click</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO23-2" id="co_browser_agnostic_features_CO23-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>    </code><code class="n">wait</code><code class="o">.</code><code class="na">until</code><code class="o">(</code><code class="n">ExpectedConditions</code><code class="o">.</code><code class="na">alertIsPresent</code><code class="o">(</code><code class="o">)</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO23-3" id="co_browser_agnostic_features_CO23-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>    </code><code class="n">Alert</code><code> </code><code class="n">alert</code><code> </code><code class="o">=</code><code> </code><code class="n">driver</code><code class="o">.</code><code class="na">switchTo</code><code class="o">(</code><code class="o">)</code><code class="o">.</code><code class="na">alert</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO23-4" id="co_browser_agnostic_features_CO23-4"><img alt="4" src="assets/4.png"/></a><code>&#13;
</code><code>    </code><code class="n">assertThat</code><code class="o">(</code><code class="n">alert</code><code class="o">.</code><code class="na">getText</code><code class="o">(</code><code class="o">)</code><code class="o">)</code><code class="o">.</code><code class="na">isEqualTo</code><code class="o">(</code><code class="s">"Hello world!"</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO23-5" id="co_browser_agnostic_features_CO23-5"><img alt="5" src="assets/5.png"/></a><code>&#13;
</code><code>    </code><code class="n">alert</code><code class="o">.</code><code class="na">accept</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO23-6" id="co_browser_agnostic_features_CO23-6"><img alt="6" src="assets/6.png"/></a><code>&#13;
</code><code class="o">}</code></pre></div>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO23-1" id="callout_browser_agnostic_features_CO23-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>We open the practice web page that launches dialog boxes.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO23-2" id="callout_browser_agnostic_features_CO23-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>We click on the left button to launch a JavaScript alert.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO23-3" id="callout_browser_agnostic_features_CO23-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>We wait until the alert dialog is displayed on the screen.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO23-4" id="callout_browser_agnostic_features_CO23-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>We change the focus to the alert pop-up.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO23-5" id="callout_browser_agnostic_features_CO23-5"><img alt="5" src="assets/5.png"/></a></dt>&#13;
<dd><p>We verify that the alert text is as expected.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO23-6" id="callout_browser_agnostic_features_CO23-6"><img alt="6" src="assets/6.png"/></a></dt>&#13;
<dd><p>We click on the OK button of the alert dialog.</p></dd>&#13;
</dl>&#13;
&#13;
<p>We can replace steps 3 and 4 with a single explicit wait statement, as follows (you can find it in a second test in the same class in the examples repository):</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">Alert</code> <code class="n">alert</code> <code class="o">=</code> <code class="n">wait</code><code class="o">.</code><code class="na">until</code><code class="o">(</code><code class="n">ExpectedConditions</code><code class="o">.</code><code class="na">alertIsPresent</code><code class="o">());</code></pre>&#13;
&#13;
<p>The next <a data-startref="ch4_term38" data-type="indexterm" id="idm45849723951328"/>test (<a data-type="xref" href="#confirm_example">Example 4-26</a>) illustrates <a data-primary="confirm dialog boxes" data-type="indexterm" id="idm45849723949792"/>how to deal with a confirm dialog. Notice this example is quite similar to the previous one, but in this case, <a data-primary="dismiss() method" data-type="indexterm" id="idm45849723936464"/>we can invoke the method <code>dismiss()</code> to click on the Cancel button available on the confirm dialog. Finally, <a data-type="xref" href="#prompt_example">Example 4-27</a> shows <a data-primary="prompt dialog boxes" data-type="indexterm" id="idm45849723934448"/>how to manage a prompt dialog. In this case, we can type a string into the input text.</p>&#13;
<div data-type="example" id="confirm_example">&#13;
<h5><span class="label">Example 4-26. </span>Test handling a confirm dialog</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="nd">@Test</code>&#13;
<code class="kt">void</code> <code class="nf">testConfirm</code><code class="o">()</code> <code class="o">{</code>&#13;
    <code class="n">driver</code><code class="o">.</code><code class="na">get</code><code class="o">(</code>&#13;
            <code class="s">"https://bonigarcia.dev/selenium-webdriver-java/dialog-boxes.html"</code><code class="o">);</code>&#13;
    <code class="n">WebDriverWait</code> <code class="n">wait</code> <code class="o">=</code> <code class="k">new</code> <code class="n">WebDriverWait</code><code class="o">(</code><code class="n">driver</code><code class="o">,</code> <code class="n">Duration</code><code class="o">.</code><code class="na">ofSeconds</code><code class="o">(</code><code class="mi">5</code><code class="o">));</code>&#13;
&#13;
    <code class="n">driver</code><code class="o">.</code><code class="na">findElement</code><code class="o">(</code><code class="n">By</code><code class="o">.</code><code class="na">id</code><code class="o">(</code><code class="s">"my-confirm"</code><code class="o">)).</code><code class="na">click</code><code class="o">();</code>&#13;
    <code class="n">wait</code><code class="o">.</code><code class="na">until</code><code class="o">(</code><code class="n">ExpectedConditions</code><code class="o">.</code><code class="na">alertIsPresent</code><code class="o">());</code>&#13;
    <code class="n">Alert</code> <code class="n">confirm</code> <code class="o">=</code> <code class="n">driver</code><code class="o">.</code><code class="na">switchTo</code><code class="o">().</code><code class="na">alert</code><code class="o">();</code>&#13;
    <code class="n">assertThat</code><code class="o">(</code><code class="n">confirm</code><code class="o">.</code><code class="na">getText</code><code class="o">()).</code><code class="na">isEqualTo</code><code class="o">(</code><code class="s">"Is this correct?"</code><code class="o">);</code>&#13;
    <code class="n">confirm</code><code class="o">.</code><code class="na">dismiss</code><code class="o">();</code>&#13;
<code class="o">}</code></pre></div>&#13;
<div data-type="example" id="prompt_example">&#13;
<h5><span class="label">Example 4-27. </span>Test handling a prompt dialog</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="nd">@Test</code>&#13;
<code class="kt">void</code> <code class="nf">testPrompt</code><code class="o">()</code> <code class="o">{</code>&#13;
    <code class="n">driver</code><code class="o">.</code><code class="na">get</code><code class="o">(</code>&#13;
            <code class="s">"https://bonigarcia.dev/selenium-webdriver-java/dialog-boxes.html"</code><code class="o">);</code>&#13;
    <code class="n">WebDriverWait</code> <code class="n">wait</code> <code class="o">=</code> <code class="k">new</code> <code class="n">WebDriverWait</code><code class="o">(</code><code class="n">driver</code><code class="o">,</code> <code class="n">Duration</code><code class="o">.</code><code class="na">ofSeconds</code><code class="o">(</code><code class="mi">5</code><code class="o">));</code>&#13;
&#13;
    <code class="n">driver</code><code class="o">.</code><code class="na">findElement</code><code class="o">(</code><code class="n">By</code><code class="o">.</code><code class="na">id</code><code class="o">(</code><code class="s">"my-prompt"</code><code class="o">)).</code><code class="na">click</code><code class="o">();</code>&#13;
    <code class="n">wait</code><code class="o">.</code><code class="na">until</code><code class="o">(</code><code class="n">ExpectedConditions</code><code class="o">.</code><code class="na">alertIsPresent</code><code class="o">());</code>&#13;
    <code class="n">Alert</code> <code class="n">prompt</code> <code class="o">=</code> <code class="n">driver</code><code class="o">.</code><code class="na">switchTo</code><code class="o">().</code><code class="na">alert</code><code class="o">();</code>&#13;
    <code class="n">prompt</code><code class="o">.</code><code class="na">sendKeys</code><code class="o">(</code><code class="s">"John Doe"</code><code class="o">);</code>&#13;
    <code class="n">assertThat</code><code class="o">(</code><code class="n">prompt</code><code class="o">.</code><code class="na">getText</code><code class="o">()).</code><code class="na">isEqualTo</code><code class="o">(</code><code class="s">"Please enter your name"</code><code class="o">);</code>&#13;
    <code class="n">prompt</code><code class="o">.</code><code class="na">accept</code><code class="o">();</code>&#13;
<code class="o">}</code></pre></div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Modal Windows" data-type="sect2"><div class="sect2" id="idm45849724328368">&#13;
<h2>Modal Windows</h2>&#13;
&#13;
<p>Modal windows <a data-startref="ch4_term39" data-type="indexterm" id="idm45849723692800"/><a data-startref="ch4_term40" data-type="indexterm" id="idm45849723759232"/><a data-primary="CSS" data-secondary="modal window dialog boxes" data-type="indexterm" id="idm45849723758560"/><a data-primary="modal window dialog boxes" data-type="indexterm" id="idm45849723757648"/>are dialog boxes built with basic CSS and HTML. For this reason, Selenium WebDriver does not provide any specific utility for manipulating them. Instead, we use the standard WebDriver API (locators, waits, etc.) to interact with modal windows. <a data-type="xref" href="#modal_example">Example 4-28</a> shows a basic test using the practice web page that contains dialog boxes.</p>&#13;
<div data-type="example" id="modal_example">&#13;
<h5><span class="label">Example 4-28. </span>Test handling a modal dialog</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="nd">@Test</code>&#13;
<code class="kt">void</code> <code class="nf">testModal</code><code class="o">()</code> <code class="o">{</code>&#13;
    <code class="n">driver</code><code class="o">.</code><code class="na">get</code><code class="o">(</code>&#13;
            <code class="s">"https://bonigarcia.dev/selenium-webdriver-java/dialog-boxes.html"</code><code class="o">);</code>&#13;
    <code class="n">WebDriverWait</code> <code class="n">wait</code> <code class="o">=</code> <code class="k">new</code> <code class="n">WebDriverWait</code><code class="o">(</code><code class="n">driver</code><code class="o">,</code> <code class="n">Duration</code><code class="o">.</code><code class="na">ofSeconds</code><code class="o">(</code><code class="mi">5</code><code class="o">));</code>&#13;
&#13;
    <code class="n">driver</code><code class="o">.</code><code class="na">findElement</code><code class="o">(</code><code class="n">By</code><code class="o">.</code><code class="na">id</code><code class="o">(</code><code class="s">"my-modal"</code><code class="o">)).</code><code class="na">click</code><code class="o">();</code>&#13;
    <code class="n">WebElement</code> <code class="n">close</code> <code class="o">=</code> <code class="n">driver</code>&#13;
            <code class="o">.</code><code class="na">findElement</code><code class="o">(</code><code class="n">By</code><code class="o">.</code><code class="na">xpath</code><code class="o">(</code><code class="s">"//button[text() = 'Close']"</code><code class="o">));</code>&#13;
    <code class="n">assertThat</code><code class="o">(</code><code class="n">close</code><code class="o">.</code><code class="na">getTagName</code><code class="o">()).</code><code class="na">isEqualTo</code><code class="o">(</code><code class="s">"button"</code><code class="o">);</code>&#13;
    <code class="n">wait</code><code class="o">.</code><code class="na">until</code><code class="o">(</code><code class="n">ExpectedConditions</code><code class="o">.</code><code class="na">elementToBeClickable</code><code class="o">(</code><code class="n">close</code><code class="o">));</code>&#13;
    <code class="n">close</code><code class="o">.</code><code class="na">click</code><code class="o">();</code>&#13;
<code class="o">}</code></pre></div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section class="pagebreak-before less_space" data-pdf-bookmark="Web Storage" data-type="sect1"><div class="sect1" id="idm45849723608800">&#13;
<h1>Web Storage</h1>&#13;
&#13;
<p>The <a href="https://html.spec.whatwg.org/multipage/webstorage.html">Web Storage API</a> allows web applications <a data-primary="browsers, interoperable features of" data-secondary="web storage" data-type="indexterm" id="idm45849723638064"/><a data-primary="web storage" data-type="indexterm" id="idm45849723637120"/><a data-primary="storage, web" data-type="indexterm" id="idm45849723636448"/><a data-primary="local storage" data-type="indexterm" id="idm45849723635776"/>to store data locally in the client file system. This API provides two JavaScript objects:</p>&#13;
<dl>&#13;
<dt><code>window.localStorage</code></dt>&#13;
<dd>&#13;
<p>To store <a data-primary="window.localStorage" data-type="indexterm" id="idm45849723633264"/>data permanently</p>&#13;
</dd>&#13;
<dt><code>window.sessionStorage</code></dt>&#13;
<dd>&#13;
<p>To store data <a data-primary="window.sessionStorage" data-type="indexterm" id="idm45849723630960"/><a data-primary="session storage" data-type="indexterm" id="idm45849723566080"/>during the session time (data is deleted when the browser tab is closed)</p>&#13;
</dd>&#13;
</dl>&#13;
&#13;
<p>Selenium WebDriver <a data-primary="WebStorage interface" data-type="indexterm" id="idm45849723564704"/><a data-primary="drivers" data-secondary="WebDriver hierarchy of classes of" data-type="indexterm" id="idm45849723563680"/><a data-primary="Selenium WebDriver API" data-secondary="drivers supported by" data-type="indexterm" id="idm45849723562832"/>provides the interface <code>WebStorage</code> for manipulating the Web Storage API. Most of the <code>WebDriver</code> types supported by Selenium WebDriver <a data-primary="ChromeDriver" data-type="indexterm" id="idm45849723560992"/><a data-primary="EdgeDriver" data-type="indexterm" id="idm45849723560288"/><a data-primary="FirefoxDriver" data-type="indexterm" id="idm45849723559616"/>inherit this interface: <code>ChromeDriver</code>, <code>EdgeDriver</code>, <code>FirefoxDriver</code>, <code>OperaDriver</code>, and <code>SafariDriver</code>. This way, we can <a data-primary="Selenium WebDriver API" data-secondary="browsers supported by" data-type="indexterm" id="idm45849723556640"/>use this feature of these browsers. <a data-type="xref" href="#web_storage">Example 4-29</a> demonstrates this use in Chrome. This test uses both types of web storage (local and session).</p>&#13;
<div data-type="example" id="web_storage">&#13;
<h5><span class="label">Example 4-29. </span>Test using web storage</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="nd">@Test</code><code>&#13;
</code><code class="kt">void</code><code> </code><code class="nf">testWebStorage</code><code class="o">(</code><code class="o">)</code><code> </code><code class="o">{</code><code>&#13;
</code><code>    </code><code class="n">driver</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code>&#13;
</code><code>            </code><code class="s">"https://bonigarcia.dev/selenium-webdriver-java/web-storage.html"</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="n">WebStorage</code><code> </code><code class="n">webStorage</code><code> </code><code class="o">=</code><code> </code><code class="o">(</code><code class="n">WebStorage</code><code class="o">)</code><code> </code><code class="n">driver</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO24-1" id="co_browser_agnostic_features_CO24-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">LocalStorage</code><code> </code><code class="n">localStorage</code><code> </code><code class="o">=</code><code> </code><code class="n">webStorage</code><code class="o">.</code><code class="na">getLocalStorage</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="n">log</code><code class="o">.</code><code class="na">debug</code><code class="o">(</code><code class="s">"Local storage elements: {}"</code><code class="o">,</code><code> </code><code class="n">localStorage</code><code class="o">.</code><code class="na">size</code><code class="o">(</code><code class="o">)</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO24-2" id="co_browser_agnostic_features_CO24-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">SessionStorage</code><code> </code><code class="n">sessionStorage</code><code> </code><code class="o">=</code><code> </code><code class="n">webStorage</code><code class="o">.</code><code class="na">getSessionStorage</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="n">sessionStorage</code><code class="o">.</code><code class="na">keySet</code><code class="o">(</code><code class="o">)</code><code>&#13;
</code><code>            </code><code class="o">.</code><code class="na">forEach</code><code class="o">(</code><code class="n">key</code><code> </code><code class="o">-</code><code class="o">&gt;</code><code> </code><code class="n">log</code><code class="o">.</code><code class="na">debug</code><code class="o">(</code><code class="s">"Session storage: {}={}"</code><code class="o">,</code><code> </code><code class="n">key</code><code class="o">,</code><code>&#13;
</code><code>                    </code><code class="n">sessionStorage</code><code class="o">.</code><code class="na">getItem</code><code class="o">(</code><code class="n">key</code><code class="o">)</code><code class="o">)</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO24-3" id="co_browser_agnostic_features_CO24-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>    </code><code class="n">assertThat</code><code class="o">(</code><code class="n">sessionStorage</code><code class="o">.</code><code class="na">size</code><code class="o">(</code><code class="o">)</code><code class="o">)</code><code class="o">.</code><code class="na">isEqualTo</code><code class="o">(</code><code class="mi">2</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">sessionStorage</code><code class="o">.</code><code class="na">setItem</code><code class="o">(</code><code class="s">"new element"</code><code class="o">,</code><code> </code><code class="s">"new value"</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="n">assertThat</code><code class="o">(</code><code class="n">sessionStorage</code><code class="o">.</code><code class="na">size</code><code class="o">(</code><code class="o">)</code><code class="o">)</code><code class="o">.</code><code class="na">isEqualTo</code><code class="o">(</code><code class="mi">3</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO24-4" id="co_browser_agnostic_features_CO24-4"><img alt="4" src="assets/4.png"/></a><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">driver</code><code class="o">.</code><code class="na">findElement</code><code class="o">(</code><code class="n">By</code><code class="o">.</code><code class="na">id</code><code class="o">(</code><code class="s">"display-session"</code><code class="o">)</code><code class="o">)</code><code class="o">.</code><code class="na">click</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code class="o">}</code></pre></div>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO24-1" id="callout_browser_agnostic_features_CO24-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>We cast the driver object to <code>WebStorage</code>.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO24-2" id="callout_browser_agnostic_features_CO24-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>We log the number of elements of local storage.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO24-3" id="callout_browser_agnostic_features_CO24-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>We log the session storage (it should contain two elements).</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO24-4" id="callout_browser_agnostic_features_CO24-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>After adding a new element, there should be three elements in the session <span class="keep-together">storage</span>.</p></dd>&#13;
</dl>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Event Listeners" data-type="sect1"><div class="sect1" id="event-listeners">&#13;
<h1>Event Listeners</h1>&#13;
&#13;
<p>The Selenium WebDriver API <a data-primary="browsers, interoperable features of" data-secondary="event listeners" data-type="indexterm" id="ch4_term41"/><a data-primary="event listeners" data-type="indexterm" id="ch4_term42"/><a data-primary="listeners" data-secondary="for event notification" data-secondary-sortas="event notification" data-type="indexterm" id="ch4_term43"/>allows creating <em>listeners</em> that notify events happening in <code>WebDriver</code> and derived objects. In former versions of Selenium WebDriver, this feature was accessible through the class <code>EventFiringWebDriver</code>. This class is deprecated as of <a data-primary="Selenium 4 (version)" data-primary-sortas="Selenium four (version)" data-type="indexterm" id="idm45849723330224"/><a data-primary="Selenium WebDriver 4 (version)" data-secondary="event listeners in" data-type="indexterm" id="idm45849723329248"/>Selenium WebDriver 4, and instead, we should use the following:</p>&#13;
<dl>&#13;
<dt><code>EventFiringDecorator</code></dt>&#13;
<dd>&#13;
<p>Wrapper <a data-primary="EventFiringDecorator interface" data-type="indexterm" id="idm45849723326416"/>class for <code>WebDriver</code> and derived objects (e.g., <code>WebElement</code>, <code>TargetLocator</code>, etc.). It allows registering one or more listeners (i.e., <code>WebDriverListener</code> instances).</p>&#13;
</dd>&#13;
<dt><code>WebDriverListener</code></dt>&#13;
<dd>&#13;
<p>Interface that <a data-primary="WebDriverListener interface and methods" data-type="indexterm" id="ch4_term44"/>should implement the listeners registered in the decorator. It supports three types of events:</p>&#13;
<dl>&#13;
<dt><em>Before</em> events</dt>&#13;
<dd>&#13;
<p>Logic inserted just before some event starts</p>&#13;
</dd>&#13;
<dt><em>After</em> events</dt>&#13;
<dd>&#13;
<p>Logic inserted just after some event terminates</p>&#13;
</dd>&#13;
<dt><em>Error</em> events</dt>&#13;
<dd>&#13;
<p>Logic inserted before an exception is thrown</p>&#13;
</dd>&#13;
</dl>&#13;
</dd>&#13;
</dl>&#13;
&#13;
<p>To implement an event listener, first, we <a data-primary="listener class, creating" data-type="indexterm" id="idm45849723315312"/>should create a listener class. In other words, we need to create a class that implements the  <code>WebDriverListener</code>. This interface defines all its methods using the <code>default</code> keyword, and therefore, it is optional to override their methods. Thanks to that feature (available as of Java 8), our class should only implement the method we need. There are plenty of listener methods available, for instance, <code>afterGet()</code> (executed <em>after</em> calling to the method <code>get()</code> in a <code>WebDriver</code> instance), or <code>beforeQuit()</code> (executed <em>before</em> calling to the <code>quit()</code> method in a <code>WebDriver</code> instance), to name a few. My recommendation for checking all these listeners is to use your favorite IDE to discover the possible methods to be overridden/implemented. <a data-type="xref" href="#webdriverlistener">Figure 4-12</a> shows the <a data-primary="Eclipse IDE" data-type="indexterm" id="idm45849723308768"/>wizard for doing this in Eclipse.</p>&#13;
&#13;
<figure><div class="figure" id="webdriverlistener">&#13;
<img alt="hosw 0412" src="assets/hosw_0412.png"/>&#13;
<h6><span class="label">Figure 4-12. </span>WebDriverListener methods in Eclipse</h6>&#13;
</div></figure>&#13;
&#13;
<p>Once we have implemented our listener, we need to <a data-primary="decorator class, creating" data-type="indexterm" id="idm45849723305584"/>create the decorator class. There are two ways to do that. If we want to decorate a <code>WebDriver</code> object, we can create an <a data-primary="EventFiringDecorator interface" data-type="indexterm" id="idm45849723304400"/><a data-primary="decorate() method" data-type="indexterm" id="idm45849723303632"/>instance of <code>EventFiringDecorator</code> (passing the listener as the argument to the constructor) and then invoke the method <code>decorate()</code>  to pass the <code>WebDriver</code> object. For instance:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">WebDriver</code> <code class="n">decoratedDriver</code> <code class="o">=</code> <code class="k">new</code> <code class="n">EventFiringDecorator</code><code class="o">(</code><code class="n">myListener</code><code class="o">)</code>&#13;
        <code class="o">.</code><code class="na">decorate</code><code class="o">(</code><code class="n">originalDriver</code><code class="o">);</code></pre>&#13;
&#13;
<p>The second way is to <a data-primary="createDecorated() method" data-type="indexterm" id="idm45849723297040"/><a data-primary="Decorate&lt;T&gt; generic class" data-type="indexterm" id="idm45849723296016"/>decorate other objects of the Selenium WebDriver API, namely <code>WebElement</code>, <code>TargetLocator</code>, <code>Navigation</code>, <code>Options</code>, <code>Timeouts</code>, <code>Window</code>, <code>Alert</code>, or <code>VirtualAuthenticator</code>. In this case, we need to invoke the method <code>createDecorated()</code> in an <code>EventFiringDecorator</code> object to get a <code>Decorated&lt;T&gt;</code> generic class. The following snippet shows an example using a <code>WebElement</code> as a parameter:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">Decorated</code><code class="o">&lt;</code><code class="n">WebElement</code><code class="o">&gt;</code> <code class="n">decoratedWebElement</code> <code class="o">=</code> <code class="k">new</code> <code class="n">EventFiringDecorator</code><code class="o">(</code>&#13;
        <code class="n">listener</code><code class="o">).</code><code class="na">createDecorated</code><code class="o">(</code><code class="n">myWebElement</code><code class="o">);</code></pre>&#13;
&#13;
<p>Let’s look at a completed example. First, <a data-type="xref" href="#eventlistener">Example 4-30</a> shows the class that implements the <code>WebDriverListener</code> interface. Notice <a data-primary="takeScreenshot()" data-type="indexterm" id="idm45849723271824"/><a data-primary="afterGet() method" data-type="indexterm" id="ch4_term45"/><a data-primary="beforeQuit() method" data-type="indexterm" id="ch4_term46"/>this class implements two methods: <code>afterGet()</code> and <code>beforeQuit()</code>. Both methods call <code>takeScreenshot()</code> to take a browser screenshot. All in all, we are collecting browser screenshots just after loading a web page (typically at the beginning of the test) and before quitting (typically at the end of the test). Then, <a data-type="xref" href="#eventfiringdecorator">Example 4-31</a> shows the test that uses this listener.</p>&#13;
<div data-type="example" id="eventlistener">&#13;
<h5><span class="label">Example 4-30. </span>Event listener implementing methods afterGet() and beforeQuit()</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code><code> </code><code class="kd">class</code><code> </code><code class="nc">MyEventListener</code><code> </code><code class="kd">implements</code><code> </code><code class="n">WebDriverListener</code><code> </code><code class="o">{</code><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="kd">static</code><code> </code><code class="kd">final</code><code> </code><code class="n">Logger</code><code> </code><code class="n">log</code><code> </code><code class="o">=</code><code> </code><code class="n">getLogger</code><code class="o">(</code><code class="n">lookup</code><code class="o">(</code><code class="o">)</code><code class="o">.</code><code class="na">lookupClass</code><code class="o">(</code><code class="o">)</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="nd">@Override</code><code>&#13;
</code><code>    </code><code class="kd">public</code><code> </code><code class="kt">void</code><code> </code><code class="nf">afterGet</code><code class="o">(</code><code class="n">WebDriver</code><code> </code><code class="n">driver</code><code class="o">,</code><code> </code><code class="n">String</code><code> </code><code class="n">url</code><code class="o">)</code><code> </code><code class="o">{</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO25-1" id="co_browser_agnostic_features_CO25-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>        </code><code class="n">WebDriverListener</code><code class="o">.</code><code class="na">super</code><code class="o">.</code><code class="na">afterGet</code><code class="o">(</code><code class="n">driver</code><code class="o">,</code><code> </code><code class="n">url</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>        </code><code class="n">takeScreenshot</code><code class="o">(</code><code class="n">driver</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="o">}</code><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="nd">@Override</code><code>&#13;
</code><code>    </code><code class="kd">public</code><code> </code><code class="kt">void</code><code> </code><code class="nf">beforeQuit</code><code class="o">(</code><code class="n">WebDriver</code><code> </code><code class="n">driver</code><code class="o">)</code><code> </code><code class="o">{</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO25-2" id="co_browser_agnostic_features_CO25-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>        </code><code class="n">takeScreenshot</code><code class="o">(</code><code class="n">driver</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="o">}</code><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="kd">private</code><code> </code><code class="kt">void</code><code> </code><code class="nf">takeScreenshot</code><code class="o">(</code><code class="n">WebDriver</code><code> </code><code class="n">driver</code><code class="o">)</code><code> </code><code class="o">{</code><code>&#13;
</code><code>        </code><code class="n">TakesScreenshot</code><code> </code><code class="n">ts</code><code> </code><code class="o">=</code><code> </code><code class="o">(</code><code class="n">TakesScreenshot</code><code class="o">)</code><code> </code><code class="n">driver</code><code class="o">;</code><code>&#13;
</code><code>        </code><code class="n">File</code><code> </code><code class="n">screenshot</code><code> </code><code class="o">=</code><code> </code><code class="n">ts</code><code class="o">.</code><code class="na">getScreenshotAs</code><code class="o">(</code><code class="n">OutputType</code><code class="o">.</code><code class="na">FILE</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>        </code><code class="n">SessionId</code><code> </code><code class="n">sessionId</code><code> </code><code class="o">=</code><code> </code><code class="o">(</code><code class="o">(</code><code class="n">RemoteWebDriver</code><code class="o">)</code><code> </code><code class="n">driver</code><code class="o">)</code><code class="o">.</code><code class="na">getSessionId</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>        </code><code class="n">Date</code><code> </code><code class="n">today</code><code> </code><code class="o">=</code><code> </code><code class="k">new</code><code> </code><code class="n">Date</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>        </code><code class="n">SimpleDateFormat</code><code> </code><code class="n">dateFormat</code><code> </code><code class="o">=</code><code> </code><code class="k">new</code><code> </code><code class="n">SimpleDateFormat</code><code class="o">(</code><code>&#13;
</code><code>                </code><code class="s">"yyyy.MM.dd_HH.mm.ss.SSS"</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>        </code><code class="n">String</code><code> </code><code class="n">screenshotFileName</code><code> </code><code class="o">=</code><code> </code><code class="n">String</code><code class="o">.</code><code class="na">format</code><code class="o">(</code><code class="s">"%s-%s.png"</code><code class="o">,</code><code>&#13;
</code><code>                </code><code class="n">dateFormat</code><code class="o">.</code><code class="na">format</code><code class="o">(</code><code class="n">today</code><code class="o">)</code><code class="o">,</code><code> </code><code class="n">sessionId</code><code class="o">.</code><code class="na">toString</code><code class="o">(</code><code class="o">)</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>        </code><code class="n">Path</code><code> </code><code class="n">destination</code><code> </code><code class="o">=</code><code> </code><code class="n">Paths</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code class="n">screenshotFileName</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO25-3" id="co_browser_agnostic_features_CO25-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>&#13;
</code><code>        </code><code class="k">try</code><code> </code><code class="o">{</code><code>&#13;
</code><code>            </code><code class="n">Files</code><code class="o">.</code><code class="na">move</code><code class="o">(</code><code class="n">screenshot</code><code class="o">.</code><code class="na">toPath</code><code class="o">(</code><code class="o">)</code><code class="o">,</code><code> </code><code class="n">destination</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>        </code><code class="o">}</code><code> </code><code class="k">catch</code><code> </code><code class="o">(</code><code class="n">IOException</code><code> </code><code class="n">e</code><code class="o">)</code><code> </code><code class="o">{</code><code>&#13;
</code><code>            </code><code class="n">log</code><code class="o">.</code><code class="na">error</code><code class="o">(</code><code class="s">"Exception moving screenshot from {} to {}"</code><code class="o">,</code><code> </code><code class="n">screenshot</code><code class="o">,</code><code>&#13;
</code><code>                    </code><code class="n">destination</code><code class="o">,</code><code> </code><code class="n">e</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>        </code><code class="o">}</code><code>&#13;
</code><code>    </code><code class="o">}</code><code>&#13;
</code><code>&#13;
</code><code class="o">}</code></pre></div>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO25-1" id="callout_browser_agnostic_features_CO25-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>We override this method to execute custom logic <em>after</em> loading web pages with the <code>WebDriver</code> object.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO25-2" id="callout_browser_agnostic_features_CO25-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>We override this method to execute custom logic <em>before</em> quitting the <code>WebDriver</code> object.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO25-3" id="callout_browser_agnostic_features_CO25-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>We use a <a data-primary="PNG format, screenshots with" data-type="indexterm" id="idm45849723117456"/>unique name for the PNG screenshots. For that, we get the system date (date and time) plus the session <a data-startref="ch4_term44" data-type="indexterm" id="idm45849723116512"/><a data-startref="ch4_term45" data-type="indexterm" id="idm45849723115840"/><a data-startref="ch4_term46" data-type="indexterm" id="idm45849723115168"/>identifier.</p></dd>&#13;
</dl>&#13;
<div data-type="example" id="eventfiringdecorator">&#13;
<h5><span class="label">Example 4-31. </span>Test using EventFiringDecorator and the previous listener</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">class</code><code> </code><code class="nc">EventListenerJupiterTest</code><code> </code><code class="o">{</code><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="n">WebDriver</code><code> </code><code class="n">driver</code><code class="o">;</code><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="nd">@BeforeEach</code><code>&#13;
</code><code>    </code><code class="kt">void</code><code> </code><code class="nf">setup</code><code class="o">(</code><code class="o">)</code><code> </code><code class="o">{</code><code>&#13;
</code><code>        </code><code class="n">MyEventListener</code><code> </code><code class="n">listener</code><code> </code><code class="o">=</code><code> </code><code class="k">new</code><code> </code><code class="n">MyEventListener</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>        </code><code class="n">WebDriver</code><code> </code><code class="n">originalDriver</code><code> </code><code class="o">=</code><code> </code><code class="n">WebDriverManager</code><code class="o">.</code><code class="na">chromedriver</code><code class="o">(</code><code class="o">)</code><code class="o">.</code><code class="na">create</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>        </code><code class="n">driver</code><code> </code><code class="o">=</code><code> </code><code class="k">new</code><code> </code><code class="n">EventFiringDecorator</code><code class="o">(</code><code class="n">listener</code><code class="o">)</code><code class="o">.</code><code class="na">decorate</code><code class="o">(</code><code class="n">originalDriver</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO26-1" id="co_browser_agnostic_features_CO26-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>    </code><code class="o">}</code><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="nd">@AfterEach</code><code>&#13;
</code><code>    </code><code class="kt">void</code><code> </code><code class="nf">teardown</code><code class="o">(</code><code class="o">)</code><code> </code><code class="o">{</code><code>&#13;
</code><code>        </code><code class="n">driver</code><code class="o">.</code><code class="na">quit</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="o">}</code><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="nd">@Test</code><code>&#13;
</code><code>    </code><code class="kt">void</code><code> </code><code class="nf">testEventListener</code><code class="o">(</code><code class="o">)</code><code> </code><code class="o">{</code><code>&#13;
</code><code>        </code><code class="n">driver</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code class="s">"https://bonigarcia.dev/selenium-webdriver-java/"</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>        </code><code class="n">assertThat</code><code class="o">(</code><code class="n">driver</code><code class="o">.</code><code class="na">getTitle</code><code class="o">(</code><code class="o">)</code><code class="o">)</code><code>&#13;
</code><code>                </code><code class="o">.</code><code class="na">isEqualTo</code><code class="o">(</code><code class="s">"Hands-On Selenium WebDriver with Java"</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>        </code><code class="n">driver</code><code class="o">.</code><code class="na">findElement</code><code class="o">(</code><code class="n">By</code><code class="o">.</code><code class="na">linkText</code><code class="o">(</code><code class="s">"Web form"</code><code class="o">)</code><code class="o">)</code><code class="o">.</code><code class="na">click</code><code class="o">(</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_browser_agnostic_features_CO26-2" id="co_browser_agnostic_features_CO26-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>    </code><code class="o">}</code><code>&#13;
</code><code>&#13;
</code><code class="o">}</code></pre></div>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO26-1" id="callout_browser_agnostic_features_CO26-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>We create a <a data-primary="EventFiringDecorator interface" data-type="indexterm" id="idm45849722744720"/><a data-primary="MyEventListener class" data-type="indexterm" id="idm45849722744112"/>decorated <code>WebDriver</code> object using an instance on <code>MyEventListener</code>. We use the resulting <code>driver</code> to control the browser in the <code>@Test</code> logic.</p></dd>&#13;
<dt><a class="co" href="#co_browser_agnostic_features_CO26-2" id="callout_browser_agnostic_features_CO26-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>We click on a web link to change the page. The resulting two screenshots taken in the listener should be <a data-startref="ch4_term41" data-type="indexterm" id="idm45849722764016"/><a data-startref="ch4_term42" data-type="indexterm" id="idm45849722763312"/><a data-startref="ch4_term43" data-type="indexterm" id="idm45849722762640"/>different.</p></dd>&#13;
</dl>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section class="pagebreak-before less_space" data-pdf-bookmark="WebDriver Exceptions" data-type="sect1"><div class="sect1" id="exceptions">&#13;
<h1>WebDriver Exceptions</h1>&#13;
&#13;
<p>All the exceptions <a data-primary="browsers, interoperable features of" data-secondary="WebDriver exceptions" data-type="indexterm" id="ch4_term47"/><a data-primary="WebDriver Exceptions class" data-type="indexterm" id="ch4_term48"/><a data-primary="exceptions" data-type="indexterm" id="ch4_term49"/><a data-primary="Selenium WebDriver API" data-secondary="exceptions in" data-type="indexterm" id="ch4_term50"/>provided by the WebDriver API inherit from the class <code>WebDriverException</code> and are <em>unchecked</em> (see the following sidebar if you are unfamiliar with this terminology). <a data-type="xref" href="#webdriver-exceptions">Figure 4-13</a> shows these exceptions in <a data-primary="Selenium WebDriver 4 (version)" data-secondary="exceptions in" data-type="indexterm" id="idm45849722699168"/>Selenium WebDriver 4. As this image shows, there are many different exception types. <a data-type="xref" href="#webdriver-exceptions-table">Table 4-10</a> summarizes some of the most common causes.</p>&#13;
&#13;
<figure><div class="figure" id="webdriver-exceptions">&#13;
<img alt="hosw 0413" src="assets/hosw_0413.png"/>&#13;
<h6><span class="label">Figure 4-13. </span>Selenium WebDriver exceptions</h6>&#13;
</div></figure>&#13;
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="idm45849722695472">&#13;
<h5>Exceptions in Java</h5>&#13;
<p>In Java, an <a data-primary="Java" data-secondary="exceptions in" data-type="indexterm" id="idm45849722694336"/>exception is an event that disrupts the execution of a program. A class hierarchy is used to model different exception types in the standard Java API. The root of this <a data-primary="Throwable class" data-type="indexterm" id="idm45849722693360"/>hierarchy is the <code>Throwable</code> class. It has two subtypes:</p>&#13;
<dl>&#13;
<dt><code>Error</code></dt>&#13;
<dd>&#13;
<p>Irrecoverable problems. As a <a data-primary="error messages" data-type="indexterm" id="idm45849722690832"/>general rule, applications crash rather than handle these severe errors. Some examples are <code>OutOfMemoryError</code> or <code>StackOverflow​Er⁠ror</code>.</p>&#13;
</dd>&#13;
<dt><code>Exception</code></dt>&#13;
<dd>&#13;
<p>Recoverable problems. Applications can handle these exceptions by using <span class="keep-together"><code>try-catch</code></span> blocks. There are two types of <code>Exception</code> classes:</p>&#13;
<dl>&#13;
<dt><em>Checked</em> exceptions</dt>&#13;
<dd>&#13;
<p>Classes that <a data-primary="checked exceptions" data-type="indexterm" id="idm45849722685040"/>directly inherit the <code>Throwable</code> class (except <em>RuntimeException</em> and <em>Error</em>). These exceptions are validated at compile time, and therefore we must handle them with <code>try-catch</code> blocks or rethrow using <code>throws</code>. Examples of check exceptions are <code>IOException</code> or <code>MalformedURLException</code>.</p>&#13;
</dd>&#13;
<dt><em>Unchecked</em> exceptions</dt>&#13;
<dd>&#13;
<p>Classes that <a data-primary="unchecked exceptions" data-type="indexterm" id="idm45849722679840"/>inherit from the <code>RuntimeException</code> class, which is a subtype of <code>Exception.</code> These exceptions do not require being handled with <code>try-catch</code> or rethrowing with <code>throws</code>. Some examples of unchecked exceptions are <code>NullPointerException</code> or <code>ArrayIndexOutOfBoundException</code>.</p>&#13;
</dd>&#13;
</dl>&#13;
</dd>&#13;
</dl>&#13;
</div></aside>&#13;
<table id="webdriver-exceptions-table">&#13;
<caption><span class="label">Table 4-10. </span>Usual WebDriver exceptions and common causes</caption>&#13;
<thead>&#13;
<tr>&#13;
<th>Exception</th>&#13;
<th>Description</th>&#13;
<th>Common causes</th>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">NoSuchElementException</code></pre></div></td>&#13;
<td><p>Web element not available</p></td>&#13;
<td><div>&#13;
<ul>&#13;
<li>&#13;
<p>Invalid locator strategy</p>&#13;
</li>&#13;
<li>&#13;
<p>The element has not <a data-primary="NoSuchElementException exception" data-type="indexterm" id="idm45849722668272"/>been rendered (maybe you need to wait for it)</p>&#13;
</li>&#13;
</ul></div></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">NoAlertPresentException</code></pre></div></td>&#13;
<td><p>Dialog (alert, prompt, or confirm) not available</p></td>&#13;
<td><p>Trying to perform an action (e.g., <code>accept()</code> or <code>dismiss()</code>) into an unavailable dialog</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">NoSuchWindowException</code></pre></div></td>&#13;
<td><p>Window or tab not available</p></td>&#13;
<td><p>Trying to switch into an unavailable window or tab</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">NoSuchFrameException</code></pre></div></td>&#13;
<td><p>Frame or iframe not available</p></td>&#13;
<td><p>Trying to switch into an unavailable frame or iframe</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">InvalidArgumentException</code></pre></div></td>&#13;
<td><p>Incorrect argument <a data-primary="InvalidArgumentException exception" data-type="indexterm" id="idm45849722564320"/>when calling some method of the Selenium WebDriver API</p></td>&#13;
<td><div>&#13;
<ul>&#13;
<li>&#13;
<p>Bad URL in navigation methods</p>&#13;
</li>&#13;
<li>&#13;
<p>Nonexistent path when uploading files</p>&#13;
</li>&#13;
<li>&#13;
<p>Bad argument type in a JavaScript script</p>&#13;
</li>&#13;
</ul></div></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">StaleElementReferenceException</code></pre></div></td>&#13;
<td><p>The element is <em>stale</em>, i.e., it no longer appears on the page</p></td>&#13;
<td><p>The DOM gets updated when trying to interact with a previously located element</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">UnreachableBrowserException</code></pre></div></td>&#13;
<td><p>Problem communicating with the browser</p></td>&#13;
<td><div>&#13;
<ul>&#13;
<li>&#13;
<p>The connection with the remote browser could not be established</p>&#13;
</li>&#13;
<li>&#13;
<p>The browser died in the middle of a WebDriver session</p>&#13;
</li>&#13;
</ul></div></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">TimeoutException</code></pre></div></td>&#13;
<td><p>Page loading timeout</p></td>&#13;
<td><p>Some web page <a data-primary="TimeoutException exception" data-type="indexterm" id="idm45849722522656"/>takes longer than expected to load</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">ScriptTimeoutException</code></pre></div></td>&#13;
<td><p>Script loading timeout</p></td>&#13;
<td><p>Some script takes <a data-primary="ScriptTimeoutException exception" data-type="indexterm" id="idm45849722492048"/>longer than expected to execute</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><div>&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">ElementNotVisibleException</code>&#13;
<code class="n">ElementNotSelectableException</code>&#13;
<code class="n">ElementClickInterceptedException</code></pre></div></td>&#13;
<td><p>The element is on the DOM but is not visible/selectable/clickable</p></td>&#13;
<td><div>&#13;
<ul>&#13;
<li>&#13;
<p>Insufficient (or nonexistent) wait until the element is displayed/selectable/clickable</p>&#13;
</li>&#13;
<li>&#13;
<p>The page layout (perhaps caused by viewport change) makes that element overlay on the element we try to <a data-startref="ch4_term47" data-type="indexterm" id="idm45849722494944"/><a data-startref="ch4_term48" data-type="indexterm" id="idm45849722494272"/><a data-startref="ch4_term49" data-type="indexterm" id="idm45849722473680"/><a data-startref="ch4_term50" data-type="indexterm" id="idm45849722473008"/>interact with</p>&#13;
</li>&#13;
</ul></div></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Summary and Outlook" data-type="sect1"><div class="sect1" id="idm45849722471696">&#13;
<h1>Summary and Outlook</h1>&#13;
&#13;
<p>This chapter provided a <a data-primary="browsers, interoperable features of" data-secondary="summary of" data-type="indexterm" id="idm45849722453024"/>comprehensive review of those WebDriver API features interoperable in different web browsers. Among them, you discovered how to execute JavaScript with Selenium WebDriver, with synchronous, pinned (i.e., attached to a WebDriver session), and asynchronous scripts. Then, you learned about timeouts, used to specify a time limit interval for page loading and script execution. Also, you saw how to manage several browser aspects, such as size and position, navigation history, the shadow DOM, and cookies. Next, you discovered how to interact with specific web elements, such as dropdown lists (select and data lists), navigation targets (windows, tabs, frames, and iframes), and dialog boxes (alerts, prompts, confirms, and modals). Finally, we reviewed the mechanism for implementing web storage and event listeners in Selenium WebDriver 4 and the most relevant WebDriver exceptions (and their common causes).</p>&#13;
&#13;
<p>The next chapter <a data-primary="browsers, noninteroperable features of" data-secondary="summary of" data-type="indexterm" id="idm45849722451504"/>continues to expose the features of the Selenium WebDriver API. The chapter explains those aspects specific to a given browser (e.g., Chrome, Firefox, etc.), including browser capabilities (e.g., <code>ChromeOptions</code>, <code>FirefoxOptions</code>, etc.), the Chrome DevTools Protocol (CDP), network interception, mocking geolocation&#13;
coordinates, the WebDriver BiDirectional (BiDi) protocol, authentication mechanisms, or printing web pages to PDF, among other features.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section></body></html>