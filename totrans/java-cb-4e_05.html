<html><head></head><body><section data-pdf-bookmark="Chapter 5. Numbers" data-type="chapter" epub:type="chapter"><div class="chapter" id="javacook-numbers">&#13;
<h1><span class="label">Chapter 5. </span>Numbers</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="5.0 Introduction" data-type="sect1"><div class="sect1" id="javacook-numbers-intro">&#13;
<h1>5.0 Introduction</h1>&#13;
&#13;
<p><a data-primary="numbers" data-type="indexterm" id="nu_ch"/><a data-primary="numbers" data-secondary="about" data-type="indexterm" id="idm45290683216824"/>Numbers are basic to just about any computation. They’re used for array indices, temperatures, salaries, ratings, and an infinite variety of things. Yet they’re not as simple as they seem. With floating-point numbers, how accurate is accurate? With random numbers, how random is random? With strings that should contain a number, what actually constitutes a number?</p>&#13;
&#13;
<p>Java has several built-in, or <a data-primary="primitive types" data-type="indexterm" id="idm45290683214984"/><em>primitive</em>, types that can be used to represent numbers, summarized in <a data-type="xref" href="#javacook-numbers-TABLE-1">Table 5-1</a> with their <a data-primary="wrapper types" data-type="indexterm" id="idm45290683213000"/><em>wrapper</em> (object) types, as well as some numeric types that do not represent primitive types. Note that unlike languages such as C or Perl, which don’t specify the size or precision of numeric types, Java—with its goal of portability—specifies these exactly and states that they are the same on all platforms.<a data-primary="numbers" data-secondary="types of" data-type="indexterm" id="idm45290683211592"/></p>&#13;
<table id="javacook-numbers-TABLE-1">&#13;
<caption><span class="label">Table 5-1. </span>Numeric types</caption>&#13;
<thead>&#13;
<tr>&#13;
<th>Built-in type</th>&#13;
<th>Object wrapper</th>&#13;
<th>Size of built-in (bits)</th>&#13;
<th>Contents</th>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td><p><code>byte</code></p></td>&#13;
<td><p><code>Byte</code></p></td>&#13;
<td><p>8</p></td>&#13;
<td><p>Signed integer</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>short</code></p></td>&#13;
<td><p><code>Short</code></p></td>&#13;
<td><p>16</p></td>&#13;
<td><p>Signed integer</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>int</code></p></td>&#13;
<td><p><code>Integer</code></p></td>&#13;
<td><p>32</p></td>&#13;
<td><p>Signed integer</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>long</code></p></td>&#13;
<td><p><code>Long</code></p></td>&#13;
<td><p>64</p></td>&#13;
<td><p>Signed integer</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>float</code></p></td>&#13;
<td><p><code>Float</code></p></td>&#13;
<td><p>32</p></td>&#13;
<td><p>IEEE-754 floating point</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>double</code></p></td>&#13;
<td><p><code>Double</code></p></td>&#13;
<td><p>64</p></td>&#13;
<td><p>IEEE-754 floating point</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>char</code></p></td>&#13;
<td><p><code>Character</code></p></td>&#13;
<td><p>16</p></td>&#13;
<td><p>Unsigned Unicode character</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>n/a</p></td>&#13;
<td><p><code>BigInteger</code></p></td>&#13;
<td><p>unlimited</p></td>&#13;
<td><p>Arbitrary-size immutable integer value</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>n/a</p></td>&#13;
<td><p><code>BigDecimal</code></p></td>&#13;
<td><p>unlimited</p></td>&#13;
<td><p>Arbitrary-size-and-precision immutable floating-point value</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
&#13;
<p>As you can see, Java provides a numeric type for just about any purpose. There are four sizes of signed integers for representing various sizes of whole numbers. There are two sizes of floating-point numbers to approximate real numbers. There is also a type specifically designed to represent and allow operations on Unicode characters.&#13;
The primitive numeric types are discussed here. The “Big” value types are described in <a data-type="xref" href="#javacook-numbers-SECT-19">Recipe 5.12</a>.</p>&#13;
&#13;
<p>When you read a string representing a number from user input or a text file, you need to convert it to the appropriate type. The object wrapper classes in the second column have several functions, one of which is to provide this basic conversion functionality—replacing the C programmer’s <em>atoi</em>/<em>atof</em> family of functions and the numeric arguments to <em>scanf</em>.</p>&#13;
&#13;
<p>Going the other way, you can convert any number (indeed, anything at all in Java) to a string just by using string concatenation. If you want a little bit of control over numeric formatting, <a data-type="xref" href="#javacook-numbers-SECT-8">Recipe 5.5</a> shows you how to use some of the object wrappers’ conversion routines. And if you want full control, that recipe also shows the use of <code>NumberFormat</code> and its related classes to provide full control of formatting.</p>&#13;
&#13;
<p>As the name<a data-primary="object wrappers" data-type="indexterm" id="idm45290682408296"/> <em>object wrapper</em> implies, these classes are also used to wrap a number in a Java object, as many parts of the standard API are defined in terms of objects. Later on, <a data-type="xref" href="ch12.html#javacook-netclient-SECT-5.2">“Solution”</a>&#13;
shows using an <code>Integer</code> object to save an <code>int</code>’s value to a file using object serialization and retrieving the value later.</p>&#13;
&#13;
<p>But I haven’t yet mentioned the issues of <a data-primary="floating point numbers" data-type="indexterm" id="idm45290682404840"/>floating point. R<a data-primary="real numbers" data-type="indexterm" id="idm45290682404008"/>eal numbers, you may recall, are numbers with a fractional part. There is an infinite number of real numbers. A floating-point number—what a computer uses to approximate a real number—is not the same as a real number. The number of floating-point numbers is finite, with only 2^32 different bit patterns for <code>float</code>s, and 2^64 for <code>double</code>s. Thus, most real values have only an approximate correspondence to floating point. The result of printing the real number 0.3 works correctly, like this:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="c1">// numbers/RealValues.java</code>&#13;
<code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"The real value 0.3 is "</code> <code class="o">+</code> <code class="mf">0.3</code><code class="o">);</code></pre>&#13;
&#13;
<p>That code results in this printout:</p>&#13;
&#13;
<pre data-type="programlisting">The real value 0.3 is 0.3</pre>&#13;
&#13;
<p>But the difference between a real value and its floating-point approximation can accumulate if the value is used in a computation; this is often called a <em>rounding error</em>. Continuing the previous example, the real 0.3 multiplied by 3 yields:</p>&#13;
&#13;
<pre data-type="programlisting">The real 0.3 times 3 is 0.89999999999999991</pre>&#13;
&#13;
<p class="pagebreak-before">Surprised? Not only is it off by a bit from what you might expect, but you will of course get the same output on any conforming Java implementation. I ran it on machines as disparate as an AMD/Intel PC with OpenBSD, a PC with Windows and the standard JDK, and on macOS. Always the same answer.</p>&#13;
&#13;
<p>And what about <a data-primary="random numbers" data-type="indexterm" id="idm45290682389976"/>random numbers? How random are they? You have probably heard the term<a data-primary="Pseudorandom Number Generator (PRNG)" data-type="indexterm" id="idm45290682389112"/><a data-primary="PRNG (Pseudorandom Number Generator)" data-type="indexterm" id="idm45290682388472"/> <em>Pseudorandom Number Generator</em>, or PRNG. All conventional random number generators,&#13;
whether written in Fortran, C, or Java, generate pseudorandom numbers. That is, they’re&#13;
not truly random! True randomness comes only from specially built hardware: an analog&#13;
source of Brownian noise connected to an analog-to-digital converter, for&#13;
example.<a data-primary="Lavarand" data-type="indexterm" id="idm45290682382232"/><sup><a data-type="noteref" href="ch05.html#idm45290682381560" id="idm45290682381560-marker">1</a></sup> Your average PC of today may have some good sources of entropy, or even hardware-based sources of&#13;
randomness (which have not been widely used or tested yet). However, pseudorandom number&#13;
generators are good enough for most purposes, so we use them. Java provides one random&#13;
generator in the base library <code>java.lang.Math</code>, and several others; we’ll examine these in&#13;
<a data-type="xref" href="#javacook-numbers-SECT-13">Recipe 5.9</a>.</p>&#13;
&#13;
<p>The class <code>java.lang.Math</code> contains an entire math library in one class, including trigonometry, conversions (including degrees to radians and back), rounding, truncating, square root, minimum, and maximum. It’s all there. Check the javadoc for <code>java.lang.Math</code>.</p>&#13;
&#13;
<p>The package <code>java.math</code> contains support for<a data-primary="big numbers" data-type="indexterm" id="idm45290682376184"/> <em>big numbers</em>—those larger than the normal built-in long integers, for example. See <a data-type="xref" href="#javacook-numbers-SECT-19">Recipe 5.12</a>.</p>&#13;
&#13;
<p>Java works hard to ensure that your programs are reliable. The usual ways you’d notice this are in the common requirement to catch potential exceptions—all through the Java API—and in the need to <em>cast</em>, or convert, when storing a value that might or might not fit into the variable you’re trying to store it in. I’ll show examples of these.</p>&#13;
&#13;
<p>Overall, Java’s handling of numeric data fits well with the ideals of portability, reliability, and ease of programming.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="See Also" data-type="sect2"><div class="sect2" id="javacook-numbers-intro.2">&#13;
<h2>See Also</h2>&#13;
&#13;
<p>The <a href="https://docs.oracle.com/javase/specs">Java Language Specification</a>, and the javadoc page for <code>java.lang.Math</code>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="5.1 Checking Whether a String Is a Valid Number" data-type="sect1"><div class="sect1" id="javacook-numbers-SECT-1">&#13;
<h1>5.1 Checking Whether a String Is a Valid Number</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-numbers-SECT-1.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="numbers" data-secondary="checking validity of strings of" data-type="indexterm" id="nu_ch1"/><a data-primary="strings" data-secondary="of numbers, checking validity of" data-type="indexterm" id="str_nu"/>You need to check whether a given string contains a valid number, and, if so, convert it to binary (internal) form.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-numbers-SECT-1.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>To accomplish this, use the appropriate wrapper class’s conversion routine and catch the <code>NumberFormatException</code>. This code converts a string to a <code>double</code>:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting">    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">argv</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">String</code> <code class="n">aNumber</code> <code class="o">=</code> <code class="n">argv</code><code class="o">[</code><code class="mi">0</code><code class="o">];</code>    <code class="c1">// not argv[1]</code>&#13;
        <code class="kt">double</code> <code class="n">result</code><code class="o">;</code>&#13;
        <code class="k">try</code> <code class="o">{</code>&#13;
            <code class="n">result</code> <code class="o">=</code> <code class="n">Double</code><code class="o">.</code><code class="na">parseDouble</code><code class="o">(</code><code class="n">aNumber</code><code class="o">);</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Number is "</code> <code class="o">+</code> <code class="n">result</code><code class="o">);</code>&#13;
        <code class="o">}</code> <code class="k">catch</code><code class="o">(</code><code class="n">NumberFormatException</code> <code class="n">exc</code><code class="o">)</code> <code class="o">{</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Invalid number "</code> <code class="o">+</code> <code class="n">aNumber</code><code class="o">);</code>&#13;
            <code class="k">return</code><code class="o">;</code>&#13;
        <code class="o">}</code>&#13;
    <code class="o">}</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-numbers-SECT-1.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>This code lets you validate only numbers in the format that the designers of the wrapper classes expected. If you need to accept a different definition of numbers, you could use regular expressions (see <a data-type="xref" href="ch04.html#javacook-regex">Chapter 4</a>) to make the determination.</p>&#13;
&#13;
<p>There may also be times when you want to tell if a given number is an integer number or a floating-point number. One way is to check for the characters ., <code>d</code>, <code>e</code>, or <code>f</code> in the input; if one of these characters is present, convert the number as a <code>double</code>. Otherwise, convert it as an <code>int</code>:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting">    <code class="cm">/*</code>&#13;
<code class="cm">     * Process one String, returning it as a Number subclass</code>&#13;
<code class="cm">     */</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="n">Number</code> <code class="nf">process</code><code class="o">(</code><code class="n">String</code> <code class="n">s</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="k">if</code> <code class="o">(</code><code class="n">s</code><code class="o">.</code><code class="na">matches</code><code class="o">(</code><code class="s">"[+-]*\\d*\\.\\d+[dDeEfF]*"</code><code class="o">))</code> <code class="o">{</code>&#13;
            <code class="k">try</code> <code class="o">{</code>&#13;
                <code class="kt">double</code> <code class="n">dValue</code> <code class="o">=</code> <code class="n">Double</code><code class="o">.</code><code class="na">parseDouble</code><code class="o">(</code><code class="n">s</code><code class="o">);</code>&#13;
                <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"It's a double: "</code> <code class="o">+</code> <code class="n">dValue</code><code class="o">);</code>&#13;
                <code class="k">return</code> <code class="n">Double</code><code class="o">.</code><code class="na">valueOf</code><code class="o">(</code><code class="n">dValue</code><code class="o">);</code>&#13;
            <code class="o">}</code> <code class="k">catch</code> <code class="o">(</code><code class="n">NumberFormatException</code> <code class="n">e</code><code class="o">)</code> <code class="o">{</code>&#13;
                <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Invalid double: "</code> <code class="o">+</code> <code class="n">s</code><code class="o">);</code>&#13;
                <code class="k">return</code> <code class="n">Double</code><code class="o">.</code><code class="na">NaN</code><code class="o">;</code>&#13;
            <code class="o">}</code>&#13;
        <code class="o">}</code> <code class="k">else</code> <code class="c1">// did not contain . d e or f, so try as int.</code>&#13;
            <code class="k">try</code> <code class="o">{</code>&#13;
                <code class="kt">int</code> <code class="n">iValue</code> <code class="o">=</code> <code class="n">Integer</code><code class="o">.</code><code class="na">parseInt</code><code class="o">(</code><code class="n">s</code><code class="o">);</code>&#13;
                <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"It's an int: "</code> <code class="o">+</code> <code class="n">iValue</code><code class="o">);</code>&#13;
                <code class="k">return</code> <code class="n">Integer</code><code class="o">.</code><code class="na">valueOf</code><code class="o">(</code><code class="n">iValue</code><code class="o">);</code>&#13;
            <code class="o">}</code> <code class="k">catch</code> <code class="o">(</code><code class="n">NumberFormatException</code> <code class="n">e2</code><code class="o">)</code> <code class="o">{</code>&#13;
                <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Not a number: "</code> <code class="o">+</code> <code class="n">s</code><code class="o">);</code>&#13;
                <code class="k">return</code> <code class="n">Double</code><code class="o">.</code><code class="na">NaN</code><code class="o">;</code>&#13;
            <code class="o">}</code>&#13;
    <code class="o">}</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="See Also" data-type="sect2"><div class="sect2" id="javacook-numbers-SECT-1.4">&#13;
<h2>See Also</h2>&#13;
&#13;
<p>A more involved form of parsing is offered by the <code>DecimalFormat</code> class, discussed in <a data-type="xref" href="#javacook-numbers-SECT-8">Recipe 5.5</a>.</p>&#13;
&#13;
<p>There is also the <code>Scanner</code> class; see <a data-type="xref" href="ch10.html#javacook-io-SECT-5">Recipe 10.6</a>.<a data-primary="" data-startref="nu_ch" data-type="indexterm" id="idm45290681841528"/><a data-primary="" data-startref="str_nu" data-type="indexterm" id="idm45290681840552"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="5.2 Converting Numbers to Objects and Vice Versa" data-type="sect1"><div class="sect1" id="javacook-numbers-SECT-3">&#13;
<h1>5.2 Converting Numbers to Objects and Vice Versa</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-numbers-SECT-3.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="numbers" data-secondary="converting to/from objects" data-type="indexterm" id="idm45290681836424"/><a data-primary="objects" data-secondary="converting to/from numbers" data-type="indexterm" id="idm45290681835480"/>You need to convert numbers to objects and objects to numbers.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-numbers-SECT-3.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use the object wrapper classes listed in <a data-type="xref" href="#javacook-numbers-TABLE-1">Table 5-1</a> at the beginning of this chapter.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-numbers-SECT-3.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>Often you have a primitive number and you need to pass it into a method where an <code>Object</code> is required, or vice versa. Long ago you had to invoke the conversion routines that are part of the <code>wrapper</code> classes, but now you<a data-primary="auto-boxing/auto-unboxing" data-type="indexterm" id="idm45290681828392"/> can generally use automatic conversion (called <em>auto-boxing</em>/<em>auto-unboxing</em>).&#13;
See <a data-type="xref" href="#javacook-CHP-8-EX-6">Example 5-1</a> for examples of both.</p>&#13;
<div data-type="example" id="javacook-CHP-8-EX-6">&#13;
<h5><span class="label">Example 5-1. </span>main/src/main/java/structure/AutoboxDemo.java</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code><code> </code><code class="kd">class</code><code> </code><code class="nc">AutoboxDemo</code><code> </code><code class="o">{</code><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="cm">/** Shows auto-boxing (in the call to foo(i), i is wrapped automatically)&#13;
     * and auto-unboxing (the return value is automatically unwrapped).&#13;
     */</code><code>&#13;
</code><code>    </code><code class="kd">public</code><code> </code><code class="kd">static</code><code> </code><code class="kt">void</code><code> </code><code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[</code><code class="o">]</code><code> </code><code class="n">args</code><code class="o">)</code><code> </code><code class="o">{</code><code>&#13;
</code><code>        </code><code class="kt">int</code><code> </code><code class="n">i</code><code> </code><code class="o">=</code><code> </code><code class="mi">42</code><code class="o">;</code><code>&#13;
</code><code>        </code><code class="kt">int</code><code> </code><code class="n">result</code><code> </code><code class="o">=</code><code> </code><code class="n">foo</code><code class="o">(</code><code class="n">i</code><code class="o">)</code><code class="o">;</code><code>            </code><a class="co" href="#callout_numbers_CO1-1" id="co_numbers_CO1-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>        </code><code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">result</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="o">}</code><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="kd">public</code><code> </code><code class="kd">static</code><code> </code><code class="n">Integer</code><code> </code><code class="nf">foo</code><code class="o">(</code><code class="n">Integer</code><code> </code><code class="n">i</code><code class="o">)</code><code> </code><code class="o">{</code><code>&#13;
</code><code>        </code><code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Object = "</code><code> </code><code class="o">+</code><code> </code><code class="n">i</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>        </code><code class="k">return</code><code> </code><code class="n">Integer</code><code class="o">.</code><code class="na">valueOf</code><code class="o">(</code><code class="mi">123</code><code class="o">)</code><code class="o">;</code><code>    </code><a class="co" href="#callout_numbers_CO1-2" id="co_numbers_CO1-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>    </code><code class="o">}</code><code>&#13;
</code><code class="o">}</code></pre></div>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_numbers_CO1-1" id="callout_numbers_CO1-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Auto-boxing: <code>int 42</code> is converted to <code>Integer(42)</code>. Also auto-unboxing: the <code class="keep-together">Integer</code> returned from <a data-primary="foo() method" data-type="indexterm" id="idm45290682078648"/><code>foo()</code> is auto-unboxed to assign to <code>int result</code>.</p></dd>&#13;
<dt><a class="co" href="#co_numbers_CO1-2" id="callout_numbers_CO1-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>No auto-boxing: <a data-primary="valueOf() method" data-type="indexterm" id="idm45290682074760"/><code>valueOf()</code> returns <code>Integer</code>. If the line said <code>return Integer.intValueOf(123)</code>, then it would be a second example of auto-boxing because the method return value is <code>Integer</code>.</p></dd>&#13;
</dl>&#13;
&#13;
<p>To explicitly convert between an <code>int</code> and an <code>Integer</code> object, or vice versa, you can use the&#13;
<code>wrapper</code> class methods:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">IntObject</code> <code class="o">{</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">args</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="c1">// int to Integer</code>&#13;
        <code class="n">Integer</code> <code class="n">i1</code> <code class="o">=</code> <code class="n">Integer</code><code class="o">.</code><code class="na">valueOf</code><code class="o">(</code><code class="mi">42</code><code class="o">);</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">i1</code><code class="o">.</code><code class="na">toString</code><code class="o">());</code>        <code class="c1">// or just i1</code>&#13;
&#13;
        <code class="c1">// Integer to int</code>&#13;
        <code class="kt">int</code> <code class="n">i2</code> <code class="o">=</code> <code class="n">i1</code><code class="o">.</code><code class="na">intValue</code><code class="o">();</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">i2</code><code class="o">);</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="5.3 Taking a Fraction of an Integer Without Using Floating Point" data-type="sect1"><div class="sect1" id="javacook-numbers-SECT-4">&#13;
<h1>5.3 Taking a Fraction of an Integer Without Using Floating Point</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-numbers-SECT-4.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="floating point numbers" data-type="indexterm" id="idm45290681669432"/><a data-primary="numbers" data-secondary="fractions of integers" data-type="indexterm" id="idm45290681668728"/><a data-primary="integers" data-type="indexterm" id="idm45290682038376"/>You want to multiply an integer by a fraction without converting the fraction to a floating-point number.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-numbers-SECT-4.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Multiply the integer by the numerator and divide by the denominator.</p>&#13;
&#13;
<p>This technique should be used only when efficiency is more important than clarity because it tends to detract from the readability—and therefore the maintainability—of your code.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-numbers-SECT-4.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>Because integers and floating-point numbers are stored differently, it may sometimes be desirable and feasible, for efficiency purposes, to multiply an integer by a <span class="keep-together">fractional</span> value without converting the values to floating point and back, and without requiring a cast:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">FractMult</code> <code class="o">{</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">u</code><code class="o">)</code> <code class="o">{</code>&#13;
&#13;
        <code class="kt">double</code> <code class="n">d1</code> <code class="o">=</code> <code class="mf">0.666</code> <code class="o">*</code> <code class="mi">5</code><code class="o">;</code>  <code class="c1">// fast but obscure and inaccurate: convert</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">d1</code><code class="o">);</code> <code class="c1">// 2/3 to 0.666 in programmer's head</code>&#13;
&#13;
        <code class="kt">double</code> <code class="n">d2</code> <code class="o">=</code> <code class="mi">2</code><code class="o">/</code><code class="mi">3</code> <code class="o">*</code> <code class="mi">5</code><code class="o">;</code>    <code class="c1">// wrong answer - 2/3 == 0, 0*5 = 0</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">d2</code><code class="o">);</code>&#13;
&#13;
        <code class="kt">double</code> <code class="n">d3</code> <code class="o">=</code> <code class="mi">2</code><code class="n">d</code><code class="o">/</code><code class="mi">3</code><code class="n">d</code> <code class="o">*</code> <code class="mi">5</code><code class="o">;</code>  <code class="c1">// "normal"</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">d3</code><code class="o">);</code>&#13;
&#13;
        <code class="kt">double</code> <code class="n">d4</code> <code class="o">=</code> <code class="o">(</code><code class="mi">2</code><code class="o">*</code><code class="mi">5</code><code class="o">)/</code><code class="mi">3</code><code class="n">d</code><code class="o">;</code>   <code class="c1">// one step done as integers, almost same answer</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">d4</code><code class="o">);</code>&#13;
&#13;
        <code class="kt">int</code> <code class="n">i5</code> <code class="o">=</code> <code class="mi">2</code><code class="o">*</code><code class="mi">5</code><code class="o">/</code><code class="mi">3</code><code class="o">;</code>         <code class="c1">// fast, approximate integer answer</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">i5</code><code class="o">);</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p>Running the code looks like this:</p>&#13;
<pre data-type="programlisting" id="I_5_tt152">$ <strong>java numbers.FractMult</strong>&#13;
3.33&#13;
0.0&#13;
3.333333333333333&#13;
3.3333333333333335&#13;
3&#13;
$</pre>&#13;
&#13;
<p>You should beware of the possibility of numeric overflow and avoid this optimization&#13;
if you cannot guarantee that the multiplication by the numerator will not <span class="keep-together">overflow</span>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="5.4 Working with Floating-Point Numbers" data-type="sect1"><div class="sect1" id="javacook-numbers-SECT-5">&#13;
<h1>5.4 Working with Floating-Point Numbers</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-numbers-SECT-5.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="floating point numbers" data-type="indexterm" id="fpn_a"/>You want to be able to compare and round floating-point numbers.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-numbers-SECT-5.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Compare with the <code>INFINITY</code> constants, and use <a data-primary="isNaN() method" data-type="indexterm" id="idm45290681548824"/><code>isNaN()</code> to check for <code>NaN</code> (not a number).</p>&#13;
&#13;
<p>Compare floating values with an epsilon value.</p>&#13;
&#13;
<p>Round floating point values with <a data-primary="Math.round() method" data-type="indexterm" id="idm45290681546328"/><code>Math.round()</code> or custom code.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="idm45290681545112">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>Comparisons can be a bit tricky: fixed-point operations that can do things like divide by zero result in Java notifying you abruptly by throwing an exception. This is because integer division by zero is considered a <a data-primary="logic error" data-type="indexterm" id="idm45290681543240"/><em>logic error</em>.</p>&#13;
&#13;
<p>Floating-point operations, however, do not throw an exception because they are defined over an (almost) infinite range of values. Instead, they signal errors by producing the constant <code>POSITIVE_INFINITY</code>  if you divide a positive floating-point number by zero, the constant <code>NEGATIVE_INFINITY</code> if you divide a negative floating-point value by zero, and <code>NaN</code> if you otherwise generate an invalid result. Values for these three public constants are defined in both the <code>Float</code> and the <code>Double</code> wrapper classes. The value <code>NaN</code> has the unusual property that it is not equal to itself (i.e., <code>NaN</code> != <code>NaN</code>). Thus, it would hardly make sense to compare a (possibly suspect) number against <code>NaN</code>, because the following expression can never be true:</p>&#13;
&#13;
<pre data-type="programlisting">x == NaN</pre>&#13;
&#13;
<p>Instead, the methods <a data-primary="Float.isNaN() method" data-type="indexterm" id="idm45290681536328"/><code>Float.isNaN(float)</code> and<a data-primary="Double.isNaN() method" data-type="indexterm" id="idm45290681535208"/> <code>Double.isNaN(double)</code> must be used:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting">    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">argv</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="kt">double</code> <code class="n">d</code> <code class="o">=</code> <code class="mi">123</code><code class="o">;</code>&#13;
        <code class="kt">double</code> <code class="n">e</code> <code class="o">=</code> <code class="mi">0</code><code class="o">;</code>&#13;
        <code class="k">if</code> <code class="o">(</code><code class="n">d</code><code class="o">/</code><code class="n">e</code> <code class="o">==</code> <code class="n">Double</code><code class="o">.</code><code class="na">POSITIVE_INFINITY</code><code class="o">)</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Check for POSITIVE_INFINITY works"</code><code class="o">);</code>&#13;
        <code class="kt">double</code> <code class="n">s</code> <code class="o">=</code> <code class="n">Math</code><code class="o">.</code><code class="na">sqrt</code><code class="o">(-</code><code class="mi">1</code><code class="o">);</code>&#13;
        <code class="k">if</code> <code class="o">(</code><code class="n">s</code> <code class="o">==</code> <code class="n">Double</code><code class="o">.</code><code class="na">NaN</code><code class="o">)</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Comparison with NaN incorrectly returns true"</code><code class="o">);</code>&#13;
        <code class="k">if</code> <code class="o">(</code><code class="n">Double</code><code class="o">.</code><code class="na">isNaN</code><code class="o">(</code><code class="n">s</code><code class="o">))</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Double.isNaN() correctly returns true"</code><code class="o">);</code>&#13;
    <code class="o">}</code></pre>&#13;
&#13;
<p>Note that this, by itself, is not sufficient to ensure that floating-point calculations have been done with adequate accuracy. For example, the following program demonstrates a contrived calculation—Heron’s formula for the area of a triangle—both in <code>float</code> and in <code>double</code>. The double values are correct, but the floating-point value comes out as zero due to rounding errors. This happens because, in Java, operations involving only <code>float</code> values are performed as 32-bit calculations. Related languages such as C automatically promote these to double during the computation, which can eliminate some loss of accuracy. Let’s take a look:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">Heron</code> <code class="o">{</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">args</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="c1">// Sides for triangle in float</code>&#13;
        <code class="kt">float</code> <code class="n">af</code><code class="o">,</code> <code class="n">bf</code><code class="o">,</code> <code class="n">cf</code><code class="o">;</code>&#13;
        <code class="kt">float</code> <code class="n">sf</code><code class="o">,</code> <code class="n">areaf</code><code class="o">;</code>&#13;
&#13;
        <code class="c1">// Ditto in double</code>&#13;
        <code class="kt">double</code> <code class="n">ad</code><code class="o">,</code> <code class="n">bd</code><code class="o">,</code> <code class="n">cd</code><code class="o">;</code>&#13;
        <code class="kt">double</code> <code class="n">sd</code><code class="o">,</code> <code class="n">aread</code><code class="o">;</code>&#13;
&#13;
        <code class="c1">// Area of triangle in float</code>&#13;
        <code class="n">af</code> <code class="o">=</code> <code class="mf">12345679.0f</code><code class="o">;</code>&#13;
        <code class="n">bf</code> <code class="o">=</code> <code class="mf">12345678.0f</code><code class="o">;</code>&#13;
        <code class="n">cf</code> <code class="o">=</code> <code class="mf">1.01233995f</code><code class="o">;</code>&#13;
&#13;
        <code class="n">sf</code> <code class="o">=</code> <code class="o">(</code><code class="n">af</code><code class="o">+</code><code class="n">bf</code><code class="o">+</code><code class="n">cf</code><code class="o">)/</code><code class="mf">2.0f</code><code class="o">;</code>&#13;
        <code class="n">areaf</code> <code class="o">=</code> <code class="o">(</code><code class="kt">float</code><code class="o">)</code><code class="n">Math</code><code class="o">.</code><code class="na">sqrt</code><code class="o">(</code><code class="n">sf</code> <code class="o">*</code> <code class="o">(</code><code class="n">sf</code> <code class="o">-</code> <code class="n">af</code><code class="o">)</code> <code class="o">*</code> <code class="o">(</code><code class="n">sf</code> <code class="o">-</code> <code class="n">bf</code><code class="o">)</code> <code class="o">*</code> <code class="o">(</code><code class="n">sf</code> <code class="o">-</code> <code class="n">cf</code><code class="o">));</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Single precision: "</code> <code class="o">+</code> <code class="n">areaf</code><code class="o">);</code>&#13;
&#13;
        <code class="c1">// Area of triangle in double</code>&#13;
        <code class="n">ad</code> <code class="o">=</code> <code class="mf">12345679.0</code><code class="o">;</code>&#13;
        <code class="n">bd</code> <code class="o">=</code> <code class="mf">12345678.0</code><code class="o">;</code>&#13;
        <code class="n">cd</code> <code class="o">=</code> <code class="mf">1.01233995</code><code class="o">;</code>&#13;
&#13;
        <code class="n">sd</code> <code class="o">=</code> <code class="o">(</code><code class="n">ad</code><code class="o">+</code><code class="n">bd</code><code class="o">+</code><code class="n">cd</code><code class="o">)/</code><code class="mf">2.0d</code><code class="o">;</code>&#13;
        <code class="n">aread</code> <code class="o">=</code> <code class="n">Math</code><code class="o">.</code><code class="na">sqrt</code><code class="o">(</code><code class="n">sd</code> <code class="o">*</code> <code class="o">(</code><code class="n">sd</code> <code class="o">-</code> <code class="n">ad</code><code class="o">)</code> <code class="o">*</code> <code class="o">(</code><code class="n">sd</code> <code class="o">-</code> <code class="n">bd</code><code class="o">)</code> <code class="o">*</code> <code class="o">(</code><code class="n">sd</code> <code class="o">-</code> <code class="n">cd</code><code class="o">));</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Double precision: "</code> <code class="o">+</code> <code class="n">aread</code><code class="o">);</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p>Now let’s run it:</p>&#13;
<pre data-type="programlisting" id="I_5_tt156">$ <strong>java numbers.Heron</strong>&#13;
Single precision: 0.0&#13;
Double precision: 972730.0557076167&#13;
</pre>&#13;
&#13;
<p>If in doubt, use <code>double</code>!</p>&#13;
&#13;
<p>To ensure consistency of very large-magnitude double computations on different Java implementations, Java provides the keyword <code>strictfp</code>, which can apply to classes, interfaces, or methods within a class.<sup><a data-type="noteref" href="ch05.html#idm45290681215064" id="idm45290681215064-marker">2</a></sup> If a computation is Strict-FP, then it must always, for example, return the value <code>INFINITY</code> if a calculation would overflow the value of <code>Double.MAX_VALUE</code>  (or underflow the value <code>Double.MIN_VALUE</code>). Non-Strict-FP calculations—the default—are allowed to perform calculations on a greater range and can return a valid final result that is in range even if the interim product was out of range. This is pretty esoteric and affects only computations that approach the bounds of what fits into a double.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Comparing floating-point values" data-type="sect3"><div class="sect3" id="idm45290681212424">&#13;
<h3>Comparing floating-point values</h3>&#13;
&#13;
<p>Based on what we’ve just discussed, you probably won’t just go comparing two floats or doubles for equality. You might expect the floating-point wrapper classes, <code>Float</code> and <code>Double</code>, to override the <a data-primary="equals() method" data-type="indexterm" id="idm45290681209576"/><code>equals()</code> method, which they do. The <code>equals()</code> method returns <code>true</code> if the two values are the same bit for bit (i.e., if and only if the numbers are the same or are both <code>NaN</code>). It returns <code>false</code> otherwise, including if the argument passed in is null, or if one object is +0.0 and the other is –0.0.</p>&#13;
&#13;
<p>I said earlier that <code>NaN != Nan</code>, but if you compare with <code>equals()</code>,&#13;
the result is true:</p>&#13;
&#13;
<pre data-type="programlisting">jshell&gt; Float f1 = Float.valueOf(Float.NaN)&#13;
f1 ==&gt; NaN&#13;
&#13;
jshell&gt; Float f2 = Float.valueOf(Float.NaN)&#13;
f2 ==&gt; NaN&#13;
&#13;
jshell&gt; f1 == f2 # Comparing object identities&#13;
$4 ==&gt; false&#13;
&#13;
jshell&gt; f1.equals(f1) # bitwise comparison of values&#13;
$5 ==&gt; true</pre>&#13;
&#13;
<p>If this sounds weird, remember that the complexity comes partly from the nature of doing real number computations in the less-precise floating-point hardware. It also comes partly from the details of the <a data-primary="IEEE Standard 754" data-type="indexterm" id="idm45290681203720"/>IEEE Standard 754, which specifies the floating-point functionality that Java tries to adhere to so that underlying floating-point processor hardware can be used even when Java programs are being interpreted.</p>&#13;
&#13;
<p>To actually compare floating-point numbers for equality, it is generally desirable to compare them within some tiny range of allowable differences; this range is often regarded as a <a data-primary="tolerance" data-type="indexterm" id="idm45290681201864"/>tolerance or as <a data-primary="epsilon" data-type="indexterm" id="idm45290681201032"/><em>epsilon</em>. <a data-type="xref" href="#javacook-numbers-EX-1">Example 5-2</a> shows an <a data-primary="equals() method" data-type="indexterm" id="idm45290681199080"/><code>equals()</code> method you can use to do this comparison, as well as comparisons on values of <code>NaN</code>. When run, it prints that the first two numbers are equal within epsilon:</p>&#13;
<pre data-type="programlisting" id="I_5_tt157">$ <strong>java numbers.FloatCmp</strong>&#13;
True within epsilon 1.0E-7&#13;
$</pre>&#13;
<div data-type="example" id="javacook-numbers-EX-1">&#13;
<h5><span class="label">Example 5-2. </span>main/src/main/java/numbers/FloatCmp.java</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">FloatCmp</code> <code class="o">{</code>&#13;
&#13;
    <code class="kd">final</code> <code class="kd">static</code> <code class="kt">double</code> <code class="n">EPSILON</code> <code class="o">=</code> <code class="mf">0.0000001</code><code class="o">;</code>&#13;
&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">argv</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="kt">double</code> <code class="n">da</code> <code class="o">=</code> <code class="mi">3</code> <code class="o">*</code> <code class="o">.</code><code class="mi">3333333333</code><code class="o">;</code>&#13;
        <code class="kt">double</code> <code class="n">db</code> <code class="o">=</code> <code class="mf">0.99999992857</code><code class="o">;</code>&#13;
&#13;
        <code class="c1">// Compare two numbers that are expected to be close.</code>&#13;
        <code class="k">if</code> <code class="o">(</code><code class="n">da</code> <code class="o">==</code> <code class="n">db</code><code class="o">)</code> <code class="o">{</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Java considers "</code> <code class="o">+</code> <code class="n">da</code> <code class="o">+</code> <code class="s">"=="</code> <code class="o">+</code> <code class="n">db</code><code class="o">);</code>&#13;
        <code class="c1">// else compare with our own equals overload</code>&#13;
        <code class="o">}</code> <code class="k">else</code> <code class="k">if</code> <code class="o">(</code><code class="n">equals</code><code class="o">(</code><code class="n">da</code><code class="o">,</code> <code class="n">db</code><code class="o">,</code> <code class="mf">0.0000001</code><code class="o">))</code> <code class="o">{</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Equal within epsilon "</code> <code class="o">+</code> <code class="n">EPSILON</code><code class="o">);</code>&#13;
        <code class="o">}</code> <code class="k">else</code> <code class="o">{</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">da</code> <code class="o">+</code> <code class="s">" != "</code> <code class="o">+</code> <code class="n">db</code><code class="o">);</code>&#13;
        <code class="o">}</code>&#13;
&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"NaN prints as "</code> <code class="o">+</code> <code class="n">Double</code><code class="o">.</code><code class="na">NaN</code><code class="o">);</code>&#13;
&#13;
        <code class="c1">// Show that comparing two NaNs is not a good idea:</code>&#13;
        <code class="kt">double</code> <code class="n">nan1</code> <code class="o">=</code> <code class="n">Double</code><code class="o">.</code><code class="na">NaN</code><code class="o">;</code>&#13;
        <code class="kt">double</code> <code class="n">nan2</code> <code class="o">=</code> <code class="n">Double</code><code class="o">.</code><code class="na">NaN</code><code class="o">;</code>&#13;
        <code class="k">if</code> <code class="o">(</code><code class="n">nan1</code> <code class="o">==</code> <code class="n">nan2</code><code class="o">)</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Comparing two NaNs incorrectly returns true."</code><code class="o">);</code>&#13;
        <code class="k">else</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Comparing two NaNs correctly reports false."</code><code class="o">);</code>&#13;
&#13;
        <code class="k">if</code> <code class="o">(</code><code class="n">Double</code><code class="o">.</code><code class="na">valueOf</code><code class="o">(</code><code class="n">nan1</code><code class="o">).</code><code class="na">equals</code><code class="o">(</code><code class="n">Double</code><code class="o">.</code><code class="na">valueOf</code><code class="o">(</code><code class="n">nan2</code><code class="o">)))</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Double(NaN).equals(NaN) correctly returns true."</code><code class="o">);</code>&#13;
        <code class="k">else</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code>&#13;
                <code class="s">"Double(NaN).equals(NaN) incorrectly returns false."</code><code class="o">);</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/** Compare two doubles within a given epsilon */</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">boolean</code> <code class="nf">equals</code><code class="o">(</code><code class="kt">double</code> <code class="n">a</code><code class="o">,</code> <code class="kt">double</code> <code class="n">b</code><code class="o">,</code> <code class="kt">double</code> <code class="n">eps</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="k">if</code> <code class="o">(</code><code class="n">a</code><code class="o">==</code><code class="n">b</code><code class="o">)</code> <code class="k">return</code> <code class="kc">true</code><code class="o">;</code>&#13;
        <code class="c1">// If the difference is less than epsilon, treat as equal.</code>&#13;
        <code class="k">return</code> <code class="n">Math</code><code class="o">.</code><code class="na">abs</code><code class="o">(</code><code class="n">a</code> <code class="o">-</code> <code class="n">b</code><code class="o">)</code> <code class="o">&lt;</code> <code class="n">eps</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/** Compare two doubles, using default epsilon */</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">boolean</code> <code class="nf">equals</code><code class="o">(</code><code class="kt">double</code> <code class="n">a</code><code class="o">,</code> <code class="kt">double</code> <code class="n">b</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="k">return</code> <code class="nf">equals</code><code class="o">(</code><code class="n">a</code><code class="o">,</code> <code class="n">b</code><code class="o">,</code> <code class="n">EPSILON</code><code class="o">);</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre></div>&#13;
&#13;
<p>Note that neither of the <code>System.err</code> messages about incorrect returns prints. The point of this example with <code>NaN</code>s is that you should always make sure values are not <code>NaN</code> before entrusting them to <a data-primary="Double.equals() method" data-type="indexterm" id="idm45290681185656"/><code>Double.equals()</code>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Rounding" data-type="sect3"><div class="sect3" id="idm45290681184536">&#13;
<h3>Rounding</h3>&#13;
&#13;
<p><a data-primary="rounding" data-type="indexterm" id="idm45290681183064"/>If you simply cast a floating value to an integer value, Java truncates the value. A value like 3.999999 cast to an <code>int</code> or <code>long</code> becomes 3, not 4. To round floating-point numbers properly, use <a data-primary="Math.round() method" data-type="indexterm" id="idm45290680863176"/><code>Math.round()</code>. It has two overloads: if you give it a <code>double</code>, you get a <code>long</code> result; if you give it a <code>float</code>, you get an <code>int</code>.</p>&#13;
&#13;
<p>What if you don’t like the rounding rules used by <a data-primary="round() method" data-type="indexterm" id="idm45290680859976"/><code>round</code>? If, for some bizarre reason, you wanted to round numbers greater than 0.54 instead of the normal 0.5, you could write your own version of <code>round()</code>:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">Round</code> <code class="o">{</code>&#13;
    <code class="cm">/** We round a number up if its fraction exceeds this threshold. */</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kd">final</code> <code class="kt">double</code> <code class="n">THRESHOLD</code> <code class="o">=</code> <code class="mf">0.54</code><code class="o">;</code>&#13;
&#13;
    <code class="cm">/*</code>&#13;
<code class="cm">     * Round floating values to integers.</code>&#13;
<code class="cm">     * @return the closest int to the argument.</code>&#13;
<code class="cm">     * @param d A non-negative values to be rounded.</code>&#13;
<code class="cm">     */</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">int</code> <code class="nf">round</code><code class="o">(</code><code class="kt">double</code> <code class="n">d</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="k">return</code> <code class="o">(</code><code class="kt">int</code><code class="o">)</code><code class="n">Math</code><code class="o">.</code><code class="na">floor</code><code class="o">(</code><code class="n">d</code> <code class="o">+</code> <code class="mf">1.0</code> <code class="o">-</code> <code class="n">THRESHOLD</code><code class="o">);</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">argv</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="kt">double</code> <code class="n">d</code> <code class="o">=</code> <code class="mf">0.1</code><code class="o">;</code> <code class="n">d</code><code class="o">&lt;=</code><code class="mf">1.0</code><code class="o">;</code> <code class="n">d</code><code class="o">+=</code><code class="mf">0.05</code><code class="o">)</code> <code class="o">{</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"My way:  "</code> <code class="o">+</code> <code class="n">d</code> <code class="o">+</code> <code class="s">"-&gt; "</code> <code class="o">+</code> <code class="n">round</code><code class="o">(</code><code class="n">d</code><code class="o">));</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Math way:"</code> <code class="o">+</code> <code class="n">d</code> <code class="o">+</code> <code class="s">"-&gt; "</code> <code class="o">+</code> <code class="n">Math</code><code class="o">.</code><code class="na">round</code><code class="o">(</code><code class="n">d</code><code class="o">));</code>&#13;
        <code class="o">}</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p>If, on the other hand, you simply want to display a number with less precision than it normally&#13;
gets, you probably want to use a <code>DecimalFormat</code> object or a <code>Formatter</code> object, which we&#13;
look at in <a data-type="xref" href="#javacook-numbers-SECT-8">Recipe 5.5</a>.<a data-primary="" data-startref="fpn_a" data-type="indexterm" id="idm45290680835096"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="5.5 Formatting Numbers" data-type="sect1"><div class="sect1" id="javacook-numbers-SECT-8">&#13;
<h1>5.5 Formatting Numbers</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-numbers-SECT-8.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="formatting" data-secondary="numbers" data-type="indexterm" id="fo_nu"/><a data-primary="numbers" data-secondary="formatting" data-type="indexterm" id="nu_fo"/>You need to format numbers.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-numbers-SECT-8.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use a <code>NumberFormat</code> subclass.</p>&#13;
&#13;
<p>Java did not originally provide C-style <code>printf/scanf</code> functions because they tend to mix together formatting and input/output in a very inflexible way. Programs using <code>printf/scanf</code> can be hard to internationalize, for example.&#13;
Of course, by popular demand, Java did eventually introduce <a data-primary="printf() method" data-type="indexterm" id="idm45290680761944"/><code>printf()</code>, which along with <a data-primary="String.format() method" data-type="indexterm" id="idm45290680760856"/><code>String.format()</code>&#13;
is now standard in Java; see <a data-type="xref" href="ch10.html#javacook-io-SECT-3">Recipe 10.4</a>.</p>&#13;
&#13;
<p>Java has an entire package, <code>java.text</code>, full of formatting routines as general and flexible as anything you might imagine. As with <code>printf</code>, it has an involved formatting language, described in the javadoc page. Consider the presentation of long numbers. In North America, the number one thousand twenty-four and a quarter is written 1,024.25; in most of Europe it is 1 024,25; and in some other part of the world it might be written 1.024,25. Not to mention how currencies and percentages are <span class="keep-together">formatted!</span> Trying to keep track of this yourself would drive the average small software shop around the bend rather quickly.</p>&#13;
&#13;
<p>Fortunately, the <code>java.text</code> package includes a <code>Locale</code> class; and, furthermore, the Java runtime automatically sets a default <code>Locale</code> object based on the user’s environment (on the Macintosh and Windows, the user’s preferences, and on Unix, the user’s environment variables). To provide a nondefault locale in code, see <a data-type="xref" href="ch03.html#javacook-i18n-SECT-8">Recipe 3.12</a>. To provide formatters customized for numbers, currencies, and percentages, the <code>NumberFormat</code> class has static<a data-primary="factory methods" data-type="indexterm" id="idm45290680753240"/> <em>factory methods</em> that normally return a <code>DecimalFormat</code> with the correct pattern already instantiated. A <code>DecimalFormat</code> object appropriate to the user’s locale can be obtained from the factory method <a data-primary="NumberFormat.getInstance() method" data-type="indexterm" id="idm45290680751016"/><code>NumberFormat.getInstance()</code> and manipulated using <a data-primary="set methods" data-type="indexterm" id="idm45290680749864"/><code>set</code> methods. Surprisingly, the method <a data-primary="setMinimumIntegerDigits() method" data-type="indexterm" id="idm45290680748728"/><code>setMinimumIntegerDigits()</code> turns out to be the easy way to generate a number format with leading zeros. Here is an example:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">NumFormat2</code> <code class="o">{</code>&#13;
    <code class="cm">/** A number to format */</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kd">final</code> <code class="kt">double</code> <code class="n">data</code><code class="o">[]</code> <code class="o">=</code> <code class="o">{</code>&#13;
        <code class="mi">0</code><code class="o">,</code> <code class="mi">1</code><code class="o">,</code> <code class="mi">22</code><code class="n">d</code><code class="o">/</code><code class="mi">7</code><code class="o">,</code> <code class="mf">100.2345678</code>&#13;
    <code class="o">};</code>&#13;
&#13;
    <code class="cm">/** The main (and only) method in this class. */</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">av</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="c1">// Get a format instance</code>&#13;
        <code class="n">NumberFormat</code> <code class="n">form</code> <code class="o">=</code> <code class="n">NumberFormat</code><code class="o">.</code><code class="na">getInstance</code><code class="o">();</code>&#13;
&#13;
        <code class="c1">// Set it to look like 999.99[99]</code>&#13;
        <code class="n">form</code><code class="o">.</code><code class="na">setMinimumIntegerDigits</code><code class="o">(</code><code class="mi">3</code><code class="o">);</code>&#13;
        <code class="n">form</code><code class="o">.</code><code class="na">setMinimumFractionDigits</code><code class="o">(</code><code class="mi">2</code><code class="o">);</code>&#13;
        <code class="n">form</code><code class="o">.</code><code class="na">setMaximumFractionDigits</code><code class="o">(</code><code class="mi">4</code><code class="o">);</code>&#13;
&#13;
        <code class="c1">// Now print using it</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">i</code><code class="o">=</code><code class="mi">0</code><code class="o">;</code> <code class="n">i</code><code class="o">&lt;</code><code class="n">data</code><code class="o">.</code><code class="na">length</code><code class="o">;</code> <code class="n">i</code><code class="o">++)</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">data</code><code class="o">[</code><code class="n">i</code><code class="o">]</code> <code class="o">+</code> <code class="s">"\tformats as "</code> <code class="o">+</code>&#13;
                <code class="n">form</code><code class="o">.</code><code class="na">format</code><code class="o">(</code><code class="n">data</code><code class="o">[</code><code class="n">i</code><code class="o">]));</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p>This prints the contents of the array using the <code>NumberFormat</code> instance <code>form</code>:</p>&#13;
<pre data-type="programlisting" id="I_5_tt160">$ <strong>java numbers.NumFormat2</strong>&#13;
0.0     formats as 000.00&#13;
1.0     formats as 001.00&#13;
3.142857142857143       formats as 003.1429&#13;
100.2345678     formats as 100.2346&#13;
$</pre>&#13;
&#13;
<p>You can also construct a <code>DecimalFormat</code> with a particular pattern or change the pattern dynamically using <a data-primary="applyPattern() method" data-type="indexterm" id="idm45290680509720"/><code>applyPattern()</code>. Some of the more common pattern characters are shown in<a data-primary="DercimalFormat" data-type="indexterm" id="idm45290680508632"/> <a data-type="xref" href="#javacook-numbers-TABLE-2">Table 5-2</a>.</p>&#13;
<table id="javacook-numbers-TABLE-2">&#13;
<caption><span class="label">Table 5-2. </span>DecimalFormat pattern characters</caption>&#13;
<thead>&#13;
<tr>&#13;
<th>Character</th>&#13;
<th>Meaning</th>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td><p><code>#</code></p></td>&#13;
<td><p>Numeric digit (leading zeros suppressed)</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>0</code></p></td>&#13;
<td><p>Numeric digit (leading zeros provided)</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>.</p></td>&#13;
<td><p>Locale-specific decimal separator (decimal point)</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>,</p></td>&#13;
<td><p>Locale-specific grouping separator (comma in English)</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>-</code></p></td>&#13;
<td><p>Locale-specific negative indicator (minus sign)</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>%</code></p></td>&#13;
<td><p>Shows the value as a percentage</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>;</code></p></td>&#13;
<td><p>Separates two formats: the first for positive and the second for negative values</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>'</p></td>&#13;
<td><p>Escapes one of the above characters so it appears</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>Anything else</p></td>&#13;
<td><p>Appears as itself</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
&#13;
<p>The <code>NumFormatDemo</code> program uses one <code>DecimalFormat</code> to print a number with only two decimal places and a second to format the number according to the default locale:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting">    <code class="cm">/** A number to format */</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kd">final</code> <code class="kt">double</code> <code class="n">intlNumber</code> <code class="o">=</code> <code class="mf">1024.25</code><code class="o">;</code>&#13;
    <code class="cm">/** Another number to format */</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kd">final</code> <code class="kt">double</code> <code class="n">ourNumber</code> <code class="o">=</code> <code class="mf">100.2345678</code><code class="o">;</code>&#13;
        <code class="n">NumberFormat</code> <code class="n">defForm</code> <code class="o">=</code> <code class="n">NumberFormat</code><code class="o">.</code><code class="na">getInstance</code><code class="o">();</code>&#13;
        <code class="n">NumberFormat</code> <code class="n">ourForm</code> <code class="o">=</code> <code class="k">new</code> <code class="n">DecimalFormat</code><code class="o">(</code><code class="s">"##0.##"</code><code class="o">);</code>&#13;
        <code class="c1">// toPattern() will reveal the combination of #0., etc</code>&#13;
        <code class="c1">// that this particular Locale uses to format with!</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"defForm's pattern is "</code> <code class="o">+</code>&#13;
            <code class="o">((</code><code class="n">DecimalFormat</code><code class="o">)</code><code class="n">defForm</code><code class="o">).</code><code class="na">toPattern</code><code class="o">());</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">intlNumber</code> <code class="o">+</code> <code class="s">" formats as "</code> <code class="o">+</code>&#13;
            <code class="n">defForm</code><code class="o">.</code><code class="na">format</code><code class="o">(</code><code class="n">intlNumber</code><code class="o">));</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">ourNumber</code> <code class="o">+</code> <code class="s">" formats as "</code> <code class="o">+</code>&#13;
            <code class="n">ourForm</code><code class="o">.</code><code class="na">format</code><code class="o">(</code><code class="n">ourNumber</code><code class="o">));</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">ourNumber</code> <code class="o">+</code> <code class="s">" formats as "</code> <code class="o">+</code>&#13;
            <code class="n">defForm</code><code class="o">.</code><code class="na">format</code><code class="o">(</code><code class="n">ourNumber</code><code class="o">)</code> <code class="o">+</code> <code class="s">" using the default format"</code><code class="o">);</code></pre>&#13;
&#13;
<p>This program prints the given pattern and then formats the same number using several formats:</p>&#13;
<pre data-type="programlisting" id="I_5_tt162">$ <strong>java numbers.NumFormatDemo</strong>&#13;
defForm's pattern is #,##0.###&#13;
1024.25 formats as 1,024.25&#13;
100.2345678 formats as 100.23&#13;
100.2345678 formats as 100.235 using the default format&#13;
$</pre>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Human-readable number formatting" data-type="sect3"><div class="sect3" id="javacook-numbers-SECT-8.3">&#13;
<h3>Human-readable number formatting</h3>&#13;
&#13;
<p><a data-primary="human-readable number formatting" data-type="indexterm" id="idm45290680331784"/><a data-primary="Linux" data-type="indexterm" id="idm45290680331016"/><a data-primary="Unix" data-secondary="human-readable number formatting and" data-type="indexterm" id="idm45290680330344"/>To print a number in what Linux/Unix calls “human readable format” (many display commands&#13;
accept <code>a -h</code> argument for this format), use the Java 12 <code>CompactNumberFormat</code>, as shown in&#13;
<a data-type="xref" href="#javacook-numbers-EX-cnf">Example 5-3</a>.</p>&#13;
<div data-type="example" id="javacook-numbers-EX-cnf">&#13;
<h5><span class="label">Example 5-3. </span>nmain/src/main/java/numbers/CompactFormatDemo.java</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">CompactFormatDemo</code> <code class="o">{</code>&#13;
&#13;
    <code class="kd">static</code> <code class="kd">final</code> <code class="n">Number</code><code class="o">[]</code> <code class="n">nums</code> <code class="o">=</code> <code class="o">{</code>&#13;
        <code class="mi">0</code><code class="o">,</code> <code class="mi">1</code><code class="o">,</code> <code class="mf">1.25</code><code class="o">,</code> <code class="mi">1234</code><code class="o">,</code> <code class="mi">12345</code><code class="o">,</code> <code class="mf">123456.78</code><code class="o">,</code> <code class="mi">123456789012L</code>&#13;
    <code class="o">};</code>&#13;
    <code class="kd">static</code> <code class="kd">final</code> <code class="n">String</code><code class="o">[]</code> <code class="n">strs</code> <code class="o">=</code> <code class="o">{</code>&#13;
        <code class="s">"1"</code><code class="o">,</code> <code class="s">"1.25"</code><code class="o">,</code> <code class="s">"1234"</code><code class="o">,</code> <code class="s">"12.345K"</code><code class="o">,</code> <code class="s">"1234556.78"</code><code class="o">,</code> <code class="s">"123456789012L"</code>&#13;
    <code class="o">};</code>&#13;
&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">args</code><code class="o">)</code> <code class="kd">throws</code> <code class="n">ParseException</code> <code class="o">{</code>&#13;
        <code class="n">NumberFormat</code> <code class="n">cnf</code> <code class="o">=</code> <code class="n">NumberFormat</code><code class="o">.</code><code class="na">getCompactNumberInstance</code><code class="o">();</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Formatting:"</code><code class="o">);</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="n">Number</code> <code class="n">n</code> <code class="o">:</code> <code class="n">nums</code><code class="o">)</code> <code class="o">{</code>&#13;
            <code class="n">cnf</code><code class="o">.</code><code class="na">setParseIntegerOnly</code><code class="o">(</code><code class="kc">false</code><code class="o">);</code>&#13;
            <code class="n">cnf</code><code class="o">.</code><code class="na">setMinimumFractionDigits</code><code class="o">(</code><code class="mi">2</code><code class="o">);</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">n</code> <code class="o">+</code> <code class="s">": "</code> <code class="o">+</code> <code class="n">cnf</code><code class="o">.</code><code class="na">format</code><code class="o">(</code><code class="n">n</code><code class="o">));</code>&#13;
        <code class="o">}</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Parsing:"</code><code class="o">);</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="n">String</code> <code class="n">s</code> <code class="o">:</code> <code class="n">strs</code><code class="o">)</code> <code class="o">{</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">s</code> <code class="o">+</code> <code class="s">": "</code> <code class="o">+</code> <code class="n">cnf</code><code class="o">.</code><code class="na">parse</code><code class="o">(</code><code class="n">s</code><code class="o">));</code>&#13;
        <code class="o">}</code>&#13;
    <code class="o">}</code>&#13;
&#13;
<code class="o">}</code></pre></div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Roman numeral formatting" data-type="sect3"><div class="sect3" id="idm45290680323144">&#13;
<h3>Roman numeral formatting</h3>&#13;
&#13;
<p><a data-primary="Roman numeral formatting" data-type="indexterm" id="idm45290680321896"/>To work with roman numerals, use my <code>RomanNumberFormat</code> class, as in this demo:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting">        <code class="n">RomanNumberFormat</code> <code class="n">nf</code> <code class="o">=</code> <code class="k">new</code> <code class="n">RomanNumberFormat</code><code class="o">();</code>&#13;
        <code class="kt">int</code> <code class="n">year</code> <code class="o">=</code> <code class="n">LocalDate</code><code class="o">.</code><code class="na">now</code><code class="o">().</code><code class="na">getYear</code><code class="o">();</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">year</code> <code class="o">+</code> <code class="s">" -&gt; "</code> <code class="o">+</code> <code class="n">nf</code><code class="o">.</code><code class="na">format</code><code class="o">(</code><code class="n">year</code><code class="o">));</code></pre>&#13;
&#13;
<p>Running <code>RomanNumberSimple</code> in 2020 produces this output:</p>&#13;
&#13;
<pre data-type="programlisting">2020-&gt;MMXX</pre>&#13;
&#13;
<p>The source of the <code>RomanNumberFormat</code> class is in <em>src/main/java/numbers/RomanNumberFormat.java</em>.&#13;
Several of the public methods are required because I wanted it to be a subclass of <code>Format</code>, which is abstract.&#13;
This accounts for some of the complexity, like having three different format methods.</p>&#13;
&#13;
<p>Note that the <a data-primary="RomanNumberFormat.parseObject() method" data-type="indexterm" id="idm45290679981784"/><code>RomanNumberFormat.parseObject( )</code> method is also required, but the code doesn’t&#13;
implement parsing in this version.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="See Also" data-type="sect2"><div class="sect2" id="javacook-numbers-SECT-11.4">&#13;
<h2>See Also</h2>&#13;
&#13;
<p><a data-primary="Java I/O (Harold)" data-type="indexterm" id="idm45290679979288"/><a data-primary="Harold, Elliotte" data-secondary="Java I/O" data-type="indexterm" id="idm45290679978584"/><em><a class="orm:hideurl" href="http://shop.oreilly.com/product/9780596527501.do">Java I/O</a></em> by Elliotte Harold (O’Reilly) includes an entire chapter on <code>NumberFormat</code> and develops the subclass <code>ExponentialNumberFormat</code>.<a data-primary="" data-startref="fo_nu" data-type="indexterm" id="idm45290679975656"/><a data-primary="" data-startref="nu_fo" data-type="indexterm" id="idm45290679974648"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="5.6 Converting Among Binary, Octal, Decimal, and Hexadecimal" data-type="sect1"><div class="sect1" id="javacook-numbers-SECT-9">&#13;
<h1>5.6 Converting Among Binary, Octal, Decimal, and Hexadecimal</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-numbers-SECT-9.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="octal numbers" data-type="indexterm" id="idm45290679970536"/><a data-primary="numbers" data-secondary="converting types of" data-type="indexterm" id="idm45290679969832"/><a data-primary="binary numbers" data-type="indexterm" id="idm45290679968888"/><a data-primary="decimal numbers" data-type="indexterm" id="idm45290679968216"/><a data-primary="hexadecimal numbers" data-type="indexterm" id="idm45290679967544"/>You want to display an integer as a series of bits—for example, when interacting with certain hardware devices—or in some alternative number base (binary is base 2, octal is base 8, decimal is 10, hexadecimal is 16). You want to convert a binary number or a hexadecimal value into an integer.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-numbers-SECT-9.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>The class <code>java.lang.Integer</code> provides the solutions. Most of the time you can use <code>Integer.parseInt(String input, int radix)</code> to convert from any type of number to an <code>Integer</code>, and <code>Integer.toString(int input, int radix)</code> to go the other way. <a data-type="xref" href="#javacook-recipe-FILE">Example 5-4</a> shows some examples of using the <code>Integer</code> class.</p>&#13;
<div data-type="example" id="javacook-recipe-FILE">&#13;
<h5><span class="label">Example 5-4. </span>main/src/main/java/numbers/IntegerBinOctHexEtc.java</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting">        <code class="n">String</code> <code class="n">input</code> <code class="o">=</code> <code class="s">"101010"</code><code class="o">;</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">radix</code> <code class="o">:</code> <code class="k">new</code> <code class="kt">int</code><code class="o">[]</code> <code class="o">{</code> <code class="mi">2</code><code class="o">,</code> <code class="mi">8</code><code class="o">,</code> <code class="mi">10</code><code class="o">,</code> <code class="mi">16</code><code class="o">,</code> <code class="mi">36</code> <code class="o">})</code> <code class="o">{</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">print</code><code class="o">(</code><code class="n">input</code> <code class="o">+</code> <code class="s">" in base "</code> <code class="o">+</code> <code class="n">radix</code> <code class="o">+</code> <code class="s">" is "</code>&#13;
                    <code class="o">+</code> <code class="n">Integer</code><code class="o">.</code><code class="na">valueOf</code><code class="o">(</code><code class="n">input</code><code class="o">,</code> <code class="n">radix</code><code class="o">)</code> <code class="o">+</code> <code class="s">"; "</code><code class="o">);</code>&#13;
            <code class="kt">int</code> <code class="n">i</code> <code class="o">=</code> <code class="mi">42</code><code class="o">;</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">i</code> <code class="o">+</code> <code class="s">" formatted in base "</code> <code class="o">+</code> <code class="n">radix</code> <code class="o">+</code> <code class="s">" is "</code>&#13;
                    <code class="o">+</code> <code class="n">Integer</code><code class="o">.</code><code class="na">toString</code><code class="o">(</code><code class="n">i</code><code class="o">,</code> <code class="n">radix</code><code class="o">));</code>&#13;
        <code class="o">}</code></pre></div>&#13;
&#13;
<p>This program prints the binary string as an integer in various bases, and the integer 42 in those&#13;
same number bases:</p>&#13;
<pre data-type="programlisting" id="I_5_tt164">$ <strong>java numbers.IntegerBinOctHexEtc</strong>&#13;
101010 in base 2 is 42; 42 formatted in base 2 is 101010&#13;
101010 in base 8 is 33288; 42 formatted in base 8 is 52&#13;
101010 in base 10 is 101010; 42 formatted in base 10 is 42&#13;
101010 in base 16 is 1052688; 42 formatted in base 16 is 2a&#13;
101010 in base 36 is 60512868; 42 formatted in base 36 is 16&#13;
$ </pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-numbers-SECT-9.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>There are also specialized versions of <a data-primary="toString() method" data-type="indexterm" id="idm45290679869016"/><code>toString(int)</code> that don’t require you to specify&#13;
the radix, for example, <a data-primary="toBinaryString() method" data-type="indexterm" id="idm45290679867928"/><code>toBinaryString()</code> to convert an integer to binary,&#13;
<a data-primary="toHexString() method" data-type="indexterm" id="idm45290679866840"/><code>toHexString()</code> for hexadecimal, <a data-primary="toOctalString() method" data-type="indexterm" id="idm45290679865752"/><code>toOctalString()</code>, and so on.  The javadoc page for the <code>Integer</code> class is&#13;
your friend here.</p>&#13;
&#13;
<p>The <code>String</code> class itself includes a series of static methods—<a data-primary="valueOf() method" data-type="indexterm" id="idm45290679863416"/><code>valueOf(int)</code>, <code>val⁠ue​Of(double)</code>, and so on—that also provide default formatting. That is, they return the given numeric value formatted as a string.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="5.7 Operating on a Series of Integers" data-type="sect1"><div class="sect1" id="javacook-numbers-SECT-10">&#13;
<h1>5.7 Operating on a Series of Integers</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-numbers-SECT-10.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="integers" data-type="indexterm" id="idm45290679858488"/><a data-primary="numbers" data-secondary="series of integers" data-type="indexterm" id="idm45290679857784"/>You need to work on a range of  integers.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-numbers-SECT-10.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>For a contiguous set, use<a data-primary="range() method" data-type="indexterm" id="idm45290679854808"/><a data-primary="rangeClosed() method" data-type="indexterm" id="idm45290679854104"/> <code>IntStream::range</code> and <code>rangeClosed</code>, or the older <code>for</code> loop.</p>&#13;
&#13;
<p>For discontinuous ranges of numbers, use a <code>java.util.BitSet</code>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-numbers-SECT-10.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>To process a contiguous set of integers, Java provides both <code>range()</code> / <code>rangeClosed()</code> methods in the <code>IntStream</code> and <code>LongStream</code> classes.&#13;
These take a starting and ending number; <code>range()</code> excludes the ending number while&#13;
<code>rangeClosed()</code> closes on, or includes, the ending number.&#13;
You can also iterate over a range of numbers using the traditional <code>for</code> loop.&#13;
Loop control for the <code>for</code> loop is in three parts: initialize, test, and&#13;
change. If the test part is initially false, the loop will never be&#13;
executed, not even once.  You can iterate over the elements of an array or&#13;
collection (see <a data-type="xref" href="ch07.html#javacook-structure">Chapter 7</a>) using a for-each loop.</p>&#13;
&#13;
<p>The program in <a data-type="xref" href="#javacook-numbers-EX-NUMBER">Example 5-5</a> demonstrates these techniques.</p>&#13;
<div class="less_space pagebreak-before" data-type="example" id="javacook-numbers-EX-NUMBER">&#13;
<h5><span class="label">Example 5-5. </span>main/src/main/java/numbers/NumSeries.java</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">NumSeries</code> <code class="o">{</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">args</code><code class="o">)</code> <code class="o">{</code>&#13;
&#13;
        <code class="c1">// For ordinal list of numbers n to m, use rangeClosed(start, endInclusive)</code>&#13;
        <code class="n">IntStream</code><code class="o">.</code><code class="na">rangeClosed</code><code class="o">(</code><code class="mi">1</code><code class="o">,</code> <code class="mi">12</code><code class="o">).</code><code class="na">forEach</code><code class="o">(</code>&#13;
            <code class="n">i</code> <code class="o">-&gt;</code> <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Month # "</code> <code class="o">+</code> <code class="n">i</code><code class="o">));</code>&#13;
&#13;
        <code class="c1">// Or, use a for loop starting at 1.</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">i</code> <code class="o">=</code> <code class="mi">1</code><code class="o">;</code> <code class="n">i</code> <code class="o">&lt;=</code> <code class="n">months</code><code class="o">.</code><code class="na">length</code><code class="o">;</code> <code class="n">i</code><code class="o">++)</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Month # "</code> <code class="o">+</code> <code class="n">i</code><code class="o">);</code>&#13;
&#13;
        <code class="c1">// Or a foreach loop</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="n">String</code> <code class="n">month</code> <code class="o">:</code> <code class="n">months</code><code class="o">)</code> <code class="o">{</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">month</code><code class="o">);</code>&#13;
        <code class="o">}</code>&#13;
&#13;
        <code class="c1">// When you want a set of array indices, use range(start, endExclusive)</code>&#13;
        <code class="n">IntStream</code><code class="o">.</code><code class="na">range</code><code class="o">(</code><code class="mi">0</code><code class="o">,</code> <code class="n">months</code><code class="o">.</code><code class="na">length</code><code class="o">).</code><code class="na">forEach</code><code class="o">(</code>&#13;
            <code class="n">i</code> <code class="o">-&gt;</code> <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Month "</code> <code class="o">+</code> <code class="n">months</code><code class="o">[</code><code class="n">i</code><code class="o">]));</code>&#13;
&#13;
        <code class="c1">// Or, use a for loop starting at 0.</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">i</code> <code class="o">=</code> <code class="mi">0</code><code class="o">;</code> <code class="n">i</code> <code class="o">&lt;</code> <code class="n">months</code><code class="o">.</code><code class="na">length</code><code class="o">;</code> <code class="n">i</code><code class="o">++)</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Month "</code> <code class="o">+</code> <code class="n">months</code><code class="o">[</code><code class="n">i</code><code class="o">]);</code>&#13;
&#13;
        <code class="c1">// For e.g., counting by 3 from 11 to 27, use a for loop</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">i</code> <code class="o">=</code> <code class="mi">11</code><code class="o">;</code> <code class="n">i</code> <code class="o">&lt;=</code> <code class="mi">27</code><code class="o">;</code> <code class="n">i</code> <code class="o">+=</code> <code class="mi">3</code><code class="o">)</code> <code class="o">{</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"i = "</code> <code class="o">+</code> <code class="n">i</code><code class="o">);</code>&#13;
        <code class="o">}</code>&#13;
&#13;
        <code class="c1">// A discontiguous set of integers, using a BitSet</code>&#13;
&#13;
        <code class="c1">// Create a BitSet and turn on a couple of bits.</code>&#13;
        <code class="n">BitSet</code> <code class="n">b</code> <code class="o">=</code> <code class="k">new</code> <code class="n">BitSet</code><code class="o">();</code>&#13;
        <code class="n">b</code><code class="o">.</code><code class="na">set</code><code class="o">(</code><code class="mi">0</code><code class="o">);</code>    <code class="c1">// January</code>&#13;
        <code class="n">b</code><code class="o">.</code><code class="na">set</code><code class="o">(</code><code class="mi">3</code><code class="o">);</code>    <code class="c1">// April</code>&#13;
        <code class="n">b</code><code class="o">.</code><code class="na">set</code><code class="o">(</code><code class="mi">8</code><code class="o">);</code>    <code class="c1">// September</code>&#13;
&#13;
        <code class="c1">// Presumably this would be somewhere else in the code.</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">i</code> <code class="o">=</code> <code class="mi">0</code><code class="o">;</code> <code class="n">i</code><code class="o">&lt;</code><code class="n">months</code><code class="o">.</code><code class="na">length</code><code class="o">;</code> <code class="n">i</code><code class="o">++)</code> <code class="o">{</code>&#13;
            <code class="k">if</code> <code class="o">(</code><code class="n">b</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code class="n">i</code><code class="o">))</code>&#13;
                <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Month "</code> <code class="o">+</code> <code class="n">months</code><code class="o">[</code><code class="n">i</code><code class="o">]);</code>&#13;
        <code class="o">}</code>&#13;
&#13;
        <code class="c1">// Same example but shorter:</code>&#13;
        <code class="c1">// a discontiguous set of integers, using an array</code>&#13;
        <code class="kt">int</code><code class="o">[]</code> <code class="n">numbers</code> <code class="o">=</code> <code class="o">{</code><code class="mi">0</code><code class="o">,</code> <code class="mi">3</code><code class="o">,</code> <code class="mi">8</code><code class="o">};</code>&#13;
&#13;
        <code class="c1">// Presumably somewhere else in the code... Also a foreach loop</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">n</code> <code class="o">:</code> <code class="n">numbers</code><code class="o">)</code> <code class="o">{</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Month: "</code> <code class="o">+</code> <code class="n">months</code><code class="o">[</code><code class="n">n</code><code class="o">]);</code>&#13;
        <code class="o">}</code>&#13;
    <code class="o">}</code>&#13;
    <code class="cm">/** Names of months. See Dates/Times chapter for a better way to get these */</code>&#13;
    <code class="kd">protected</code> <code class="kd">static</code> <code class="n">String</code> <code class="n">months</code><code class="o">[]</code> <code class="o">=</code> <code class="o">{</code>&#13;
        <code class="s">"January"</code><code class="o">,</code> <code class="s">"February"</code><code class="o">,</code> <code class="s">"March"</code><code class="o">,</code> <code class="s">"April"</code><code class="o">,</code>&#13;
        <code class="s">"May"</code><code class="o">,</code> <code class="s">"June"</code><code class="o">,</code> <code class="s">"July"</code><code class="o">,</code> <code class="s">"August"</code><code class="o">,</code>&#13;
        <code class="s">"September"</code><code class="o">,</code> <code class="s">"October"</code><code class="o">,</code> <code class="s">"November"</code><code class="o">,</code> <code class="s">"December"</code>&#13;
    <code class="o">};</code>&#13;
<code class="o">}</code></pre></div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="5.8 Formatting with Correct Plurals" data-type="sect1"><div class="sect1" id="javacook-numbers-SECT-12">&#13;
<h1>5.8 Formatting with Correct Plurals</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-numbers-SECT-12.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="formatting" data-secondary="with correct plurals" data-type="indexterm" id="idm45290679830712"/><a data-primary="numbers" data-secondary="formatting with correct plurals" data-type="indexterm" id="idm45290679829736"/>You’re printing something like <code>"We used " + n + " items"</code>, but in English,&#13;
“We used 1 items” is ungrammatical. You want “We used 1 item.”</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-numbers-SECT-12.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use a<a data-primary="ChoiceFormat" data-type="indexterm" id="idm45290679431480"/> <code>ChoiceFormat</code> or a conditional statement.</p>&#13;
&#13;
<p>Use Java’s ternary operator (<code>cond ? trueval</code> : <code>falseval</code>) in a string concatenation. Both zero and plurals get an “s” appended to the noun in English (“no books, one book, two books”), so we test for <code>n==1</code>:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">FormatPlurals</code> <code class="o">{</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">argv</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">report</code><code class="o">(</code><code class="mi">0</code><code class="o">);</code>&#13;
        <code class="n">report</code><code class="o">(</code><code class="mi">1</code><code class="o">);</code>&#13;
        <code class="n">report</code><code class="o">(</code><code class="mi">2</code><code class="o">);</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/** report -- using conditional operator */</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">report</code><code class="o">(</code><code class="kt">int</code> <code class="n">n</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"We used "</code> <code class="o">+</code> <code class="n">n</code> <code class="o">+</code> <code class="s">" item"</code> <code class="o">+</code> <code class="o">(</code><code class="n">n</code><code class="o">==</code><code class="mi">1</code><code class="o">?</code><code class="s">""</code><code class="o">:</code><code class="s">"s"</code><code class="o">));</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p>Does it work?</p>&#13;
<pre data-type="programlisting" id="I_5_tt171">$ <strong>java numbers.FormatPlurals</strong>&#13;
We used 0 items&#13;
We used 1 item&#13;
We used 2 items&#13;
$</pre>&#13;
&#13;
<p>The final <code>println</code> statement is effectively equivalent to the following:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="k">if</code> <code class="o">(</code><code class="n">n</code><code class="o">==</code><code class="mi">1</code><code class="o">)</code>&#13;
    <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"We used "</code> <code class="o">+</code> <code class="n">n</code> <code class="o">+</code> <code class="s">" item"</code><code class="o">);</code>&#13;
<code class="k">else</code>&#13;
    <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"We used "</code> <code class="o">+</code> <code class="n">n</code> <code class="o">+</code> <code class="s">" items"</code><code class="o">);</code></pre>&#13;
&#13;
<p>This is a lot longer, so the ternary conditional operator is worth learning.</p>&#13;
&#13;
<p>The <code>ChoiceFormat</code> is ideal for this. It is actually capable of much more, but here I’ll show only this simplest use. I specify the values 0, 1, and 2 (or more), and the string values to print corresponding to each number. The numbers are then formatted according to the range they fall into:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">FormatPluralsChoice</code> <code class="kd">extends</code> <code class="n">FormatPlurals</code> <code class="o">{</code>&#13;
&#13;
    <code class="c1">// ChoiceFormat to just give pluralized word</code>&#13;
    <code class="kd">static</code> <code class="kt">double</code><code class="o">[]</code> <code class="n">limits</code> <code class="o">=</code> <code class="o">{</code> <code class="mi">0</code><code class="o">,</code> <code class="mi">1</code><code class="o">,</code> <code class="mi">2</code> <code class="o">};</code>&#13;
    <code class="kd">static</code> <code class="n">String</code><code class="o">[]</code> <code class="n">formats</code> <code class="o">=</code> <code class="o">{</code> <code class="s">"reviews"</code><code class="o">,</code> <code class="s">"review"</code><code class="o">,</code> <code class="s">"reviews"</code><code class="o">};</code>&#13;
    <code class="kd">static</code> <code class="n">ChoiceFormat</code> <code class="n">pluralizedFormat</code> <code class="o">=</code> <code class="k">new</code> <code class="n">ChoiceFormat</code><code class="o">(</code><code class="n">limits</code><code class="o">,</code> <code class="n">formats</code><code class="o">);</code>&#13;
&#13;
    <code class="c1">// ChoiceFormat to give English text version, quantified</code>&#13;
    <code class="kd">static</code> <code class="n">ChoiceFormat</code> <code class="n">quantizedFormat</code> <code class="o">=</code> <code class="k">new</code> <code class="n">ChoiceFormat</code><code class="o">(</code>&#13;
        <code class="s">"0#no reviews|1#one review|1&lt;many reviews"</code><code class="o">);</code>&#13;
&#13;
    <code class="c1">// Test data</code>&#13;
    <code class="kd">static</code> <code class="kt">int</code><code class="o">[]</code> <code class="n">data</code> <code class="o">=</code> <code class="o">{</code> <code class="o">-</code><code class="mi">1</code><code class="o">,</code> <code class="mi">0</code><code class="o">,</code> <code class="mi">1</code><code class="o">,</code> <code class="mi">2</code><code class="o">,</code> <code class="mi">3</code> <code class="o">};</code>&#13;
&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">argv</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Pluralized Format"</code><code class="o">);</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">i</code> <code class="o">:</code> <code class="n">data</code><code class="o">)</code> <code class="o">{</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Found "</code> <code class="o">+</code> <code class="n">i</code> <code class="o">+</code> <code class="s">" "</code> <code class="o">+</code> <code class="n">pluralizedFormat</code><code class="o">.</code><code class="na">format</code><code class="o">(</code><code class="n">i</code><code class="o">));</code>&#13;
        <code class="o">}</code>&#13;
&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Quantized Format"</code><code class="o">);</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">i</code> <code class="o">:</code> <code class="n">data</code><code class="o">)</code> <code class="o">{</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Found "</code> <code class="o">+</code> <code class="n">quantizedFormat</code><code class="o">.</code><code class="na">format</code><code class="o">(</code><code class="n">i</code><code class="o">));</code>&#13;
        <code class="o">}</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p>This generates the same output as the basic version. It is slightly longer, but more general, and lends itself better to internationalization.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="See Also" data-type="sect2"><div class="sect2" id="idm45290679432584">&#13;
<h2>See Also</h2>&#13;
&#13;
<p>In addition to <code>ChoiceFormat</code>, the same result can be achieved with a <a data-primary="MessageFormat class" data-type="indexterm" id="idm45290679274728"/><code>MessageFormat</code>.&#13;
The online source in file <em>main/src/main/java/i18n/MessageFormatDemo.java</em> has an example.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="5.9 Generating Random Numbers" data-type="sect1"><div class="sect1" id="javacook-numbers-SECT-13">&#13;
<h1>5.9 Generating Random Numbers</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-numbers-SECT-13.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="numbers" data-secondary="random number generators" data-type="indexterm" id="nu_rng"/><a data-primary="random numbers" data-type="indexterm" id="rn_ge"/>You need to generate pseudorandom numbers in a hurry.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-numbers-SECT-13.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use <a data-primary="java.lang.Math.random() method" data-type="indexterm" id="idm45290679087176"/><code>java.lang.Math.random()</code> to generate random numbers. There is no claim that the random values it returns are very <em>good</em> random numbers, however.&#13;
Like most software-only implementations, these are <a data-primary="Pseudorandom Number Generator (PRNG)" data-type="indexterm" id="idm45290679085560"/><a data-primary="PRNG (Pseudorandom Number Generator)" data-type="indexterm" id="idm45290679084840"/><em>Pseudorandom Number Generators</em> (PRNGs),&#13;
meaning that the numbers are not totally random, but devised from an algorithm.&#13;
That said, they are adequate for casual use.&#13;
This code exercises the <a data-primary="random() method" data-type="indexterm" id="idm45290679083592"/><code>random()</code> method:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="c1">// numbers/Random1.java</code>&#13;
<code class="c1">// java.lang.Math.random( ) is static, don't need any constructor calls</code>&#13;
<code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"A random from java.lang.Math is "</code> <code class="o">+</code> <code class="n">Math</code><code class="o">.</code><code class="na">random</code><code class="o">(</code> <code class="o">));</code></pre>&#13;
&#13;
<p>Note that this method only generates double values. If you need integers, construct a&#13;
<code>java.util.Random</code> object and call its <a data-primary="nextInt() method" data-type="indexterm" id="idm45290679075464"/><code>nextInt()</code> method; if you pass it an integer value,&#13;
this will become the upper bound. Here I generate integers from 1 to 10:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">RandomInt</code> <code class="o">{</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">a</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">Random</code> <code class="n">r</code> <code class="o">=</code> <code class="k">new</code> <code class="n">Random</code><code class="o">();</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">i</code><code class="o">=</code><code class="mi">0</code><code class="o">;</code> <code class="n">i</code><code class="o">&lt;</code><code class="mi">1000</code><code class="o">;</code> <code class="n">i</code><code class="o">++)</code>&#13;
            <code class="c1">// nextInt(10) goes from 0-9; add 1 for 1-10;</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="mi">1</code><code class="o">+</code><code class="n">r</code><code class="o">.</code><code class="na">nextInt</code><code class="o">(</code><code class="mi">10</code><code class="o">));</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p>To see if my <code>RandomInt</code> demo was really working well, I used the <a data-primary="Unix" data-secondary="sort tool" data-type="indexterm" id="idm45290678841416"/><a data-primary="Unix" data-secondary="Uniq tool" data-type="indexterm" id="idm45290678840536"/><a data-primary="sort tool (Unix)" data-type="indexterm" id="idm45290678839592"/><a data-primary="uniq tool (Unix)" data-type="indexterm" id="idm45290678838920"/>Unix tools <em>sort</em> and <em>uniq</em>, which together give a count of how many times each value was chosen. For 1,000 integers, each&#13;
of 10 values should be chosen about 100 times. I ran it twice to get a better idea&#13;
of the distribution:</p>&#13;
<pre data-type="programlisting" id="I_5_tt176">$ <strong>java numbers.RandomInt | sort | uniq -c | sort -k 2 -n</strong>&#13;
  96 1&#13;
 107 2&#13;
 102 3&#13;
 122 4&#13;
  99 5&#13;
 105 6&#13;
  97 7&#13;
  96 8&#13;
  79 9&#13;
  97 10&#13;
$ <strong>java -cp build numbers.RandomInt | sort | uniq -c | sort -k 2 -n</strong>&#13;
  86 1&#13;
  88 2&#13;
 110 3&#13;
  97 4&#13;
  99 5&#13;
 109 6&#13;
  82 7&#13;
 116 8&#13;
  99 9&#13;
 114 10&#13;
$&#13;
</pre>&#13;
&#13;
<p>The next step is to run these through a statistical program to see how really random they&#13;
are; we’ll return to this in a minute.</p>&#13;
&#13;
<p>In general, to generate random numbers, you need to construct a <code>java.util.Random</code> object (not just any old random object) and call its&#13;
<code>next*()</code> methods. These methods include <a data-primary="nextBoolean() method" data-type="indexterm" id="idm45290678999160"/><a data-primary="nextBytes() method" data-type="indexterm" id="idm45290678998456"/><a data-primary="nextDouble() method" data-type="indexterm" id="idm45290678997784"/><a data-primary="nextFloat() method" data-type="indexterm" id="idm45290678997112"/><a data-primary="nextInt() method" data-type="indexterm" id="idm45290678996440"/><a data-primary="nextLong() method" data-type="indexterm" id="idm45290678995768"/><code>nextBoolean()</code>, <code>nextBytes()</code> (which fills the given array of bytes with random values), <code>nextDouble()</code>, <code>nextFloat()</code>, <code>nextInt()</code>, and <code>nextLong()</code>. Don’t be confused by the capitalization of <code>Float</code>, <code>Double</code>, etc. They return the primitive types <code>boolean</code>, <code>float</code>, <code>double</code>, etc., not the capitalized wrapper objects. Clear enough? Maybe an example will help:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting">    <code class="c1">// java.util.Random methods are non-static, so need to construct</code>&#13;
    <code class="n">Random</code> <code class="n">r</code> <code class="o">=</code> <code class="k">new</code> <code class="n">Random</code><code class="o">();</code>&#13;
    <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">i</code><code class="o">=</code><code class="mi">0</code><code class="o">;</code> <code class="n">i</code><code class="o">&lt;</code><code class="mi">10</code><code class="o">;</code> <code class="n">i</code><code class="o">++)</code>&#13;
    <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"A double from java.util.Random is "</code> <code class="o">+</code> <code class="n">r</code><code class="o">.</code><code class="na">nextDouble</code><code class="o">());</code>&#13;
    <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">i</code><code class="o">=</code><code class="mi">0</code><code class="o">;</code> <code class="n">i</code><code class="o">&lt;</code><code class="mi">10</code><code class="o">;</code> <code class="n">i</code><code class="o">++)</code>&#13;
    <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"An integer from java.util.Random is "</code> <code class="o">+</code> <code class="n">r</code><code class="o">.</code><code class="na">nextInt</code><code class="o">());</code></pre>&#13;
&#13;
<p>A fixed value <a data-primary="starting seed" data-type="indexterm" id="idm45290678989224"/>(<em>starting seed</em>) can be provided to generate repeatable values, as for testing.&#13;
You can also use the <a data-primary="nextGaussian() method" data-type="indexterm" id="idm45290678796024"/><code>java.util.Random nextGaussian()</code> method, as shown next. The <code>nextDouble()</code> methods try to give a flat distribution between 0 and 1.0, in which each value has an equal chance of being selected. A Gaussian or normal distribution is a bell curve of values from negative infinity to positive infinity, with the majority of the values around zero (0.0).</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="c1">// numbers/Random3.java</code>&#13;
<code class="n">Random</code> <code class="n">r</code> <code class="o">=</code> <code class="k">new</code> <code class="n">Random</code><code class="o">();</code>&#13;
<code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">i</code> <code class="o">=</code> <code class="mi">0</code><code class="o">;</code> <code class="n">i</code> <code class="o">&lt;</code> <code class="mi">10</code><code class="o">;</code> <code class="n">i</code><code class="o">++)</code>&#13;
    <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"A gaussian random double is "</code> <code class="o">+</code> <code class="n">r</code><code class="o">.</code><code class="na">nextGaussian</code><code class="o">());</code></pre>&#13;
&#13;
<p>To illustrate the different distributions, I generated 10,000 numbers using&#13;
<a data-primary="nextRandom() method" data-type="indexterm" id="idm45290678792728"/><code>nextRandom()</code> first and then using <code>nextGaussian()</code>. The code for this is in <em>Random4.java</em>&#13;
(not shown here) and is a combination of the previous programs with code to print the&#13;
results into files. I then plotted histograms using the <a data-primary="R statistics package" data-type="indexterm" id="idm45290678758024"/>R statistics package (see&#13;
<a data-type="xref" href="ch11.html#javacook-ds">Chapter 11</a> and <a href="http://www.r-project.org"><em class="hyperlink">http://www.r-project.org</em></a>).&#13;
The R script used to generate the graph, <em>randomnesshistograms.r</em>, is in&#13;
<em>javasrc</em> under <em>main/src/main/resources</em>. The results are shown in&#13;
<a data-type="xref" href="#javacook-numbers-FIG-1">Figure 5-1</a>.</p>&#13;
&#13;
<p>Looks like both PRNGs do their job!</p>&#13;
&#13;
<figure><div class="figure" id="javacook-numbers-FIG-1">&#13;
<img alt="jcb4 0501" src="assets/jcb4_0501.png"/>&#13;
<h6><span class="label">Figure 5-1. </span>Flat (left) and Gaussian (right) distributions</h6>&#13;
</div></figure>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="See Also" data-type="sect2"><div class="sect2" id="javacook-numbers-SECT-14.3">&#13;
<h2>See Also</h2>&#13;
&#13;
<p>The javadoc documentation for <code>java.util.Random</code>, and the warning in <a data-type="xref" href="#javacook-numbers-intro">Recipe 5.0</a> about pseudorandomness versus real randomness.</p>&#13;
&#13;
<p>For cryptographic use, see class <code>java.security.SecureRandom</code>, which provides cryptographically strong pseudorandom number generators.<a data-primary="" data-startref="nu_rng" data-type="indexterm" id="idm45290678695112"/><a data-primary="" data-startref="rn_ge" data-type="indexterm" id="idm45290678694168"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="5.10 Multiplying Matrices" data-type="sect1"><div class="sect1" id="javacook-numbers-SECT-17">&#13;
<h1>5.10 Multiplying Matrices</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-numbers-SECT-17.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="matrices, multiplying" data-type="indexterm" id="ma_mu"/><a data-primary="numbers" data-secondary="matrices, multiplying" data-type="indexterm" id="nu_mam"/>You need to multiply a pair of two-dimensional arrays, as is common in mathematical and engineering applications.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-numbers-SECT-17.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use the following code as a model.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-numbers-SECT-17.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>It is straightforward to multiply an array of a numeric type.&#13;
In real life you would probably use a full-blown package such as the<a data-primary="Efficient Java Matrix Library (EJML)" data-type="indexterm" id="idm45290678683128"/><a data-primary="EJML (Efficient Java Matrix Library)" data-type="indexterm" id="idm45290678682456"/>&#13;
<a href="http://ejml.org/wiki/index.php?title=Main_Page">Efficient Java Matrix Library (EJML)</a>&#13;
or <a data-primary="DeepLearning4Java" data-type="indexterm" id="idm45290678680984"/><a data-primary="ND4J package" data-type="indexterm" id="idm45290678680280"/>DeepLearning4Java’s&#13;
<a href="https://deeplearning4j.org/docs/latest/nd4j-overview">ND4J package</a>.&#13;
However a simple implementation can serve to show the concepts involved;&#13;
the code in <a data-type="xref" href="#javacook-numbers-EX-3">Example 5-6</a> implements matrix <span class="keep-together">multiplication.</span></p>&#13;
<div data-type="example" id="javacook-numbers-EX-3">&#13;
<h5><span class="label">Example 5-6. </span>Matrix.java</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">Matrix</code> <code class="o">{</code>&#13;
&#13;
    <code class="cm">/* Matrix-multiply two arrays together.</code>&#13;
<code class="cm">     * The arrays MUST be rectangular.</code>&#13;
<code class="cm">     * @author Adapted from Tom Christiansen &amp; Nathan Torkington's</code>&#13;
<code class="cm">     * implementation in their Perl Cookbook.</code>&#13;
<code class="cm">     */</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">int</code><code class="o">[][]</code> <code class="nf">multiply</code><code class="o">(</code><code class="kt">int</code><code class="o">[][]</code> <code class="n">m1</code><code class="o">,</code> <code class="kt">int</code><code class="o">[][]</code> <code class="n">m2</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="kt">int</code> <code class="n">m1rows</code> <code class="o">=</code> <code class="n">m1</code><code class="o">.</code><code class="na">length</code><code class="o">;</code>&#13;
        <code class="kt">int</code> <code class="n">m1cols</code> <code class="o">=</code> <code class="n">m1</code><code class="o">[</code><code class="mi">0</code><code class="o">].</code><code class="na">length</code><code class="o">;</code>&#13;
        <code class="kt">int</code> <code class="n">m2rows</code> <code class="o">=</code> <code class="n">m2</code><code class="o">.</code><code class="na">length</code><code class="o">;</code>&#13;
        <code class="kt">int</code> <code class="n">m2cols</code> <code class="o">=</code> <code class="n">m2</code><code class="o">[</code><code class="mi">0</code><code class="o">].</code><code class="na">length</code><code class="o">;</code>&#13;
        <code class="k">if</code> <code class="o">(</code><code class="n">m1cols</code> <code class="o">!=</code> <code class="n">m2rows</code><code class="o">)</code>&#13;
            <code class="k">throw</code> <code class="k">new</code> <code class="nf">IllegalArgumentException</code><code class="o">(</code>&#13;
                <code class="s">"matrices don't match: "</code> <code class="o">+</code> <code class="n">m1cols</code> <code class="o">+</code> <code class="s">" != "</code> <code class="o">+</code> <code class="n">m2rows</code><code class="o">);</code>&#13;
        <code class="kt">int</code><code class="o">[][]</code> <code class="n">result</code> <code class="o">=</code> <code class="k">new</code> <code class="kt">int</code><code class="o">[</code><code class="n">m1rows</code><code class="o">][</code><code class="n">m2cols</code><code class="o">];</code>&#13;
&#13;
        <code class="c1">// multiply</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">i</code><code class="o">=</code><code class="mi">0</code><code class="o">;</code> <code class="n">i</code><code class="o">&lt;</code><code class="n">m1rows</code><code class="o">;</code> <code class="n">i</code><code class="o">++)</code> <code class="o">{</code>&#13;
            <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">j</code><code class="o">=</code><code class="mi">0</code><code class="o">;</code> <code class="n">j</code><code class="o">&lt;</code><code class="n">m2cols</code><code class="o">;</code> <code class="n">j</code><code class="o">++)</code> <code class="o">{</code>&#13;
                <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">k</code><code class="o">=</code><code class="mi">0</code><code class="o">;</code> <code class="n">k</code><code class="o">&lt;</code><code class="n">m1cols</code><code class="o">;</code> <code class="n">k</code><code class="o">++)</code> <code class="o">{</code>&#13;
                    <code class="n">result</code><code class="o">[</code><code class="n">i</code><code class="o">][</code><code class="n">j</code><code class="o">]</code> <code class="o">+=</code> <code class="n">m1</code><code class="o">[</code><code class="n">i</code><code class="o">][</code><code class="n">k</code><code class="o">]</code> <code class="o">*</code> <code class="n">m2</code><code class="o">[</code><code class="n">k</code><code class="o">][</code><code class="n">j</code><code class="o">];</code>&#13;
                <code class="o">}</code>&#13;
            <code class="o">}</code>&#13;
        <code class="o">}</code>&#13;
&#13;
        <code class="k">return</code> <code class="n">result</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/** Matrix print.</code>&#13;
<code class="cm">     */</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">mprint</code><code class="o">(</code><code class="kt">int</code><code class="o">[][]</code> <code class="n">a</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="kt">int</code> <code class="n">rows</code> <code class="o">=</code> <code class="n">a</code><code class="o">.</code><code class="na">length</code><code class="o">;</code>&#13;
        <code class="kt">int</code> <code class="n">cols</code> <code class="o">=</code> <code class="n">a</code><code class="o">[</code><code class="mi">0</code><code class="o">].</code><code class="na">length</code><code class="o">;</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"array["</code><code class="o">+</code><code class="n">rows</code><code class="o">+</code><code class="s">"]["</code><code class="o">+</code><code class="n">cols</code><code class="o">+</code><code class="s">"] = {"</code><code class="o">);</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">i</code><code class="o">=</code><code class="mi">0</code><code class="o">;</code> <code class="n">i</code><code class="o">&lt;</code><code class="n">rows</code><code class="o">;</code> <code class="n">i</code><code class="o">++)</code> <code class="o">{</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">print</code><code class="o">(</code><code class="s">"{"</code><code class="o">);</code>&#13;
            <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">j</code><code class="o">=</code><code class="mi">0</code><code class="o">;</code> <code class="n">j</code><code class="o">&lt;</code><code class="n">cols</code><code class="o">;</code> <code class="n">j</code><code class="o">++)</code>&#13;
                <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">print</code><code class="o">(</code><code class="s">" "</code> <code class="o">+</code> <code class="n">a</code><code class="o">[</code><code class="n">i</code><code class="o">][</code><code class="n">j</code><code class="o">]</code> <code class="o">+</code> <code class="s">","</code><code class="o">);</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"},"</code><code class="o">);</code>&#13;
        <code class="o">}</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"};"</code><code class="o">);</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre></div>&#13;
&#13;
<p>Here is a program that uses the <code>Matrix</code> class to multiply two arrays of <code>int</code>s:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting">        <code class="kt">int</code> <code class="n">x</code><code class="o">[][]</code> <code class="o">=</code> <code class="o">{</code>&#13;
            <code class="o">{</code> <code class="mi">3</code><code class="o">,</code> <code class="mi">2</code><code class="o">,</code> <code class="mi">3</code> <code class="o">},</code>&#13;
            <code class="o">{</code> <code class="mi">5</code><code class="o">,</code> <code class="mi">9</code><code class="o">,</code> <code class="mi">8</code> <code class="o">},</code>&#13;
        <code class="o">};</code>&#13;
        <code class="kt">int</code> <code class="n">y</code><code class="o">[][]</code> <code class="o">=</code> <code class="o">{</code>&#13;
            <code class="o">{</code> <code class="mi">4</code><code class="o">,</code> <code class="mi">7</code> <code class="o">},</code>&#13;
            <code class="o">{</code> <code class="mi">9</code><code class="o">,</code> <code class="mi">3</code> <code class="o">},</code>&#13;
            <code class="o">{</code> <code class="mi">8</code><code class="o">,</code> <code class="mi">1</code> <code class="o">},</code>&#13;
        <code class="o">};</code>&#13;
        <code class="kt">int</code> <code class="n">z</code><code class="o">[][]</code> <code class="o">=</code> <code class="n">Matrix</code><code class="o">.</code><code class="na">multiply</code><code class="o">(</code><code class="n">x</code><code class="o">,</code> <code class="n">y</code><code class="o">);</code>&#13;
        <code class="n">Matrix</code><code class="o">.</code><code class="na">mprint</code><code class="o">(</code><code class="n">x</code><code class="o">);</code>&#13;
        <code class="n">Matrix</code><code class="o">.</code><code class="na">mprint</code><code class="o">(</code><code class="n">y</code><code class="o">);</code>&#13;
        <code class="n">Matrix</code><code class="o">.</code><code class="na">mprint</code><code class="o">(</code><code class="n">z</code><code class="o">);</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="See Also" data-type="sect2"><div class="sect2" id="javacook-numbers-SECT-17.4">&#13;
<h2>See Also</h2>&#13;
&#13;
<p>Consult a book on numerical methods for more things to do with matrices; one of our&#13;
reviewers recommends the series of <a data-primary="Numerical Recipes books" data-type="indexterm" id="idm45290678172040"/><em>Numerical Recipes</em> books, available from <a href="http://nrbook.com"><em class="hyperlink">http://nrbook.com</em></a>. (Note that this site has a link to their new web presence, <a href="https://numerical.recipes"><em class="hyperlink">https://numerical.recipes</em></a> however, that site requires Adobe Flash, which most browsers no longer support due to security concerns.) There are several translations of the book’s code into various languages, including <a href="http://numerical.recipes/aboutJava.html">Java</a>. Pricing varies by package.</p>&#13;
&#13;
<p>Commercial software packages can do some of these calculations for you; for one example, see<a data-primary="Rogue Wave Software" data-type="indexterm" id="idm45290678167416"/>&#13;
the numeric libraries available from <a href="http://www.roguewave.com">Rogue Wave Software</a>.<a data-primary="" data-startref="ma_mu" data-type="indexterm" id="idm45290678165912"/><a data-primary="" data-startref="nu_mam" data-type="indexterm" id="idm45290678164904"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="5.11 Using Complex Numbers" data-type="sect1"><div class="sect1" id="javacook-numbers-SECT-18">&#13;
<h1>5.11 Using Complex Numbers</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-numbers-SECT-18.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="complex numbers" data-type="indexterm" id="co_nu"/><a data-primary="numbers" data-secondary="complex" data-type="indexterm" id="nu_co"/>You need to manipulate complex numbers, as is common in mathematical, scientific, or engineering applications.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-numbers-SECT-18.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Java does not provide any explicit support for dealing with complex numbers. You could keep track of the real and imaginary parts and do the computations yourself, but that is not a very well-structured solution.</p>&#13;
&#13;
<p>A better solution, of course, is to use a class that implements complex numbers.&#13;
<span class="keep-together">I once</span> wrote just such a class, but now I recommend using the&#13;
<a data-primary="Apache Commons Math library" data-type="indexterm" id="idm45290678154952"/>Apache Commons Math library for this.&#13;
The build coordinates for this are <code>org.apache.commons:commons-math3:3.6.1</code> (or later).&#13;
First, an example of using Apache’s library:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">ComplexDemoACM</code> <code class="o">{</code>&#13;
&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">args</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">Complex</code> <code class="n">c</code> <code class="o">=</code> <code class="k">new</code> <code class="n">Complex</code><code class="o">(</code><code class="mi">3</code><code class="o">,</code>  <code class="mi">5</code><code class="o">);</code>&#13;
        <code class="n">Complex</code> <code class="n">d</code> <code class="o">=</code> <code class="k">new</code> <code class="n">Complex</code><code class="o">(</code><code class="mi">2</code><code class="o">,</code> <code class="o">-</code><code class="mi">2</code><code class="o">);</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">c</code><code class="o">);</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">c</code> <code class="o">+</code> <code class="s">".getReal() = "</code> <code class="o">+</code> <code class="n">c</code><code class="o">.</code><code class="na">getReal</code><code class="o">());</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">c</code> <code class="o">+</code> <code class="s">" + "</code> <code class="o">+</code> <code class="n">d</code> <code class="o">+</code> <code class="s">" = "</code> <code class="o">+</code> <code class="n">c</code><code class="o">.</code><code class="na">add</code><code class="o">(</code><code class="n">d</code><code class="o">));</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">c</code> <code class="o">+</code> <code class="s">" + "</code> <code class="o">+</code> <code class="n">d</code> <code class="o">+</code> <code class="s">" = "</code> <code class="o">+</code> <code class="n">c</code><code class="o">.</code><code class="na">add</code><code class="o">(</code><code class="n">d</code><code class="o">));</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">c</code> <code class="o">+</code> <code class="s">" * "</code> <code class="o">+</code> <code class="n">d</code> <code class="o">+</code> <code class="s">" = "</code> <code class="o">+</code> <code class="n">c</code><code class="o">.</code><code class="na">multiply</code><code class="o">(</code><code class="n">d</code><code class="o">));</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">c</code><code class="o">.</code><code class="na">divide</code><code class="o">(</code><code class="n">d</code><code class="o">));</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p>Running this demo program produces the following output:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="o">(</code><code class="mf">3.0</code><code class="o">,</code> <code class="mf">5.0</code><code class="o">)</code>&#13;
<code class="o">(</code><code class="mf">3.0</code><code class="o">,</code> <code class="mf">5.0</code><code class="o">).</code><code class="na">getReal</code><code class="o">()</code> <code class="o">=</code> <code class="mf">3.0</code>&#13;
<code class="o">(</code><code class="mf">3.0</code><code class="o">,</code> <code class="mf">5.0</code><code class="o">)</code> <code class="o">+</code> <code class="o">(</code><code class="mf">2.0</code><code class="o">,</code> <code class="o">-</code><code class="mf">2.0</code><code class="o">)</code> <code class="o">=</code> <code class="o">(</code><code class="mf">5.0</code><code class="o">,</code> <code class="mf">3.0</code><code class="o">)</code>&#13;
<code class="o">(</code><code class="mf">3.0</code><code class="o">,</code> <code class="mf">5.0</code><code class="o">)</code> <code class="o">+</code> <code class="o">(</code><code class="mf">2.0</code><code class="o">,</code> <code class="o">-</code><code class="mf">2.0</code><code class="o">)</code> <code class="o">=</code> <code class="o">(</code><code class="mf">5.0</code><code class="o">,</code> <code class="mf">3.0</code><code class="o">)</code>&#13;
<code class="o">(</code><code class="mf">3.0</code><code class="o">,</code> <code class="mf">5.0</code><code class="o">)</code> <code class="o">*</code> <code class="o">(</code><code class="mf">2.0</code><code class="o">,</code> <code class="o">-</code><code class="mf">2.0</code><code class="o">)</code> <code class="o">=</code> <code class="o">(</code><code class="mf">16.0</code><code class="o">,</code> <code class="mf">4.0</code><code class="o">)</code>&#13;
<code class="o">(-</code><code class="mf">0.5</code><code class="o">,</code> <code class="mf">2.0</code><code class="o">)</code></pre>&#13;
&#13;
<p><a data-type="xref" href="#javacook-numbers-EX-4">Example 5-7</a> is the source for my version of the <code>Complex</code> class and shouldn’t require much explanation.  The Apache one is admittedly more sophisticated, but I leave mine here just&#13;
to demystify the basic operation of complex numbers.</p>&#13;
&#13;
<p>To keep the API general, I provide—for each of add, subtract, and <span class="keep-together">multiply—</span>both a static method that works on two complex objects and a nonstatic method that applies the operation to the given object and one other object.<a data-primary="" data-startref="co_nu" data-type="indexterm" id="idm45290677802168"/><a data-primary="" data-startref="nu_co" data-type="indexterm" id="idm45290677801192"/></p>&#13;
<div data-type="example" id="javacook-numbers-EX-4">&#13;
<h5><span class="label">Example 5-7. </span>main/src/main/java/numbers/Complex.java</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">Complex</code> <code class="o">{</code>&#13;
    <code class="cm">/** The real part */</code>&#13;
    <code class="kd">private</code> <code class="kt">double</code> <code class="n">r</code><code class="o">;</code>&#13;
    <code class="cm">/** The imaginary part */</code>&#13;
    <code class="kd">private</code> <code class="kt">double</code> <code class="n">i</code><code class="o">;</code>&#13;
&#13;
    <code class="cm">/** Construct a Complex */</code>&#13;
    <code class="n">Complex</code><code class="o">(</code><code class="kt">double</code> <code class="n">rr</code><code class="o">,</code> <code class="kt">double</code> <code class="n">ii</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">r</code> <code class="o">=</code> <code class="n">rr</code><code class="o">;</code>&#13;
        <code class="n">i</code> <code class="o">=</code> <code class="n">ii</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/** Display the current Complex as a String, for use in</code>&#13;
<code class="cm">     * println() and elsewhere.</code>&#13;
<code class="cm">     */</code>&#13;
    <code class="kd">public</code> <code class="n">String</code> <code class="nf">toString</code><code class="o">()</code> <code class="o">{</code>&#13;
        <code class="n">StringBuilder</code> <code class="n">sb</code> <code class="o">=</code> <code class="k">new</code> <code class="n">StringBuilder</code><code class="o">().</code><code class="na">append</code><code class="o">(</code><code class="n">r</code><code class="o">);</code>&#13;
        <code class="k">if</code> <code class="o">(</code><code class="n">i</code><code class="o">&gt;</code><code class="mi">0</code><code class="o">)</code>&#13;
            <code class="n">sb</code><code class="o">.</code><code class="na">append</code><code class="o">(</code><code class="sc">'+'</code><code class="o">);</code>    <code class="c1">// else append(i) appends - sign</code>&#13;
        <code class="k">return</code> <code class="n">sb</code><code class="o">.</code><code class="na">append</code><code class="o">(</code><code class="n">i</code><code class="o">).</code><code class="na">append</code><code class="o">(</code><code class="sc">'i'</code><code class="o">).</code><code class="na">toString</code><code class="o">();</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/** Return just the Real part */</code>&#13;
    <code class="kd">public</code> <code class="kt">double</code> <code class="nf">getReal</code><code class="o">()</code> <code class="o">{</code>&#13;
        <code class="k">return</code> <code class="n">r</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
    <code class="cm">/** Return just the Real part */</code>&#13;
    <code class="kd">public</code> <code class="kt">double</code> <code class="nf">getImaginary</code><code class="o">()</code> <code class="o">{</code>&#13;
        <code class="k">return</code> <code class="n">i</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
    <code class="cm">/** Return the magnitude of a complex number */</code>&#13;
    <code class="kd">public</code> <code class="kt">double</code> <code class="nf">magnitude</code><code class="o">()</code> <code class="o">{</code>&#13;
        <code class="k">return</code> <code class="n">Math</code><code class="o">.</code><code class="na">sqrt</code><code class="o">(</code><code class="n">r</code><code class="o">*</code><code class="n">r</code> <code class="o">+</code> <code class="n">i</code><code class="o">*</code><code class="n">i</code><code class="o">);</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/** Add another Complex to this one</code>&#13;
<code class="cm">     */</code>&#13;
    <code class="kd">public</code> <code class="n">Complex</code> <code class="nf">add</code><code class="o">(</code><code class="n">Complex</code> <code class="n">other</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="k">return</code> <code class="nf">add</code><code class="o">(</code><code class="k">this</code><code class="o">,</code> <code class="n">other</code><code class="o">);</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/** Add two Complexes</code>&#13;
<code class="cm">     */</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="n">Complex</code> <code class="nf">add</code><code class="o">(</code><code class="n">Complex</code> <code class="n">c1</code><code class="o">,</code> <code class="n">Complex</code> <code class="n">c2</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="k">return</code> <code class="k">new</code> <code class="nf">Complex</code><code class="o">(</code><code class="n">c1</code><code class="o">.</code><code class="na">r</code><code class="o">+</code><code class="n">c2</code><code class="o">.</code><code class="na">r</code><code class="o">,</code> <code class="n">c1</code><code class="o">.</code><code class="na">i</code><code class="o">+</code><code class="n">c2</code><code class="o">.</code><code class="na">i</code><code class="o">);</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/** Subtract another Complex from this one</code>&#13;
<code class="cm">     */</code>&#13;
    <code class="kd">public</code> <code class="n">Complex</code> <code class="nf">subtract</code><code class="o">(</code><code class="n">Complex</code> <code class="n">other</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="k">return</code> <code class="nf">subtract</code><code class="o">(</code><code class="k">this</code><code class="o">,</code> <code class="n">other</code><code class="o">);</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/** Subtract two Complexes</code>&#13;
<code class="cm">     */</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="n">Complex</code> <code class="nf">subtract</code><code class="o">(</code><code class="n">Complex</code> <code class="n">c1</code><code class="o">,</code> <code class="n">Complex</code> <code class="n">c2</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="k">return</code> <code class="k">new</code> <code class="nf">Complex</code><code class="o">(</code><code class="n">c1</code><code class="o">.</code><code class="na">r</code><code class="o">-</code><code class="n">c2</code><code class="o">.</code><code class="na">r</code><code class="o">,</code> <code class="n">c1</code><code class="o">.</code><code class="na">i</code><code class="o">-</code><code class="n">c2</code><code class="o">.</code><code class="na">i</code><code class="o">);</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/** Multiply this Complex times another one</code>&#13;
<code class="cm">     */</code>&#13;
    <code class="kd">public</code> <code class="n">Complex</code> <code class="nf">multiply</code><code class="o">(</code><code class="n">Complex</code> <code class="n">other</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="k">return</code> <code class="nf">multiply</code><code class="o">(</code><code class="k">this</code><code class="o">,</code> <code class="n">other</code><code class="o">);</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/** Multiply two Complexes</code>&#13;
<code class="cm">     */</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="n">Complex</code> <code class="nf">multiply</code><code class="o">(</code><code class="n">Complex</code> <code class="n">c1</code><code class="o">,</code> <code class="n">Complex</code> <code class="n">c2</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="k">return</code> <code class="k">new</code> <code class="nf">Complex</code><code class="o">(</code><code class="n">c1</code><code class="o">.</code><code class="na">r</code><code class="o">*</code><code class="n">c2</code><code class="o">.</code><code class="na">r</code> <code class="o">-</code> <code class="n">c1</code><code class="o">.</code><code class="na">i</code><code class="o">*</code><code class="n">c2</code><code class="o">.</code><code class="na">i</code><code class="o">,</code> <code class="n">c1</code><code class="o">.</code><code class="na">r</code><code class="o">*</code><code class="n">c2</code><code class="o">.</code><code class="na">i</code> <code class="o">+</code> <code class="n">c1</code><code class="o">.</code><code class="na">i</code><code class="o">*</code><code class="n">c2</code><code class="o">.</code><code class="na">r</code><code class="o">);</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/** Divide c1 by c2.</code>&#13;
<code class="cm">     * @author Gisbert Selke.</code>&#13;
<code class="cm">     */</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="n">Complex</code> <code class="nf">divide</code><code class="o">(</code><code class="n">Complex</code> <code class="n">c1</code><code class="o">,</code> <code class="n">Complex</code> <code class="n">c2</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="k">return</code> <code class="k">new</code> <code class="nf">Complex</code><code class="o">(</code>&#13;
            <code class="o">(</code><code class="n">c1</code><code class="o">.</code><code class="na">r</code><code class="o">*</code><code class="n">c2</code><code class="o">.</code><code class="na">r</code><code class="o">+</code><code class="n">c1</code><code class="o">.</code><code class="na">i</code><code class="o">*</code><code class="n">c2</code><code class="o">.</code><code class="na">i</code><code class="o">)/(</code><code class="n">c2</code><code class="o">.</code><code class="na">r</code><code class="o">*</code><code class="n">c2</code><code class="o">.</code><code class="na">r</code><code class="o">+</code><code class="n">c2</code><code class="o">.</code><code class="na">i</code><code class="o">*</code><code class="n">c2</code><code class="o">.</code><code class="na">i</code><code class="o">),</code>&#13;
            <code class="o">(</code><code class="n">c1</code><code class="o">.</code><code class="na">i</code><code class="o">*</code><code class="n">c2</code><code class="o">.</code><code class="na">r</code><code class="o">-</code><code class="n">c1</code><code class="o">.</code><code class="na">r</code><code class="o">*</code><code class="n">c2</code><code class="o">.</code><code class="na">i</code><code class="o">)/(</code><code class="n">c2</code><code class="o">.</code><code class="na">r</code><code class="o">*</code><code class="n">c2</code><code class="o">.</code><code class="na">r</code><code class="o">+</code><code class="n">c2</code><code class="o">.</code><code class="na">i</code><code class="o">*</code><code class="n">c2</code><code class="o">.</code><code class="na">i</code><code class="o">));</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/* Compare this Complex number with another</code>&#13;
<code class="cm">     */</code>&#13;
    <code class="kd">public</code> <code class="kt">boolean</code> <code class="nf">equals</code><code class="o">(</code><code class="n">Object</code> <code class="n">o</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="k">if</code> <code class="o">(</code><code class="n">o</code><code class="o">.</code><code class="na">getClass</code><code class="o">()</code> <code class="o">!=</code> <code class="n">Complex</code><code class="o">.</code><code class="na">class</code><code class="o">)</code> <code class="o">{</code>&#13;
            <code class="k">throw</code> <code class="k">new</code> <code class="nf">IllegalArgumentException</code><code class="o">(</code>&#13;
                    <code class="s">"Complex.equals argument must be a Complex"</code><code class="o">);</code>&#13;
        <code class="o">}</code>&#13;
        <code class="n">Complex</code> <code class="n">other</code> <code class="o">=</code> <code class="o">(</code><code class="n">Complex</code><code class="o">)</code><code class="n">o</code><code class="o">;</code>&#13;
        <code class="k">return</code> <code class="n">r</code> <code class="o">==</code> <code class="n">other</code><code class="o">.</code><code class="na">r</code> <code class="o">&amp;&amp;</code> <code class="n">i</code> <code class="o">==</code> <code class="n">other</code><code class="o">.</code><code class="na">i</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/* Generate a hashCode; not sure how well distributed these are.</code>&#13;
<code class="cm">     */</code>&#13;
    <code class="kd">public</code> <code class="kt">int</code> <code class="nf">hashCode</code><code class="o">()</code> <code class="o">{</code>&#13;
        <code class="k">return</code> <code class="o">(</code><code class="kt">int</code><code class="o">)(</code><code class="n">r</code><code class="o">)</code> <code class="o">|</code>  <code class="o">(</code><code class="kt">int</code><code class="o">)</code><code class="n">i</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre></div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="5.12 Handling Very Large Numbers" data-type="sect1"><div class="sect1" id="javacook-numbers-SECT-19">&#13;
<h1>5.12 Handling Very Large Numbers</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-numbers-SECT-19.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="numbers" data-secondary="very large" data-type="indexterm" id="nu_vl"/>You need to handle integer numbers larger than <code>Long.MAX_VALUE</code> or floating-point values larger than <code>Double.MAX_VALUE</code>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-numbers-SECT-19.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use the <code>BigInteger</code> or <code>BigDecimal</code> values in package <code>java.math</code>, as shown in <a data-type="xref" href="#javacook-recipe-BigNums">Example 5-8</a>.</p>&#13;
<div data-type="example" id="javacook-recipe-BigNums">&#13;
<h5><span class="label">Example 5-8. </span>main/src/main/java/numbers/BigNums.java</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting">        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Here's Long.MAX_VALUE: "</code> <code class="o">+</code> <code class="n">Long</code><code class="o">.</code><code class="na">MAX_VALUE</code><code class="o">);</code>&#13;
        <code class="n">BigInteger</code> <code class="n">bInt</code> <code class="o">=</code> <code class="k">new</code> <code class="n">BigInteger</code><code class="o">(</code><code class="s">"3419229223372036854775807"</code><code class="o">);</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Here's a bigger number: "</code> <code class="o">+</code> <code class="n">bInt</code><code class="o">);</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Here it is as a double: "</code> <code class="o">+</code> <code class="n">bInt</code><code class="o">.</code><code class="na">doubleValue</code><code class="o">());</code></pre></div>&#13;
&#13;
<p>Note that the constructor takes the number as a string. Obviously you couldn’t just type the numeric digits because, by definition, these classes are designed to represent numbers larger than will fit in a Java <code>long</code>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-numbers-SECT-19.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>Both <code>BigInteger</code> and <code>BigDecimal</code> objects are immutable; that is, once constructed, they always represent a given number. That said, a number of methods return new objects that are mutations of the original, such as<a data-primary="negate() method" data-type="indexterm" id="idm45290677258152"/> <code>negate()</code>, which returns the negative of the given <code>BigInteger</code> or <code>BigDecimal</code>. There are also methods corresponding to most of the Java language built-in operators defined on the base types <code>int</code>/<code>long</code> and <code>float</code>/<code class="keep-together">double</code>. The division method makes you specify the rounding method; consult a book on numerical analysis for details. <a data-type="xref" href="#javacook-numbers-EX-5">Example 5-9</a> is a simple stack-based calculator using <code>BigDecimal</code> as its numeric data type.</p>&#13;
<div data-type="example" id="javacook-numbers-EX-5">&#13;
<h5><span class="label">Example 5-9. </span>main/src/main/java/numbers/BigNumCalc.java</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">BigNumCalc</code> <code class="o">{</code>&#13;
&#13;
    <code class="cm">/** an array of Objects, simulating user input */</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="n">Object</code><code class="o">[]</code> <code class="n">testInput</code> <code class="o">=</code> <code class="o">{</code>&#13;
        <code class="k">new</code> <code class="nf">BigDecimal</code><code class="o">(</code><code class="s">"3419229223372036854775807.23343"</code><code class="o">),</code>&#13;
        <code class="k">new</code> <code class="nf">BigDecimal</code><code class="o">(</code><code class="s">"2.0"</code><code class="o">),</code>&#13;
        <code class="s">"*"</code><code class="o">,</code>&#13;
    <code class="o">};</code>&#13;
&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">args</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">BigNumCalc</code> <code class="n">calc</code> <code class="o">=</code> <code class="k">new</code> <code class="n">BigNumCalc</code><code class="o">();</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">calc</code><code class="o">.</code><code class="na">calculate</code><code class="o">(</code><code class="n">testInput</code><code class="o">));</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/**</code>&#13;
<code class="cm">     * Stack of numbers being used in the calculator.</code>&#13;
<code class="cm">     */</code>&#13;
    <code class="n">Stack</code><code class="o">&lt;</code><code class="n">BigDecimal</code><code class="o">&gt;</code> <code class="n">stack</code> <code class="o">=</code> <code class="k">new</code> <code class="n">Stack</code><code class="o">&lt;&gt;();</code>&#13;
&#13;
    <code class="cm">/**</code>&#13;
<code class="cm">     * Calculate a set of operands; the input is an Object array containing</code>&#13;
<code class="cm">     * either BigDecimal objects (which may be pushed onto the Stack) and</code>&#13;
<code class="cm">     * operators (which are operated on immediately).</code>&#13;
<code class="cm">     * @param input</code>&#13;
<code class="cm">     * @return</code>&#13;
<code class="cm">     */</code>&#13;
    <code class="kd">public</code> <code class="n">BigDecimal</code> <code class="nf">calculate</code><code class="o">(</code><code class="n">Object</code><code class="o">[]</code> <code class="n">input</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">BigDecimal</code> <code class="n">tmp</code><code class="o">;</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">i</code> <code class="o">=</code> <code class="mi">0</code><code class="o">;</code> <code class="n">i</code> <code class="o">&lt;</code> <code class="n">input</code><code class="o">.</code><code class="na">length</code><code class="o">;</code> <code class="n">i</code><code class="o">++)</code> <code class="o">{</code>&#13;
            <code class="n">Object</code> <code class="n">o</code> <code class="o">=</code> <code class="n">input</code><code class="o">[</code><code class="n">i</code><code class="o">];</code>&#13;
            <code class="k">if</code> <code class="o">(</code><code class="n">o</code> <code class="k">instanceof</code> <code class="n">BigDecimal</code><code class="o">)</code> <code class="o">{</code>&#13;
                <code class="n">stack</code><code class="o">.</code><code class="na">push</code><code class="o">((</code><code class="n">BigDecimal</code><code class="o">)</code> <code class="n">o</code><code class="o">);</code>&#13;
            <code class="o">}</code> <code class="k">else</code> <code class="k">if</code> <code class="o">(</code><code class="n">o</code> <code class="k">instanceof</code> <code class="n">String</code><code class="o">)</code> <code class="o">{</code>&#13;
                <code class="k">switch</code> <code class="o">(((</code><code class="n">String</code><code class="o">)</code><code class="n">o</code><code class="o">).</code><code class="na">charAt</code><code class="o">(</code><code class="mi">0</code><code class="o">))</code> <code class="o">{</code>&#13;
                <code class="c1">// + and * are commutative, order doesn't matter</code>&#13;
                <code class="k">case</code> <code class="sc">'+'</code><code class="o">:</code>&#13;
                    <code class="n">stack</code><code class="o">.</code><code class="na">push</code><code class="o">((</code><code class="n">stack</code><code class="o">.</code><code class="na">pop</code><code class="o">()).</code><code class="na">add</code><code class="o">(</code><code class="n">stack</code><code class="o">.</code><code class="na">pop</code><code class="o">()));</code>&#13;
                    <code class="k">break</code><code class="o">;</code>&#13;
                <code class="k">case</code> <code class="sc">'*'</code><code class="o">:</code>&#13;
                    <code class="n">stack</code><code class="o">.</code><code class="na">push</code><code class="o">((</code><code class="n">stack</code><code class="o">.</code><code class="na">pop</code><code class="o">()).</code><code class="na">multiply</code><code class="o">(</code><code class="n">stack</code><code class="o">.</code><code class="na">pop</code><code class="o">()));</code>&#13;
                    <code class="k">break</code><code class="o">;</code>&#13;
                <code class="c1">// - and /, order *does* matter</code>&#13;
                <code class="k">case</code> <code class="sc">'-'</code><code class="o">:</code>&#13;
                    <code class="n">tmp</code> <code class="o">=</code> <code class="o">(</code><code class="n">BigDecimal</code><code class="o">)</code><code class="n">stack</code><code class="o">.</code><code class="na">pop</code><code class="o">();</code>&#13;
                    <code class="n">stack</code><code class="o">.</code><code class="na">push</code><code class="o">((</code><code class="n">stack</code><code class="o">.</code><code class="na">pop</code><code class="o">()).</code><code class="na">subtract</code><code class="o">(</code><code class="n">tmp</code><code class="o">));</code>&#13;
                    <code class="k">break</code><code class="o">;</code>&#13;
                <code class="k">case</code> <code class="sc">'/'</code><code class="o">:</code>&#13;
                    <code class="n">tmp</code> <code class="o">=</code> <code class="n">stack</code><code class="o">.</code><code class="na">pop</code><code class="o">();</code>&#13;
                    <code class="n">stack</code><code class="o">.</code><code class="na">push</code><code class="o">((</code><code class="n">stack</code><code class="o">.</code><code class="na">pop</code><code class="o">()).</code><code class="na">divide</code><code class="o">(</code><code class="n">tmp</code><code class="o">,</code>&#13;
                        <code class="n">BigDecimal</code><code class="o">.</code><code class="na">ROUND_HALF_UP</code><code class="o">));</code>&#13;
                    <code class="k">break</code><code class="o">;</code>&#13;
                <code class="k">default</code><code class="o">:</code>&#13;
                    <code class="k">throw</code> <code class="k">new</code> <code class="nf">IllegalStateException</code><code class="o">(</code><code class="s">"Unknown OPERATOR popped"</code><code class="o">);</code>&#13;
                <code class="o">}</code>&#13;
            <code class="o">}</code> <code class="k">else</code> <code class="o">{</code>&#13;
                <code class="k">throw</code> <code class="k">new</code> <code class="nf">IllegalArgumentException</code><code class="o">(</code><code class="s">"Syntax error in input"</code><code class="o">);</code>&#13;
            <code class="o">}</code>&#13;
        <code class="o">}</code>&#13;
        <code class="k">return</code> <code class="n">stack</code><code class="o">.</code><code class="na">pop</code><code class="o">();</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre></div>&#13;
&#13;
<p>Running this produces the expected (very large) value:</p>&#13;
<pre data-type="programlisting" id="I_5_tt188">&gt; <strong>javac -d . numbers/BigNumCalc.java</strong>&#13;
&gt; <strong>java numbers.BigNumCalc</strong>&#13;
6838458446744073709551614.466860&#13;
&gt;</pre>&#13;
&#13;
<p>The current version has its inputs hardcoded, as does the JUnit test program, but in real life you can use regular expressions to extract words or operators from an input stream (as in <a data-type="xref" href="ch04.html#javacook-regex-SECT-5">Recipe 4.5</a>), or you can use the <code>StreamTokenizer</code> approach of the simple calculator (see <a data-type="xref" href="ch10.html#javacook-io-SECT-4">Recipe 10.5</a>). The stack of numbers is maintained using a <code>java.util.Stack</code> (see <a data-type="xref" href="ch07.html#javacook-structure-SECT-14">Recipe 7.16</a>).</p>&#13;
&#13;
<p><code>BigInteger</code> is mainly useful in cryptographic and security applications. Its method <a data-primary="isProbablyPrime() method" data-type="indexterm" id="idm45290676775928"/><code>isProbablyPrime()</code> can create prime pairs for public key cryptography. <code>BigDecimal</code> might also be useful in computing the size of the universe.<a data-primary="" data-startref="nu_vl" data-type="indexterm" id="idm45290676774392"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="5.13 Program: TempConverter" data-type="sect1"><div class="sect1" id="javacook-numbers-SECT-20">&#13;
<h1>5.13 Program: TempConverter</h1>&#13;
&#13;
<p><a data-primary="numbers" data-secondary="TempConverter program" data-type="indexterm" id="nu_tcp"/><a data-primary="TempConverter program" data-type="indexterm" id="tcp_a"/>The program shown in <a data-type="xref" href="#javacook-numbers-EX-6">Example 5-10</a> prints a table of Fahrenheit temperatures (still used in daily weather reporting in the US and its territories, Liberia, and some countries in the Caribbean) and the corresponding Celsius temperatures (used in science everywhere and in daily life in the rest of the world).</p>&#13;
<div data-type="example" id="javacook-numbers-EX-6">&#13;
<h5><span class="label">Example 5-10. </span>main/src/main/java/numbers/TempConverter.java</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">TempConverter</code> <code class="o">{</code>&#13;
&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">args</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">TempConverter</code> <code class="n">t</code> <code class="o">=</code> <code class="k">new</code> <code class="n">TempConverter</code><code class="o">();</code>&#13;
        <code class="n">t</code><code class="o">.</code><code class="na">start</code><code class="o">();</code>&#13;
        <code class="n">t</code><code class="o">.</code><code class="na">data</code><code class="o">();</code>&#13;
        <code class="n">t</code><code class="o">.</code><code class="na">end</code><code class="o">();</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="kd">protected</code> <code class="kt">void</code> <code class="nf">start</code><code class="o">()</code> <code class="o">{</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="kd">protected</code> <code class="kt">void</code> <code class="nf">data</code><code class="o">()</code> <code class="o">{</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">i</code><code class="o">=-</code><code class="mi">40</code><code class="o">;</code> <code class="n">i</code><code class="o">&lt;=</code><code class="mi">120</code><code class="o">;</code> <code class="n">i</code><code class="o">+=</code><code class="mi">10</code><code class="o">)</code> <code class="o">{</code>&#13;
            <code class="kt">double</code> <code class="n">c</code> <code class="o">=</code> <code class="n">fToC</code><code class="o">(</code><code class="n">i</code><code class="o">);</code>&#13;
            <code class="n">print</code><code class="o">(</code><code class="n">i</code><code class="o">,</code> <code class="n">c</code><code class="o">);</code>&#13;
        <code class="o">}</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">double</code> <code class="nf">cToF</code><code class="o">(</code><code class="kt">double</code> <code class="n">deg</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="k">return</code> <code class="o">(</code> <code class="n">deg</code> <code class="o">*</code> <code class="mi">9</code> <code class="o">/</code> <code class="mi">5</code><code class="o">)</code> <code class="o">+</code> <code class="mi">32</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">double</code> <code class="nf">fToC</code><code class="o">(</code><code class="kt">double</code> <code class="n">deg</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="k">return</code> <code class="o">(</code> <code class="n">deg</code> <code class="o">-</code> <code class="mi">32</code> <code class="o">)</code> <code class="o">*</code> <code class="o">(</code> <code class="mi">5</code><code class="n">d</code> <code class="o">/</code> <code class="mi">9</code> <code class="o">);</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="kd">protected</code> <code class="kt">void</code> <code class="nf">print</code><code class="o">(</code><code class="kt">double</code> <code class="n">f</code><code class="o">,</code> <code class="kt">double</code> <code class="n">c</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">f</code> <code class="o">+</code> <code class="s">" "</code> <code class="o">+</code> <code class="n">c</code><code class="o">);</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="kd">protected</code> <code class="kt">void</code> <code class="nf">end</code><code class="o">()</code> <code class="o">{</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre></div>&#13;
&#13;
<p>This works, but these numbers print with about 15 digits of (useless)&#13;
decimal fractions! The second version of this program subclasses&#13;
the first and uses <code>printf</code> (see <a data-type="xref" href="ch10.html#javacook-io-SECT-3">Recipe 10.4</a>) to control&#13;
the formatting of the converted temperatures (see <a data-type="xref" href="#javacook-numbers-EX-7">Example 5-11</a>).&#13;
It will now look right, assuming you’re printing in a monospaced font.<a data-primary="" data-startref="nu_tcp" data-type="indexterm" id="idm45290676761992"/><a data-primary="" data-startref="tcp_a" data-type="indexterm" id="idm45290676612680"/></p>&#13;
<div data-type="example" id="javacook-numbers-EX-7">&#13;
<h5><span class="label">Example 5-11. </span>main/src/main/java/numbers/TempConverter2.java</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">TempConverter2</code> <code class="kd">extends</code> <code class="n">TempConverter</code> <code class="o">{</code>&#13;
&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">args</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">TempConverter</code> <code class="n">t</code> <code class="o">=</code> <code class="k">new</code> <code class="n">TempConverter2</code><code class="o">();</code>&#13;
        <code class="n">t</code><code class="o">.</code><code class="na">start</code><code class="o">();</code>&#13;
        <code class="n">t</code><code class="o">.</code><code class="na">data</code><code class="o">();</code>&#13;
        <code class="n">t</code><code class="o">.</code><code class="na">end</code><code class="o">();</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="nd">@Override</code>&#13;
    <code class="kd">protected</code> <code class="kt">void</code> <code class="nf">print</code><code class="o">(</code><code class="kt">double</code> <code class="n">f</code><code class="o">,</code> <code class="kt">double</code> <code class="n">c</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">printf</code><code class="o">(</code><code class="s">"%6.2f %6.2f%n"</code><code class="o">,</code> <code class="n">f</code><code class="o">,</code> <code class="n">c</code><code class="o">);</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="nd">@Override</code>&#13;
    <code class="kd">protected</code> <code class="kt">void</code> <code class="nf">start</code><code class="o">()</code> <code class="o">{</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Fahr    Centigrade"</code><code class="o">);</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="nd">@Override</code>&#13;
    <code class="kd">protected</code> <code class="kt">void</code> <code class="nf">end</code><code class="o">()</code> <code class="o">{</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"-------------------"</code><code class="o">);</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre></div>&#13;
<pre data-type="programlisting" id="I_5_tt189">C:\javasrc\numbers&gt;<strong>java numbers.TempConverter2</strong>&#13;
Fahr    Centigrade&#13;
-40.00 -40.00&#13;
-30.00 -34.44&#13;
-20.00 -28.89&#13;
-10.00 -23.33&#13;
  0.00 -17.78&#13;
 10.00 -12.22&#13;
 20.00  -6.67&#13;
 30.00  -1.11&#13;
 40.00   4.44&#13;
 50.00  10.00&#13;
 60.00  15.56&#13;
 70.00  21.11&#13;
 80.00  26.67&#13;
 90.00  32.22&#13;
100.00  37.78&#13;
110.00  43.33&#13;
120.00  48.89&#13;
</pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="5.14 Program: Number Palindromes" data-type="sect1"><div class="sect1" id="javacook-numbers-SECT-21">&#13;
<h1>5.14 Program: Number Palindromes</h1>&#13;
&#13;
<p><a data-primary="Number Palindromes program" data-type="indexterm" id="npp_a"/><a data-primary="numbers" data-secondary="Number Palindromes program" data-type="indexterm" id="nu_npp"/>My wife, Betty, recently  reminded me of a theorem that I must have studied in high school but whose name I have long since forgotten: that any positive integer number can be used to generate a palindrome by adding to it the number comprised of its digits in reverse order. Palindromes are sequences that read the same in either direction, such as the name “Anna” or the phrase “Madam, I’m Adam” (ignoring spaces and punctuation). We normally think of palindromes as composed of text, but the concept can be applied to numbers: 13,531 is a palindrome. Start with the number 72, for example, and add to it the number 27. The results of this addition is 99, which is a (short) palindrome. Starting with 142, add 241, and you get 383. Some numbers take more than one try to generate a palindrome. 1,951 + 1,591 yields 3,542, which is not palindromic. The second round, however, 3,542 + 2,453, yields 5,995, which is. The number 17,892, which my son Benjamin picked out of the air, requires 12 rounds to generate a palindrome, but it does terminate:</p>&#13;
<pre data-type="programlisting" id="I_5_tt191">C:\javasrc\numbers&gt;<strong>java  numbers.Palindrome 72 142 1951 17892</strong>&#13;
Trying 72&#13;
72-&gt;99&#13;
Trying 142&#13;
142-&gt;383&#13;
Trying 1951&#13;
Trying 3542&#13;
1951-&gt;5995&#13;
Trying 17892&#13;
Trying 47763&#13;
Trying 84537&#13;
Trying 158085&#13;
Trying 738936&#13;
Trying 1378773&#13;
Trying 5157504&#13;
Trying 9215019&#13;
Trying 18320148&#13;
Trying 102422529&#13;
Trying 1027646730&#13;
Trying 1404113931&#13;
17892-&gt;2797227972&#13;
&#13;
C:\javasrc\numbers&gt;</pre>&#13;
&#13;
<p>If this sounds to you like a natural candidate for recursion, you are correct. <em>Recursion</em> involves dividing a problem into simple and identical steps that can be implemented by a function that calls itself and provides a way of termination. Our basic approach, as shown in method <code>findPalindrome</code>, is this:</p>&#13;
&#13;
<pre data-type="programlisting">long findPalindrome(long num) {&#13;
    if (isPalindrome(num))&#13;
        return num;&#13;
    return findPalindrome(num + reverseNumber(num));&#13;
}</pre>&#13;
&#13;
<p>That is, if the starting number is already a palindromic number, return it; otherwise, add it to its reverse, and try again. The version of the code shown here handles simple cases directly (single digits are always palindromic, for example). We won’t think about negative numbers because these have a character at the front that loses its meaning if placed at the end, and hence are not strictly palindromic. Further, palindromic forms of certain numbers are too long to fit in Java’s 64-bit <code>long</code> integer. These cause underflow, which is trapped. As a result, an error message like “too big” is reported.<sup><a data-type="noteref" href="ch05.html#idm45290676556776" id="idm45290676556776-marker">3</a></sup> Having said all that, <a data-type="xref" href="#javacook-numbers-EX-9">Example 5-12</a> shows the code.</p>&#13;
<div data-type="example" id="javacook-numbers-EX-9">&#13;
<h5><span class="label">Example 5-12. </span>main/src/main/java/numbers/Palindrome.java</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">Palindrome</code> <code class="o">{</code>&#13;
&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">boolean</code> <code class="n">verbose</code> <code class="o">=</code> <code class="kc">true</code><code class="o">;</code>&#13;
&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">argv</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="n">String</code> <code class="n">num</code> <code class="o">:</code> <code class="n">argv</code><code class="o">)</code> <code class="o">{</code>&#13;
            <code class="k">try</code> <code class="o">{</code>&#13;
                <code class="kt">long</code> <code class="n">l</code> <code class="o">=</code> <code class="n">Long</code><code class="o">.</code><code class="na">parseLong</code><code class="o">(</code><code class="n">num</code><code class="o">);</code>&#13;
                <code class="k">if</code> <code class="o">(</code><code class="n">l</code> <code class="o">&lt;</code> <code class="mi">0</code><code class="o">)</code> <code class="o">{</code>&#13;
                    <code class="n">System</code><code class="o">.</code><code class="na">err</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">num</code> <code class="o">+</code> <code class="s">" -&gt; TOO SMALL"</code><code class="o">);</code>&#13;
                    <code class="k">continue</code><code class="o">;</code>&#13;
                <code class="o">}</code>&#13;
                <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">num</code> <code class="o">+</code> <code class="s">"-&gt;"</code> <code class="o">+</code> <code class="n">findPalindrome</code><code class="o">(</code><code class="n">l</code><code class="o">));</code>&#13;
            <code class="o">}</code> <code class="k">catch</code> <code class="o">(</code><code class="n">NumberFormatException</code> <code class="n">e</code><code class="o">)</code> <code class="o">{</code>&#13;
                <code class="n">System</code><code class="o">.</code><code class="na">err</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">num</code> <code class="o">+</code> <code class="s">"-&gt; INVALID"</code><code class="o">);</code>&#13;
            <code class="o">}</code> <code class="k">catch</code> <code class="o">(</code><code class="n">IllegalStateException</code> <code class="n">e</code><code class="o">)</code> <code class="o">{</code>&#13;
                <code class="n">System</code><code class="o">.</code><code class="na">err</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">num</code> <code class="o">+</code> <code class="s">"-&gt; "</code> <code class="o">+</code> <code class="n">e</code><code class="o">);</code>&#13;
            <code class="o">}</code>&#13;
        <code class="o">}</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/** find a palindromic number given a starting point, by</code>&#13;
<code class="cm">     * recursing until we get a number that is palindromic.</code>&#13;
<code class="cm">     */</code>&#13;
    <code class="kd">static</code> <code class="kt">long</code> <code class="nf">findPalindrome</code><code class="o">(</code><code class="kt">long</code> <code class="n">num</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="k">if</code> <code class="o">(</code><code class="n">num</code> <code class="o">&lt;</code> <code class="mi">0</code><code class="o">)</code>&#13;
            <code class="k">throw</code> <code class="k">new</code> <code class="nf">IllegalStateException</code><code class="o">(</code><code class="s">"negative"</code><code class="o">);</code>&#13;
        <code class="k">if</code> <code class="o">(</code><code class="n">isPalindrome</code><code class="o">(</code><code class="n">num</code><code class="o">))</code>&#13;
            <code class="k">return</code> <code class="n">num</code><code class="o">;</code>&#13;
        <code class="k">if</code> <code class="o">(</code><code class="n">verbose</code><code class="o">)</code>&#13;
             <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Trying "</code> <code class="o">+</code> <code class="n">num</code><code class="o">);</code>&#13;
        <code class="k">return</code> <code class="nf">findPalindrome</code><code class="o">(</code><code class="n">num</code> <code class="o">+</code> <code class="n">reverseNumber</code><code class="o">(</code><code class="n">num</code><code class="o">));</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/** The number of digits in Long.MAX_VALUE */</code>&#13;
    <code class="kd">protected</code> <code class="kd">static</code> <code class="kd">final</code> <code class="kt">int</code> <code class="n">MAX_DIGITS</code> <code class="o">=</code> <code class="mi">19</code><code class="o">;</code>&#13;
&#13;
    <code class="c1">// digits array is shared by isPalindrome and reverseNumber,</code>&#13;
    <code class="c1">// which cannot both be running at the same time.</code>&#13;
&#13;
    <code class="cm">/* Statically allocated array to avoid new-ing each time. */</code>&#13;
    <code class="kd">static</code> <code class="kt">long</code><code class="o">[]</code> <code class="n">digits</code> <code class="o">=</code> <code class="k">new</code> <code class="kt">long</code><code class="o">[</code><code class="n">MAX_DIGITS</code><code class="o">];</code>&#13;
&#13;
    <code class="cm">/** Check if a number is palindromic. */</code>&#13;
    <code class="kd">static</code> <code class="kt">boolean</code> <code class="nf">isPalindrome</code><code class="o">(</code><code class="kt">long</code> <code class="n">num</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="c1">// Consider any single digit to be as palindromic as can be</code>&#13;
        <code class="k">if</code> <code class="o">(</code><code class="n">num</code> <code class="o">&gt;=</code> <code class="mi">0</code> <code class="o">&amp;&amp;</code> <code class="n">num</code> <code class="o">&lt;=</code> <code class="mi">9</code><code class="o">)</code>&#13;
            <code class="k">return</code> <code class="kc">true</code><code class="o">;</code>&#13;
&#13;
        <code class="kt">int</code> <code class="n">nDigits</code> <code class="o">=</code> <code class="mi">0</code><code class="o">;</code>&#13;
        <code class="k">while</code> <code class="o">(</code><code class="n">num</code> <code class="o">&gt;</code> <code class="mi">0</code><code class="o">)</code> <code class="o">{</code>&#13;
            <code class="n">digits</code><code class="o">[</code><code class="n">nDigits</code><code class="o">++]</code> <code class="o">=</code> <code class="n">num</code> <code class="o">%</code> <code class="mi">10</code><code class="o">;</code>&#13;
            <code class="n">num</code> <code class="o">/=</code> <code class="mi">10</code><code class="o">;</code>&#13;
        <code class="o">}</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">i</code><code class="o">=</code><code class="mi">0</code><code class="o">;</code> <code class="n">i</code><code class="o">&lt;</code><code class="n">nDigits</code><code class="o">/</code><code class="mi">2</code><code class="o">;</code> <code class="n">i</code><code class="o">++)</code>&#13;
            <code class="k">if</code> <code class="o">(</code><code class="n">digits</code><code class="o">[</code><code class="n">i</code><code class="o">]</code> <code class="o">!=</code> <code class="n">digits</code><code class="o">[</code><code class="n">nDigits</code> <code class="o">-</code> <code class="n">i</code> <code class="o">-</code> <code class="mi">1</code><code class="o">])</code>&#13;
                <code class="k">return</code> <code class="kc">false</code><code class="o">;</code>&#13;
        <code class="k">return</code> <code class="kc">true</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="kd">static</code> <code class="kt">long</code> <code class="nf">reverseNumber</code><code class="o">(</code><code class="kt">long</code> <code class="n">num</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="kt">int</code> <code class="n">nDigits</code> <code class="o">=</code> <code class="mi">0</code><code class="o">;</code>&#13;
        <code class="k">while</code> <code class="o">(</code><code class="n">num</code> <code class="o">&gt;</code> <code class="mi">0</code><code class="o">)</code> <code class="o">{</code>&#13;
            <code class="n">digits</code><code class="o">[</code><code class="n">nDigits</code><code class="o">++]</code> <code class="o">=</code> <code class="n">num</code> <code class="o">%</code> <code class="mi">10</code><code class="o">;</code>&#13;
            <code class="n">num</code> <code class="o">/=</code> <code class="mi">10</code><code class="o">;</code>&#13;
        <code class="o">}</code>&#13;
        <code class="kt">long</code> <code class="n">ret</code> <code class="o">=</code> <code class="mi">0</code><code class="o">;</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">i</code><code class="o">=</code><code class="mi">0</code><code class="o">;</code> <code class="n">i</code><code class="o">&lt;</code><code class="n">nDigits</code><code class="o">;</code> <code class="n">i</code><code class="o">++)</code> <code class="o">{</code>&#13;
            <code class="n">ret</code> <code class="o">*=</code> <code class="mi">10</code><code class="o">;</code>&#13;
            <code class="n">ret</code> <code class="o">+=</code> <code class="n">digits</code><code class="o">[</code><code class="n">i</code><code class="o">];</code>&#13;
        <code class="o">}</code>&#13;
        <code class="k">return</code> <code class="n">ret</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre></div>&#13;
&#13;
<p>While it’s not strictly a numerical solution, <a data-primary="Hinojosa, Daniel" data-type="indexterm" id="idm45290676545352"/>Daniel Hinojosa noted that you&#13;
can use <a data-primary="StringBuilder" data-type="indexterm" id="idm45290676544616"/><code>StringBuilder</code> to do the reversal portion, resulting in shorter, more&#13;
elegant code that is only fractionally slower:</p>&#13;
&#13;
<pre data-type="programlisting">    static boolean isPalindrome(long num) {&#13;
        long result = reverseNumber(num);&#13;
        return num == result;&#13;
    }&#13;
&#13;
    private static long reverseNumber(long num) {&#13;
        StringBuilder stringBuilder = new StringBuilder();&#13;
        stringBuilder.append(num);&#13;
        return Long.parseLong(stringBuilder.reverse().toString());&#13;
    }</pre>&#13;
&#13;
<p>A full version of his code is in the file <em>PalindromeViaStringBuilder.java</em>.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="See Also" data-type="sect2"><div class="sect2" id="javacook-numbers-SECT-21.1">&#13;
<h2>See Also</h2>&#13;
&#13;
<p>People using Java in scientific or large-scale numeric computing may wish to check out the value types forthcoming from&#13;
<a href="https://wiki.openjdk.java.net/display/valhalla/Main">“Project Valhalla” in Java</a>.&#13;
See also a 2019 presentation&#13;
titled <a href="https://www.youtube.com/watch?v=UlnoCj4B8pU">“Vectors and Numerics on the JVM”</a>.<a data-primary="" data-startref="npp_a" data-type="indexterm" id="idm45290675948472"/><a data-primary="" data-startref="nu_npp" data-type="indexterm" id="idm45290675947496"/><a data-primary="" data-startref="nu_ch" data-type="indexterm" id="idm45290675946552"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<div data-type="footnotes"><p data-type="footnote" id="idm45290682381560"><sup><a href="ch05.html#idm45290682381560-marker">1</a></sup> For a low-cost source of randomness, check out the now-defunct <a href="http://en.wikipedia.org/wiki/Lavarand">Lavarand</a>. The process used digitized video of 1970s lava lamps to provide “hardware-based” randomness. Fun!</p><p data-type="footnote" id="idm45290681215064"><sup><a href="ch05.html#idm45290681215064-marker">2</a></sup> Note that an expression consisting entirely of compile-time constants, like <code>Math.PI \* 2.1e17</code>, is also considered to be Strict-FP.</p><p data-type="footnote" id="idm45290676556776"><sup><a href="ch05.html#idm45290676556776-marker">3</a></sup> Certain values do not work; for example, Ashish Batia reported that this version gets an exception on the value 8,989 (which it does).</p></div></div></section></body></html>