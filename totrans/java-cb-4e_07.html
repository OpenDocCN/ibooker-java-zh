<html><head></head><body><section data-pdf-bookmark="Chapter 7. Structuring Data with Java" data-type="chapter" epub:type="chapter"><div class="chapter" id="javacook-structure">&#13;
<h1><span class="label">Chapter 7. </span>Structuring Data with Java</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="7.0 Introduction" data-type="sect1"><div class="sect1" id="javacook-structure-intro">&#13;
<h1>7.0 Introduction</h1>&#13;
&#13;
<p><a data-primary="data structures" data-type="indexterm" id="ds_ch"/><a data-primary="data structures" data-secondary="about" data-type="indexterm" id="idm45290673619032"/>Almost every application beyond “Hello, World” needs to keep track of some structured data. A simple numeric problem might work with three or four numbers only, but most applications have groups of similar data items. A GUI-based application may need to keep track of a number of dialog windows. A personal information manager, or PIM, needs to keep track of a number of, well, persons. An operating system needs to keep track of who is allowed to log in, who is currently logged in, and what those users are doing. A library needs to keep track of who has books checked out and when they’re due. A network server may need to keep track of its active clients. A pattern emerges here, and it revolves around variations of what has traditionally been called <em>data</em> <em class="keep-together">structuring</em>.</p>&#13;
&#13;
<p>There are data structures in the memory of a running program; there is structure in the data in a file on disk, and there is structure in the information stored in a database. In this chapter, we concentrate on the first aspect: in-memory data. We’ll cover the second aspect in <a data-type="xref" href="ch10.html#javacook-io">Chapter 10</a>; the third is out of scope for this book.</p>&#13;
&#13;
<p>If you had to think about in-memory data, you might want to compare it to a collection of index cards in a filing box or to a treasure hunt where each clue leads to the next. Or you might think of it like my desk—apparently scattered, but actually a very powerful collection filled with meaningful information. Each of these is a good analogy for a type of data structuring that Java provides. An array is a fixed-length linear collection of data items, like the card filing box: it can only hold so much, then it overflows. The treasure hunt is like a data structure called a <a data-primary="linked lists" data-type="indexterm" id="idm45290673613288"/><em>linked list</em>. The first release of Java had no standard linked list class, but you could write your own traditional data structure classes (and still can; you see a DIY linked list implementation in <a data-type="xref" href="#javacook-structure-SECT-5">Recipe 7.8</a>). The complex collection represents Java’s <code>Collection</code> classes. A document entitled <a data-primary="Collections Framework" data-type="indexterm" id="idm45290673610808"/><em>Collections Framework Overview</em>, distributed with the Java Development Kit documentation (and stored therein as file <em>…/docs/guide/collections/overview.html</em> <!--and
This URL was not brought forward past Java 8(?),
do not update.-->&#13;
<a href="http://docs.oracle.com/javase/8/docs/technotes/guides/collections/index.html">online</a>), provides a detailed discussion of the Collections Framework. The framework aspects of Java collections are summarized in <a data-type="xref" href="#javacook-structure-collections">Recipe 7.3</a>.</p>&#13;
&#13;
<p>Beware of typographic issues. The word <code>Arrays</code> (in constant width font) refers to the class <code>java.util.Arrays</code>; but in the normal typeface, the word “arrays” is simply the plural of “array” (and will be found capitalized at the beginning of a sentence). Also, note that <code>HashMap</code> and <code>HashSet</code> follow the rule of having a midcapital at each word boundary, whereas the older <code>Hashtable</code> does not (the <em>t</em> is not capitalized).</p>&#13;
&#13;
<p>The <code>java.util</code> package has become something of a catch-all over&#13;
the years. Besides the legacy date/time API covered in&#13;
<a data-type="xref" href="ch06.html#javacook-dates-legacy">Recipe 6.9</a>, several other classes from <code>java.util</code>&#13;
are not covered in this chapter. All the classes whose names begin&#13;
with <code>Abstract</code> are, in fact, abstract, and we’ll discuss their nonabstract subclasses.&#13;
The <code>StringTokenizer</code> class is covered in <a data-type="xref" href="ch03.html#javacook-strings-SECT-1">Recipe 3.1</a>.&#13;
<code>BitSet</code> is used less frequently than some&#13;
of the classes discussed here and is simple enough to learn on your own.&#13;
<code>BitSet</code> stores the bits very compactly in memory, but&#13;
because it predates the Collection API and wasn’t retrofitted, it doesn’t&#13;
implement any of the standard collection interfaces.&#13;
Also not covered here are <code>EnumSet</code> and <code>EnumMap</code>,&#13;
specialized for efficient storage/retrieval of enums. These are newer&#13;
than <code>BitSet</code> and <em>do</em> implement the modern collection interfaces.</p>&#13;
&#13;
<p>We start our discussion of data structuring techniques with one of&#13;
the oldest structures, the array.&#13;
We’ll discuss the overall structure of <code>java.util</code>’s Collections Framework.&#13;
Then we’ll go through a variety of structuring techniques using classes from <code>java.util</code>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="7.1 Using Arrays for Data Structuring" data-type="sect1"><div class="sect1" id="javacook-structure-SECT-1">&#13;
<h1>7.1 Using Arrays for Data Structuring</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-structure-SECT-1.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="data structures" data-secondary="arrays and" data-type="indexterm" id="idm45290673592152"/>You need to keep track of a fixed amount of information and retrieve it (usually) <span class="keep-together">sequentially</span>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-structure-SECT-1.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use an array.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-structure-SECT-1.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>Arrays can be used to hold any linear collection of data. The items in an array must all be of the same type. You can make an array of any primitive type or any object type. For<a data-primary="primitive types" data-type="indexterm" id="idm45290673585736"/> <em>arrays of primitive types</em>, such as <code>int</code>s and <code>boolean</code>s, the data is stored in the array. For <a data-primary="objects" data-secondary="arrays for" data-type="indexterm" id="idm45290673583624"/><em>arrays of objects</em>, a reference is stored in the array, so the normal rules of reference variables and casting apply. Note in particular that if the array is declared as <code>Object[]</code>, object references of any type can be stored in it without casting, although a valid cast is required to take an <code>Object</code> reference out and use it as its original type. I’ll say a bit more on two-dimensional arrays in <a data-type="xref" href="#javacook-structure-SECT-15">Recipe 7.17</a>; otherwise, you should treat this as a review example:</p>&#13;
&#13;
<p><em>main/src/main/java/lang/Array1.java</em></p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">Array1</code>  <code class="o">{</code>&#13;
    <code class="nd">@SuppressWarnings</code><code class="o">(</code><code class="s">"unused"</code><code class="o">)</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">argv</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="kt">int</code><code class="o">[]</code> <code class="n">monthLen1</code><code class="o">;</code>            <code class="c1">// declare a reference</code>&#13;
        <code class="n">monthLen1</code> <code class="o">=</code> <code class="k">new</code> <code class="kt">int</code><code class="o">[</code><code class="mi">12</code><code class="o">];</code>        <code class="c1">// construct it</code>&#13;
        <code class="kt">int</code><code class="o">[]</code> <code class="n">monthLen2</code> <code class="o">=</code> <code class="k">new</code> <code class="kt">int</code><code class="o">[</code><code class="mi">12</code><code class="o">];</code>    <code class="c1">// short form</code>&#13;
        <code class="c1">// even shorter is this initializer form:</code>&#13;
        <code class="kt">int</code><code class="o">[]</code> <code class="n">monthLen3</code> <code class="o">=</code> <code class="o">{</code>&#13;
                <code class="mi">31</code><code class="o">,</code> <code class="mi">28</code><code class="o">,</code> <code class="mi">31</code><code class="o">,</code> <code class="mi">30</code><code class="o">,</code>&#13;
                <code class="mi">31</code><code class="o">,</code> <code class="mi">30</code><code class="o">,</code> <code class="mi">31</code><code class="o">,</code> <code class="mi">31</code><code class="o">,</code>&#13;
                <code class="mi">30</code><code class="o">,</code> <code class="mi">31</code><code class="o">,</code> <code class="mi">30</code><code class="o">,</code> <code class="mi">31</code><code class="o">,</code>&#13;
        <code class="o">};</code>&#13;
&#13;
        <code class="kd">final</code> <code class="kt">int</code> <code class="n">MAX</code> <code class="o">=</code> <code class="mi">10</code><code class="o">;</code>&#13;
        <code class="n">LocalDate</code><code class="o">[]</code> <code class="n">days</code> <code class="o">=</code> <code class="k">new</code> <code class="n">LocalDate</code><code class="o">[</code><code class="n">MAX</code><code class="o">];</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">i</code><code class="o">=</code><code class="mi">0</code><code class="o">;</code> <code class="n">i</code><code class="o">&lt;</code><code class="n">MAX</code><code class="o">;</code> <code class="n">i</code><code class="o">++)</code> <code class="o">{</code>&#13;
            <code class="n">days</code><code class="o">[</code><code class="n">i</code><code class="o">]</code> <code class="o">=</code> <code class="n">LocalDate</code><code class="o">.</code><code class="na">of</code><code class="o">(</code><code class="mi">2022</code><code class="o">,</code> <code class="mi">02</code><code class="o">,</code> <code class="n">i</code> <code class="o">+</code> <code class="mi">1</code><code class="o">);</code>&#13;
        <code class="o">}</code>&#13;
&#13;
        <code class="c1">// Two-Dimensional Arrays</code>&#13;
        <code class="c1">// Want a 10-by-24 array</code>&#13;
        <code class="kt">int</code><code class="o">[][]</code> <code class="n">me</code> <code class="o">=</code> <code class="k">new</code> <code class="kt">int</code><code class="o">[</code><code class="mi">10</code><code class="o">][];</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">i</code><code class="o">=</code><code class="mi">0</code><code class="o">;</code> <code class="n">i</code><code class="o">&lt;</code><code class="mi">10</code><code class="o">;</code> <code class="n">i</code><code class="o">++)</code>&#13;
            <code class="n">me</code><code class="o">[</code><code class="n">i</code><code class="o">]</code> <code class="o">=</code> <code class="k">new</code> <code class="kt">int</code><code class="o">[</code><code class="mi">24</code><code class="o">];</code>&#13;
&#13;
        <code class="c1">// Remember that an array has a ".length" attribute</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">me</code><code class="o">.</code><code class="na">length</code><code class="o">);</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">me</code><code class="o">[</code><code class="mi">0</code><code class="o">].</code><code class="na">length</code><code class="o">);</code>&#13;
&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p>Arrays in Java work nicely. The type checking provides reasonable integrity, and array bounds are always checked by the runtime system, further contributing to reliability.</p>&#13;
&#13;
<p>The only problem with arrays is: what if the array fills up and you still have data coming in? See <a data-type="xref" href="#javacook-structure-SECT-2">Recipe 7.2</a>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="7.2 Resizing an Array" data-type="sect1"><div class="sect1" id="javacook-structure-SECT-2">&#13;
<h1>7.2 Resizing an Array</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-structure-SECT-2.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="arrays" data-type="indexterm" id="idm45290673301544"/><a data-primary="data structures" data-secondary="resizing arrays" data-type="indexterm" id="idm45290673300840"/><a data-primary="resizing arrays" data-type="indexterm" id="idm45290673299896"/>The array filled up, and you got an <code>ArrayIndexOutOfBoundsException</code>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-structure-SECT-2.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Make the array bigger. Or, use an <code>ArrayList</code>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-structure-SECT-2.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>One approach is to allocate the array at a reasonable size to begin with; but if you find yourself with more data than will fit, reallocate a new, bigger array and copy the elements into it.<a data-primary="System.arrayCopy() method" data-type="indexterm" id="idm45290673293928"/><sup><a data-type="noteref" href="ch07.html#idm45290673293208" id="idm45290673293208-marker">1</a></sup> Here is code that does so:</p>&#13;
&#13;
<p><em>main/src/main/java/lang/Array2.java</em></p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code><code> </code><code class="kd">class</code><code> </code><code class="nc">Array2</code><code>  </code><code class="o">{</code><code>&#13;
</code><code>    </code><code class="kd">public</code><code> </code><code class="kd">final</code><code> </code><code class="kd">static</code><code> </code><code class="kt">int</code><code> </code><code class="n">INITIAL</code><code> </code><code class="o">=</code><code> </code><code class="mi">10</code><code class="o">,</code><code>   </code><a class="co" href="#callout_structuring_data_with_java_CO1-1" id="co_structuring_data_with_java_CO1-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>        </code><code class="n">GROW_FACTOR</code><code> </code><code class="o">=</code><code> </code><code class="mi">2</code><code class="o">;</code><code>                    </code><a class="co" href="#callout_structuring_data_with_java_CO1-2" id="co_structuring_data_with_java_CO1-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="kd">public</code><code> </code><code class="kd">static</code><code> </code><code class="kt">void</code><code> </code><code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[</code><code class="o">]</code><code> </code><code class="n">argv</code><code class="o">)</code><code> </code><code class="o">{</code><code>&#13;
</code><code>        </code><code class="kt">int</code><code> </code><code class="n">nDates</code><code> </code><code class="o">=</code><code> </code><code class="mi">0</code><code class="o">;</code><code>&#13;
</code><code>        </code><code class="n">LocalDateTime</code><code class="o">[</code><code class="o">]</code><code> </code><code class="n">dates</code><code> </code><code class="o">=</code><code> </code><code class="k">new</code><code> </code><code class="n">LocalDateTime</code><code class="o">[</code><code class="n">INITIAL</code><code class="o">]</code><code class="o">;</code><code>&#13;
</code><code>        </code><code class="n">StructureDemo</code><code> </code><code class="n">source</code><code> </code><code class="o">=</code><code> </code><code class="k">new</code><code> </code><code class="n">StructureDemo</code><code class="o">(</code><code class="mi">21</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>        </code><code class="n">LocalDateTime</code><code> </code><code class="n">c</code><code class="o">;</code><code>&#13;
</code><code>        </code><code class="k">while</code><code> </code><code class="o">(</code><code class="o">(</code><code class="n">c</code><code class="o">=</code><code class="n">source</code><code class="o">.</code><code class="na">getDate</code><code class="o">(</code><code class="o">)</code><code class="o">)</code><code> </code><code class="o">!</code><code class="o">=</code><code> </code><code class="kc">null</code><code class="o">)</code><code> </code><code class="o">{</code><code>&#13;
</code><code>&#13;
</code><code>            </code><code class="c1">// if (nDates &gt;= dates.length) {&#13;
</code><code>            </code><code class="c1">//     throw new RuntimeException(&#13;
</code><code>            </code><code class="c1">//         "Too Many Dates! Simplify your life!!");&#13;
</code><code>            </code><code class="c1">// }&#13;
</code><code>&#13;
</code><code>            </code><code class="c1">// better: reallocate, making data structure dynamic&#13;
</code><code>            </code><code class="k">if</code><code> </code><code class="o">(</code><code class="n">nDates</code><code> </code><code class="o">&gt;</code><code class="o">=</code><code> </code><code class="n">dates</code><code class="o">.</code><code class="na">length</code><code class="o">)</code><code> </code><code class="o">{</code><code>&#13;
</code><code>                </code><code class="n">LocalDateTime</code><code class="o">[</code><code class="o">]</code><code> </code><code class="n">tmp</code><code> </code><code class="o">=</code><code>&#13;
</code><code>                    </code><code class="k">new</code><code> </code><code class="n">LocalDateTime</code><code class="o">[</code><code class="n">dates</code><code class="o">.</code><code class="na">length</code><code> </code><code class="o">*</code><code> </code><code class="n">GROW_FACTOR</code><code class="o">]</code><code class="o">;</code><code>&#13;
</code><code>                </code><code class="n">System</code><code class="o">.</code><code class="na">arraycopy</code><code class="o">(</code><code class="n">dates</code><code class="o">,</code><code> </code><code class="mi">0</code><code class="o">,</code><code> </code><code class="n">tmp</code><code class="o">,</code><code> </code><code class="mi">0</code><code class="o">,</code><code> </code><code class="n">dates</code><code class="o">.</code><code class="na">length</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>                </code><code class="n">dates</code><code> </code><code class="o">=</code><code> </code><code class="n">tmp</code><code class="o">;</code><code>    </code><code class="c1">// copies the array reference&#13;
</code><code>                </code><code class="c1">// old array will be garbage collected soon...&#13;
</code><code>            </code><code class="o">}</code><code>&#13;
</code><code>            </code><code class="n">dates</code><code class="o">[</code><code class="n">nDates</code><code class="o">+</code><code class="o">+</code><code class="o">]</code><code> </code><code class="o">=</code><code> </code><code class="n">c</code><code class="o">;</code><code>&#13;
</code><code>        </code><code class="o">}</code><code>&#13;
</code><code>        </code><code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Final array size = "</code><code> </code><code class="o">+</code><code> </code><code class="n">dates</code><code class="o">.</code><code class="na">length</code><code class="o">)</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="o">}</code><code>&#13;
</code><code class="o">}</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_structuring_data_with_java_CO1-1" id="callout_structuring_data_with_java_CO1-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>A good guess is necessary; know your data!</p></dd>&#13;
<dt><a class="co" href="#co_structuring_data_with_java_CO1-2" id="callout_structuring_data_with_java_CO1-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>The growth factor is arbitary; 2 is a good value here but will continue to double exponentially.&#13;
You might want to use a factor like 1.5, which would&#13;
mean more allocations at the low end but less explosive growth. You need to manage this somehow!</p></dd>&#13;
</dl>&#13;
&#13;
<p>This technique works reasonably well for simple or relatively small linear collections of data.&#13;
For data with a more variable structure, you probably want to use a more dynamic approach,&#13;
as in <a data-type="xref" href="#javacook-structure-SECT-3">Recipe 7.4</a>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="7.3 The Collections Framework" data-type="sect1"><div class="sect1" id="javacook-structure-collections">&#13;
<h1>7.3 The Collections Framework</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-structure-collections.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="Collections Framework" data-type="indexterm" id="idm45290672680056"/><a data-primary="data structures" data-secondary="collections framework" data-type="indexterm" id="idm45290672679352"/><a data-primary="Java" data-secondary="collections" data-type="indexterm" id="idm45290672678408"/>You’re having trouble keeping track of all these lists, sets, and iterators.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-structure-collections.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>There’s a pattern to it. See <a data-type="xref" href="#javacook-structure-FIG-3">Figure 7-1</a> and <a data-type="xref" href="#javacook-structure-TABLE-2">Table 7-1</a>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-structure-collections.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p><code>List</code>, <code>Set</code>, <code>Map</code>, and <code>Queue</code> are the four fundamental data structures of the Collections Framework.&#13;
<code>List</code> and <code>Set</code> are both sequences, with the difference that <code>List</code> preserves order and allows duplicate&#13;
entries, whereas <code>Set</code>, true to the mathematical concept behind it, does not.&#13;
<code>Map</code> is a key/value store, also known as a hash, a dictionary, or an associative store.&#13;
Queues are, as the same suggests, structures that you can push into at one end and pull out from the other.</p>&#13;
&#13;
<p><a data-type="xref" href="#javacook-structure-TABLE-2">Table 7-1</a> shows some of the important collection-based classes from package <code>java.util</code>.&#13;
It is intentionally not 100% complete due to space limitations.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="See Also" data-type="sect2"><div class="sect2" id="javacook-structure-collections.4">&#13;
<h2>See Also</h2>&#13;
&#13;
<p>The javadoc documentation on <code>Collections</code>, <code>Arrays</code>, <code>List</code>, <code>Set</code>, and the classes that implement them provides more details than there’s room for here. <a data-type="xref" href="#javacook-structure-TABLE-2">Table 7-1</a> may further help you to absorb the regularity of the Collections Framework.</p>&#13;
<!-- This table has a two-line spanned header, but the "Implementations"
part needs to be centered over the 4 cols that it spans, sort of like

*****************************************************************************
* Interface   *                       Implementations
*             ****************************************************************
*             * Resizable array * Hashed Table * Linked List * Balanced Tree *
*****************************************************************************
-->&#13;
<table id="javacook-structure-TABLE-2">&#13;
<caption><span class="label">Table 7-1. </span>Java collections</caption>&#13;
<thead>&#13;
<tr>&#13;
<th rowspan="2">Interfaces</th>&#13;
<th class="center" colspan="4">Implementations</th>&#13;
</tr>&#13;
<tr>&#13;
<th>Resizable array</th>&#13;
<th>Hashed table</th>&#13;
<th>Linked list</th>&#13;
<th>Balanced tree</th>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td/>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>List</code></p></td>&#13;
<td><p><code>ArrayList, Vector</code></p></td>&#13;
<td/>&#13;
<td><p><code>LinkedList</code></p></td>&#13;
<td/>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>Set</code></p></td>&#13;
<td/>&#13;
<td><p><code>HashSet</code></p></td>&#13;
<td/>&#13;
<td><p><code>TreeSet</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>Map</code></p></td>&#13;
<td/>&#13;
<td><p><code>HashMap, HashTable</code></p></td>&#13;
<td/>&#13;
<td><p><code>TreeMap</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>Queue</code></p></td>&#13;
<td><p><code>Deque</code>s, <code>BlockingQueue</code>s, etc.</p></td>&#13;
<td/>&#13;
<td/>&#13;
<td/>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
&#13;
<p><a data-type="xref" href="#javacook-structure-FIG-3">Figure 7-1</a> shows the relationships among&#13;
several of these types.</p>&#13;
&#13;
<figure><div class="figure" id="javacook-structure-FIG-3">&#13;
<img alt="jcb4 0701" src="assets/jcb4_0701.png"/>&#13;
<h6><span class="label">Figure 7-1. </span>The Collections Framework: Rectangles are interfaces; ovals classes; Solid lines are inheritance; dashed lines represent <code>implements</code></h6>&#13;
</div></figure>&#13;
&#13;
<p><code>Queue</code> and its subtypes are treated in <a data-type="xref" href="ch16.html#javacook-threads">Chapter 16</a>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="7.4 Like an Array, but More Dynamic" data-type="sect1"><div class="sect1" id="javacook-structure-SECT-3">&#13;
<h1>7.4 Like an Array, but More Dynamic</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-structure-SECT-3.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="data structures" data-secondary="ArrayLists and" data-type="indexterm" id="idm45290672671320"/><a data-primary="ArrayList" data-type="indexterm" id="idm45290672670456"/>You don’t want to worry about storage reallocation (often because you don’t know how&#13;
big the incoming dataset is going to be); you want a standard class to handle it for you.&#13;
You want to store your data in any of the <code>Collection</code> classes defined in&#13;
<a data-type="xref" href="#javacook-structure">Chapter 7</a> with type safety and without having to write downcasts when&#13;
retrieving data from the collection.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-structure-SECT-3.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use a <code>List</code> implementation or one of the other Collections classes, along with&#13;
Java’s Generic Types mechanism, declaring the <code>Collection</code> with a <a data-primary="type parameter" data-type="indexterm" id="idm45290672744040"/><em>type parameter</em> <span class="keep-together">identifying</span>&#13;
the type of your data.&#13;
The type parameter name appears in angle brackets after the declaration and instantiation.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-structure-SECT-3.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>The first of the <code>Collections</code> classes we will discuss,&#13;
<code>ArrayList</code>, is a standard class from <code>java.util</code> that encapsulates the functionality of an array but allows it to expand automatically. You can just keep on adding things to it, and each addition behaves the same. If you watch <em>really</em> closely, you might notice a brief extra pause once in a while when adding objects as the <code>ArrayList</code> reallocates and copies. But you don’t have to think about it.</p>&#13;
&#13;
<p>However, because <code>ArrayList</code> is a class and isn’t part of the syntax of Java, you can’t&#13;
use Java’s array syntax; you must use methods to access the <code>ArrayList</code>’s data. It has&#13;
methods to add objects, retrieve objects, find objects, and tell you how big the <code>List</code> is&#13;
and how big it can become without having to reallocate (note that the <code>ArrayList</code> class is&#13;
but one implementation of the <code>List</code> interface; more on that later). Like the other collection&#13;
classes in <code>java.util</code>, <code>ArrayList</code>’s storing and retrieval methods were originally defined&#13;
to have parameters and return values of <code>java.lang.Object</code>. Because <code>Object</code> is the ancestor of&#13;
every defined type, you can&#13;
store objects of any type in a <code>List</code> (or any collection) and cast it when retrieving it.&#13;
If you need to store a small number of built-ins (like <code>int</code> and <code>float</code>) into a&#13;
collection containing other data, use the appropriate wrapper class (see the introduction&#13;
to <a data-type="xref" href="ch05.html#javacook-numbers">Chapter 5</a>). To store <code>boolean</code>s, either store them directly in a&#13;
<code>java.util.BitSet</code> (see the online documentation) or store them in a <code>List</code> using the&#13;
<code>Boolean</code> wrapper class.</p>&#13;
&#13;
<p>Because <code>Object</code> is usually too general for accurate work, all modern versions of Java provide&#13;
the <a data-primary="generic types" data-type="indexterm" id="idm45290673256344"/><em>generic types</em> mechanism.&#13;
Nowadays, you declare an <code>ArrayList</code> (or other&#13;
collection) with a type parameter in angle brackets, and the parameters and returns are treated as being of&#13;
that type by the compiler, ensuring that objects of the wrong type don’t make it into your collections,&#13;
and avoiding the need to write casts when retrieving objects.&#13;
For example, this is how you declare an <code>ArrayList</code> for holding <code>String</code> object references:</p>&#13;
&#13;
<pre data-type="programlisting">List&lt;String&gt; myList = new ArrayList&lt;&gt;();</pre>&#13;
&#13;
<p>It is a good practice to <em>declare</em> the variable as the interface type <code>List</code>, even though&#13;
you are <em>defining</em> it (constructing it) as an <code>ArrayList</code>.&#13;
This makes it easier to change from one <code>List</code> implementation to another, and it avoids accidentally depending&#13;
on an implementation-specific method not in the <code>List</code> interface&#13;
(which would also make it harder to change the implementation).</p>&#13;
&#13;
<p class="pagebreak-before">The <code>&lt;&gt;</code> in the definition part is a vestige of legacy Java versions, in which you&#13;
had to repeat the type definition, so you’d write <code>new ArrayList&lt;String&gt;()</code> in that example.&#13;
Nowadays just use <code>&lt;&gt;</code> (as in the example) to indicate that you want the type copied from the declaration.&#13;
The &lt;&gt; is called the<a data-primary="diamond operator" data-type="indexterm" id="idm45290673206600"/> <em>diamond operator</em>.</p>&#13;
&#13;
<p>As of Java 13, you can simplify by using the new <code>var</code> keyword (for local variables only):</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">var</code> <code class="n">myList</code> <code class="o">=</code> <code class="k">new</code> <code class="n">ArrayList</code><code class="o">&lt;</code><code class="n">String</code><code class="o">&gt;();</code></pre>&#13;
&#13;
<p><a data-type="xref" href="#javacook-structure-TABLE-1">Table 7-2</a> shows some of the most important methods of the <code>List</code> interface,&#13;
which is implemented by <code>ArrayList</code> and other <code>List</code> implementations.&#13;
This means that the exact same methods can be used with the older <code>Vector</code>&#13;
class and several other implementing classes.&#13;
You’d just have to change the name used in the constructor call.<a data-primary="add() method" data-type="indexterm" id="idm45290673196296"/><a data-primary="clear() method" data-type="indexterm" id="idm45290673195592"/><a data-primary="contains() method" data-type="indexterm" id="idm45290673194920"/><a data-primary="forEach() method" data-type="indexterm" id="idm45290673194248"/><a data-primary="indexOf() method" data-type="indexterm" id="idm45290673193576"/><a data-primary="remove() method" data-type="indexterm" id="idm45290673192904"/></p>&#13;
<table id="javacook-structure-TABLE-1">&#13;
<caption><span class="label">Table 7-2. </span>Common List&lt;T&gt; methods</caption>&#13;
<thead>&#13;
<tr>&#13;
<th>Method signature</th>&#13;
<th>Usage</th>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td><p><code>add(T o)</code></p></td>&#13;
<td><p>Add the given element at the end</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>add(int i, T o)</code></p></td>&#13;
<td><p>Insert the given element at the specified position</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>clear()</code></p></td>&#13;
<td><p>Remove all element references from the <code>Collection</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>contains(T o)</code></p></td>&#13;
<td><p>True if the <code>List</code> contains the given object</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>forEach(lambda)</code></p></td>&#13;
<td><p>Perform the lambda for each element</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>get(int i)</code></p></td>&#13;
<td><p>Return the object reference at the specified position</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>indexOf(T o)</code></p></td>&#13;
<td><p>Return the index where the given object is found, or –1</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>of(T t, …)</code></p></td>&#13;
<td><p>Create a list from multiple objects</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>remove(T o), remove(int i)</code></p></td>&#13;
<td><p>Remove an object by reference or by position</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>toArray()</code></p></td>&#13;
<td><p>Return an array containing the objects in the <code>Collection</code></p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
&#13;
<p><code>ArrayListDemo</code> stores data in an <code>ArrayList</code> and retrieves it for processing:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">ArrayListDemo</code> <code class="o">{</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">argv</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">List</code><code class="o">&lt;</code><code class="n">LocalDate</code><code class="o">&gt;</code> <code class="n">editions</code> <code class="o">=</code> <code class="k">new</code> <code class="n">ArrayList</code><code class="o">&lt;&gt;();</code>&#13;
&#13;
        <code class="c1">// Add lots of elements to the ArrayList...</code>&#13;
        <code class="n">editions</code><code class="o">.</code><code class="na">add</code><code class="o">(</code><code class="n">LocalDate</code><code class="o">.</code><code class="na">of</code><code class="o">(</code><code class="mi">2001</code><code class="o">,</code> <code class="mi">06</code><code class="o">,</code> <code class="mi">01</code><code class="o">));</code>&#13;
        <code class="n">editions</code><code class="o">.</code><code class="na">add</code><code class="o">(</code><code class="n">LocalDate</code><code class="o">.</code><code class="na">of</code><code class="o">(</code><code class="mi">2004</code><code class="o">,</code> <code class="mi">06</code><code class="o">,</code> <code class="mi">01</code><code class="o">));</code>&#13;
        <code class="n">editions</code><code class="o">.</code><code class="na">add</code><code class="o">(</code><code class="n">LocalDate</code><code class="o">.</code><code class="na">of</code><code class="o">(</code><code class="mi">2014</code><code class="o">,</code> <code class="mi">06</code><code class="o">,</code> <code class="mi">20</code><code class="o">));</code>&#13;
&#13;
        <code class="c1">// Use old-style 'for' loop to get index number.</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Retrieving by index:"</code><code class="o">);</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">i</code> <code class="o">=</code> <code class="mi">0</code><code class="o">;</code> <code class="n">i</code><code class="o">&lt;</code><code class="n">editions</code><code class="o">.</code><code class="na">size</code><code class="o">();</code> <code class="n">i</code><code class="o">++)</code> <code class="o">{</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">printf</code><code class="o">(</code><code class="s">"Edition %d was %s\n"</code><code class="o">,</code> <code class="n">i</code> <code class="o">+</code> <code class="mi">1</code><code class="o">,</code> <code class="n">editions</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code class="n">i</code><code class="o">));</code>&#13;
        <code class="o">}</code>&#13;
        <code class="c1">// Use normal 'for' loop for simpler access</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Retrieving by Iterable:"</code><code class="o">);</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="n">LocalDate</code> <code class="n">dt</code> <code class="o">:</code> <code class="n">editions</code><code class="o">)</code> <code class="o">{</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Edition "</code> <code class="o">+</code> <code class="n">dt</code><code class="o">);</code>&#13;
        <code class="o">}</code>&#13;
&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p>The older <code>Vector</code> and <code>Hashtable</code> classes predate the Collections Framework, so they&#13;
offer additional methods with different names: <code>Vector</code> provides <a data-primary="addElement() method" data-type="indexterm" id="idm45290673113304"/><code>addElement()</code> and&#13;
<a data-primary="elementAt() method" data-type="indexterm" id="idm45290673055592"/><code>elementAt()</code>. You may still run across these in legacy code, but you should use the <code>Collection</code> methods <a data-primary="add() method" data-type="indexterm" id="idm45290673054056"/><code>add()</code> and <a data-primary="get() method" data-type="indexterm" id="idm45290673052936"/><code>get()</code> instead. Another difference is that the methods of <code>Vector</code> are synchronized, meaning&#13;
that they can be accessed safely from multiple threads (see <a data-type="xref" href="ch16.html#javacook-threads-SECT-5">Recipe 16.5</a>). This&#13;
does mean more overhead, though, so for single-threaded access it is faster to&#13;
use an <code>ArrayList</code> (see timing results in <a data-type="xref" href="#javacook-structure-SECT-17">Recipe 7.19</a>).</p>&#13;
&#13;
<p>There are various conversion methods. <a data-type="xref" href="#javacook-structure-TABLE-1">Table 7-2</a> mentions <a data-primary="toArray() method" data-type="indexterm" id="idm45290673048168"/><code>toArray()</code>, which will expose&#13;
the contents of a <code>List</code> as an array.&#13;
The <code>List</code> interface in Java 9+ features a static <a data-primary="of() method" data-type="indexterm" id="idm45290673046152"/><code>of()</code> method, which converts in the other&#13;
direction, from an array into a <code>List</code>.&#13;
In conjunction with the variable arguments feature of modern Java,&#13;
you can create and populate a list in one call to <a data-primary="List.of() method" data-type="indexterm" id="idm45290673044520"/><code>List.of()</code>, like this:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">List</code><code class="o">&lt;</code><code class="n">String</code><code class="o">&gt;</code> <code class="n">firstNames</code> <code class="o">=</code> <code class="n">List</code><code class="o">.</code><code class="na">of</code><code class="o">(</code><code class="s">"Robin"</code><code class="o">,</code> <code class="s">"Jaime"</code><code class="o">,</code> <code class="s">"Joey"</code><code class="o">);</code></pre>&#13;
&#13;
<p>In legacy code that you will find in older apps and in web searches, <a data-primary="Arrays.asList() method" data-type="indexterm" id="idm45290672894504"/><code>Arrays.asList()</code>&#13;
provided this functionality, so you will come across code like this:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">List</code><code class="o">&lt;</code><code class="n">String</code><code class="o">&gt;</code> <code class="n">lastNames</code> <code class="o">=</code> <code class="n">Arrays</code><code class="o">.</code><code class="na">asList</code><code class="o">(</code><code class="s">"Smith"</code><code class="o">,</code> <code class="s">"Jones"</code><code class="o">,</code> <code class="s">"MacKenzie"</code><code class="o">);</code>&#13;
<code class="c1">// or even</code>&#13;
<code class="n">List</code><code class="o">&lt;</code><code class="n">String</code><code class="o">&gt;</code> <code class="n">lastNames</code> <code class="o">=</code>&#13;
    <code class="n">Arrays</code><code class="o">.</code><code class="na">asList</code><code class="o">(</code><code class="k">new</code> <code class="n">String</code><code class="o">[]{</code><code class="s">"Smith"</code><code class="o">,</code> <code class="s">"Jones"</code><code class="o">,</code> <code class="s">"MacKenzie"</code><code class="o">});</code></pre>&#13;
&#13;
<p>Java does indeed get less verbose as time goes by!</p>&#13;
&#13;
<p>You can still instantiate classes such as <code>ArrayList</code> without using a specific type. In&#13;
this case, you will get a compiler warning, and the class will behave as in the old days; that is, the objects returned from a <code>Collection</code> or&#13;
<code>Iterator</code> will be of type <code>java.lang.Object</code> and must be downcast before you can call&#13;
any class-specific methods or use them in any application-specific method calls.</p>&#13;
&#13;
<p>As a further example, consider the <code>Map</code> interface mentioned in <a data-type="xref" href="#javacook-structure">Chapter 7</a>. A <code>Map</code> requires a key and a value in its <code>put()</code> method. A <code>Map</code>, therefore, has two parameterized types. To set up a <code>Map</code> whose keys are <code>Person</code> objects and whose values are <code>Address</code> objects (assuming these two classes exist in your application), you could define it like this:</p>&#13;
&#13;
<pre data-type="programlisting">Map&lt;Person, Address&gt; addressMap = new HashMap&lt;&gt;();</pre>&#13;
&#13;
<p>This <code>Map</code> expects a <code>Person</code> as its key and an <code>Address</code> as its value in the <a data-primary="put() method" data-type="indexterm" id="idm45290672869016"/><code>put()</code>&#13;
method. The <a data-primary="get() method" data-type="indexterm" id="idm45290672867896"/><code>get()</code> method returns an <code>Address</code> object, the <code>keySet()</code> method returns&#13;
<code>Set&lt;Person&gt;</code> (i.e., a <code>Set</code> specialized for <code>Person</code> objects). There are also convenience routines for when you want to create a <code>Map</code> from existing objects. The most useful is several overloads of before existing <code>Map.of(key,value,key,value…)</code> similar to <code>List.of()</code> (but limited to 10 pairs),&#13;
and so on.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="See Also" data-type="sect2"><div class="sect2" id="idm45290672870328">&#13;
<h2>See Also</h2>&#13;
&#13;
<p>Although the generics avoid your having to write downcasts, the casts still occur at runtime;&#13;
they are just provided by the compiler.&#13;
The compiler techniques used in compiling these new constructs in a backward-compatible&#13;
way include<a data-primary="erasure" data-type="indexterm" id="idm45290672862232"/><a data-primary="bridging" data-type="indexterm" id="idm45290672861528"/> <em>erasure</em> and <em>bridging</em>, topics discussed in <a data-primary="Java Generics and Collections (Naftalin and Wadler)" data-type="indexterm" id="idm45290672859864"/><a data-primary="Naftalin, Maurice" data-secondary="Java Generics and Collections" data-type="indexterm" id="idm45290672859096"/><a data-primary="Wadler, Philip" data-secondary="Java Generics and Collections" data-type="indexterm" id="idm45290672858184"/>&#13;
<a href="http://shop.oreilly.com/product/9780596527754.do"><em>Java Generics and Collections</em></a>&#13;
by Maurice Naftalin and Philip Wadler.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="7.5 Using Generic Types in Your Own Class" data-type="sect1"><div class="sect1" id="javacook-CHP-8-SECT-3">&#13;
<h1>7.5 Using Generic Types in Your Own Class</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-CHP-8-SECT-3.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="generic types" data-type="indexterm" id="gt_a"/><a data-primary="data structures" data-secondary="generic types in classes" data-type="indexterm" id="ds_gtc"/>You wish to define your own container classes using the generic type mechanism to avoid needless casting.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-CHP-8-SECT-3.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Define a class using <code>&lt;</code> <em><code>TypeName</code></em> <code>&gt;</code> where the container type is declared and <em><code>TypeName</code></em> where it is used.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-CHP-8-SECT-3.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>Consider the very simple <code>Stack</code> class in <a data-type="xref" href="#javacook-CHP-8-EX-4">Example 7-1</a>.&#13;
(We discuss the nature and uses of stack classes in <a data-type="xref" href="#javacook-structure-SECT-14">Recipe 7.16</a>.)</p>&#13;
&#13;
<p>This version has been parameterized to take a type whose local name is <code>T</code>. This type <code>T</code> will be the type of the argument of the <a data-primary="push() method" data-type="indexterm" id="idm45290672840872"/><code>push()</code> method, the return type of the<a data-primary="pop() method" data-type="indexterm" id="idm45290672839784"/> <code>pop()</code> method, and so on. Because of this return type—more specific than the <code>Object</code> return type of the original Collections—the return value from <code>pop()</code> does not need to be downcasted. All containers in the Collections Framework (<code>java.util</code>) are parameterized similarly.</p>&#13;
<div data-type="example" id="javacook-CHP-8-EX-4">&#13;
<h5><span class="label">Example 7-1. </span>main/src/main/java/structure/MyStack.java</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">MyStack</code><code class="o">&lt;</code><code class="n">T</code><code class="o">&gt;</code> <code class="kd">implements</code> <code class="n">SimpleStack</code><code class="o">&lt;</code><code class="n">T</code><code class="o">&gt;</code> <code class="o">{</code>&#13;
&#13;
    <code class="kd">private</code> <code class="kt">int</code> <code class="n">depth</code> <code class="o">=</code> <code class="mi">0</code><code class="o">;</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kd">final</code> <code class="kt">int</code> <code class="n">DEFAULT_INITIAL</code> <code class="o">=</code> <code class="mi">10</code><code class="o">;</code>&#13;
    <code class="kd">private</code> <code class="n">T</code><code class="o">[]</code> <code class="n">stack</code><code class="o">;</code>&#13;
&#13;
    <code class="kd">public</code> <code class="nf">MyStack</code><code class="o">()</code> <code class="o">{</code>&#13;
        <code class="k">this</code><code class="o">(</code><code class="n">DEFAULT_INITIAL</code><code class="o">);</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="kd">public</code> <code class="nf">MyStack</code><code class="o">(</code><code class="kt">int</code> <code class="n">howBig</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="k">if</code> <code class="o">(</code><code class="n">howBig</code> <code class="o">&lt;=</code> <code class="mi">0</code><code class="o">)</code> <code class="o">{</code>&#13;
            <code class="k">throw</code> <code class="k">new</code> <code class="nf">IllegalArgumentException</code><code class="o">(</code>&#13;
            <code class="n">howBig</code> <code class="o">+</code> <code class="s">" must be positive, but was "</code> <code class="o">+</code> <code class="n">howBig</code><code class="o">);</code>&#13;
        <code class="o">}</code>&#13;
        <code class="n">stack</code> <code class="o">=</code> <code class="o">(</code><code class="n">T</code><code class="o">[])</code><code class="k">new</code> <code class="n">Object</code><code class="o">[</code><code class="n">howBig</code><code class="o">];</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="nd">@Override</code>&#13;
    <code class="kd">public</code> <code class="kt">boolean</code> <code class="nf">empty</code><code class="o">()</code> <code class="o">{</code>&#13;
        <code class="k">return</code> <code class="n">depth</code> <code class="o">==</code> <code class="mi">0</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/** push - add an element onto the stack */</code>&#13;
    <code class="nd">@Override</code>&#13;
    <code class="kd">public</code> <code class="kt">void</code> <code class="nf">push</code><code class="o">(</code><code class="n">T</code> <code class="n">obj</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="c1">// Could check capacity and expand</code>&#13;
        <code class="n">stack</code><code class="o">[</code><code class="n">depth</code><code class="o">++]</code> <code class="o">=</code> <code class="n">obj</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/* pop - return and remove the top element */</code>&#13;
    <code class="nd">@Override</code>&#13;
    <code class="kd">public</code> <code class="n">T</code> <code class="nf">pop</code><code class="o">()</code> <code class="o">{</code>&#13;
        <code class="o">--</code><code class="n">depth</code><code class="o">;</code>&#13;
        <code class="n">T</code> <code class="n">tmp</code> <code class="o">=</code> <code class="n">stack</code><code class="o">[</code><code class="n">depth</code><code class="o">];</code>&#13;
        <code class="n">stack</code><code class="o">[</code><code class="n">depth</code><code class="o">]</code> <code class="o">=</code> <code class="kc">null</code><code class="o">;</code>&#13;
        <code class="k">return</code> <code class="n">tmp</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/** peek - return the top element but don't remove it */</code>&#13;
    <code class="nd">@Override</code>&#13;
    <code class="kd">public</code> <code class="n">T</code> <code class="nf">peek</code><code class="o">()</code> <code class="o">{</code>&#13;
        <code class="k">if</code> <code class="o">(</code><code class="n">depth</code> <code class="o">==</code> <code class="mi">0</code><code class="o">)</code> <code class="o">{</code>&#13;
            <code class="k">return</code> <code class="kc">null</code><code class="o">;</code>&#13;
        <code class="o">}</code>&#13;
        <code class="k">return</code> <code class="n">stack</code><code class="o">[</code><code class="n">depth</code><code class="o">-</code><code class="mi">1</code><code class="o">];</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="kd">public</code> <code class="kt">boolean</code> <code class="nf">hasNext</code><code class="o">()</code> <code class="o">{</code>&#13;
        <code class="k">return</code> <code class="n">depth</code> <code class="o">&gt;</code> <code class="mi">0</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="kd">public</code> <code class="kt">boolean</code> <code class="nf">hasRoom</code><code class="o">()</code> <code class="o">{</code>&#13;
        <code class="k">return</code> <code class="n">depth</code> <code class="o">&lt;</code> <code class="n">stack</code><code class="o">.</code><code class="na">length</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="kd">public</code> <code class="kt">int</code> <code class="nf">getStackDepth</code><code class="o">()</code> <code class="o">{</code>&#13;
        <code class="k">return</code> <code class="n">depth</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre></div>&#13;
&#13;
<p>The association of a particular type is done at the time the class is instantiated. For&#13;
example, to instantiate a <code>MyStack</code> specialized for holding <code>BankAccount</code> objects, you&#13;
would need to code only the following:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">MyStack</code><code class="o">&lt;</code><code class="n">BankAccount</code><code class="o">&gt;</code> <code class="n">theAccounts</code> <code class="o">=</code> <code class="k">new</code> <code class="n">MyStack</code><code class="o">&lt;&gt;(</code> <code class="o">);</code></pre>&#13;
&#13;
<p>If you don’t provide a type parameter <code>T</code>,&#13;
this collection, like the ones in <code>java.util</code>, will behave as they did in the days before generic collections—accepting input arguments of any type, returning <code>java.lang.Object</code> from getter methods, and requiring downcasting—as their default, backward-compatible behavior. <a data-type="xref" href="#javacook-CHP-8-EX-5">Example 7-2</a> shows a program that creates two instances of <code>MyStack</code>, one specialized for <code>String</code>s and one left general. The general one, called <code>ms2</code>, is loaded up with the same two <code>String</code> objects as <code>ms1</code> but also includes a <code>Date</code> object. The printing code is now broken, because it will throw a <code>ClassCastException</code>: a <code>Date</code> is not a <code>String</code>. I handle this case specially for pedantic purposes: it is illustrative of the kinds of errors you can get into when using nonparameterized container classes.</p>&#13;
<div data-type="example" id="javacook-CHP-8-EX-5">&#13;
<h5><span class="label">Example 7-2. </span>main/src/main/java/structure/MyStackDemo.java</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">MyStackDemo</code> <code class="o">{</code>&#13;
&#13;
    <code class="nd">@SuppressWarnings</code><code class="o">({</code><code class="s">"rawtypes"</code><code class="o">,</code><code class="s">"unchecked"</code><code class="o">})</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">args</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">MyStack</code><code class="o">&lt;</code><code class="n">String</code><code class="o">&gt;</code> <code class="n">ms1</code> <code class="o">=</code> <code class="k">new</code> <code class="n">MyStack</code><code class="o">&lt;&gt;();</code>&#13;
        <code class="n">ms1</code><code class="o">.</code><code class="na">push</code><code class="o">(</code><code class="s">"billg"</code><code class="o">);</code>&#13;
        <code class="n">ms1</code><code class="o">.</code><code class="na">push</code><code class="o">(</code><code class="s">"scottm"</code><code class="o">);</code>&#13;
&#13;
        <code class="k">while</code> <code class="o">(</code><code class="n">ms1</code><code class="o">.</code><code class="na">hasNext</code><code class="o">())</code> <code class="o">{</code>&#13;
            <code class="n">String</code> <code class="n">name</code> <code class="o">=</code> <code class="n">ms1</code><code class="o">.</code><code class="na">pop</code><code class="o">();</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">name</code><code class="o">);</code>&#13;
        <code class="o">}</code>&#13;
&#13;
        <code class="c1">// Old way of using Collections: not type safe.</code>&#13;
        <code class="c1">// DO NOT GENERICIZE THIS</code>&#13;
        <code class="n">MyStack</code> <code class="n">ms2</code> <code class="o">=</code> <code class="k">new</code> <code class="n">MyStack</code><code class="o">();</code>&#13;
        <code class="n">ms2</code><code class="o">.</code><code class="na">push</code><code class="o">(</code><code class="s">"billg"</code><code class="o">);</code>               <code class="c1">// EXPECT WARNING</code>&#13;
        <code class="n">ms2</code><code class="o">.</code><code class="na">push</code><code class="o">(</code><code class="s">"scottm"</code><code class="o">);</code>              <code class="c1">// EXPECT WARNING</code>&#13;
        <code class="n">ms2</code><code class="o">.</code><code class="na">push</code><code class="o">(</code><code class="k">new</code> <code class="n">java</code><code class="o">.</code><code class="na">util</code><code class="o">.</code><code class="na">Date</code><code class="o">());</code>  <code class="c1">// EXPECT WARNING</code>&#13;
&#13;
        <code class="c1">// Show that it is broken</code>&#13;
        <code class="k">try</code> <code class="o">{</code>&#13;
            <code class="n">String</code> <code class="n">bad</code> <code class="o">=</code> <code class="o">(</code><code class="n">String</code><code class="o">)</code><code class="n">ms2</code><code class="o">.</code><code class="na">pop</code><code class="o">();</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">err</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Didn't get expected exception, popped "</code> <code class="o">+</code> <code class="n">bad</code><code class="o">);</code>&#13;
        <code class="o">}</code> <code class="k">catch</code> <code class="o">(</code><code class="n">ClassCastException</code> <code class="n">ex</code><code class="o">)</code> <code class="o">{</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Did get expected exception."</code><code class="o">);</code>&#13;
        <code class="o">}</code>&#13;
&#13;
        <code class="c1">// Removed the brokenness, print rest of it.</code>&#13;
        <code class="k">while</code> <code class="o">(</code><code class="n">ms2</code><code class="o">.</code><code class="na">hasNext</code><code class="o">())</code> <code class="o">{</code>&#13;
            <code class="n">String</code> <code class="n">name</code> <code class="o">=</code> <code class="o">(</code><code class="n">String</code><code class="o">)</code><code class="n">ms2</code><code class="o">.</code><code class="na">pop</code><code class="o">();</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">name</code><code class="o">);</code>&#13;
        <code class="o">}</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre></div>&#13;
&#13;
<p>Because of this potential for error, the compiler warns that you have unchecked raw types. Like the deprecation warnings discussed in <a data-type="xref" href="ch01.html#javacook-getstarted-SECT-9">Recipe 1.9</a>, by default, these warnings are not printed in detail by the <a data-primary="javac command" data-type="indexterm" id="idm45290672183336"/><em>javac</em> compiler (they will appear in most IDEs). You ask for them with the rather lengthy option <code>-Xlint:unchecked</code>:</p>&#13;
<pre data-type="programlisting" id="I_8_tt276">C:&gt; <strong>javac -source 1.5 structure/MyStackDemo.java</strong>&#13;
Note: MyStackDemo.java uses unchecked or unsafe operations.&#13;
Note: Recompile with -Xlint:unchecked for details.&#13;
C:&gt; <strong>javac -source 1.5 -Xlint:unchecked structure/MyStackDemo.java</strong>&#13;
MyStackDemo.java:14: warning: unchecked call to push(T) as a member of the raw&#13;
type MyStack&#13;
                ms2.push("billg");&#13;
                   ^&#13;
MyStackDemo.java:15: warning: unchecked call to push(T) as a member of the raw&#13;
type MyStack&#13;
                ms2.push("scottm");&#13;
                   ^&#13;
MyStackDemo.java:16: warning: unchecked call to push(T) as a member of the raw&#13;
type MyStack&#13;
                ms2.push(new java.util.Date( ));&#13;
                   ^&#13;
3 warnings&#13;
C:&gt;</pre>&#13;
&#13;
<p>I say more about the development and evolution of <code>MyStack</code> in <a data-type="xref" href="#javacook-structure-SECT-14">Recipe 7.16</a>.<a data-primary="" data-startref="ds_gtc" data-type="indexterm" id="idm45290671960104"/><a data-primary="" data-startref="gt_a" data-type="indexterm" id="idm45290671959128"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="7.6 How Shall I Iterate Thee? Let Me Enumerate the Ways" data-type="sect1"><div class="sect1" id="javacook-structure-iterate">&#13;
<h1>7.6 How Shall I Iterate Thee? Let Me Enumerate the Ways</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-structure-iterate.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="data structures" data-secondary="iterating over" data-type="indexterm" id="ds_io"/><a data-primary="iterating" data-type="indexterm" id="it_a"/>You need to iterate over some structured data.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-structure-iterate.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Java provides many ways to iterate over collections of data. Here they are, in newest-first order:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p><a data-primary="Stream.forEach() method" data-type="indexterm" id="idm45290671949576"/><code>Stream.forEach()</code> method (Java 8)</p>&#13;
</li>&#13;
<li>&#13;
<p><a data-primary="Iterable.forEach() method" data-type="indexterm" id="idm45290671947720"/><code>Iterable.forEach()</code> method (Java 8)</p>&#13;
</li>&#13;
<li>&#13;
<p><a data-primary="for each loop" data-type="indexterm" id="idm45290671945896"/>Java “foreach” loop (Java 5)</p>&#13;
</li>&#13;
<li>&#13;
<p><a data-primary="java.util.Iterator() method" data-type="indexterm" id="idm45290671944360"/><code>java.util.Iterator</code> (Java 2)</p>&#13;
</li>&#13;
<li>&#13;
<p><a data-primary="for loop" data-type="indexterm" id="idm45290671942440"/>Three-part <code>for</code> loop</p>&#13;
</li>&#13;
<li>&#13;
<p><a data-primary="while loop" data-type="indexterm" id="idm45290671940424"/><code>while</code> loop&#13;
*<a data-primary="enumerations" data-type="indexterm" id="idm45290671939336"/> Enumeration</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p>Pick one and use it. Or learn them all and save!</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-structure-iterate.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>A few words on each of the iteration methods are given here.&#13;
Note that the first few are the most common.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Stream.forEach method (Java 8)" data-type="sect3"><div class="sect3" id="javacook-structure-iterate.Stream.forEach">&#13;
<h3>Stream.forEach method (Java 8)</h3>&#13;
&#13;
<p><a data-primary="Stream.forEach() method" data-type="indexterm" id="idm45290671934200"/>The <code>Stream</code> mechanism introduced as part of Java’s functional programming&#13;
provides one of the two most-recent ways of iterating, <code>Stream.forEach()</code>, and&#13;
is discussed in <a data-type="xref" href="ch09.html#javacook-fp-streams1-1">Recipe 9.3</a>.&#13;
For now, here’s a quick example, using the <code>BufferedReader</code> method&#13;
<code>lines()</code> that returns a <code>Stream</code>:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">$</code> <code class="n">jshell</code>&#13;
<code class="n">jshell</code><code class="o">&gt;</code> <code class="kn">import</code> <code class="nn">java.io.*</code><code class="o">;</code>&#13;
<code class="n">jshell</code><code class="o">&gt;</code> <code class="n">BufferedReader</code> <code class="n">is</code> <code class="o">=</code>&#13;
  <code class="k">new</code> <code class="nf">BufferedReader</code><code class="o">(</code><code class="k">new</code> <code class="n">FileReader</code><code class="o">(</code><code class="s">"/home/ian/.profile"</code><code class="o">));</code>&#13;
<code class="n">is</code> <code class="o">==&gt;</code> <code class="n">java</code><code class="o">.</code><code class="na">io</code><code class="o">.</code><code class="na">BufferedReader</code><code class="err">@</code><code class="mi">58651</code><code class="n">fd0</code>&#13;
<code class="n">jshell</code><code class="o">&gt;</code> <code class="n">is</code><code class="o">.</code><code class="na">lines</code><code class="o">().</code><code class="na">forEach</code><code class="o">(</code><code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">::</code><code class="n">println</code><code class="o">)</code>&#13;
<code class="o">...</code> <code class="n">prints</code> <code class="n">the</code> <code class="n">lines</code> <code class="n">of</code> <code class="n">the</code> <code class="n">file</code> <code class="o">...</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Iterable.forEach method (Java 8)" data-type="sect3"><div class="sect3" id="javacook-structure-iterate.Iterable.forEach">&#13;
<h3>Iterable.forEach method (Java 8)</h3>&#13;
&#13;
<p><a data-primary="Iterable.forEach() method" data-type="indexterm" id="idm45290671873416"/>The other recent iteration technique is the <code>Iterable.forEach()</code> method, added in Java 8.&#13;
This method can be called on any <code>Iterable</code> (unfortunately, the array class does not yet implement&#13;
<code>Iterable</code>) and takes one argument implementing the <a data-primary="functional interface" data-type="indexterm" id="idm45290671871208"/><em>functional interface</em> <code>java.util.function.Consumer</code>.&#13;
Functional interfaces are discussed in <a data-type="xref" href="ch09.html#javacook-fp">Chapter 9</a>, but here is one example:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code><code> </code><code class="kd">class</code><code> </code><code class="nc">IterableForEach</code><code> </code><code class="o">{</code><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="kd">public</code><code> </code><code class="kd">static</code><code> </code><code class="kt">void</code><code> </code><code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[</code><code class="o">]</code><code> </code><code class="n">args</code><code class="o">)</code><code> </code><code class="o">{</code><code>&#13;
</code><code>        </code><code class="n">Collection</code><code class="o">&lt;</code><code class="n">String</code><code class="o">&gt;</code><code> </code><code class="n">c</code><code> </code><code class="o">=</code><code>                    </code><a class="co" href="#callout_structuring_data_with_java_CO2-1" id="co_structuring_data_with_java_CO2-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>                </code><code class="n">List</code><code class="o">.</code><code class="na">of</code><code class="o">(</code><code class="s">"One"</code><code class="o">,</code><code> </code><code class="s">"Two"</code><code class="o">,</code><code> </code><code class="s">"Three"</code><code class="o">)</code><code class="o">;</code><code>   </code><a class="co" href="#callout_structuring_data_with_java_CO2-2" id="co_structuring_data_with_java_CO2-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>        </code><code class="n">c</code><code class="o">.</code><code class="na">forEach</code><code class="o">(</code><code class="n">s</code><code> </code><code class="o">-</code><code class="o">&gt;</code><code> </code><code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">s</code><code class="o">)</code><code class="o">)</code><code class="o">;</code><code>    </code><a class="co" href="#callout_structuring_data_with_java_CO2-3" id="co_structuring_data_with_java_CO2-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>    </code><code class="o">}</code><code>&#13;
</code><code class="o">}</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_structuring_data_with_java_CO2-1" id="callout_structuring_data_with_java_CO2-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Declare a <code>Collection</code> (a <code>Collection</code> is an <code>Iterable</code>).</p></dd>&#13;
<dt><a class="co" href="#co_structuring_data_with_java_CO2-2" id="callout_structuring_data_with_java_CO2-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Populate it with <a data-primary="Arrays.of() method" data-type="indexterm" id="idm45290671697928"/><code>Arrays.of()</code> with an array or sequence of objects&#13;
(see <a data-type="xref" href="#javacook-structure-SECT-3">Recipe 7.4</a> for how this arbitrary argument list becomes an array).</p></dd>&#13;
<dt><a class="co" href="#co_structuring_data_with_java_CO2-3" id="callout_structuring_data_with_java_CO2-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>Invoke the collection’s <a data-primary="forEach() method" data-type="indexterm" id="idm45290671656584"/><code>forEach()</code> method, passing a lambda expression (see&#13;
<a data-type="xref" href="ch09.html#javacook-fp">Chapter 9</a> for a discussion of how <code>s</code>→<code>System.out.println(s)</code> gets mapped to a&#13;
<code>Consumer</code> interface implementation without your even having to import this interface).</p></dd>&#13;
</dl>&#13;
&#13;
<p>This style of iteration—sometimes called<a data-primary="internal iteration" data-type="indexterm" id="idm45290671653448"/> <em>internal iteration</em>—inverts the control from the traditional&#13;
<code>for</code> loop; the collection is in charge of when and how the iteration works.</p>&#13;
<div data-type="tip"><h6>Tip</h6>&#13;
<p>Both <code>Stream.forEach</code> and <code>Iterable.forEach()</code> take one argument, of type <code>java.util.function.Consumer</code>,&#13;
so they work largely the same way, at least syntactically. This is intentional.</p>&#13;
</div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Java “foreach” loop (Java 5)" data-type="sect3"><div class="sect3" id="javacook-structure-iterate.Java5.forEach">&#13;
<h3>Java “foreach” loop (Java 5)</h3>&#13;
&#13;
<p><a data-primary="for each loop" data-type="indexterm" id="idm45290671648280"/>This is the for-each loop syntax:</p>&#13;
&#13;
<pre data-type="programlisting">for (Type var : Iterable&lt;Type&gt;) {&#13;
	// do something with "var"&#13;
}</pre>&#13;
&#13;
<p>The for-each loop is probably the most common style of loop in modern Java code.&#13;
The <code>Iterable</code> can be an array or anything that implements <code>Iterable</code> (the <code>Collection</code> implementations included).</p>&#13;
&#13;
<p>This style is used throughout the book. In addition, many third-party frameworks/libraries provide their own types that implement&#13;
<code>Iterable</code> for use with the <code>for</code> loop.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="java.util.Iterator (Java 2)" data-type="sect3"><div class="sect3" id="javacook-structure-iterate.Iterator">&#13;
<h3>java.util.Iterator (Java 2)</h3>&#13;
&#13;
<p><a data-primary="java.util.Iterator() method" data-type="indexterm" id="idm45290671642440"/>The older <code>Iterator</code> interface has three methods:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">interface</code> <code class="nc">java</code><code class="o">.</code><code class="na">util</code><code class="o">.</code><code class="na">Iterator</code><code class="o">&lt;</code><code class="n">E</code><code class="o">&gt;</code> <code class="o">{</code>&#13;
  <code class="kd">public</code> <code class="kd">abstract</code> <code class="kt">boolean</code> <code class="nf">hasNext</code><code class="o">();</code>&#13;
  <code class="kd">public</code> <code class="kd">abstract</code> <code class="n">E</code> <code class="nf">next</code><code class="o">();</code>&#13;
  <code class="kd">public</code> <code class="k">default</code> <code class="kt">void</code> <code class="nf">remove</code><code class="o">();</code>&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p>It was once common to write code like this, which you’ll still find occasionally in older code:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">Iterator</code> <code class="n">it</code> <code class="o">=</code> <code class="o">...;</code> <code class="c1">// legacy code; might not even have type parameter</code>&#13;
<code class="k">while</code> <code class="o">(</code><code class="n">it</code><code class="o">.</code><code class="na">hasNext</code><code class="o">())</code> <code class="o">{</code>&#13;
	<code class="o">(</code><code class="n">MyDataType</code><code class="o">)</code> <code class="n">c</code> <code class="o">=</code> <code class="n">it</code><code class="o">.</code><code class="na">next</code><code class="o">();</code>&#13;
	<code class="c1">// Do something with c</code>&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p>The<a data-primary="remove() method" data-type="indexterm" id="idm45290671592152"/> <code>remove()</code> method throws an <code>UnsupportedOperationException</code> if called on a read-only collection.&#13;
In conjunction with <code>Stream</code>s and default methods, there is now a fourth method:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="k">default</code> <code class="kt">void</code> <code class="nf">forEachRemaining</code><code class="o">(</code><code class="n">java</code><code class="o">.</code><code class="na">util</code><code class="o">.</code><code class="na">function</code><code class="o">.</code><code class="na">Consumer</code><code class="o">&lt;?</code> <code class="kd">super</code> <code class="n">E</code><code class="o">&gt;);</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Three-part for loop" data-type="sect3"><div class="sect3" id="javacook-structure-iterate.forloop">&#13;
<h3>Three-part for loop</h3>&#13;
&#13;
<p><a data-primary="for loop" data-type="indexterm" id="idm45290671551976"/>This is the traditional <code>for</code> loop invented by <a data-primary="Ritchie, Dennis" data-type="indexterm" id="idm45290671550760"/>Dennis Ritchie in the early 1970s for the C language:</p>&#13;
&#13;
<pre data-code-language="c" data-type="programlisting"><code class="k">for</code> <code class="p">(</code><code class="n">init</code><code class="p">;</code> <code class="n">test</code><code class="p">;</code> <code class="n">change</code><code class="p">)</code> <code class="p">{</code>&#13;
	<code class="c1">// do something</code>&#13;
<code class="p">}</code></pre>&#13;
&#13;
<p>Its most common form is with an <code>int</code> “index variable” or “loop variable”:</p>&#13;
&#13;
<pre data-code-language="c" data-type="programlisting"><code class="n">MyDataType</code><code class="p">[]</code> <code class="n">data</code> <code class="o">=</code> <code class="p">...</code>&#13;
<code class="k">for</code> <code class="p">(</code><code class="kt">int</code> <code class="n">i</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code> <code class="n">i</code> <code class="o">&lt;</code> <code class="n">data</code><code class="p">.</code><code class="n">length</code><code class="p">;</code> <code class="n">i</code><code class="o">++</code><code class="p">)</code>&#13;
	<code class="n">MyDataType</code> <code class="n">d</code> <code class="o">=</code> <code class="n">data</code><code class="p">[</code><code class="n">i</code><code class="p">];</code>&#13;
	<code class="c1">// do something with it</code>&#13;
<code class="p">}</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="while loop" data-type="sect3"><div class="sect3" id="javacook-structure-iterate.whileloop">&#13;
<h3>while loop</h3>&#13;
&#13;
<p><a data-primary="while loop" data-type="indexterm" id="idm45290671404696"/>A <code>while</code> loop executes its loop body as long as (while) the test condition is true.&#13;
It’s commonly used in conjunction with an <code>Enumeration</code> or <code>Iterator</code>, like this:</p>&#13;
&#13;
<pre data-type="programlisting">Iterator&lt;MyData&gt; iterator = ...&#13;
while (iterator.hasNext()) {&#13;
	MyData md = iterator.next();&#13;
	//&#13;
}</pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Enumeration" data-type="sect3"><div class="sect3" id="javacook-structure-iterate.Enumeration">&#13;
<h3>Enumeration</h3>&#13;
&#13;
<p><a data-primary="enumerations" data-type="indexterm" id="idm45290671399944"/>An <code>Enumeration</code> is like an <code>Iterator</code> (shown earlier),&#13;
but it lacks the <a data-primary="remove() method" data-type="indexterm" id="idm45290671398024"/><code>remove()</code> method,&#13;
and the control methods have longer names—for example, <a data-primary="hasMoreElements() method" data-type="indexterm" id="idm45290671396936"/><a data-primary="nextElement() method" data-type="indexterm" id="idm45290671396264"/><code>hasMore​Ele⁠ments()</code> and <code>nextElement()</code>.&#13;
For new code, there is little to recommend implementing <code>Enumeration</code>.<a data-primary="" data-startref="ds_io" data-type="indexterm" id="idm45290671394344"/><a data-primary="" data-startref="it_a" data-type="indexterm" id="idm45290671393336"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="7.7 Eschewing Duplicates with a Set" data-type="sect1"><div class="sect1" id="javacook-structure-sets">&#13;
<h1>7.7 Eschewing Duplicates with a Set</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-structure-sets.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="sets" data-type="indexterm" id="idm45290671389528"/><a data-primary="data structures" data-secondary="Set inteface" data-type="indexterm" id="idm45290671388824"/>You want a structure that will avoid storing duplicates.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-structure-sets.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use a <code>Set</code> implementation instead of a <code>List</code> (e.g., <code>Set&lt;String&gt; myNames = new HashSet&lt;&gt;()</code>).</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-structure-sets.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>The <code>Set</code> interface is similar to the <code>List</code> interface,<sup><a data-type="noteref" href="ch07.html#idm45290671381032" id="idm45290671381032-marker">2</a></sup> with methods like <a data-primary="add() method" data-type="indexterm" id="idm45290671378968"/><a data-primary="remove() method" data-type="indexterm" id="idm45290671378232"/><a data-primary="contains() method" data-type="indexterm" id="idm45290671377560"/><a data-primary="size() method" data-type="indexterm" id="idm45290671376888"/><a data-primary="isEmpty() method" data-type="indexterm" id="idm45290671355400"/><code>add()</code>, <code>remove()</code>, <code>contains()</code>, <code>size()</code>, and <code>isEmpty()</code>. The difference is that it doesn’t preserve order; instead, it enforces uniqueness—if you add the same item (as considered by its <a data-primary="equals() method" data-type="indexterm" id="idm45290671352632"/><code>equals()</code> method) twice or more, it will only be present once in the set. For this reason, the index-based methods such as <a data-primary="add() method" data-type="indexterm" id="idm45290671351416"/><code>add(int, Object)</code> and <a data-primary="get() method" data-type="indexterm" id="idm45290671350328"/><code>get(int)</code> are missing from the <code>Set</code> implementation: you might know that you’ve added seven objects but only five of those were unique, so calling <code>get()</code> to retrieve the sixth one would have to throw an <code>ArrayIndexOutOfBoundsException</code>! It’s better not to think of a <code>Set</code> as being indexed.</p>&#13;
<div data-type="warning" epub:type="warning"><h6>Warning</h6>&#13;
<p>As the Java 7 <code>Set</code> document states: “Note: Great care must be exercised if mutable objects are used as set elements. The behavior of a set is not specified if the value of an object is changed in a manner that affects equals comparisons while the object is an element in the set. A special case of this prohibition is that it is not permissible for a set to contain itself as an element.”</p>&#13;
</div>&#13;
&#13;
<p>This code shows a duplicate entry being made to a <code>Set</code>, which will contain only one copy of the string <code>"One"</code>:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting">        <code class="n">Set</code><code class="o">&lt;</code><code class="n">String</code><code class="o">&gt;</code> <code class="n">hashSet</code> <code class="o">=</code> <code class="k">new</code> <code class="n">HashSet</code><code class="o">&lt;&gt;();</code>&#13;
        <code class="n">hashSet</code><code class="o">.</code><code class="na">add</code><code class="o">(</code><code class="s">"One"</code><code class="o">);</code>&#13;
        <code class="n">hashSet</code><code class="o">.</code><code class="na">add</code><code class="o">(</code><code class="s">"Two"</code><code class="o">);</code>&#13;
        <code class="n">hashSet</code><code class="o">.</code><code class="na">add</code><code class="o">(</code><code class="s">"One"</code><code class="o">);</code> <code class="c1">// DUPLICATE</code>&#13;
        <code class="n">hashSet</code><code class="o">.</code><code class="na">add</code><code class="o">(</code><code class="s">"Three"</code><code class="o">);</code>&#13;
        <code class="n">hashSet</code><code class="o">.</code><code class="na">forEach</code><code class="o">(</code><code class="n">s</code> <code class="o">-&gt;</code> <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">s</code><code class="o">));</code></pre>&#13;
&#13;
<p>Not surprisingly, only the three distinct values are printed.</p>&#13;
&#13;
<p>If you need a sorted <code>Set</code>, there is in fact a <code>SortedSet</code> interface, of which the most common&#13;
implementation is a <code>TreeSet</code>; see a <code>TreeSet</code> example in <a data-type="xref" href="#javacook-structure-SECT-9">Recipe 7.12</a>.</p>&#13;
&#13;
<p>As with <code>List</code>s, the <code>Set</code> interface offers the <code>of</code> method as of Java 9:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">Set</code><code class="o">&lt;</code><code class="n">Double</code><code class="o">&gt;</code> <code class="n">nums</code> <code class="o">=</code> <code class="n">Set</code><code class="o">.</code><code class="na">of</code><code class="o">(</code><code class="n">Math</code><code class="o">.</code><code class="na">PI</code><code class="o">,</code> <code class="mi">22</code><code class="n">D</code><code class="o">/</code><code class="mi">7</code><code class="o">,</code> <code class="n">Math</code><code class="o">.</code><code class="na">E</code><code class="o">);</code>&#13;
<code class="n">Set</code><code class="o">&lt;</code><code class="n">String</code><code class="o">&gt;</code> <code class="n">firstNames</code> <code class="o">=</code> <code class="n">Set</code><code class="o">.</code><code class="na">of</code><code class="o">(</code><code class="s">"Robin"</code><code class="o">,</code> <code class="s">"Jaime"</code><code class="o">,</code> <code class="s">"Joey"</code><code class="o">);</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="7.8 Structuring Data in a Linked List" data-type="sect1"><div class="sect1" id="javacook-structure-SECT-5">&#13;
<h1>7.8 Structuring Data in a Linked List</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-structure-SECT-5.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="data structures" data-secondary="linked lists" data-type="indexterm" id="ds_ll"/><a data-primary="linked lists" data-type="indexterm" id="ll_a"/>Your data isn’t suitable for use in an array.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-structure-SECT-5.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use a linked list; Java’s <code>LinkedList</code> class is quite suitable.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-structure-SECT-5.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>Anybody who’s taken Computer Science 101 (or any computer science course) should be&#13;
familiar with data structuring, such as linked lists and binary trees. A linked list is commonly used when you have an&#13;
unpredictably large number of data items, you wish to allocate just the right amount of&#13;
storage, and you want to access them in the same order that you created them.&#13;
<a data-type="xref" href="#javacook-structure-FIG-1">Figure 7-2</a> is a diagram showing the normal arrangement.</p>&#13;
&#13;
<figure><div class="figure" id="javacook-structure-FIG-1">&#13;
<img alt="jcb4 0702" src="assets/jcb4_0702.png"/>&#13;
<h6><span class="label">Figure 7-2. </span>Linked list structure</h6>&#13;
</div></figure>&#13;
&#13;
<p>Of course, the Collections API provides a <code>LinkedList</code> class; here is a simple program that uses it:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">LinkedListDemo</code> <code class="o">{</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">argv</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Here is a demo of Java's LinkedList class"</code><code class="o">);</code>&#13;
        <code class="n">LinkedList</code><code class="o">&lt;</code><code class="n">String</code><code class="o">&gt;</code> <code class="n">l</code> <code class="o">=</code> <code class="k">new</code> <code class="n">LinkedList</code><code class="o">&lt;&gt;();</code>&#13;
        <code class="n">l</code><code class="o">.</code><code class="na">add</code><code class="o">(</code><code class="k">new</code> <code class="n">Object</code><code class="o">().</code><code class="na">toString</code><code class="o">());</code>&#13;
        <code class="n">l</code><code class="o">.</code><code class="na">add</code><code class="o">(</code><code class="s">"Hello"</code><code class="o">);</code>&#13;
        <code class="n">l</code><code class="o">.</code><code class="na">add</code><code class="o">(</code><code class="s">"end of the list"</code><code class="o">);</code>&#13;
&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Here is a list of all the elements"</code><code class="o">);</code>&#13;
        <code class="n">l</code><code class="o">.</code><code class="na">forEach</code><code class="o">(</code><code class="n">o</code> <code class="o">-&gt;</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Next element: "</code> <code class="o">+</code> <code class="n">o</code><code class="o">));</code>&#13;
&#13;
        <code class="k">if</code> <code class="o">(</code><code class="n">l</code><code class="o">.</code><code class="na">indexOf</code><code class="o">(</code><code class="s">"Hello"</code><code class="o">)</code> <code class="o">&lt;</code> <code class="mi">0</code><code class="o">)</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">err</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Lookup does not work"</code><code class="o">);</code>&#13;
        <code class="k">else</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">err</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Lookup works"</code><code class="o">);</code>&#13;
&#13;
        <code class="c1">// Now, for added fun, let's walk the linked list backwards.</code>&#13;
        <code class="n">ListIterator</code><code class="o">&lt;</code><code class="n">String</code><code class="o">&gt;</code> <code class="n">li</code> <code class="o">=</code> <code class="n">l</code><code class="o">.</code><code class="na">listIterator</code><code class="o">();</code>&#13;
        <code class="k">while</code> <code class="o">(</code><code class="n">li</code><code class="o">.</code><code class="na">hasPrevious</code><code class="o">())</code> <code class="o">{</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Back to: "</code> <code class="o">+</code> <code class="n">li</code><code class="o">.</code><code class="na">previous</code><code class="o">());</code>&#13;
        <code class="o">}</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p>The <code>ListIterator</code> used here is a subinterface of <code>Iterator</code>, which was discussed in&#13;
<a data-type="xref" href="#javacook-structure-iterate">Recipe 7.6</a>.</p>&#13;
&#13;
<p>Just to show how this kind of list works, here&#13;
is code that shows part of the implemention of a simple linked list:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">LinkList</code><code class="o">&lt;</code><code class="n">T</code><code class="o">&gt;</code> <code class="kd">implements</code> <code class="n">List</code><code class="o">&lt;</code><code class="n">T</code><code class="o">&gt;</code> <code class="o">{</code>&#13;
&#13;
    <code class="cm">/* A TNode stores one node or item in a Linked List */</code>&#13;
    <code class="kd">private</code> <code class="kd">static</code> <code class="kd">class</code> <code class="nc">TNode</code><code class="o">&lt;</code><code class="n">T</code><code class="o">&gt;</code> <code class="o">{</code>&#13;
        <code class="kd">private</code> <code class="n">TNode</code><code class="o">&lt;</code><code class="n">T</code><code class="o">&gt;</code> <code class="n">next</code><code class="o">;</code>&#13;
        <code class="kd">private</code> <code class="n">T</code> <code class="n">data</code><code class="o">;</code>&#13;
        <code class="n">TNode</code><code class="o">(</code><code class="n">T</code> <code class="n">o</code><code class="o">,</code> <code class="n">TNode</code><code class="o">&lt;</code><code class="n">T</code><code class="o">&gt;</code> <code class="n">next</code><code class="o">)</code> <code class="o">{</code>&#13;
            <code class="n">data</code> <code class="o">=</code> <code class="n">o</code><code class="o">;</code>&#13;
            <code class="k">this</code><code class="o">.</code><code class="na">next</code> <code class="o">=</code> <code class="n">next</code><code class="o">;</code>&#13;
        <code class="o">}</code>&#13;
        <code class="nd">@Override</code>&#13;
        <code class="kd">public</code> <code class="n">String</code> <code class="nf">toString</code><code class="o">()</code> <code class="o">{</code>&#13;
            <code class="k">return</code> <code class="n">String</code><code class="o">.</code><code class="na">format</code><code class="o">(</code><code class="s">"TNode: data='%s', next='%d'"</code><code class="o">,</code> <code class="n">data</code><code class="o">,</code>&#13;
                    <code class="n">next</code> <code class="o">==</code> <code class="kc">null</code> <code class="o">?</code> <code class="mi">0</code> <code class="o">:</code> <code class="n">next</code><code class="o">.</code><code class="na">hashCode</code><code class="o">());</code>&#13;
        <code class="o">}</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="kd">private</code> <code class="kt">boolean</code> <code class="n">DIAGNOSTIC</code> <code class="o">=</code> <code class="kc">false</code><code class="o">;</code>&#13;
&#13;
    <code class="cm">/** The root or first TNode in the list; is a dummy pointer,</code>&#13;
<code class="cm">     * so its data will always be null. Simpler this way.</code>&#13;
<code class="cm">     */</code>&#13;
    <code class="kd">protected</code> <code class="n">TNode</code><code class="o">&lt;</code><code class="n">T</code><code class="o">&gt;</code> <code class="n">first</code><code class="o">;</code>&#13;
    <code class="cm">/**</code>&#13;
<code class="cm">     * For certain optimizations: A second ref to the last TNode in the list;</code>&#13;
<code class="cm">     * initially == first; always valid (never null), always has next == null.</code>&#13;
<code class="cm">     */</code>&#13;
    <code class="kd">protected</code> <code class="n">TNode</code><code class="o">&lt;</code><code class="n">T</code><code class="o">&gt;</code> <code class="n">last</code><code class="o">;</code>&#13;
&#13;
    <code class="cm">/** Construct a LinkList: initialize the first and last nodes */</code>&#13;
    <code class="kd">public</code> <code class="nf">LinkList</code><code class="o">()</code> <code class="o">{</code>&#13;
        <code class="n">clear</code><code class="o">();</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/** Construct a LinkList given another Collection.</code>&#13;
<code class="cm">     * This method is recommended by the general contract of List.</code>&#13;
<code class="cm">     */</code>&#13;
    <code class="kd">public</code> <code class="nf">LinkList</code><code class="o">(</code><code class="n">Collection</code><code class="o">&lt;</code><code class="n">T</code><code class="o">&gt;</code> <code class="n">c</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="k">this</code><code class="o">();</code>&#13;
        <code class="n">addAll</code><code class="o">(</code><code class="n">c</code><code class="o">);</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/** Set the List (back) to its initial state.</code>&#13;
<code class="cm">     * Any references held will be discarded.</code>&#13;
<code class="cm">     */</code>&#13;
    <code class="nd">@Override</code>&#13;
    <code class="kd">public</code> <code class="kt">void</code> <code class="nf">clear</code><code class="o">()</code> <code class="o">{</code>&#13;
        <code class="n">first</code> <code class="o">=</code> <code class="k">new</code> <code class="n">TNode</code><code class="o">&lt;</code><code class="n">T</code><code class="o">&gt;(</code><code class="kc">null</code><code class="o">,</code> <code class="kc">null</code><code class="o">);</code>&#13;
        <code class="n">last</code> <code class="o">=</code> <code class="n">first</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/** Add one object to the end of the list. Update the "next"</code>&#13;
<code class="cm">     * reference in the previous end, to refer to the new node.</code>&#13;
<code class="cm">     * Update "last" to refer to the new node.</code>&#13;
<code class="cm">     */</code>&#13;
    <code class="nd">@Override</code>&#13;
    <code class="kd">public</code> <code class="kt">boolean</code> <code class="nf">add</code><code class="o">(</code><code class="n">T</code> <code class="n">o</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">last</code><code class="o">.</code><code class="na">next</code> <code class="o">=</code> <code class="k">new</code> <code class="n">TNode</code><code class="o">&lt;</code><code class="n">T</code><code class="o">&gt;(</code><code class="n">o</code><code class="o">,</code> <code class="kc">null</code><code class="o">);</code>&#13;
        <code class="n">last</code> <code class="o">=</code> <code class="n">last</code><code class="o">.</code><code class="na">next</code><code class="o">;</code>&#13;
        <code class="k">return</code> <code class="kc">true</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="nd">@Override</code>&#13;
    <code class="kd">public</code> <code class="kt">void</code> <code class="nf">add</code><code class="o">(</code><code class="kt">int</code> <code class="n">where</code><code class="o">,</code> <code class="n">T</code> <code class="n">o</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">TNode</code><code class="o">&lt;</code><code class="n">T</code><code class="o">&gt;</code> <code class="n">t</code> <code class="o">=</code> <code class="n">first</code><code class="o">;</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">i</code><code class="o">=</code><code class="mi">0</code><code class="o">;</code> <code class="n">i</code><code class="o">&lt;=</code><code class="n">where</code><code class="o">;</code> <code class="n">i</code><code class="o">++)</code> <code class="o">{</code>&#13;
            <code class="n">t</code> <code class="o">=</code> <code class="n">t</code><code class="o">.</code><code class="na">next</code><code class="o">;</code>&#13;
            <code class="k">if</code> <code class="o">(</code><code class="n">t</code> <code class="o">==</code> <code class="kc">null</code><code class="o">)</code> <code class="o">{</code>&#13;
                <code class="k">throw</code> <code class="k">new</code> <code class="nf">IndexOutOfBoundsException</code><code class="o">(</code>&#13;
                    <code class="s">"'add(n,T) went off end of list"</code><code class="o">);</code>&#13;
            <code class="o">}</code>&#13;
            <code class="k">if</code> <code class="o">(</code><code class="n">DIAGNOSTIC</code><code class="o">)</code> <code class="o">{</code>&#13;
                <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">printf</code><code class="o">(</code><code class="s">"in add(int,T): i = %d, t = %s%n"</code><code class="o">,</code> <code class="n">i</code><code class="o">,</code> <code class="n">t</code><code class="o">);</code>&#13;
            <code class="o">}</code>&#13;
        <code class="o">}</code>&#13;
        <code class="k">if</code> <code class="o">(</code><code class="n">DIAGNOSTIC</code><code class="o">)</code> <code class="o">{</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">printf</code><code class="o">(</code><code class="s">"in add(int,T): to insert before %s\n"</code><code class="o">,</code> <code class="n">t</code><code class="o">);</code>&#13;
        <code class="o">}</code>&#13;
        <code class="kd">final</code> <code class="n">TNode</code><code class="o">&lt;</code><code class="n">T</code><code class="o">&gt;</code> <code class="n">nn</code> <code class="o">=</code> <code class="k">new</code> <code class="n">TNode</code><code class="o">&lt;&gt;(</code><code class="n">o</code><code class="o">,</code> <code class="n">t</code><code class="o">.</code><code class="na">next</code><code class="o">);</code>&#13;
        <code class="n">t</code><code class="o">.</code><code class="na">next</code> <code class="o">=</code> <code class="n">nn</code><code class="o">;</code>&#13;
        <code class="k">if</code> <code class="o">(</code><code class="n">DIAGNOSTIC</code><code class="o">)</code> <code class="o">{</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">printf</code><code class="o">(</code><code class="s">"add(%d,%s)\n"</code><code class="o">,</code> <code class="n">where</code><code class="o">,</code> <code class="n">o</code><code class="o">);</code>&#13;
            <code class="n">dump</code><code class="o">(</code><code class="s">"add(int,T)"</code><code class="o">);</code>&#13;
        <code class="o">}</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="nd">@Override</code>&#13;
    <code class="kd">public</code> <code class="kt">boolean</code> <code class="nf">addAll</code><code class="o">(</code><code class="n">Collection</code><code class="o">&lt;?</code> <code class="kd">extends</code> <code class="n">T</code><code class="o">&gt;</code> <code class="n">c</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">c</code><code class="o">.</code><code class="na">forEach</code><code class="o">(</code><code class="n">o</code> <code class="o">-&gt;</code> <code class="n">add</code><code class="o">((</code><code class="n">T</code><code class="o">)</code> <code class="n">o</code><code class="o">));</code>&#13;
        <code class="k">return</code> <code class="kc">false</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="nd">@Override</code>&#13;
    <code class="kd">public</code> <code class="kt">boolean</code> <code class="nf">addAll</code><code class="o">(</code><code class="kt">int</code> <code class="n">i</code><code class="o">,</code> <code class="n">Collection</code><code class="o">&lt;?</code> <code class="kd">extends</code> <code class="n">T</code><code class="o">&gt;</code> <code class="n">c</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">AtomicInteger</code> <code class="n">j</code> <code class="o">=</code> <code class="k">new</code> <code class="n">AtomicInteger</code><code class="o">(</code><code class="n">i</code><code class="o">);</code>&#13;
        <code class="n">c</code><code class="o">.</code><code class="na">forEach</code><code class="o">(</code><code class="n">o</code> <code class="o">-&gt;</code> <code class="o">{</code> <code class="n">add</code><code class="o">(</code><code class="n">j</code><code class="o">.</code><code class="na">getAndIncrement</code><code class="o">(),</code> <code class="n">o</code><code class="o">);</code> <code class="o">});</code>&#13;
        <code class="k">return</code> <code class="kc">true</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="nd">@Override</code>&#13;
    <code class="kd">public</code> <code class="kt">boolean</code> <code class="nf">contains</code><code class="o">(</code><code class="n">Object</code> <code class="n">o</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">TNode</code><code class="o">&lt;</code><code class="n">T</code><code class="o">&gt;</code> <code class="n">t</code> <code class="o">=</code> <code class="n">first</code><code class="o">;</code>&#13;
        <code class="k">while</code> <code class="o">((</code><code class="n">t</code> <code class="o">=</code> <code class="n">t</code><code class="o">.</code><code class="na">next</code><code class="o">)</code> <code class="o">!=</code> <code class="kc">null</code><code class="o">)</code> <code class="o">{</code>&#13;
            <code class="k">if</code> <code class="o">(</code><code class="n">t</code><code class="o">.</code><code class="na">data</code><code class="o">.</code><code class="na">equals</code><code class="o">(</code><code class="n">o</code><code class="o">))</code> <code class="o">{</code>&#13;
                <code class="k">return</code> <code class="kc">true</code><code class="o">;</code>&#13;
            <code class="o">}</code>&#13;
        <code class="o">}</code>&#13;
        <code class="k">return</code> <code class="kc">false</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="nd">@Override</code>&#13;
    <code class="kd">public</code> <code class="n">T</code> <code class="nf">get</code><code class="o">(</code><code class="kt">int</code> <code class="n">where</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">TNode</code><code class="o">&lt;</code><code class="n">T</code><code class="o">&gt;</code> <code class="n">t</code> <code class="o">=</code> <code class="n">first</code><code class="o">;</code>&#13;
        <code class="kt">int</code> <code class="n">i</code><code class="o">=</code><code class="mi">0</code><code class="o">;</code>&#13;
        <code class="c1">// If we get to the end of list before 'where', error out</code>&#13;
        <code class="k">while</code> <code class="o">(</code><code class="n">i</code><code class="o">++&lt;=</code><code class="n">where</code><code class="o">)</code> <code class="o">{</code>&#13;
            <code class="k">if</code> <code class="o">(</code><code class="n">t</code><code class="o">.</code><code class="na">next</code> <code class="o">==</code> <code class="kc">null</code><code class="o">)</code> <code class="o">{</code>&#13;
                <code class="k">throw</code> <code class="k">new</code> <code class="nf">IndexOutOfBoundsException</code><code class="o">();</code>&#13;
            <code class="o">}</code>&#13;
            <code class="n">t</code> <code class="o">=</code> <code class="n">t</code><code class="o">.</code><code class="na">next</code><code class="o">;</code>&#13;
        <code class="o">}</code>&#13;
        <code class="k">return</code> <code class="n">t</code><code class="o">.</code><code class="na">data</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="nd">@Override</code>&#13;
    <code class="kd">public</code> <code class="kt">boolean</code> <code class="nf">isEmpty</code><code class="o">()</code> <code class="o">{</code>&#13;
        <code class="k">return</code> <code class="n">first</code> <code class="o">==</code> <code class="n">last</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="kd">public</code> <code class="n">Iterator</code><code class="o">&lt;</code><code class="n">T</code><code class="o">&gt;</code> <code class="nf">iterator</code><code class="o">()</code> <code class="o">{</code>&#13;
        <code class="k">return</code> <code class="k">new</code> <code class="n">Iterator</code><code class="o">&lt;</code><code class="n">T</code><code class="o">&gt;()</code> <code class="o">{</code>&#13;
            <code class="kd">final</code> <code class="kt">int</code> <code class="n">size</code> <code class="o">=</code> <code class="n">size</code><code class="o">();</code>&#13;
            <code class="kt">int</code> <code class="n">n</code> <code class="o">=</code> <code class="mi">0</code><code class="o">;</code>&#13;
            <code class="n">TNode</code><code class="o">&lt;</code><code class="n">T</code><code class="o">&gt;</code> <code class="n">t</code> <code class="o">=</code> <code class="n">first</code><code class="o">;</code>&#13;
            <code class="cm">/**</code>&#13;
<code class="cm">             * Two cases in which next == null:</code>&#13;
<code class="cm">             * 1) The list is empty, we are at first</code>&#13;
<code class="cm">             * 2) The list is not empty, we are at last.</code>&#13;
<code class="cm">             */</code>&#13;
            <code class="kd">public</code> <code class="kt">boolean</code> <code class="nf">hasNext</code><code class="o">()</code> <code class="o">{</code>&#13;
                <code class="k">return</code> <code class="n">n</code> <code class="o">&lt;</code> <code class="n">size</code><code class="o">;</code>&#13;
            <code class="o">}</code>&#13;
&#13;
            <code class="kd">public</code> <code class="n">T</code> <code class="nf">next</code><code class="o">()</code> <code class="o">{</code>&#13;
                <code class="k">if</code> <code class="o">(</code><code class="n">t</code> <code class="o">==</code> <code class="n">first</code><code class="o">)</code> <code class="o">{</code>&#13;
                    <code class="n">t</code> <code class="o">=</code> <code class="n">t</code><code class="o">.</code><code class="na">next</code><code class="o">;</code>&#13;
                <code class="o">}</code>&#13;
                <code class="n">TNode</code><code class="o">&lt;</code><code class="n">T</code><code class="o">&gt;</code> <code class="n">result</code> <code class="o">=</code> <code class="n">t</code><code class="o">;</code>&#13;
                <code class="n">t</code> <code class="o">=</code> <code class="n">t</code><code class="o">.</code><code class="na">next</code><code class="o">;</code>&#13;
                <code class="o">++</code><code class="n">n</code><code class="o">;</code>&#13;
                <code class="k">return</code> <code class="n">result</code><code class="o">.</code><code class="na">data</code><code class="o">;</code>&#13;
            <code class="o">}</code>&#13;
            <code class="kd">public</code> <code class="kt">void</code> <code class="nf">remove</code><code class="o">()</code> <code class="o">{</code>&#13;
                <code class="k">throw</code> <code class="k">new</code> <code class="nf">UnsupportedOperationException</code><code class="o">(</code><code class="s">"remove"</code><code class="o">);</code>&#13;
            <code class="o">}</code>&#13;
        <code class="o">};</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="nd">@Override</code>&#13;
    <code class="kd">public</code> <code class="kt">boolean</code> <code class="nf">remove</code><code class="o">(</code><code class="n">Object</code> <code class="n">o</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">TNode</code><code class="o">&lt;</code><code class="n">T</code><code class="o">&gt;</code> <code class="n">p</code> <code class="o">=</code> <code class="n">first</code><code class="o">,</code> <code class="n">prev</code> <code class="o">=</code> <code class="kc">null</code><code class="o">;</code>&#13;
        <code class="k">while</code> <code class="o">(</code><code class="n">p</code> <code class="o">!=</code> <code class="kc">null</code><code class="o">)</code> <code class="o">{</code>&#13;
            <code class="k">if</code> <code class="o">(</code><code class="n">p</code><code class="o">.</code><code class="na">data</code> <code class="o">==</code> <code class="n">o</code><code class="o">)</code> <code class="o">{</code>&#13;
                <code class="n">prev</code><code class="o">.</code><code class="na">next</code> <code class="o">=</code> <code class="n">p</code><code class="o">.</code><code class="na">next</code><code class="o">;</code>&#13;
                <code class="k">return</code> <code class="kc">true</code><code class="o">;</code>&#13;
            <code class="o">}</code>&#13;
            <code class="n">prev</code> <code class="o">=</code> <code class="n">p</code><code class="o">;</code> <code class="n">p</code> <code class="o">=</code> <code class="n">p</code><code class="o">.</code><code class="na">next</code><code class="o">;</code>&#13;
        <code class="o">}</code>&#13;
        <code class="k">return</code> <code class="kc">false</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="nd">@Override</code>&#13;
    <code class="kd">public</code> <code class="n">T</code> <code class="nf">set</code><code class="o">(</code><code class="kt">int</code> <code class="n">i</code><code class="o">,</code> <code class="n">T</code> <code class="n">o</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">TNode</code><code class="o">&lt;</code><code class="n">T</code><code class="o">&gt;</code> <code class="n">tmp</code> <code class="o">=</code> <code class="n">find</code><code class="o">(</code><code class="n">i</code><code class="o">);</code>&#13;
        <code class="n">tmp</code><code class="o">.</code><code class="na">data</code> <code class="o">=</code> <code class="n">o</code><code class="o">;</code>&#13;
        <code class="k">return</code> <code class="n">o</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="nd">@Override</code>&#13;
    <code class="kd">public</code> <code class="kt">int</code> <code class="nf">size</code><code class="o">()</code> <code class="o">{</code>&#13;
        <code class="n">TNode</code><code class="o">&lt;</code><code class="n">T</code><code class="o">&gt;</code> <code class="n">t</code> <code class="o">=</code> <code class="n">first</code><code class="o">;</code>&#13;
        <code class="kt">int</code> <code class="n">i</code><code class="o">;</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="n">i</code><code class="o">=</code><code class="mi">0</code><code class="o">;</code> <code class="o">;</code> <code class="n">i</code><code class="o">++)</code> <code class="o">{</code>&#13;
            <code class="k">if</code> <code class="o">(</code><code class="n">t</code> <code class="o">==</code> <code class="kc">null</code><code class="o">)</code>&#13;
                <code class="k">break</code><code class="o">;</code>&#13;
            <code class="n">t</code> <code class="o">=</code> <code class="n">t</code><code class="o">.</code><code class="na">next</code><code class="o">;</code>&#13;
        <code class="o">}</code>&#13;
        <code class="k">return</code> <code class="n">i</code> <code class="o">-</code> <code class="mi">1</code><code class="o">;</code>    <code class="c1">// subtract one for mandatory head node</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="nd">@SuppressWarnings</code><code class="o">(</code><code class="s">"unchecked"</code><code class="o">)</code>&#13;
    <code class="kd">public</code> <code class="n">T</code><code class="o">[]</code> <code class="nf">toArray</code><code class="o">(</code><code class="n">Object</code><code class="o">[]</code> <code class="n">data</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="c1">// First is an empty anchor, start at its next</code>&#13;
        <code class="n">TNode</code><code class="o">&lt;</code><code class="n">T</code><code class="o">&gt;</code> <code class="n">p</code> <code class="o">=</code> <code class="n">first</code><code class="o">.</code><code class="na">next</code><code class="o">;</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">i</code> <code class="o">=</code> <code class="mi">0</code><code class="o">;</code> <code class="n">p</code> <code class="o">!=</code> <code class="kc">null</code> <code class="o">&amp;&amp;</code> <code class="n">i</code> <code class="o">&lt;</code> <code class="n">data</code><code class="o">.</code><code class="na">length</code><code class="o">;</code> <code class="n">i</code><code class="o">++)</code> <code class="o">{</code>&#13;
            <code class="n">data</code><code class="o">[</code><code class="n">i</code><code class="o">]</code> <code class="o">=</code> <code class="n">p</code><code class="o">.</code><code class="na">data</code><code class="o">;</code>&#13;
            <code class="n">p</code> <code class="o">=</code> <code class="n">p</code><code class="o">.</code><code class="na">next</code><code class="o">;</code>&#13;
        <code class="o">}</code>&#13;
        <code class="k">return</code> <code class="o">(</code><code class="n">T</code><code class="o">[])</code> <code class="n">data</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="kd">public</code> <code class="n">Object</code><code class="o">[]</code> <code class="nf">toArray</code><code class="o">()</code> <code class="o">{</code>&#13;
        <code class="n">Object</code><code class="o">[]</code> <code class="n">data</code> <code class="o">=</code> <code class="k">new</code> <code class="n">Object</code><code class="o">[</code><code class="n">size</code><code class="o">()];</code>&#13;
        <code class="k">return</code> <code class="nf">toArray</code><code class="o">(</code><code class="n">data</code><code class="o">);</code>&#13;
    <code class="o">}</code></pre>&#13;
<div data-type="warning" epub:type="warning"><h6>Warning</h6>&#13;
<p>This is just to show how the implementation of a linked list might work.&#13;
Do not use the simple <code>LinkList</code> class shown here; use the real one, <code>java.util.LinkedList</code>,&#13;
shown in action in the first example.<a data-primary="" data-startref="ds_ll" data-type="indexterm" id="idm45290670715432"/><a data-primary="" data-startref="ll_a" data-type="indexterm" id="idm45290670714456"/></p>&#13;
</div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="7.9 Mapping with Hashtable and HashMap" data-type="sect1"><div class="sect1" id="javacook-structure-SECT-6">&#13;
<h1>7.9 Mapping with Hashtable and HashMap</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-structure-SECT-6.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="data structures" data-secondary="HashMap" data-type="indexterm" id="ds_hm"/><a data-primary="data structures" data-secondary="Hashtable" data-type="indexterm" id="ds_ht"/><a data-primary="HashMap" data-type="indexterm" id="hm_a"/><a data-primary="Hashtable" data-type="indexterm" id="ht_a"/>You need a one-way mapping from one data item to another.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-structure-SECT-6.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use a <code>HashMap</code>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-structure-SECT-6.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p><code>HashMap</code> provides a one-way mapping from one set of object references to another. They are completely general purpose. I’ve used them to map from Swing push buttons to the URL that is to be opened when the button is pushed, to map names to addresses, and to implement a simple in-memory cache in a web server. You can map from anything to anything. In the following example, we map from company names to addresses; the addresses here are <code>String</code> objects, but in real life they’d probably be <code>Address</code> objects:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">HashMapDemo</code> <code class="o">{</code>&#13;
&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">argv</code><code class="o">)</code> <code class="o">{</code>&#13;
&#13;
        <code class="c1">// Construct and load the hash. This simulates loading a</code>&#13;
        <code class="c1">// database or reading from a file, or wherever the data is.</code>&#13;
&#13;
        <code class="n">Map</code><code class="o">&lt;</code><code class="n">String</code><code class="o">,</code><code class="n">String</code><code class="o">&gt;</code> <code class="n">map</code> <code class="o">=</code> <code class="k">new</code> <code class="n">HashMap</code><code class="o">&lt;</code><code class="n">String</code><code class="o">,</code><code class="n">String</code><code class="o">&gt;();</code>&#13;
&#13;
        <code class="c1">// The hash maps from company name to address.</code>&#13;
        <code class="c1">// In real life this might map to an Address object...</code>&#13;
        <code class="n">map</code><code class="o">.</code><code class="na">put</code><code class="o">(</code><code class="s">"Adobe"</code><code class="o">,</code> <code class="s">"Mountain View, CA"</code><code class="o">);</code>&#13;
        <code class="n">map</code><code class="o">.</code><code class="na">put</code><code class="o">(</code><code class="s">"IBM"</code><code class="o">,</code> <code class="s">"White Plains, NY"</code><code class="o">);</code>&#13;
        <code class="n">map</code><code class="o">.</code><code class="na">put</code><code class="o">(</code><code class="s">"Learning Tree"</code><code class="o">,</code> <code class="s">"Los Angeles, CA"</code><code class="o">);</code>&#13;
        <code class="n">map</code><code class="o">.</code><code class="na">put</code><code class="o">(</code><code class="s">"Microsoft"</code><code class="o">,</code> <code class="s">"Redmond, WA"</code><code class="o">);</code>&#13;
        <code class="n">map</code><code class="o">.</code><code class="na">put</code><code class="o">(</code><code class="s">"Netscape"</code><code class="o">,</code> <code class="s">"Mountain View, CA"</code><code class="o">);</code>&#13;
        <code class="n">map</code><code class="o">.</code><code class="na">put</code><code class="o">(</code><code class="s">"O'Reilly"</code><code class="o">,</code> <code class="s">"Sebastopol, CA"</code><code class="o">);</code>&#13;
        <code class="n">map</code><code class="o">.</code><code class="na">put</code><code class="o">(</code><code class="s">"Sun"</code><code class="o">,</code> <code class="s">"Mountain View, CA"</code><code class="o">);</code>&#13;
&#13;
        <code class="c1">// Two versions of the "retrieval" phase.</code>&#13;
        <code class="c1">// Version 1: get one pair's value given its key</code>&#13;
        <code class="c1">// (presumably the key would really come from user input):</code>&#13;
        <code class="n">String</code> <code class="n">queryString</code> <code class="o">=</code> <code class="s">"O'Reilly"</code><code class="o">;</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"You asked about "</code> <code class="o">+</code> <code class="n">queryString</code> <code class="o">+</code> <code class="s">"."</code><code class="o">);</code>&#13;
        <code class="n">String</code> <code class="n">resultString</code> <code class="o">=</code> <code class="n">map</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code class="n">queryString</code><code class="o">);</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"They are located in: "</code> <code class="o">+</code> <code class="n">resultString</code><code class="o">);</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">();</code>&#13;
&#13;
        <code class="c1">// Version 2: get ALL the keys and values</code>&#13;
        <code class="c1">// (maybe to print a report, or to save to disk)</code>&#13;
        <code class="k">for</code><code class="o">(</code> <code class="n">String</code> <code class="n">key</code> <code class="o">:</code> <code class="n">map</code><code class="o">.</code><code class="na">keySet</code><code class="o">())</code> <code class="o">{</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Key "</code> <code class="o">+</code> <code class="n">key</code> <code class="o">+</code>&#13;
                <code class="s">"; Value "</code> <code class="o">+</code> <code class="n">map</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code class="n">key</code><code class="o">));</code>&#13;
        <code class="o">}</code>&#13;
&#13;
        <code class="c1">// Version 3: Same but using a Map.Entry lambda</code>&#13;
        <code class="n">map</code><code class="o">.</code><code class="na">entrySet</code><code class="o">().</code><code class="na">forEach</code><code class="o">(</code><code class="n">mE</code> <code class="o">-&gt;</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Key + "</code> <code class="o">+</code> <code class="n">mE</code><code class="o">.</code><code class="na">getKey</code><code class="o">()+</code>&#13;
                <code class="s">"; Value "</code> <code class="o">+</code><code class="n">mE</code><code class="o">.</code><code class="na">getValue</code><code class="o">()));</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p>For this version we used both a <a data-primary="for loop" data-type="indexterm" id="idm45290669916888"/><a data-primary="forEach() method" data-type="indexterm" id="idm45290669916280"/><code>for</code> loop and a <code>forEach()</code> loop; the latter&#13;
uses the return from <a data-primary="entrySet() method" data-type="indexterm" id="idm45290669365448"/><code>entrySet()</code>, a set of <code>Map.Entry</code>, each of which contains one key and one value&#13;
(this may be faster on large maps because it avoids going back into the map to get the value each time&#13;
through the loop).&#13;
If you are modifying the list as you are going through it (e.g., removing elements),&#13;
either inside the loop or in another thread,&#13;
then these forms will fail with a <code>ConcurrentModificationException</code>.&#13;
You then need to use the <code>Iterator</code> explicitly to control the loop:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting">        <code class="c1">// Version 2: get ALL the keys and values</code>&#13;
        <code class="c1">// with concurrent modification</code>&#13;
        <code class="n">Iterator</code><code class="o">&lt;</code><code class="n">String</code><code class="o">&gt;</code> <code class="n">it</code> <code class="o">=</code> <code class="n">map</code><code class="o">.</code><code class="na">keySet</code><code class="o">().</code><code class="na">iterator</code><code class="o">();</code>&#13;
        <code class="k">while</code> <code class="o">(</code><code class="n">it</code><code class="o">.</code><code class="na">hasNext</code><code class="o">())</code> <code class="o">{</code>&#13;
            <code class="n">String</code> <code class="n">key</code> <code class="o">=</code> <code class="n">it</code><code class="o">.</code><code class="na">next</code><code class="o">();</code>&#13;
            <code class="k">if</code> <code class="o">(</code><code class="n">key</code><code class="o">.</code><code class="na">equals</code><code class="o">(</code><code class="s">"Sun"</code><code class="o">)</code> <code class="o">||</code> <code class="n">key</code><code class="o">.</code><code class="na">equals</code><code class="o">(</code><code class="s">"Netscape"</code><code class="o">))</code> <code class="o">{</code>&#13;
                <code class="n">it</code><code class="o">.</code><code class="na">remove</code><code class="o">();</code>&#13;
                <code class="k">continue</code><code class="o">;</code>&#13;
            <code class="o">}</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Company "</code> <code class="o">+</code> <code class="n">key</code> <code class="o">+</code> <code class="s">"; "</code> <code class="o">+</code>&#13;
                <code class="s">"Address "</code> <code class="o">+</code> <code class="n">map</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code class="n">key</code><code class="o">));</code>&#13;
        <code class="o">}</code></pre>&#13;
&#13;
<p>A more functional (see <a data-type="xref" href="ch09.html#javacook-fp">Chapter 9</a>) way of writing the removal, not involving explicit looping, would be this:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting">        <code class="c1">// Alternate to just do the removals, without explicit looping</code>&#13;
        <code class="n">map</code><code class="o">.</code><code class="na">keySet</code><code class="o">().</code><code class="na">removeIf</code><code class="o">(</code><code class="n">key</code> <code class="o">-&gt;</code> <code class="n">Set</code><code class="o">.</code><code class="na">of</code><code class="o">(</code><code class="s">"Netscape"</code><code class="o">,</code> <code class="s">"Sun"</code><code class="o">).</code><code class="na">contains</code><code class="o">(</code><code class="n">key</code><code class="o">));</code>&#13;
        <code class="c1">// or</code>&#13;
        <code class="n">map</code> <code class="o">.</code><code class="na">entrySet</code><code class="o">()</code>&#13;
            <code class="o">.</code><code class="na">removeIf</code><code class="o">(</code><code class="n">entry</code> <code class="o">-&gt;</code> <code class="n">Set</code><code class="o">.</code><code class="na">of</code><code class="o">(</code><code class="s">"Netscape"</code><code class="o">,</code> <code class="s">"Sun"</code><code class="o">)</code>&#13;
            <code class="o">.</code><code class="na">contains</code><code class="o">(</code><code class="n">entry</code><code class="o">.</code><code class="na">getKey</code><code class="o">()));</code>&#13;
        <code class="n">map</code><code class="o">.</code><code class="na">entrySet</code><code class="o">().</code><code class="na">forEach</code><code class="o">(</code><code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">::</code><code class="n">println</code><code class="o">);</code></pre>&#13;
<div data-type="tip"><h6>Tip</h6>&#13;
<p><code>HashMap</code> methods are not synchronized.&#13;
The older and similar <code>Hashtable</code> methods are synchronized, for use with multiple threads.<a data-primary="" data-startref="ds_hm" data-type="indexterm" id="idm45290669712952"/><a data-primary="" data-startref="ds_ht" data-type="indexterm" id="idm45290669712008"/><a data-primary="" data-startref="hm_a" data-type="indexterm" id="idm45290669711064"/><a data-primary="" data-startref="ht_a" data-type="indexterm" id="idm45290669710120"/></p>&#13;
</div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="7.10 Storing Strings in Properties and Preferences" data-type="sect1"><div class="sect1" id="javacook-structure-SECT-7">&#13;
<h1>7.10 Storing Strings in Properties and Preferences</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-structure-SECT-7.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="data structures" data-secondary="storing strings" data-type="indexterm" id="ds_ss"/><a data-primary="preferences, storing strings in" data-type="indexterm" id="pre_ss"/><a data-primary="properties" data-type="indexterm" id="pro_ss"/><a data-primary="strings" data-secondary="storing in properties/preferences" data-type="indexterm" id="str_spp"/>You need to store keys and values that are both strings, possibly with persistence across runs of a program—for example, program customization.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-structure-SECT-7.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use a <code>java.util.prefs.Preferences</code> object or a <code>java.util.Properties</code> object.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-structure-SECT-7.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>Here are three approaches to customization based on the user’s environment. Java offers <code>Preferences</code> and <code>Properties</code> for cross-platform customizations.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Preferences" data-type="sect3"><div class="sect3" id="javacook-structure-SECT-7.3.1">&#13;
<h3>Preferences</h3>&#13;
&#13;
<p>The <code>Preferences</code> class <code>java.util.prefs.Preferences</code> provides an easy-to-use mechanism for storing user customizations in a system-dependent way (which might mean dot files on Unix, a preferences file on the Mac, or the registry on Windows systems). This class provides a hierarchical set of nodes representing a user’s <span class="keep-together">preferences.</span> Data is stored in the system-dependent storage format but can also be exported to or imported from an XML format. Here is a simple demonstration of <code>Preferences</code>:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">PrefsDemo</code> <code class="o">{</code>&#13;
&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">args</code><code class="o">)</code> <code class="kd">throws</code> <code class="n">Exception</code> <code class="o">{</code>&#13;
&#13;
        <code class="c1">// Set up the Preferences for this application, by class.</code>&#13;
        <code class="n">Preferences</code> <code class="n">prefs</code> <code class="o">=</code> <code class="n">Preferences</code><code class="o">.</code><code class="na">userNodeForPackage</code><code class="o">(</code><code class="n">PrefsDemo</code><code class="o">.</code><code class="na">class</code><code class="o">);</code>&#13;
&#13;
        <code class="c1">// Retrieve some preferences previously stored, with defaults in case</code>&#13;
        <code class="c1">// this is the first run.</code>&#13;
        <code class="n">String</code> <code class="n">text</code>    <code class="o">=</code> <code class="n">prefs</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code class="s">"textFontName"</code><code class="o">,</code> <code class="s">"lucida-bright"</code><code class="o">);</code>&#13;
        <code class="n">String</code> <code class="n">display</code> <code class="o">=</code> <code class="n">prefs</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code class="s">"displayFontName"</code><code class="o">,</code> <code class="s">"lucida-blackletter"</code><code class="o">);</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">text</code><code class="o">);</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">display</code><code class="o">);</code>&#13;
&#13;
        <code class="c1">// Assume the user chose new preference values: Store them back.</code>&#13;
        <code class="n">prefs</code><code class="o">.</code><code class="na">put</code><code class="o">(</code><code class="s">"textFontName"</code><code class="o">,</code> <code class="s">"times-roman"</code><code class="o">);</code>&#13;
        <code class="n">prefs</code><code class="o">.</code><code class="na">put</code><code class="o">(</code><code class="s">"displayFontName"</code><code class="o">,</code> <code class="s">"helvetica"</code><code class="o">);</code>&#13;
&#13;
        <code class="c1">// Toss in a couple more values for the curious who want to look</code>&#13;
        <code class="c1">// at how Preferences values are actually stored.</code>&#13;
        <code class="n">Preferences</code> <code class="n">child</code> <code class="o">=</code> <code class="n">prefs</code><code class="o">.</code><code class="na">node</code><code class="o">(</code><code class="s">"a/b"</code><code class="o">);</code>&#13;
        <code class="n">child</code><code class="o">.</code><code class="na">putInt</code><code class="o">(</code><code class="s">"meaning"</code><code class="o">,</code> <code class="mi">42</code><code class="o">);</code>&#13;
        <code class="n">child</code><code class="o">.</code><code class="na">putDouble</code><code class="o">(</code><code class="s">"pi"</code><code class="o">,</code> <code class="n">Math</code><code class="o">.</code><code class="na">PI</code><code class="o">);</code>&#13;
&#13;
        <code class="c1">// And dump the subtree from our first node on down, in XML.</code>&#13;
        <code class="n">prefs</code><code class="o">.</code><code class="na">exportSubtree</code><code class="o">(</code><code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">);</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p>When you run the <code>PrefsDemo</code> program the first time, of course, it doesn’t find any settings, so the calls to <a data-primary="preferences.get() method" data-type="indexterm" id="idm45290669793000"/><code>preferences.get()</code> return the default values:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">$</code> <code class="n">java</code> <code class="o">-</code><code class="n">cp</code> <code class="n">target</code><code class="o">/</code><code class="n">classes</code> <code class="n">structure</code><code class="o">.</code><code class="na">PrefsDemo</code>&#13;
<code class="n">lucida</code><code class="o">-</code><code class="n">bright</code>&#13;
<code class="n">lucida</code><code class="o">-</code><code class="n">blackletter</code>&#13;
<code class="o">&lt;?</code><code class="n">xml</code> <code class="n">version</code><code class="o">=</code><code class="s">"1.0"</code> <code class="n">encoding</code><code class="o">=</code><code class="s">"UTF-8"</code> <code class="n">standalone</code><code class="o">=</code><code class="s">"no"</code><code class="o">?&gt;</code>&#13;
<code class="o">&lt;!</code><code class="n">DOCTYPE</code> <code class="n">preferences</code> <code class="n">SYSTEM</code> <code class="s">"http://java.sun.com/dtd/preferences.dtd"</code><code class="o">&gt;</code>&#13;
<code class="o">&lt;</code><code class="n">preferences</code> <code class="n">EXTERNAL_XML_VERSION</code><code class="o">=</code><code class="s">"1.0"</code><code class="o">&gt;</code>&#13;
  <code class="o">&lt;</code><code class="n">root</code> <code class="n">type</code><code class="o">=</code><code class="s">"user"</code><code class="o">&gt;</code>&#13;
    <code class="o">&lt;</code><code class="n">map</code><code class="o">/&gt;</code>&#13;
    <code class="o">&lt;</code><code class="n">node</code> <code class="n">name</code><code class="o">=</code><code class="s">"structure"</code><code class="o">&gt;</code>&#13;
      <code class="o">&lt;</code><code class="n">map</code><code class="o">&gt;</code>&#13;
        <code class="o">&lt;</code><code class="n">entry</code> <code class="n">key</code><code class="o">=</code><code class="s">"displayFontName"</code> <code class="n">value</code><code class="o">=</code><code class="s">"helvetica"</code><code class="o">/&gt;</code>&#13;
        <code class="o">&lt;</code><code class="n">entry</code> <code class="n">key</code><code class="o">=</code><code class="s">"textFontName"</code> <code class="n">value</code><code class="o">=</code><code class="s">"times-roman"</code><code class="o">/&gt;</code>&#13;
      <code class="o">&lt;/</code><code class="n">map</code><code class="o">&gt;</code>&#13;
      <code class="o">&lt;</code><code class="n">node</code> <code class="n">name</code><code class="o">=</code><code class="s">"a"</code><code class="o">&gt;</code>&#13;
        <code class="o">&lt;</code><code class="n">map</code><code class="o">/&gt;</code>&#13;
        <code class="o">&lt;</code><code class="n">node</code> <code class="n">name</code><code class="o">=</code><code class="s">"b"</code><code class="o">&gt;</code>&#13;
          <code class="o">&lt;</code><code class="n">map</code><code class="o">&gt;</code>&#13;
            <code class="o">&lt;</code><code class="n">entry</code> <code class="n">key</code><code class="o">=</code><code class="s">"meaning"</code> <code class="n">value</code><code class="o">=</code><code class="s">"42"</code><code class="o">/&gt;</code>&#13;
            <code class="o">&lt;</code><code class="n">entry</code> <code class="n">key</code><code class="o">=</code><code class="s">"pi"</code> <code class="n">value</code><code class="o">=</code><code class="s">"3.141592653589793"</code><code class="o">/&gt;</code>&#13;
          <code class="o">&lt;/</code><code class="n">map</code><code class="o">&gt;</code>&#13;
        <code class="o">&lt;/</code><code class="n">node</code><code class="o">&gt;</code>&#13;
      <code class="o">&lt;/</code><code class="n">node</code><code class="o">&gt;</code>&#13;
    <code class="o">&lt;/</code><code class="n">node</code><code class="o">&gt;</code>&#13;
  <code class="o">&lt;/</code><code class="n">root</code><code class="o">&gt;</code>&#13;
<code class="o">&lt;/</code><code class="n">preferences</code><code class="o">&gt;</code></pre>&#13;
&#13;
<p>On subsequent runs, it finds and returns the user-provided settings (I’ve elided the XML output&#13;
from the second run because most of the XML output is the same):</p>&#13;
<pre data-type="programlisting" id="I_7_tt239">&gt;<strong> java structure.PrefsDemo</strong>&#13;
times-roman&#13;
helvetica&#13;
...&#13;
&gt;</pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Properties" data-type="sect3"><div class="sect3" id="javacook-structure-SECT-7.3.2">&#13;
<h3>Properties</h3>&#13;
&#13;
<p>The <a data-primary="Properties class" data-type="indexterm" id="idm45290669791432"/><code>Properties</code> class is similar to a <code>HashMap</code> or <code>Hashtable</code> (it extends the latter) but with methods defined specifically for string storage and retrieval and for loading/saving. <code>Properties</code> objects are used throughout Java, for everything from setting the platform font names to customizing user applications into different <code>Locale</code> settings as part of internationalization and localization. When stored on disk, a <code>Properties</code> object looks just like a series of <code>name=value</code> assignments, with optional comments. Comments are added when you edit a <code>Properties</code> file by hand, ignored when the <code>Properties</code> object reads itself, and lost when you ask the <code>Properties</code> object to save itself to disk. Here is an example of a <code>Properties</code> file that could be used to internationalize the menus in a GUI-based program:</p>&#13;
&#13;
<pre data-type="programlisting"># Default properties for MenuIntl&#13;
program.title=Demonstrate I18N (MenuIntl)&#13;
program.message=Welcome to an English-localized Java Program&#13;
#&#13;
# The File Menu&#13;
#&#13;
file.label=File Menu&#13;
file.new.label=New File&#13;
file.new.key=N&#13;
file.open.label=Open...&#13;
file.open.key=O&#13;
file.save.label=Save&#13;
file.save.key=S&#13;
file.exit.label=Exit&#13;
file.exit.key=Q</pre>&#13;
&#13;
<p>Here is another example, showing some personalization properties:</p>&#13;
&#13;
<pre data-type="programlisting">name=Ian Darwin&#13;
favorite_popsicle=cherry&#13;
favorite_rock group=Fleetwood Mac&#13;
favorite_programming_language=Java&#13;
pencil_color=green</pre>&#13;
&#13;
<p>A <code>Properties</code> object can be loaded from a file. The rules are flexible: either <code>=</code>, :, or spaces can be used after a key name and its values. Spaces after a nonspace character are ignored in the key. A backslash can be used to continue lines or to escape other characters. Comment lines may begin with either <code>#</code> or <code>!</code>. Thus, a <code>Properties</code> file containing the previous items, if prepared by hand, could look like this:</p>&#13;
&#13;
<pre data-type="programlisting"># Here is a list of properties&#13;
! first, my name&#13;
name Ian Darwin&#13;
favorite_popsicle = cherry&#13;
favorite_rock\ group \&#13;
 Fleetwood Mac&#13;
favorite_programming_language=Java&#13;
pencil_color green</pre>&#13;
&#13;
<p>Fortunately, when a <code>Properties</code> object writes itself to a file, it uses the following simple format:</p>&#13;
&#13;
<pre data-type="programlisting">key=value</pre>&#13;
&#13;
<p>Here is an example of a program that creates a <code>Properties</code> object and adds into it the list of companies and their locations from <a data-type="xref" href="#javacook-structure-SECT-6">Recipe 7.9</a>. It then loads additional properties from disk. To simplify the I/O processing, the program assumes that the <code>Properties</code> file to be loaded is contained in the standard input, as would be done using a command-line redirection on either Unix or DOS:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">PropsCompanies</code> <code class="o">{</code>&#13;
&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">argv</code><code class="o">)</code> <code class="kd">throws</code> <code class="n">java</code><code class="o">.</code><code class="na">io</code><code class="o">.</code><code class="na">IOException</code> <code class="o">{</code>&#13;
&#13;
        <code class="n">Properties</code> <code class="n">props</code> <code class="o">=</code> <code class="k">new</code> <code class="n">Properties</code><code class="o">();</code>&#13;
&#13;
        <code class="c1">// Get my data</code>&#13;
        <code class="n">props</code><code class="o">.</code><code class="na">put</code><code class="o">(</code><code class="s">"Adobe"</code><code class="o">,</code> <code class="s">"Mountain View, CA"</code><code class="o">);</code>&#13;
        <code class="n">props</code><code class="o">.</code><code class="na">put</code><code class="o">(</code><code class="s">"IBM"</code><code class="o">,</code> <code class="s">"White Plains, NY"</code><code class="o">);</code>&#13;
        <code class="n">props</code><code class="o">.</code><code class="na">put</code><code class="o">(</code><code class="s">"Learning Tree"</code><code class="o">,</code> <code class="s">"Los Angeles, CA"</code><code class="o">);</code>&#13;
        <code class="n">props</code><code class="o">.</code><code class="na">put</code><code class="o">(</code><code class="s">"Microsoft"</code><code class="o">,</code> <code class="s">"Redmond, WA"</code><code class="o">);</code>&#13;
        <code class="n">props</code><code class="o">.</code><code class="na">put</code><code class="o">(</code><code class="s">"Netscape"</code><code class="o">,</code> <code class="s">"Mountain View, CA"</code><code class="o">);</code>&#13;
        <code class="n">props</code><code class="o">.</code><code class="na">put</code><code class="o">(</code><code class="s">"O'Reilly"</code><code class="o">,</code> <code class="s">"Sebastopol, CA"</code><code class="o">);</code>&#13;
        <code class="n">props</code><code class="o">.</code><code class="na">put</code><code class="o">(</code><code class="s">"Sun"</code><code class="o">,</code> <code class="s">"Mountain View, CA"</code><code class="o">);</code>&#13;
&#13;
        <code class="c1">// Now load additional properties</code>&#13;
        <code class="n">props</code><code class="o">.</code><code class="na">load</code><code class="o">(</code><code class="n">System</code><code class="o">.</code><code class="na">in</code><code class="o">);</code>&#13;
&#13;
        <code class="c1">// List merged properties, using System.out</code>&#13;
        <code class="n">props</code><code class="o">.</code><code class="na">list</code><code class="o">(</code><code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">);</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p>Running it as</p>&#13;
<pre data-type="programlisting" id="I_7_tt245">&#13;
<strong>java structure.PropsCompanies &lt; PropsDemo.out</strong>&#13;
</pre>&#13;
&#13;
<p>produces the following output in the file <em>PropsDemo.out</em>:</p>&#13;
&#13;
<pre data-type="programlisting">-- listing properties --&#13;
Sony=Japan&#13;
Sun=Mountain View, CA&#13;
IBM=White Plains, NY&#13;
Netscape=Mountain View, CA&#13;
Nippon_Kogaku=Japan&#13;
Acorn=United Kingdom&#13;
Adobe=Mountain View, CA&#13;
Ericsson=Sweden&#13;
O'Reilly &amp; Associates=Sebastopol, CA&#13;
Learning Tree=Los Angeles, CA</pre>&#13;
&#13;
<p>In case you didn’t notice in either the <code>HashMap</code> or the <code>Properties</code> examples, the order in which the outputs appear in these examples is neither sorted nor in the order we put them in. The hashing classes and the <code>Properties</code> subclass make no claim about the order in which objects are retrieved. If you need them sorted, see <a data-type="xref" href="#javacook-structure-SECT-8">Recipe 7.11</a>.</p>&#13;
&#13;
<p>As a convenient shortcut, my <code>FileProperties</code> class includes a constructor that takes a filename:</p>&#13;
&#13;
<pre data-type="programlisting">import com.darwinsys.util.FileProperties;&#13;
...&#13;
Properties p = new FileProperties("PropsDemo.out");</pre>&#13;
&#13;
<p>Note that constructing a <code>FileProperties</code> object causes it to be loaded, and therefore the constructor may throw a checked exception of class <code>IOException</code>.<a data-primary="" data-startref="ds_ss" data-type="indexterm" id="idm45290668782520"/><a data-primary="" data-startref="pre_ss" data-type="indexterm" id="idm45290668781512"/><a data-primary="" data-startref="pro_ss" data-type="indexterm" id="idm45290668780568"/><a data-primary="" data-startref="str_spp" data-type="indexterm" id="idm45290668779624"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="7.11 Sorting a Collection" data-type="sect1"><div class="sect1" id="javacook-structure-SECT-8">&#13;
<h1>7.11 Sorting a Collection</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-structure-SECT-8.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="collections" data-secondary="sorting" data-type="indexterm" id="co_so"/><a data-primary="data structures" data-secondary="sorting collections" data-type="indexterm" id="ds_sc"/><a data-primary="sorting" data-type="indexterm" id="so_co"/>You put your data into a collection in random order or used a <code>Properties</code> object that&#13;
doesn’t preserve the order, and now you want it sorted.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-structure-SECT-8.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use the static method <a data-primary="Arrays.sort() method" data-type="indexterm" id="idm45290668770424"/><a data-primary="Collections.sort() method" data-type="indexterm" id="idm45290668769688"/><code>Arrays.sort()</code> or <code>Collections.sort()</code>, optionally providing a <code>Comparator</code>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-structure-SECT-8.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>If your data is in an array, then you can sort it using the static <a data-primary="sort() method" data-type="indexterm" id="idm45290668765336"/><code>sort()</code> method of the <code class="keep-together">Arrays</code> utility class. If it is in a <code>Collection</code>, you can use the static <code>sort()</code> method of the <code>Collections</code> class. Here is a set of strings being sorted in place in an <code>Array</code>:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">SortArray</code> <code class="o">{</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">unused</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">String</code><code class="o">[]</code> <code class="n">strings</code> <code class="o">=</code> <code class="o">{</code>&#13;
            <code class="s">"painful"</code><code class="o">,</code>&#13;
            <code class="s">"mainly"</code><code class="o">,</code>&#13;
            <code class="s">"gaining"</code><code class="o">,</code>&#13;
            <code class="s">"raindrops"</code>&#13;
        <code class="o">};</code>&#13;
        <code class="n">Arrays</code><code class="o">.</code><code class="na">sort</code><code class="o">(</code><code class="n">strings</code><code class="o">);</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">i</code><code class="o">=</code><code class="mi">0</code><code class="o">;</code> <code class="n">i</code><code class="o">&lt;</code><code class="n">strings</code><code class="o">.</code><code class="na">length</code><code class="o">;</code> <code class="n">i</code><code class="o">++)</code> <code class="o">{</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">strings</code><code class="o">[</code><code class="n">i</code><code class="o">]);</code>&#13;
        <code class="o">}</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p>What if the default sort order isn’t what you want? Well, you can create an object that&#13;
implements the <code>Comparator&lt;T&gt;</code> interface and pass that as the second argument to sort.&#13;
Fortunately, for the most common ordering next to the default, you don’t have to:&#13;
a public constant <code>String.CASE_INSENSITIVE_ORDER</code> can be passed as this second argument. The&#13;
<code>String</code> class defines it as a <code>Comparator&lt;String&gt;</code> that orders <code>String</code> objects as by&#13;
<code>compareToIgnoreCase</code>. But if you need something fancier, you probably need to write a&#13;
<code>Comparator&lt;T&gt;</code>. In some cases you may be able to use the <a data-primary="Comparator.comparing() method" data-type="indexterm" id="idm45290668641832"/><span class="keep-together"><code>Comparator.comparing()</code></span> method&#13;
and other static methods on <code>Comparator</code> to create a custom comparator without having to create a class.&#13;
Suppose that, for some strange reason, you need to sort strings using all&#13;
but the first character of the string. One way to do this would be to write this&#13;
<code>Comparator&lt;String&gt;</code>:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="cm">/** Comparator for comparing strings ignoring first character.</code>&#13;
<code class="cm"> */</code>&#13;
<code class="kd">public</code> <code class="kd">class</code> <code class="nc">SubstringComparator</code> <code class="kd">implements</code> <code class="n">Comparator</code><code class="o">&lt;</code><code class="n">String</code><code class="o">&gt;</code> <code class="o">{</code>&#13;
    <code class="nd">@Override</code>&#13;
    <code class="kd">public</code> <code class="kt">int</code> <code class="nf">compare</code><code class="o">(</code><code class="n">String</code> <code class="n">s1</code><code class="o">,</code> <code class="n">String</code> <code class="n">s2</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">s1</code> <code class="o">=</code> <code class="n">s1</code><code class="o">.</code><code class="na">substring</code><code class="o">(</code><code class="mi">1</code><code class="o">);</code>&#13;
        <code class="n">s2</code> <code class="o">=</code> <code class="n">s2</code><code class="o">.</code><code class="na">substring</code><code class="o">(</code><code class="mi">1</code><code class="o">);</code>&#13;
        <code class="k">return</code> <code class="n">s1</code><code class="o">.</code><code class="na">compareTo</code><code class="o">(</code><code class="n">s2</code><code class="o">);</code>&#13;
        <code class="c1">// or, more concisely:</code>&#13;
        <code class="c1">// return s1.substring(1).compareTo(s2.substring(1));</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p>Using it is just a matter of passing it as the <code>Comparator</code> argument to the correct form of <a data-primary="sort() method" data-type="indexterm" id="idm45290668586488"/><code>sort()</code>, as shown here:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">SubstringComparatorDemo</code> <code class="o">{</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">unused</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">String</code><code class="o">[]</code> <code class="n">strings</code> <code class="o">=</code> <code class="o">{</code>&#13;
            <code class="s">"painful"</code><code class="o">,</code>&#13;
            <code class="s">"mainly"</code><code class="o">,</code>&#13;
            <code class="s">"gaining"</code><code class="o">,</code>&#13;
            <code class="s">"raindrops"</code>&#13;
        <code class="o">};</code>&#13;
        <code class="n">Arrays</code><code class="o">.</code><code class="na">sort</code><code class="o">(</code><code class="n">strings</code><code class="o">);</code>&#13;
        <code class="n">dump</code><code class="o">(</code><code class="n">strings</code><code class="o">,</code> <code class="s">"Using Default Sort"</code><code class="o">);</code>&#13;
        <code class="n">Arrays</code><code class="o">.</code><code class="na">sort</code><code class="o">(</code><code class="n">strings</code><code class="o">,</code> <code class="k">new</code> <code class="n">SubstringComparator</code><code class="o">());</code>&#13;
        <code class="n">dump</code><code class="o">(</code><code class="n">strings</code><code class="o">,</code> <code class="s">"Using SubstringComparator"</code><code class="o">);</code>&#13;
&#13;
        <code class="c1">// tag::functional[]</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Functional approach:"</code><code class="o">);</code>&#13;
        <code class="n">Arrays</code><code class="o">.</code><code class="na">stream</code><code class="o">(</code><code class="n">strings</code><code class="o">)</code>&#13;
            <code class="o">.</code><code class="na">sorted</code><code class="o">(</code><code class="n">Comparator</code><code class="o">.</code><code class="na">comparing</code><code class="o">(</code><code class="n">s</code><code class="o">-&gt;</code><code class="n">s</code><code class="o">.</code><code class="na">substring</code><code class="o">(</code><code class="mi">1</code><code class="o">)))</code>&#13;
            <code class="o">.</code><code class="na">forEach</code><code class="o">(</code><code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">::</code><code class="n">println</code><code class="o">);</code>&#13;
        <code class="c1">// end::functional[]</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="kd">static</code> <code class="kt">void</code> <code class="nf">dump</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">args</code><code class="o">,</code> <code class="n">String</code> <code class="n">title</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">title</code><code class="o">);</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="n">String</code> <code class="n">s</code> <code class="o">:</code> <code class="n">args</code><code class="o">)</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">s</code><code class="o">);</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p>Again, a more functional (see <a data-type="xref" href="ch09.html#javacook-fp">Chapter 9</a>) way of writing this might be the following:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting">        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Functional approach:"</code><code class="o">);</code>&#13;
        <code class="n">Arrays</code><code class="o">.</code><code class="na">stream</code><code class="o">(</code><code class="n">strings</code><code class="o">)</code>&#13;
            <code class="o">.</code><code class="na">sorted</code><code class="o">(</code><code class="n">Comparator</code><code class="o">.</code><code class="na">comparing</code><code class="o">(</code><code class="n">s</code><code class="o">-&gt;</code><code class="n">s</code><code class="o">.</code><code class="na">substring</code><code class="o">(</code><code class="mi">1</code><code class="o">)))</code>&#13;
            <code class="o">.</code><code class="na">forEach</code><code class="o">(</code><code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">::</code><code class="n">println</code><code class="o">);</code></pre>&#13;
&#13;
<p>Here is the output of running it:</p>&#13;
<pre data-type="programlisting" id="I_7_tt251">&#13;
$ <strong>java structure.SubstrCompDemo</strong>&#13;
Using Default Sort&#13;
gaining&#13;
mainly&#13;
painful&#13;
raindrops&#13;
Using SubstringComparator&#13;
raindrops&#13;
painful&#13;
gaining&#13;
mainly</pre>&#13;
&#13;
<p>And this is all as it should be.</p>&#13;
&#13;
<p>On the other hand, you may be writing a class and want to build in&#13;
the comparison functionality so that you don’t always have to&#13;
remember to pass the <code>Comparator</code> with it. In this case, you can&#13;
directly implement the <code>java.lang.Comparable</code> interface, as is done by many classes in the&#13;
standard API. These include&#13;
<code>String</code> class; the wrapper classes <code>Byte</code>, <code>Character</code>, <code>Double</code>,&#13;
<code>Float</code>, <code>Long</code>, <code>Short</code>, and <code>Integer</code>; <code>BigInteger</code> and <code>BigDecimal</code>&#13;
from <code>java.math</code>; most objects in the date/time API in <code>java.time</code>; and&#13;
<code>java.text.CollationKey</code>.&#13;
Arrays or <code>Collections</code> of these types can be sorted without providing a&#13;
<code>Comparator</code>. Classes that implement <code>Comparable</code> are said to have&#13;
a natural ordering. The documentation strongly recommends that a&#13;
class’s natural ordering be consistent with its <a data-primary="equals() method" data-type="indexterm" id="idm45290668233016"/><code>equals()</code> method. It is consistent with <code>equals()</code> if <span class="keep-together">and only</span> if&#13;
<code>e1.compareTo((Object)e2)</code> has the same Boolean value as&#13;
<code>e1.equals((Object)e2)</code> for every instance <code>e1</code> and <code>e2</code> of the&#13;
given class. This means that if you implement <code>Comparable</code>, you&#13;
should also implement <code>equals()</code>, and the logic of <code>equals()</code>&#13;
should be consistent with the logic of the <code>compareTo()</code> method.&#13;
If you implement <code>equals()</code>, incidentally, you also should implement <code>hashCode()</code> (as discussed in <a data-type="xref" href="ch08.html#javacook-oo-SECT-2.x.1">“hashCode() and equals()”</a>).&#13;
Here, for example, is part of the appointment class <code>Appt</code> from a&#13;
hypothetical scheduling program.&#13;
The class has a <code>LocalDate</code> date variable and a <code>LocalTime</code> time variable;&#13;
the latter may be null (e.g., an all-day appointment or a to-do item);&#13;
this complicates the <code>compareTo()</code> function a little.</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="c1">// public class Appt implements Comparable {</code>&#13;
    <code class="c1">// Much code and variables omitted - see online version</code>&#13;
    <code class="c1">//-----------------------------------------------------------------</code>&#13;
    <code class="c1">//    METHODS - COMPARISON</code>&#13;
    <code class="c1">//-----------------------------------------------------------------</code>&#13;
    <code class="cm">/** compareTo method, from Comparable interface.</code>&#13;
<code class="cm">     * Compare this Appointment against another, for purposes of sorting.</code>&#13;
<code class="cm">     * &lt;P&gt;Only date and time, then text, participate, not repetition!</code>&#13;
<code class="cm">     * (Repetition has to do with recurring events, e.g.,</code>&#13;
<code class="cm">     *  "Meeting every Tuesday at 9").</code>&#13;
<code class="cm">     * This methods is consistent with equals().</code>&#13;
<code class="cm">     * @return -1 if this&lt;a2, +1 if this&gt;a2, else 0.</code>&#13;
<code class="cm">     */</code>&#13;
    <code class="nd">@Override</code>&#13;
    <code class="kd">public</code> <code class="kt">int</code> <code class="nf">compareTo</code><code class="o">(</code><code class="n">Appt</code> <code class="n">a2</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="c1">// If dates not same, trigger on their comparison</code>&#13;
        <code class="kt">int</code> <code class="n">dateComp</code> <code class="o">=</code> <code class="n">date</code><code class="o">.</code><code class="na">compareTo</code><code class="o">(</code><code class="n">a2</code><code class="o">.</code><code class="na">date</code><code class="o">);</code>&#13;
        <code class="k">if</code> <code class="o">(</code><code class="n">dateComp</code> <code class="o">!=</code> <code class="mi">0</code><code class="o">)</code>&#13;
            <code class="k">return</code> <code class="n">dateComp</code><code class="o">;</code>&#13;
        <code class="c1">// Same date. If times not same, trigger on their comparison</code>&#13;
        <code class="k">if</code> <code class="o">(</code><code class="n">time</code> <code class="o">!=</code> <code class="kc">null</code> <code class="o">&amp;&amp;</code> <code class="n">a2</code><code class="o">.</code><code class="na">time</code> <code class="o">!=</code> <code class="kc">null</code><code class="o">)</code> <code class="o">{</code>&#13;
            <code class="c1">// Neither time is null</code>&#13;
            <code class="kt">int</code> <code class="n">timeComp</code> <code class="o">=</code> <code class="n">time</code><code class="o">.</code><code class="na">compareTo</code><code class="o">(</code><code class="n">a2</code><code class="o">.</code><code class="na">time</code><code class="o">);</code>&#13;
            <code class="k">if</code> <code class="o">(</code><code class="n">timeComp</code> <code class="o">!=</code> <code class="mi">0</code><code class="o">)</code>&#13;
                <code class="k">return</code> <code class="n">timeComp</code><code class="o">;</code>&#13;
        <code class="o">}</code> <code class="k">else</code> <code class="cm">/* At least one time is null */</code> <code class="o">{</code>&#13;
            <code class="k">if</code> <code class="o">(</code><code class="n">time</code> <code class="o">==</code> <code class="kc">null</code> <code class="o">&amp;&amp;</code> <code class="n">a2</code><code class="o">.</code><code class="na">time</code> <code class="o">!=</code> <code class="kc">null</code><code class="o">)</code> <code class="o">{</code>&#13;
                <code class="k">return</code> <code class="o">-</code><code class="mi">1</code><code class="o">;</code> <code class="c1">// All-day appts sort low to appear first</code>&#13;
            <code class="o">}</code> <code class="k">else</code> <code class="k">if</code> <code class="o">(</code><code class="n">time</code> <code class="o">!=</code> <code class="kc">null</code> <code class="o">&amp;&amp;</code> <code class="n">a2</code><code class="o">.</code><code class="na">time</code> <code class="o">==</code> <code class="kc">null</code><code class="o">)</code>&#13;
                <code class="k">return</code> <code class="o">+</code><code class="mi">1</code><code class="o">;</code>&#13;
                <code class="c1">// else both have no time set, so carry on</code>&#13;
        <code class="o">}</code>&#13;
        <code class="c1">// Same date &amp; time, trigger on text</code>&#13;
        <code class="k">return</code> <code class="n">text</code><code class="o">.</code><code class="na">compareTo</code><code class="o">(</code><code class="n">a2</code><code class="o">.</code><code class="na">text</code><code class="o">);</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="nd">@Override</code>&#13;
    <code class="kd">public</code> <code class="kt">int</code> <code class="nf">hashCode</code><code class="o">()</code> <code class="o">{</code>&#13;
        <code class="kd">final</code> <code class="kt">int</code> <code class="n">prime</code> <code class="o">=</code> <code class="mi">31</code><code class="o">;</code>&#13;
        <code class="kt">int</code> <code class="n">result</code> <code class="o">=</code> <code class="mi">1</code><code class="o">;</code>&#13;
        <code class="n">result</code> <code class="o">=</code> <code class="n">prime</code> <code class="o">*</code> <code class="n">result</code> <code class="o">+</code> <code class="o">((</code><code class="n">date</code> <code class="o">==</code> <code class="kc">null</code><code class="o">)</code> <code class="o">?</code> <code class="mi">0</code> <code class="o">:</code> <code class="n">date</code><code class="o">.</code><code class="na">hashCode</code><code class="o">());</code>&#13;
        <code class="n">result</code> <code class="o">=</code> <code class="n">prime</code> <code class="o">*</code> <code class="n">result</code> <code class="o">+</code> <code class="o">((</code><code class="n">text</code> <code class="o">==</code> <code class="kc">null</code><code class="o">)</code> <code class="o">?</code> <code class="mi">0</code> <code class="o">:</code> <code class="n">text</code><code class="o">.</code><code class="na">hashCode</code><code class="o">());</code>&#13;
        <code class="n">result</code> <code class="o">=</code> <code class="n">prime</code> <code class="o">*</code> <code class="n">result</code> <code class="o">+</code> <code class="o">((</code><code class="n">time</code> <code class="o">==</code> <code class="kc">null</code><code class="o">)</code> <code class="o">?</code> <code class="mi">0</code> <code class="o">:</code> <code class="n">time</code><code class="o">.</code><code class="na">hashCode</code><code class="o">());</code>&#13;
        <code class="k">return</code> <code class="n">result</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="nd">@Override</code>&#13;
    <code class="kd">public</code> <code class="kt">boolean</code> <code class="nf">equals</code><code class="o">(</code><code class="n">Object</code> <code class="n">o2</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="k">if</code> <code class="o">(</code><code class="k">this</code> <code class="o">==</code> <code class="n">o2</code><code class="o">)</code>&#13;
            <code class="k">return</code> <code class="kc">true</code><code class="o">;</code>&#13;
        <code class="k">if</code> <code class="o">(</code><code class="n">o2</code><code class="o">.</code><code class="na">getClass</code><code class="o">()</code> <code class="o">!=</code> <code class="n">Appt</code><code class="o">.</code><code class="na">class</code><code class="o">)</code>&#13;
            <code class="k">return</code> <code class="kc">false</code><code class="o">;</code>&#13;
        <code class="n">Appt</code> <code class="n">a2</code> <code class="o">=</code> <code class="o">(</code><code class="n">Appt</code><code class="o">)</code> <code class="n">o2</code><code class="o">;</code>&#13;
        <code class="k">if</code> <code class="o">(!</code><code class="n">date</code><code class="o">.</code><code class="na">equals</code><code class="o">(</code><code class="n">a2</code><code class="o">.</code><code class="na">date</code><code class="o">))</code>&#13;
            <code class="k">return</code> <code class="kc">false</code><code class="o">;</code>&#13;
        <code class="k">if</code> <code class="o">(</code><code class="n">time</code> <code class="o">!=</code> <code class="kc">null</code> <code class="o">&amp;&amp;</code> <code class="o">!</code><code class="n">time</code><code class="o">.</code><code class="na">equals</code><code class="o">(</code><code class="n">a2</code><code class="o">.</code><code class="na">time</code><code class="o">))</code>&#13;
            <code class="k">return</code> <code class="kc">false</code><code class="o">;</code>&#13;
        <code class="k">return</code> <code class="n">text</code><code class="o">.</code><code class="na">equals</code><code class="o">(</code><code class="n">a2</code><code class="o">.</code><code class="na">text</code><code class="o">);</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/** Return a String representation of this Appt.</code>&#13;
<code class="cm">     * Output is intended for debugging, not presentation!</code>&#13;
<code class="cm">     */</code>&#13;
    <code class="nd">@Override</code>&#13;
    <code class="kd">public</code> <code class="n">String</code> <code class="nf">toString</code><code class="o">()</code> <code class="o">{</code>&#13;
        <code class="n">var</code> <code class="n">sb</code> <code class="o">=</code> <code class="k">new</code> <code class="n">StringBuilder</code><code class="o">();</code>&#13;
        <code class="n">sb</code><code class="o">.</code><code class="na">append</code><code class="o">(</code><code class="n">date</code><code class="o">).</code><code class="na">append</code><code class="o">(</code><code class="sc">' '</code><code class="o">);</code>&#13;
        <code class="k">if</code> <code class="o">(</code><code class="n">time</code> <code class="o">!=</code> <code class="kc">null</code><code class="o">)</code> <code class="o">{</code>&#13;
            <code class="n">sb</code><code class="o">.</code><code class="na">append</code><code class="o">(</code><code class="n">time</code><code class="o">.</code><code class="na">getHour</code><code class="o">())</code>&#13;
            <code class="o">.</code><code class="na">append</code><code class="o">(</code><code class="sc">':'</code><code class="o">)</code>&#13;
            <code class="o">.</code><code class="na">append</code><code class="o">(</code><code class="n">time</code><code class="o">.</code><code class="na">getMinute</code><code class="o">())</code>&#13;
            <code class="o">.</code><code class="na">append</code><code class="o">(</code><code class="sc">' '</code><code class="o">);</code>&#13;
        <code class="o">}</code> <code class="k">else</code> <code class="o">{</code>&#13;
            <code class="n">sb</code><code class="o">.</code><code class="na">append</code><code class="o">(</code><code class="s">"(All day)"</code><code class="o">).</code><code class="na">append</code><code class="o">(</code><code class="sc">' '</code><code class="o">);</code>&#13;
        <code class="o">}</code>&#13;
        <code class="n">sb</code><code class="o">.</code><code class="na">append</code><code class="o">(</code><code class="n">text</code><code class="o">).</code><code class="na">toString</code><code class="o">();</code>&#13;
        <code class="k">return</code> <code class="n">sb</code><code class="o">.</code><code class="na">toString</code><code class="o">();</code>&#13;
    <code class="o">}</code></pre>&#13;
&#13;
<p>If you’re still confused between <code>Comparable</code> and <code>Comparator</code>, you’re probably not alone.&#13;
<a data-type="xref" href="#javacook-structure-compcompcomp">Table 7-3</a> summarizes the two comparison interfaces.</p>&#13;
<table id="javacook-structure-compcompcomp">&#13;
<caption><span class="label">Table 7-3. </span>Comparable compared with Comparator</caption>&#13;
<thead>&#13;
<tr>&#13;
<th>Interface name</th>&#13;
<th>Description</th>&#13;
<th>Method(s)</th>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td><p><code>java.lang.Comparable&lt;T&gt;</code></p></td>&#13;
<td><p>Provides a natural ordering to objects. Written in the class whose objects are being sorted.</p></td>&#13;
<td><p><code>int compareTo(T o);</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>java.util.Comparator&lt;T&gt;</code></p></td>&#13;
<td><p>Provides total control over sorting objects of another class. Standalone strategy object; pass to <code>sort()</code> method or <code>Collection</code> constructor.</p></td>&#13;
<td><p><code>int compare(T o1, T o2); boolean equals(T c2)</code><a data-primary="" data-startref="co_so" data-type="indexterm" id="idm45290667784920"/><a data-primary="" data-startref="ds_sc" data-type="indexterm" id="idm45290667783976"/><a data-primary="" data-startref="so_co" data-type="indexterm" id="idm45290667783032"/></p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="7.12 Avoiding the Urge to Sort" data-type="sect1"><div class="sect1" id="javacook-structure-SECT-9">&#13;
<h1>7.12 Avoiding the Urge to Sort</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-structure-SECT-9.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="data structures" data-secondary="sorting, avoiding" data-type="indexterm" id="ds_sa"/><a data-primary="sorting" data-type="indexterm" id="so_av"/>Your data needs to be sorted, but you don’t want to stop and sort it periodically.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-structure-SECT-9.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Not everything that requires order requires an explicit <em>sort</em> operation. Just keep the data sorted at all times.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-structure-SECT-9.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>You can avoid the overhead and elapsed time of an explicit sorting&#13;
operation by ensuring that the data is in the correct order at all&#13;
times, though this may or may not be faster overall,&#13;
depending on your data and how you choose to keep it sorted.&#13;
You can keep it sorted either manually or by using a <code>TreeSet</code> or a&#13;
<code>TreeMap</code>. First, here is some code from a call tracking program&#13;
that I first wrote on the very first public release of Java (the&#13;
code has been modernized slightly!) to keep track of people I had&#13;
extended contact with. Far less functional than a Rolodex, my&#13;
<code>CallTrack</code> program maintained a list of people sorted by last name&#13;
and first name. It also had the city, phone number, and email address&#13;
of each person. Here is a very small portion of the code surrounding&#13;
the event handling for the New User push button:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">CallTrack</code> <code class="o">{</code>&#13;
&#13;
    <code class="cm">/** The list of Person objects. */</code>&#13;
    <code class="kd">protected</code> <code class="n">List</code><code class="o">&lt;</code><code class="n">Person</code><code class="o">&gt;</code> <code class="n">usrList</code> <code class="o">=</code> <code class="k">new</code> <code class="n">ArrayList</code><code class="o">&lt;&gt;();</code>&#13;
&#13;
    <code class="cm">/** The scrolling list */</code>&#13;
    <code class="kd">protected</code> <code class="n">java</code><code class="o">.</code><code class="na">awt</code><code class="o">.</code><code class="na">List</code> <code class="n">visList</code> <code class="o">=</code> <code class="k">new</code> <code class="n">java</code><code class="o">.</code><code class="na">awt</code><code class="o">.</code><code class="na">List</code><code class="o">();</code>&#13;
&#13;
    <code class="cm">/** Add one (new) Person to the list, keeping the list sorted. */</code>&#13;
    <code class="kd">protected</code> <code class="kt">void</code> <code class="nf">add</code><code class="o">(</code><code class="n">Person</code> <code class="n">p</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">String</code> <code class="n">lastName</code> <code class="o">=</code> <code class="n">p</code><code class="o">.</code><code class="na">getLastName</code><code class="o">();</code>&#13;
        <code class="kt">int</code> <code class="n">i</code><code class="o">;</code>&#13;
        <code class="c1">// Find in "i" the position in the list where to insert this person</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="n">i</code><code class="o">=</code><code class="mi">0</code><code class="o">;</code> <code class="n">i</code><code class="o">&lt;</code><code class="n">usrList</code><code class="o">.</code><code class="na">size</code><code class="o">();</code> <code class="n">i</code><code class="o">++)</code>&#13;
            <code class="k">if</code> <code class="o">(</code><code class="n">lastName</code><code class="o">.</code><code class="na">compareTo</code><code class="o">((</code><code class="n">usrList</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code class="n">i</code><code class="o">)).</code><code class="na">getLastName</code><code class="o">())</code> <code class="o">&lt;=</code> <code class="mi">0</code><code class="o">)</code>&#13;
                <code class="k">break</code><code class="o">;</code> <code class="c1">// If we don't break, OK, will insert at end of list.</code>&#13;
        <code class="n">usrList</code><code class="o">.</code><code class="na">add</code><code class="o">(</code><code class="n">i</code><code class="o">,</code> <code class="n">p</code><code class="o">);</code>&#13;
&#13;
        <code class="c1">// Now insert them in the scrolling list, in the same position.</code>&#13;
        <code class="n">visList</code><code class="o">.</code><code class="na">add</code><code class="o">(</code><code class="n">p</code><code class="o">.</code><code class="na">getFullName</code><code class="o">(),</code> <code class="n">i</code><code class="o">);</code>&#13;
        <code class="n">visList</code><code class="o">.</code><code class="na">select</code><code class="o">(</code><code class="n">i</code><code class="o">);</code>      <code class="c1">// ensure current</code>&#13;
    <code class="o">}</code>&#13;
&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p>This code uses the <code>String</code> class <code>compareTo(String)</code> routine.</p>&#13;
<div data-type="warning" epub:type="warning"><h6>Warning</h6>&#13;
<p>This code uses a linear search, which was fine for the original application but could get&#13;
very slow on large lists (it is <em>O(n)</em>). You’d need to use hashing or a binary search to&#13;
find where to put the values on large lists.</p>&#13;
</div>&#13;
&#13;
<p>If I were writing this code today, I might well use a <a data-primary="TreeSet" data-type="indexterm" id="idm45290667672712"/><code>TreeSet</code> (which keeps objects in&#13;
order) or a <a data-primary="TreeMap" data-type="indexterm" id="idm45290667671176"/><code>TreeMap</code> (which keeps the keys in order and maps from keys to values; the&#13;
keys would be the name and the values would be the <code>Person</code> objects). Both insert the&#13;
objects into a tree in the correct order, so an <code>Iterator</code> that traverses the tree always&#13;
returns the objects in sorted order. In addition, they have methods such as <a data-primary="headSet() method" data-type="indexterm" id="idm45290667669000"/><code>headSet()</code>&#13;
and <a data-primary="headMap() method" data-type="indexterm" id="idm45290667667912"/><code>headMap()</code>, which give a new <code>Set</code> or <code>Map</code> of objects of the same class, containing&#13;
the objects lexically before a given value. The <a data-primary="tailSet() method" data-type="indexterm" id="idm45290667665784"/><code>tailSet()</code> and <a data-primary="tailMap() method" data-type="indexterm" id="idm45290667664696"/><code>tailMap()</code> methods,&#13;
similarly, return objects greater than a given value, and <code>subSet()</code> and <code>subMap()</code>&#13;
return a range. The <a data-primary="first() method (collections)" data-type="indexterm" id="idm45290667662712"/><code>first()</code> and <a data-primary="last() method" data-type="indexterm" id="idm45290667661528"/><code>last()</code> methods retrieve the obvious components from&#13;
the collection. The following program uses a <code>TreeSet</code> to sort some names:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting">        <code class="c1">// A TreeSet keeps objects in sorted order. Use a Comparator</code>&#13;
        <code class="c1">// published by String for case-insensitive sorting order.</code>&#13;
        <code class="n">TreeSet</code><code class="o">&lt;</code><code class="n">String</code><code class="o">&gt;</code> <code class="n">theSet</code> <code class="o">=</code> <code class="k">new</code> <code class="n">TreeSet</code><code class="o">&lt;&gt;(</code><code class="n">String</code><code class="o">.</code><code class="na">CASE_INSENSITIVE_ORDER</code><code class="o">);</code>&#13;
        <code class="n">theSet</code><code class="o">.</code><code class="na">add</code><code class="o">(</code><code class="s">"Gosling"</code><code class="o">);</code>&#13;
        <code class="n">theSet</code><code class="o">.</code><code class="na">add</code><code class="o">(</code><code class="s">"da Vinci"</code><code class="o">);</code>&#13;
        <code class="n">theSet</code><code class="o">.</code><code class="na">add</code><code class="o">(</code><code class="s">"van Gogh"</code><code class="o">);</code>&#13;
        <code class="n">theSet</code><code class="o">.</code><code class="na">add</code><code class="o">(</code><code class="s">"Java To Go"</code><code class="o">);</code>&#13;
        <code class="n">theSet</code><code class="o">.</code><code class="na">add</code><code class="o">(</code><code class="s">"Vanguard"</code><code class="o">);</code>&#13;
        <code class="n">theSet</code><code class="o">.</code><code class="na">add</code><code class="o">(</code><code class="s">"Darwin"</code><code class="o">);</code>&#13;
        <code class="n">theSet</code><code class="o">.</code><code class="na">add</code><code class="o">(</code><code class="s">"Darwin"</code><code class="o">);</code>    <code class="c1">// TreeSet is Set, ignores duplicates.</code>&#13;
&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">printf</code><code class="o">(</code><code class="s">"Our set contains %d elements"</code><code class="o">,</code> <code class="n">theSet</code><code class="o">.</code><code class="na">size</code><code class="o">());</code>&#13;
&#13;
        <code class="c1">// Since it is sorted we can easily get various subsets</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Lowest (alphabetically) is "</code> <code class="o">+</code> <code class="n">theSet</code><code class="o">.</code><code class="na">first</code><code class="o">());</code>&#13;
&#13;
        <code class="c1">// Print how many elements are greater than "k"</code>&#13;
        <code class="c1">// Should be 2 - "van Gogh" and "Vanguard"</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">theSet</code><code class="o">.</code><code class="na">tailSet</code><code class="o">(</code><code class="s">"k"</code><code class="o">).</code><code class="na">toArray</code><code class="o">().</code><code class="na">length</code> <code class="o">+</code>&#13;
            <code class="s">" elements higher than \"k\""</code><code class="o">);</code>&#13;
&#13;
        <code class="c1">// Print the whole list in sorted order</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Sorted list:"</code><code class="o">);</code>&#13;
        <code class="n">theSet</code><code class="o">.</code><code class="na">forEach</code><code class="o">(</code><code class="n">name</code> <code class="o">-&gt;</code> <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">name</code><code class="o">));</code></pre>&#13;
&#13;
<p>One last point to note is that if you have a <code>Hashtable</code> or <code>HashMap</code>, you can convert it to a <code>TreeMap</code>, and therefore get it sorted, just by passing it to the <code>TreeMap</code> constructor: <a data-primary="" data-startref="ds_sa" data-type="indexterm" id="idm45290667430376"/><a data-primary="" data-startref="so_av" data-type="indexterm" id="idm45290667429368"/></p>&#13;
&#13;
<pre data-type="programlisting">TreeMap sorted = new TreeMap(unsortedHashMap);</pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="7.13 Finding an Object in a Collection" data-type="sect1"><div class="sect1" id="javacook-structure-SECT-11">&#13;
<h1>7.13 Finding an Object in a Collection</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-structure-SECT-11.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="collections" data-secondary="finding objects in" data-type="indexterm" id="co_fo"/><a data-primary="objects" data-secondary="finding in collections" data-type="indexterm" id="ds_fo"/>You need to see whether a given collection contains a particular value.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-structure-SECT-11.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Ask the collection if it contains an object of the given value.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-structure-SECT-11.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>If you have created the contents of a collection, you probably know what is in it and what&#13;
is not. But if the collection is prepared by another part of a large application, or even&#13;
if you’ve just been putting objects into it and now need to find out if a given value was&#13;
found, this recipe’s for you. There is quite a variety of methods, depending on which&#13;
collection class you have. The methods in <a data-type="xref" href="#javacook-structure-collectionmethods">Table 7-4</a> can be used.<a data-primary="binarySearch() method" data-type="indexterm" id="idm45290667417192"/><a data-primary="contains() method" data-type="indexterm" id="idm45290667416488"/><a data-primary="containsKey() method" data-type="indexterm" id="idm45290667415816"/><a data-primary="containsValue() method" data-type="indexterm" id="idm45290667415144"/><a data-primary="indexOf() method" data-type="indexterm" id="idm45290667414472"/><a data-primary="search() method" data-type="indexterm" id="idm45290667413800"/></p>&#13;
<table id="javacook-structure-collectionmethods">&#13;
<caption><span class="label">Table 7-4. </span>Finding objects in a collection</caption>&#13;
<thead>&#13;
<tr>&#13;
<th>Method(s)</th>&#13;
<th>Meaning</th>&#13;
<th>Implementing classes</th>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td><p><code>binarySearch()</code></p></td>&#13;
<td><p>Fairly fast search</p></td>&#13;
<td><p><code>Arrays</code>, <code>Collections</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>contains()</code></p></td>&#13;
<td><p>Search</p></td>&#13;
<td><p><code>ArrayList</code>, <code>HashSet</code>, <code>Hashtable</code>, <code>LinkList</code>, <code>Properties</code>, <code>Vector</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>containsKey()</code>, <code class="keep-together">containsValue()</code></p></td>&#13;
<td><p>Checks if the collection contains the object as a <code>Key</code> or as a <code>Value</code></p></td>&#13;
<td><p><code>HashMap</code>, <code>Hashtable</code>, <code>Properties</code>, <code>TreeMap</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>indexOf()</code></p></td>&#13;
<td><p>Returns location where object is found</p></td>&#13;
<td><p><code>ArrayList</code>, <code>LinkedList</code>, <code>List</code>, <code>Stack</code>, <code class="keep-together">Vector</code></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>search()</code></p></td>&#13;
<td><p>Search</p></td>&#13;
<td><p><code>Stack</code></p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
&#13;
<p>The methods whose names start with <code>contains</code> will use a linear search if the collection is&#13;
a collection (<code>List</code>, <code>Set</code>) but will be quite fast if the collection is hashed (<code>HashSet</code>, <code>HashMap</code>).&#13;
So you do have to know what implementation is being used in order to think about performance,&#13;
particularly when the collection is (or is likely to grow) large.</p>&#13;
&#13;
<p>The next example plays a little game of find the hidden number (or needle in a haystack):&#13;
the numbers to look through are stored in an array. As games go, it’s fairly pathetic: the&#13;
computer plays against itself, so you probably know who’s going to win. I wrote it that&#13;
way so I would know that the data array contains valid numbers. The interesting part is&#13;
not the generation of the random numbers (discussed in <a data-type="xref" href="ch05.html#javacook-numbers-SECT-13">Recipe 5.9</a>).&#13;
The array to be used with <a data-primary="Arrays.binarySearch() method" data-type="indexterm" id="idm45290667384664"/><code>Arrays.binarySearch()</code> must be&#13;
in sorted order, but because we just filled it with random numbers, it isn’t initially&#13;
sorted. Hence, we call <a data-primary="Arrays.sort() method" data-type="indexterm" id="idm45290667383400"/><code>Arrays.sort()</code>  on the array. Then we are in a position to call&#13;
<code>Arrays.binarySearch()</code>, passing in the array and the value to look for. If you run the&#13;
program with a number, it runs that many games and reports on how it fared overall. If you&#13;
don’t bother, it plays only one game:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">ArrayHunt</code>  <code class="o">{</code>&#13;
    <code class="cm">/** the maximum (and actual) number of random ints to allocate */</code>&#13;
    <code class="kd">protected</code> <code class="kd">final</code> <code class="kd">static</code> <code class="kt">int</code> <code class="n">MAX</code>    <code class="o">=</code> <code class="mi">4000</code><code class="o">;</code>&#13;
    <code class="cm">/** the value to look for */</code>&#13;
    <code class="kd">protected</code> <code class="kd">final</code> <code class="kd">static</code> <code class="kt">int</code> <code class="n">NEEDLE</code> <code class="o">=</code> <code class="mi">1999</code><code class="o">;</code>&#13;
    <code class="kt">int</code><code class="o">[]</code> <code class="n">haystack</code><code class="o">;</code>&#13;
    <code class="n">Random</code> <code class="n">r</code><code class="o">;</code>&#13;
&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">argv</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">ArrayHunt</code> <code class="n">h</code> <code class="o">=</code> <code class="k">new</code> <code class="n">ArrayHunt</code><code class="o">();</code>&#13;
        <code class="k">if</code> <code class="o">(</code><code class="n">argv</code><code class="o">.</code><code class="na">length</code> <code class="o">==</code> <code class="mi">0</code><code class="o">)</code>&#13;
            <code class="n">h</code><code class="o">.</code><code class="na">play</code><code class="o">();</code>&#13;
        <code class="k">else</code> <code class="o">{</code>&#13;
            <code class="kt">int</code> <code class="n">won</code> <code class="o">=</code> <code class="mi">0</code><code class="o">;</code>&#13;
            <code class="kt">int</code> <code class="n">games</code> <code class="o">=</code> <code class="n">Integer</code><code class="o">.</code><code class="na">parseInt</code><code class="o">(</code><code class="n">argv</code><code class="o">[</code><code class="mi">0</code><code class="o">]);</code>&#13;
            <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">i</code><code class="o">=</code><code class="mi">0</code><code class="o">;</code> <code class="n">i</code><code class="o">&lt;</code><code class="n">games</code><code class="o">;</code> <code class="n">i</code><code class="o">++)</code>&#13;
                <code class="k">if</code> <code class="o">(</code><code class="n">h</code><code class="o">.</code><code class="na">play</code><code class="o">())</code>&#13;
                    <code class="o">++</code><code class="n">won</code><code class="o">;</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Computer won "</code> <code class="o">+</code> <code class="n">won</code> <code class="o">+</code>&#13;
                <code class="s">" out of "</code> <code class="o">+</code> <code class="n">games</code> <code class="o">+</code> <code class="s">"."</code><code class="o">);</code>&#13;
        <code class="o">}</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/** Construct the hunting ground */</code>&#13;
    <code class="kd">public</code> <code class="nf">ArrayHunt</code><code class="o">()</code> <code class="o">{</code>&#13;
        <code class="n">haystack</code> <code class="o">=</code> <code class="k">new</code> <code class="kt">int</code><code class="o">[</code><code class="n">MAX</code><code class="o">];</code>&#13;
        <code class="n">r</code> <code class="o">=</code> <code class="k">new</code> <code class="n">Random</code><code class="o">();</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/** Play one game. */</code>&#13;
    <code class="kd">public</code> <code class="kt">boolean</code> <code class="nf">play</code><code class="o">()</code> <code class="o">{</code>&#13;
        <code class="kt">int</code> <code class="n">i</code><code class="o">;</code>&#13;
&#13;
        <code class="c1">// Fill the array with random data (hay?)</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="n">i</code><code class="o">=</code><code class="mi">0</code><code class="o">;</code> <code class="n">i</code><code class="o">&lt;</code><code class="n">MAX</code><code class="o">;</code> <code class="n">i</code><code class="o">++)</code> <code class="o">{</code>&#13;
            <code class="n">haystack</code><code class="o">[</code><code class="n">i</code><code class="o">]</code> <code class="o">=</code> <code class="o">(</code><code class="kt">int</code><code class="o">)(</code><code class="n">r</code><code class="o">.</code><code class="na">nextFloat</code><code class="o">()</code> <code class="o">*</code> <code class="n">MAX</code><code class="o">);</code>&#13;
        <code class="o">}</code>&#13;
&#13;
        <code class="c1">// Precondition for binary search is that data be sorted!</code>&#13;
        <code class="n">Arrays</code><code class="o">.</code><code class="na">sort</code><code class="o">(</code><code class="n">haystack</code><code class="o">);</code>&#13;
&#13;
        <code class="c1">// Look for needle in haystack</code>&#13;
        <code class="n">i</code> <code class="o">=</code> <code class="n">Arrays</code><code class="o">.</code><code class="na">binarySearch</code><code class="o">(</code><code class="n">haystack</code><code class="o">,</code> <code class="n">NEEDLE</code><code class="o">);</code>&#13;
&#13;
        <code class="k">if</code> <code class="o">(</code><code class="n">i</code> <code class="o">&gt;=</code> <code class="mi">0</code><code class="o">)</code> <code class="o">{</code>        <code class="c1">// Found it, we win.</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Value "</code> <code class="o">+</code> <code class="n">NEEDLE</code> <code class="o">+</code>&#13;
                <code class="s">" occurs at haystack["</code> <code class="o">+</code> <code class="n">i</code> <code class="o">+</code> <code class="s">"]"</code><code class="o">);</code>&#13;
            <code class="k">return</code> <code class="kc">true</code><code class="o">;</code>&#13;
        <code class="o">}</code> <code class="k">else</code> <code class="o">{</code>        <code class="c1">// Not found, we lose.</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Value "</code> <code class="o">+</code> <code class="n">NEEDLE</code> <code class="o">+</code>&#13;
                <code class="s">" does not occur in haystack; nearest value is "</code> <code class="o">+</code>&#13;
                <code class="n">haystack</code><code class="o">[-(</code><code class="n">i</code><code class="o">+</code><code class="mi">2</code><code class="o">)]</code> <code class="o">+</code> <code class="s">" (found at "</code> <code class="o">+</code> <code class="o">-(</code><code class="n">i</code><code class="o">+</code><code class="mi">2</code><code class="o">)</code> <code class="o">+</code> <code class="s">")"</code><code class="o">);</code>&#13;
            <code class="k">return</code> <code class="kc">false</code><code class="o">;</code>&#13;
        <code class="o">}</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p><a data-primary="Collections.binarySearch() method" data-type="indexterm" id="idm45290667373736"/><code>Collections.binarySearch()</code> works almost exactly the same way, except it looks in a <code>Collection</code>, which must be sorted (presumably using <code>Collections.sort</code>, as discussed in <a data-type="xref" href="#javacook-structure-SECT-8">Recipe 7.11</a>).<a data-primary="" data-startref="co_fo" data-type="indexterm" id="idm45290667370856"/><a data-primary="" data-startref="ds_fo" data-type="indexterm" id="idm45290667369880"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="7.14 Converting a Collection to an Array" data-type="sect1"><div class="sect1" id="javacook-structure-SECT-12">&#13;
<h1>7.14 Converting a Collection to an Array</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-structure-SECT-12.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="data structures" data-secondary="converting collections to arrays" data-type="indexterm" id="idm45290667049608"/><a data-primary="arrays" data-type="indexterm" id="idm45290667048616"/><a data-primary="collections" data-secondary="converting to arrays" data-type="indexterm" id="idm45290667047944"/>You have a <code>Collection</code> but you need a Java language array.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-structure-SECT-12.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use the <code>Collection</code> method <a data-primary="toArray() method" data-type="indexterm" id="idm45290667044088"/><code>toArray()</code>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-structure-SECT-12.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>If you have an <code>ArrayList</code> or other <code>Collection</code> and you need an array, you can get it&#13;
just by calling the <code>Collection</code>’s <code>toArray()</code> method. With no arguments, you get an&#13;
array whose type is <code>Object[]</code>. You can optionally provide an array argument, which is&#13;
used for two purposes:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>The type of the array argument determines the type of array returned.</p>&#13;
</li>&#13;
<li>&#13;
<p>If the array is big enough (and you can ensure that it is by allocating the array based on the <code>Collection</code>’s <a data-primary="size() method" data-type="indexterm" id="idm45290667036104"/><code>size()</code> method), then this array is filled and returned. If the array is not big enough, a new array is allocated instead. If you provide an array and objects in the <code>Collection</code> cannot be cast to this type, then you will get an <code>ArrayStoreException</code>.</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p><a data-type="xref" href="#javacook-structure-EX-1">Example 7-3</a> shows code for converting an <code>ArrayList</code> to an array of type <code>Object</code>.</p>&#13;
<div data-type="example" id="javacook-structure-EX-1">&#13;
<h5><span class="label">Example 7-3. </span>main/src/main/java/structure/ToArray.java</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting">        <code class="n">List</code><code class="o">&lt;</code><code class="n">String</code><code class="o">&gt;</code> <code class="n">list</code> <code class="o">=</code> <code class="k">new</code> <code class="n">ArrayList</code><code class="o">&lt;&gt;();</code>&#13;
        <code class="n">list</code><code class="o">.</code><code class="na">add</code><code class="o">(</code><code class="s">"Blobbo"</code><code class="o">);</code>&#13;
        <code class="n">list</code><code class="o">.</code><code class="na">add</code><code class="o">(</code><code class="s">"Cracked"</code><code class="o">);</code>&#13;
        <code class="n">list</code><code class="o">.</code><code class="na">add</code><code class="o">(</code><code class="s">"Dumbo"</code><code class="o">);</code>&#13;
&#13;
        <code class="c1">// Convert a collection to Object[], which can store objects</code>&#13;
        <code class="c1">// of any type.</code>&#13;
        <code class="n">Object</code><code class="o">[]</code> <code class="n">ol</code> <code class="o">=</code> <code class="n">list</code><code class="o">.</code><code class="na">toArray</code><code class="o">();</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Array of Object has length "</code> <code class="o">+</code> <code class="n">ol</code><code class="o">.</code><code class="na">length</code><code class="o">);</code>&#13;
&#13;
        <code class="n">String</code><code class="o">[]</code> <code class="n">sl</code> <code class="o">=</code> <code class="o">(</code><code class="n">String</code><code class="o">[])</code> <code class="n">list</code><code class="o">.</code><code class="na">toArray</code><code class="o">(</code><code class="k">new</code> <code class="n">String</code><code class="o">[</code><code class="mi">0</code><code class="o">]);</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Array of String has length "</code> <code class="o">+</code> <code class="n">sl</code><code class="o">.</code><code class="na">length</code><code class="o">);</code></pre></div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="7.15 Making Your Data Iterable" data-type="sect1"><div class="sect1" id="javacook-structure-SECT-13">&#13;
<h1>7.15 Making Your Data Iterable</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-structure-SECT-13.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="data structures" data-secondary="Iterator interface and" data-type="indexterm" id="ds_ii"/><a data-primary="iterable data" data-type="indexterm" id="id_a"/><a data-primary="Iterable interface" data-type="indexterm" id="idm45290666979128"/>You have written your own data structure, and you want to publish the data to be iterable so it can be used in the for-each loop.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-structure-SECT-13.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Make your data class <code>Iterable</code>: this interace has only one method, <code>iterator()</code>.&#13;
Write your own <code>Iterator</code>. Just implement (or provide an inner class that implements) the <code>Iterator</code>&#13;
interface.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-structure-SECT-13.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>To be usable in the modern Java for-each loop, your data class must implement <span class="keep-together"><code>Iterable</code>,</span>&#13;
a simple interface with one method, <code>Iterator&lt;T&gt; iterator()</code>.&#13;
Whether you use this interface or want to use the older <code>Iterator</code> interface directly,&#13;
the way to make data from one part of your program available in a storage-independent way to other parts of the code is to generate an <code>Iterator</code>. Here is a short program that constructs, upon request, an <code>Iterator</code> for some data that it is storing—in this case, in an array. The <code>Iterator</code> interface has only three methods<a data-primary="hasNext() method" data-type="indexterm" id="idm45290666969016"/><a data-primary="next() method" data-type="indexterm" id="idm45290666968312"/><a data-primary="remove() method" data-type="indexterm" id="idm45290666967640"/>—<code>hasNext()</code>, <code>next()</code>, and <code>remove()</code>—demonstrated in <a data-type="xref" href="#javacook-structure-EX-42">Example 7-4</a>.</p>&#13;
<div data-type="example" id="javacook-structure-EX-42">&#13;
<h5><span class="label">Example 7-4. </span>main/src/main/java/structure//IterableDemo</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">IterableDemo</code> <code class="o">{</code>&#13;
&#13;
    <code class="cm">/** Demo implements Iterable, meaning it must provide an Iterator,</code>&#13;
<code class="cm">     * and that it can be used in a foreach loop.</code>&#13;
<code class="cm">     */</code>&#13;
    <code class="kd">static</code> <code class="kd">class</code> <code class="nc">Demo</code> <code class="kd">implements</code> <code class="n">Iterable</code><code class="o">&lt;</code><code class="n">String</code><code class="o">&gt;</code> <code class="o">{</code>&#13;
&#13;
        <code class="c1">// Simple demo: use array instead of inventing new data structure</code>&#13;
        <code class="n">String</code><code class="o">[]</code> <code class="n">data</code> <code class="o">=</code> <code class="o">{</code> <code class="s">"One"</code><code class="o">,</code> <code class="s">"Two"</code><code class="o">,</code> <code class="s">"Three"</code><code class="o">};</code>&#13;
&#13;
        <code class="cm">/** This is the Iterator that makes it all happen */</code>&#13;
        <code class="kd">class</code> <code class="nc">DemoIterator</code> <code class="kd">implements</code> <code class="n">Iterator</code><code class="o">&lt;</code><code class="n">String</code><code class="o">&gt;</code> <code class="o">{</code>&#13;
            <code class="kt">int</code> <code class="n">i</code> <code class="o">=</code> <code class="mi">0</code><code class="o">;</code>&#13;
&#13;
            <code class="cm">/**</code>&#13;
<code class="cm">             * Tell if there are any more elements.</code>&#13;
<code class="cm">             * @return true if next() will succeed, false otherwise</code>&#13;
<code class="cm">             */</code>&#13;
            <code class="kd">public</code> <code class="kt">boolean</code> <code class="nf">hasNext</code><code class="o">()</code> <code class="o">{</code>&#13;
                <code class="k">return</code> <code class="n">i</code> <code class="o">&lt;</code> <code class="n">data</code><code class="o">.</code><code class="na">length</code><code class="o">;</code>&#13;
            <code class="o">}</code>&#13;
&#13;
            <code class="cm">/** @return the next element from the data */</code>&#13;
            <code class="kd">public</code> <code class="n">String</code> <code class="nf">next</code><code class="o">()</code> <code class="o">{</code>&#13;
                <code class="k">return</code> <code class="n">data</code><code class="o">[</code><code class="n">i</code><code class="o">++];</code>&#13;
            <code class="o">}</code>&#13;
&#13;
            <code class="cm">/** Remove the object that next() just returned.</code>&#13;
<code class="cm">             * An Iterator is not required to support this interface, and we don't.</code>&#13;
<code class="cm">             * @throws UnsupportedOperationException unconditionally</code>&#13;
<code class="cm">             */</code>&#13;
            <code class="kd">public</code> <code class="kt">void</code> <code class="nf">remove</code><code class="o">()</code> <code class="o">{</code>&#13;
                <code class="k">throw</code> <code class="k">new</code> <code class="nf">UnsupportedOperationException</code><code class="o">(</code><code class="s">"remove"</code><code class="o">);</code>&#13;
            <code class="o">}</code>&#13;
        <code class="o">}</code>&#13;
&#13;
        <code class="cm">/** Method by which the Demo class makes its iterator available */</code>&#13;
        <code class="kd">public</code> <code class="n">Iterator</code><code class="o">&lt;</code><code class="n">String</code><code class="o">&gt;</code> <code class="nf">iterator</code><code class="o">()</code> <code class="o">{</code>&#13;
            <code class="k">return</code> <code class="k">new</code> <code class="nf">DemoIterator</code><code class="o">();</code>&#13;
        <code class="o">}</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">args</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">Demo</code> <code class="n">demo</code> <code class="o">=</code> <code class="k">new</code> <code class="n">Demo</code><code class="o">();</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="n">String</code> <code class="n">s</code> <code class="o">:</code> <code class="n">demo</code><code class="o">)</code> <code class="o">{</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">s</code><code class="o">);</code>&#13;
        <code class="o">}</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre></div>&#13;
&#13;
<p>The comments on the <a data-primary="remove() method" data-type="indexterm" id="idm45290666960024"/><code>remove()</code> method remind me of an interesting point. This interface&#13;
introduces <code>java.util</code>’s attempt at something Java doesn’t really have, the optional&#13;
method. Because there is no syntax for this, and they didn’t want to introduce any new&#13;
syntax, the developers of the Collections Framework decided on an implementation using&#13;
existing syntax. Optional methods that are not implemented are required to throw&#13;
an <code>UnsupportedOperationException</code> if they ever get called. My <code>remove()</code> method does&#13;
just that. Note that <code>UnsupportedOperationException</code> is subclassed from <code>RuntimeException</code>, so&#13;
it is not required to be declared or caught.</p>&#13;
&#13;
<p>This code is simplistic, but it does show the syntax and demonstrates how the&#13;
<code>Iterator</code> interface works. In real code, the <code>Iterator</code> and the data are usually separate&#13;
objects (the <code>Iterator</code> might be an inner class from the data store class). Also, you&#13;
don’t even need to write this code for an array; you can just construct an <code>ArrayList</code>&#13;
object, copy the array elements into it, and ask it to provide the <code>Iterator</code>. However, I&#13;
believe it’s worth showing this simple example of the internals of an <code>Iterator</code> so that&#13;
you can understand both how it works and how you could provide one for a more&#13;
sophisticated data structure, should the need arise.</p>&#13;
&#13;
<p>The <code>Iterable</code> interface has only one nondefault method, <a data-primary="iterator() method" data-type="indexterm" id="idm45290666602248"/><code>iterator()</code>, which&#13;
must provide an <code>Iterator</code> for objects of the given type. Because the&#13;
<code>ArrayIterator</code> class implements this as well, we can use an object of type <code>ArrayIterator</code>&#13;
in a “foreach” loop, as in <a data-type="xref" href="#javacook-structure-EX-123">Example 7-5</a>.</p>&#13;
<div data-type="example" id="javacook-structure-EX-123">&#13;
<h5><span class="label">Example 7-5. </span><em>main/src/main/java/structure/ArrayIteratorDemo.java</em></h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kn">package</code> <code class="n">structure</code><code class="o">;</code>&#13;
&#13;
<code class="kn">import</code> <code class="nn">com.darwinsys.util.ArrayIterator</code><code class="o">;</code>&#13;
&#13;
<code class="kd">public</code> <code class="kd">class</code> <code class="nc">ArrayIteratorDemo</code> <code class="o">{</code>&#13;
&#13;
    <code class="kd">private</code> <code class="kd">final</code> <code class="kd">static</code> <code class="n">String</code><code class="o">[]</code> <code class="n">names</code> <code class="o">=</code> <code class="o">{</code>&#13;
        <code class="s">"rose"</code><code class="o">,</code> <code class="s">"petunia"</code><code class="o">,</code> <code class="s">"tulip"</code>&#13;
    <code class="o">};</code>&#13;
&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">args</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">ArrayIterator</code><code class="o">&lt;</code><code class="n">String</code><code class="o">&gt;</code> <code class="n">arrayIterator</code> <code class="o">=</code> <code class="k">new</code> <code class="n">ArrayIterator</code><code class="o">&lt;&gt;(</code><code class="n">names</code><code class="o">);</code>&#13;
&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Java 5, 6 way"</code><code class="o">);</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="n">String</code> <code class="n">s</code> <code class="o">:</code> <code class="n">arrayIterator</code><code class="o">)</code> <code class="o">{</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">s</code><code class="o">);</code>&#13;
        <code class="o">}</code>&#13;
&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Java 5, 6 ways"</code><code class="o">);</code>&#13;
        <code class="n">arrayIterator</code><code class="o">.</code><code class="na">forEach</code><code class="o">(</code><code class="n">s</code><code class="o">-&gt;</code><code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">s</code><code class="o">));</code>&#13;
        <code class="n">arrayIterator</code><code class="o">.</code><code class="na">forEach</code><code class="o">(</code><code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">::</code><code class="n">println</code><code class="o">);</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre></div>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Java 8 Iterable.foreach" data-type="sect3"><div class="sect3" id="idm45290666595016">&#13;
<h3>Java 8 Iterable.foreach</h3>&#13;
&#13;
<p><a data-primary="Java 8" data-primary-sortas="Java 08" data-type="indexterm" id="idm45290666594008"/>Java 8 adds <code>foreach</code> to the <code>Iterator</code> interface, a<a data-primary="default method" data-type="indexterm" id="idm45290666485576"/> <em>default method</em> (discussed in&#13;
<a data-type="xref" href="ch09.html#javacook-fp-intro">Recipe 9.0</a>) that you don’t have to write.&#13;
Thus, without changing the <code>ArrayIterator</code>, after moving to Java 8 we can use the newest-style loop,&#13;
<code>Iterator.foreach(Consumer)</code>, with a lambda expression (see <a data-type="xref" href="ch09.html#javacook-fp">Chapter 9</a>) to print each element (see <a data-type="xref" href="#javacook-structure-EX-123">Example 7-5</a>).<a data-primary="" data-startref="ds_ii" data-type="indexterm" id="idm45290666424392"/><a data-primary="" data-startref="id_a" data-type="indexterm" id="idm45290666423416"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="7.16 Using a Stack of Objects" data-type="sect1"><div class="sect1" id="javacook-structure-SECT-14">&#13;
<h1>7.16 Using a Stack of Objects</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-structure-SECT-14.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="data structures" data-secondary="object stacks" data-type="indexterm" id="ds_os"/><a data-primary="object stacks" data-type="indexterm" id="os_ab"/>You need to process data in the order of last in, first out (LIFO) or most recently added.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-structure-SECT-14.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Write your own code for creating a stack; it’s easy. Or, use a <code>java.util.Stack</code>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-structure-SECT-14.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>You need to put things into a holding area quickly and retrieve them in last-in, first-out&#13;
order. This is a common data structuring operation and is often used to reverse the order&#13;
of objects. The basic operations of any stack are <a data-primary="push() method" data-type="indexterm" id="idm45290666412520"/><code>push()</code> (add to stack), <a data-primary="pop() method" data-type="indexterm" id="idm45290666411432"/><code>pop()</code>&#13;
(remove from stack), and <a data-primary="peek() method" data-type="indexterm" id="idm45290666410312"/><code>peek()</code> (examine top element without removing). <code>ToyStack</code>&#13;
in <a data-type="xref" href="#javacook-structure-toystack">Example 7-6</a> is a simple class for stacking values of the primitive type <code>int</code>.&#13;
I’ll expand it in a page or two to allow stacking of user-defined objects.</p>&#13;
<div data-type="example" id="javacook-structure-toystack">&#13;
<h5><span class="label">Example 7-6. </span>main/src/main/java/structure/ToyStack.java</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">ToyStack</code> <code class="o">{</code>&#13;
&#13;
    <code class="cm">/** The maximum stack depth */</code>&#13;
    <code class="kd">protected</code> <code class="kt">int</code> <code class="n">MAX_DEPTH</code> <code class="o">=</code> <code class="mi">10</code><code class="o">;</code>&#13;
    <code class="cm">/** The current stack depth */</code>&#13;
    <code class="kd">protected</code> <code class="kt">int</code> <code class="n">depth</code> <code class="o">=</code> <code class="mi">0</code><code class="o">;</code>&#13;
    <code class="cm">/* The actual stack */</code>&#13;
    <code class="kd">protected</code> <code class="kt">int</code><code class="o">[]</code> <code class="n">stack</code> <code class="o">=</code> <code class="k">new</code> <code class="kt">int</code><code class="o">[</code><code class="n">MAX_DEPTH</code><code class="o">];</code>&#13;
&#13;
    <code class="cm">/** push - add an element onto the stack */</code>&#13;
    <code class="kd">protected</code> <code class="kt">void</code> <code class="nf">push</code><code class="o">(</code><code class="kt">int</code> <code class="n">n</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">stack</code><code class="o">[</code><code class="n">depth</code><code class="o">++]</code> <code class="o">=</code> <code class="n">n</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
    <code class="cm">/** pop - return and remove the top element */</code>&#13;
    <code class="kd">protected</code> <code class="kt">int</code> <code class="nf">pop</code><code class="o">()</code> <code class="o">{</code>&#13;
        <code class="k">return</code> <code class="n">stack</code><code class="o">[--</code><code class="n">depth</code><code class="o">];</code>&#13;
    <code class="o">}</code>&#13;
    <code class="cm">/** peek - return the top element but don't remove it */</code>&#13;
    <code class="kd">protected</code> <code class="kt">int</code> <code class="nf">peek</code><code class="o">()</code> <code class="o">{</code>&#13;
        <code class="k">return</code> <code class="n">stack</code><code class="o">[</code><code class="n">depth</code><code class="o">-</code><code class="mi">1</code><code class="o">];</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre></div>&#13;
&#13;
<p>If you are not familiar with the basic idea of a stack, you should work through the code&#13;
here; if you are familiar with it, you can skip ahead. While looking at it, of course,&#13;
think about what happens if <code>pop()</code> or <code>peek()</code> is called when <code>push()</code> has never been&#13;
called or if <code>push()</code> is called to stack more data than will fit.</p>&#13;
&#13;
<p>While working on <code>ToyStack2</code> (not shown but in the online source),&#13;
I extracted its interface into <code>SimpleStack</code>, which just lists&#13;
the operations. At the same time I added the <a data-primary="empty() method" data-type="indexterm" id="idm45290666292904"/><code>empty()</code> method for some compatibility with&#13;
the standard <code>java.util.Stack</code> class.&#13;
And importantly, I made it a generic type, so it can be used with values of any type. This is shown in <code>SimpleStack</code>:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting" id="javacook-structure-simplestack"><code class="kd">public</code> <code class="kd">interface</code> <code class="nc">SimpleStack</code><code class="o">&lt;</code><code class="n">T</code><code class="o">&gt;</code> <code class="o">{</code>&#13;
&#13;
    <code class="cm">/** empty - return true if the stack is empty */</code>&#13;
    <code class="kd">abstract</code> <code class="kt">boolean</code> <code class="nf">empty</code><code class="o">();</code>&#13;
&#13;
    <code class="cm">/** push - add an element onto the stack */</code>&#13;
    <code class="kd">abstract</code> <code class="kt">void</code> <code class="nf">push</code><code class="o">(</code><code class="n">T</code> <code class="n">n</code><code class="o">);</code>&#13;
&#13;
    <code class="cm">/** pop - return and remove the top element */</code>&#13;
    <code class="kd">abstract</code> <code class="n">T</code> <code class="nf">pop</code><code class="o">();</code>&#13;
&#13;
    <code class="cm">/** peek - return the top element but don't remove it */</code>&#13;
    <code class="kd">abstract</code> <code class="n">T</code> <code class="nf">peek</code><code class="o">();</code>&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p>I then made another demo stack class, <code>MyStack</code>, to implement the new interface:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting" id="javacook-structure-mystack"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">MyStack</code><code class="o">&lt;</code><code class="n">T</code><code class="o">&gt;</code> <code class="kd">implements</code> <code class="n">SimpleStack</code><code class="o">&lt;</code><code class="n">T</code><code class="o">&gt;</code> <code class="o">{</code>&#13;
&#13;
    <code class="kd">private</code> <code class="kt">int</code> <code class="n">depth</code> <code class="o">=</code> <code class="mi">0</code><code class="o">;</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kd">final</code> <code class="kt">int</code> <code class="n">DEFAULT_INITIAL</code> <code class="o">=</code> <code class="mi">10</code><code class="o">;</code>&#13;
    <code class="kd">private</code> <code class="n">T</code><code class="o">[]</code> <code class="n">stack</code><code class="o">;</code>&#13;
&#13;
    <code class="kd">public</code> <code class="nf">MyStack</code><code class="o">()</code> <code class="o">{</code>&#13;
        <code class="k">this</code><code class="o">(</code><code class="n">DEFAULT_INITIAL</code><code class="o">);</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="kd">public</code> <code class="nf">MyStack</code><code class="o">(</code><code class="kt">int</code> <code class="n">howBig</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="k">if</code> <code class="o">(</code><code class="n">howBig</code> <code class="o">&lt;=</code> <code class="mi">0</code><code class="o">)</code> <code class="o">{</code>&#13;
            <code class="k">throw</code> <code class="k">new</code> <code class="nf">IllegalArgumentException</code><code class="o">(</code>&#13;
            <code class="n">howBig</code> <code class="o">+</code> <code class="s">" must be positive, but was "</code> <code class="o">+</code> <code class="n">howBig</code><code class="o">);</code>&#13;
        <code class="o">}</code>&#13;
        <code class="n">stack</code> <code class="o">=</code> <code class="o">(</code><code class="n">T</code><code class="o">[])</code><code class="k">new</code> <code class="n">Object</code><code class="o">[</code><code class="n">howBig</code><code class="o">];</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="nd">@Override</code>&#13;
    <code class="kd">public</code> <code class="kt">boolean</code> <code class="nf">empty</code><code class="o">()</code> <code class="o">{</code>&#13;
        <code class="k">return</code> <code class="n">depth</code> <code class="o">==</code> <code class="mi">0</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/** push - add an element onto the stack */</code>&#13;
    <code class="nd">@Override</code>&#13;
    <code class="kd">public</code> <code class="kt">void</code> <code class="nf">push</code><code class="o">(</code><code class="n">T</code> <code class="n">obj</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="c1">// Could check capacity and expand</code>&#13;
        <code class="n">stack</code><code class="o">[</code><code class="n">depth</code><code class="o">++]</code> <code class="o">=</code> <code class="n">obj</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/* pop - return and remove the top element */</code>&#13;
    <code class="nd">@Override</code>&#13;
    <code class="kd">public</code> <code class="n">T</code> <code class="nf">pop</code><code class="o">()</code> <code class="o">{</code>&#13;
        <code class="o">--</code><code class="n">depth</code><code class="o">;</code>&#13;
        <code class="n">T</code> <code class="n">tmp</code> <code class="o">=</code> <code class="n">stack</code><code class="o">[</code><code class="n">depth</code><code class="o">];</code>&#13;
        <code class="n">stack</code><code class="o">[</code><code class="n">depth</code><code class="o">]</code> <code class="o">=</code> <code class="kc">null</code><code class="o">;</code>&#13;
        <code class="k">return</code> <code class="n">tmp</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/** peek - return the top element but don't remove it */</code>&#13;
    <code class="nd">@Override</code>&#13;
    <code class="kd">public</code> <code class="n">T</code> <code class="nf">peek</code><code class="o">()</code> <code class="o">{</code>&#13;
        <code class="k">if</code> <code class="o">(</code><code class="n">depth</code> <code class="o">==</code> <code class="mi">0</code><code class="o">)</code> <code class="o">{</code>&#13;
            <code class="k">return</code> <code class="kc">null</code><code class="o">;</code>&#13;
        <code class="o">}</code>&#13;
        <code class="k">return</code> <code class="n">stack</code><code class="o">[</code><code class="n">depth</code><code class="o">-</code><code class="mi">1</code><code class="o">];</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="kd">public</code> <code class="kt">boolean</code> <code class="nf">hasNext</code><code class="o">()</code> <code class="o">{</code>&#13;
        <code class="k">return</code> <code class="n">depth</code> <code class="o">&gt;</code> <code class="mi">0</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="kd">public</code> <code class="kt">boolean</code> <code class="nf">hasRoom</code><code class="o">()</code> <code class="o">{</code>&#13;
        <code class="k">return</code> <code class="n">depth</code> <code class="o">&lt;</code> <code class="n">stack</code><code class="o">.</code><code class="na">length</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="kd">public</code> <code class="kt">int</code> <code class="nf">getStackDepth</code><code class="o">()</code> <code class="o">{</code>&#13;
        <code class="k">return</code> <code class="n">depth</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p>This version has a lot more error checking (and a unit test, in the <em>src/test/java/structure</em> folder),&#13;
as well as some additional methods not in the original. One example is <a data-primary="hasRoom() method" data-type="indexterm" id="idm45290666266392"/><code>hasRoom()</code>. Unlike the full-blown <code>java.util.Stack</code>, <code>MyStack</code> does not expand beyond its original size, so we need a way to see if&#13;
it is full without throwing an exception.</p>&#13;
&#13;
<p>Now that you see how a stack works, I recommend using the provided <code>java.util.Stack</code> instead&#13;
of my demo versions; it is more fully fleshed out, more fully tested, and widely used.&#13;
Unlike the major Collections API components <code>List</code>, <code>Set</code>, and <code>Map</code>,&#13;
<code>java.util.Stack</code> does not have an interface and implementation class(es);&#13;
it is based on <code>Vector</code>, which is a <code>List</code> implementation.&#13;
The real <code>java.util.Stack</code> works in a similar manner to mine but has more methods&#13;
and more flexibility. To see that in operation, <a data-type="xref" href="ch05.html#javacook-numbers-SECT-19">Recipe 5.12</a>&#13;
provides a simple stack-based numeric calculator.<a data-primary="" data-startref="ds_os" data-type="indexterm" id="idm45290665939448"/><a data-primary="" data-startref="os_ab" data-type="indexterm" id="idm45290665938504"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="7.17 Multidimensional Structures" data-type="sect1"><div class="sect1" id="javacook-structure-SECT-15">&#13;
<h1>7.17 Multidimensional Structures</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-structure-SECT-15.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="data structures" data-secondary="multidimensional" data-type="indexterm" id="ds_mu"/><a data-primary="multidimensional structures" data-type="indexterm" id="mu_s"/>You need a multidimensional array or <code>ArrayList</code>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-structure-SECT-15.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>No problem. Java supports this.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-structure-SECT-15.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>As mentioned back in <a data-type="xref" href="#javacook-structure-SECT-1">Recipe 7.1</a>, Java arrays can hold any reference type. Because an array is a reference type, it follows that you can have arrays of arrays or, in other terminology, <em>multidimensional</em> arrays. Further, because each array has its own length attribute, the columns of a two-dimensional array, for example, do not all have to be the same length (see <a data-type="xref" href="#javacook-structure-FIG-2">Figure 7-3</a>).</p>&#13;
&#13;
<p>Here is code to allocate a couple of two-dimensional arrays, one using a loop and the other using an initializer. Both are selectively printed:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">ArrayTwoDObjects</code> <code class="o">{</code>&#13;
&#13;
    <code class="cm">/** Return list of subscript names (unrealistic; just for demo). */</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="n">String</code><code class="o">[][]</code> <code class="nf">getArrayInfo</code><code class="o">()</code> <code class="o">{</code>&#13;
        <code class="n">String</code> <code class="n">info</code><code class="o">[][];</code>&#13;
        <code class="n">info</code> <code class="o">=</code> <code class="k">new</code> <code class="n">String</code><code class="o">[</code><code class="mi">10</code><code class="o">][</code><code class="mi">10</code><code class="o">];</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">i</code><code class="o">=</code><code class="mi">0</code><code class="o">;</code> <code class="n">i</code> <code class="o">&lt;</code> <code class="n">info</code><code class="o">.</code><code class="na">length</code><code class="o">;</code> <code class="n">i</code><code class="o">++)</code> <code class="o">{</code>&#13;
            <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">j</code> <code class="o">=</code> <code class="mi">0</code><code class="o">;</code> <code class="n">j</code> <code class="o">&lt;</code> <code class="n">info</code><code class="o">[</code><code class="n">i</code><code class="o">].</code><code class="na">length</code><code class="o">;</code> <code class="n">j</code><code class="o">++)</code> <code class="o">{</code>&#13;
                <code class="n">info</code><code class="o">[</code><code class="n">i</code><code class="o">][</code><code class="n">j</code><code class="o">]</code> <code class="o">=</code> <code class="s">"String["</code> <code class="o">+</code> <code class="n">i</code> <code class="o">+</code> <code class="s">","</code> <code class="o">+</code> <code class="n">j</code> <code class="o">+</code> <code class="s">"]"</code><code class="o">;</code>&#13;
            <code class="o">}</code>&#13;
        <code class="o">}</code>&#13;
        <code class="k">return</code> <code class="n">info</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/** Run the initialization method and print part of the results */</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">args</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">print</code><code class="o">(</code><code class="s">"from getArrayInfo"</code><code class="o">,</code> <code class="n">getArrayInfo</code><code class="o">());</code>&#13;
    <code class="o">}</code>&#13;
&#13;
    <code class="cm">/** Print selected elements from the 2D array */</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">print</code><code class="o">(</code><code class="n">String</code> <code class="n">tag</code><code class="o">,</code> <code class="n">String</code><code class="o">[][]</code> <code class="n">array</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Array "</code> <code class="o">+</code> <code class="n">tag</code> <code class="o">+</code> <code class="s">" is "</code> <code class="o">+</code> <code class="n">array</code><code class="o">.</code><code class="na">length</code> <code class="o">+</code> <code class="s">" x "</code> <code class="o">+</code>&#13;
            <code class="n">array</code><code class="o">[</code><code class="mi">0</code><code class="o">].</code><code class="na">length</code><code class="o">);</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Array[0][0] = "</code> <code class="o">+</code> <code class="n">array</code><code class="o">[</code><code class="mi">0</code><code class="o">][</code><code class="mi">0</code><code class="o">]);</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Array[0][1] = "</code> <code class="o">+</code> <code class="n">array</code><code class="o">[</code><code class="mi">0</code><code class="o">][</code><code class="mi">1</code><code class="o">]);</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Array[1][0] = "</code> <code class="o">+</code> <code class="n">array</code><code class="o">[</code><code class="mi">1</code><code class="o">][</code><code class="mi">0</code><code class="o">]);</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Array[0][0] = "</code> <code class="o">+</code> <code class="n">array</code><code class="o">[</code><code class="mi">0</code><code class="o">][</code><code class="mi">0</code><code class="o">]);</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Array[1][1] = "</code> <code class="o">+</code> <code class="n">array</code><code class="o">[</code><code class="mi">1</code><code class="o">][</code><code class="mi">1</code><code class="o">]);</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre>&#13;
&#13;
<figure><div class="figure" id="javacook-structure-FIG-2">&#13;
<img alt="jcb4 0703" src="assets/jcb4_0703.png"/>&#13;
<h6><span class="label">Figure 7-3. </span>Multidimensional arrays</h6>&#13;
</div></figure>&#13;
&#13;
<p>Running it produces this output:</p>&#13;
<pre data-type="programlisting" id="I_7_tt266">&gt; <strong>java structure.ArrayTwoDObjects</strong>&#13;
Array from getArrayInfo is 10 x 10&#13;
Array[0][0] = String[0,0]&#13;
Array[0][1] = String[0,1]&#13;
Array[1][0] = String[1,0]&#13;
Array[0][0] = String[0,0]&#13;
Array[1][1] = String[1,1]&#13;
Array from getParameterInfo is 2 x 3&#13;
Array[0][0] = fontsize&#13;
Array[0][1] = 9-18&#13;
Array[1][0] = URL&#13;
Array[0][0] = fontsize&#13;
Array[1][1] = -&#13;
&gt;</pre>&#13;
&#13;
<p>The same kind of logic can be applied to any of the <code>Collections</code>. You could have an <code>ArrayList</code> of <code>ArrayLists</code>, or a <code>Vector</code> of linked lists, or whatever your little heart <span class="keep-together">desires</span>.</p>&#13;
&#13;
<p>As <a data-type="xref" href="#javacook-structure-FIG-2">Figure 7-3</a> shows, it is not necessary for the array to be regular (i.e., it’s possible for each column of the 2D array to have a different height). That is why I used <code class="keep-together">array[0].length</code> for the length of the first column in the code example.<a data-primary="" data-startref="ds_mu" data-type="indexterm" id="idm45290665685944"/><a data-primary="" data-startref="mu_s" data-type="indexterm" id="idm45290665684968"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="7.18 Simplifying Data Objects with Lombok or Record" data-type="sect1"><div class="sect1" id="javacook-structure-record">&#13;
<h1>7.18 Simplifying Data Objects with Lombok or Record</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="idm45290665682568">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="Lombok" data-type="indexterm" id="idm45290665681368"/><a data-primary="data structures" data-secondary="simplifying data objects" data-type="indexterm" id="ds_sdo"/>You waste time writing data classes that are Plain Old Java Objects (POJO), with boilerplate code&#13;
such as setters and getters, <a data-primary="equals() method" data-type="indexterm" id="idm45290665679016"/><a data-primary="hashCode() method" data-type="indexterm" id="idm45290665678344"/><a data-primary="toString() method" data-type="indexterm" id="idm45290665677672"/><code>equals()</code>, and <a data-primary="toString() method" data-type="indexterm" id="idm45290665676616"/><code>toString()</code>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="idm45290665675368">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use Lombok to autogenerate boilerplate methods.&#13;
In Java 14+, use the new <code>record</code> data type, which&#13;
generates the boilerplate methods for you.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="idm45290665673336">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>When Java was new, before there were good IDEs, developers had to&#13;
write getters and setters by hand, or by copy-paste-change.&#13;
Back then I did a study of one existing large code base and found&#13;
about a 1/2% failure rate. The setter stored the value in the wrong&#13;
place or the getter retrieved the wrong value.&#13;
Assuming random distribution, this meant that&#13;
one getter call in a hundred gave the wrong answer!&#13;
The application still worked, so I must assume those&#13;
wrong answers didn’t matter.</p>&#13;
&#13;
<p>Now we have IDEs that can generate all the boilerplate methods&#13;
such as setters/getters, equals, <code>toString()</code>, and so on.&#13;
But you still have to remember to invoke these generators.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Lombok" data-type="sect3"><div class="sect3" id="idm45290665670184">&#13;
<h3>Lombok</h3>&#13;
&#13;
<p>Project Lombok provides one solution.&#13;
It reads your <em>.class</em> files looking for its own annotations and,&#13;
when it finds them, rewrites the class files to have&#13;
the chosen <span class="keep-together">methods.</span></p>&#13;
&#13;
<p>To use Lombok, you need to add the dependency&#13;
<code>org.projectlombok:lombok:1.18.4</code> (or newer)&#13;
to your build script.&#13;
Or, if you are using an IDE, download the Lombok JAR file from&#13;
<a href="https://projectlombok.org"><em class="hyperlink">https://projectlombok.org</em></a> and install it as per the instructions there.&#13;
Then you can annotate your class with annotations like these:</p>&#13;
&#13;
<pre data-type="programlisting">@Setters @Getters</pre>&#13;
&#13;
<p>Presto! No more forgetting to generate these methods; Lombok&#13;
will do the work for you.</p>&#13;
&#13;
<p>Other annotations include the following:</p>&#13;
&#13;
<pre data-type="programlisting">@ToString&#13;
@EqualsAndHashCode&#13;
@AllArgsConstructor</pre>&#13;
&#13;
<p>For data classes, there is even <code>@Data</code>, which is a shortcut for&#13;
<code>@ToString</code>, <code>@EqualsAndHashCode</code>, <code>@Getter</code> on all fields, <code>@Setter</code> on all nonfinal fields, and <code>@RequiredArgsConstructor</code>!</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Java 14 record (preview)" data-type="sect3"><div class="sect3" id="idm45290665659704">&#13;
<h3>Java 14 record (preview)</h3>&#13;
&#13;
<p>The new <code>record</code> type provides another solution.&#13;
A <code>record</code> is a class-like construct for data classes,&#13;
a restricted form of class like enums and annotations.&#13;
You need only write the name of a data object and its fields,&#13;
and the compiler will provide a constructor,&#13;
getters, <code>hashCode()</code> and <code>equals()</code>, and <code>toString()</code>:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="n">record</code> <code class="nf">Person</code><code class="o">(</code><code class="n">String</code> <code class="n">name</code><code class="o">,</code> <code class="n">String</code> <code class="n">emailAddress</code><code class="o">)</code> <code class="o">{</code> <code class="o">}</code></pre>&#13;
&#13;
<p>The provided constructor has the same signature as the record declaration.&#13;
All fields are implicitly final, and the <code>record</code> provides getters&#13;
but not setters.&#13;
The getters have the name of the field; they do not follow the JavaBeans <em>getName()</em> pattern.&#13;
Immutable objects are important for reliable code&#13;
(see <a data-type="xref" href="ch09.html#javacook-fp-intro">Recipe 9.0</a>).&#13;
You can provide other members such as extra constructors,&#13;
static fields, and static or instance methods.&#13;
Records cannot be abstract and cannot declare additional instance fields.&#13;
All in keeping with the fact that the state of the object is&#13;
as declared in the <code>record</code> header. Here I create a <code>Person</code> record and make an instance of it, all in JShell:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">$</code> <code class="n">jshell</code> <code class="o">--</code><code class="n">enable</code><code class="o">-</code><code class="n">preview</code>&#13;
<code class="o">|</code>  <code class="n">Welcome</code> <code class="n">to</code> <code class="n">JShell</code> <code class="o">--</code> <code class="n">Version</code> <code class="mi">14</code><code class="o">-</code><code class="n">ea</code>&#13;
<code class="o">|</code>  <code class="n">For</code> <code class="n">an</code> <code class="n">introduction</code> <code class="nl">type:</code> <code class="o">/</code><code class="n">help</code> <code class="n">intro</code>&#13;
&#13;
<code class="n">jshell</code><code class="o">&gt;</code> <code class="n">record</code> <code class="nf">Person</code><code class="o">(</code><code class="n">String</code> <code class="n">name</code><code class="o">,</code> <code class="n">String</code> <code class="n">email</code><code class="o">)</code> <code class="o">{}</code>&#13;
&#13;
<code class="n">jshell</code><code class="o">&gt;</code> <code class="n">var</code> <code class="n">p</code> <code class="o">=</code> <code class="k">new</code> <code class="n">Person</code><code class="o">(</code><code class="s">"Covington Roderick Smythe"</code><code class="o">,</code> <code class="s">"roddy@smythe.tld"</code><code class="o">)</code>&#13;
<code class="n">p</code> <code class="o">==&gt;</code> <code class="n">Person</code><code class="o">[</code><code class="n">name</code><code class="o">=</code><code class="n">Covington</code> <code class="n">Roderick</code> <code class="n">Smythe</code><code class="o">,</code> <code class="n">email</code><code class="o">=</code><code class="n">roddy</code><code class="nd">@smythe.tld</code><code class="o">]</code>&#13;
&#13;
<code class="n">jshell</code><code class="o">&gt;</code> <code class="n">p</code><code class="o">.</code><code class="na">name</code><code class="o">()</code>&#13;
<code class="n">$3</code> <code class="o">==&gt;</code> <code class="s">"Covington Roderick Smythe"</code>&#13;
&#13;
<code class="n">jshell</code><code class="o">&gt;</code></pre>&#13;
&#13;
<p>One-line record definitions typically don’t need to be in a source file all their own. To show a complete example, I baked the <code>Person</code> record into a new demo program <code>PersonRecordDemo</code>.&#13;
We can save this into a file, compile it with <em>javac</em>, and then use <em>javap</em> to view the class’s structure:</p>&#13;
&#13;
<pre data-type="programlisting">$ javac --enable-preview -source 14 PersonRecordDemo.java&#13;
Note: PersonRecordDemo.java uses preview language features.&#13;
Note: Recompile with -Xlint:preview for details.&#13;
$ javap PersonRecordDemo'$'Person&#13;
Compiled from "PersonRecordDemo.java"&#13;
public final class PersonRecordDemo$Person extends java.lang.Record {&#13;
  public PersonRecordDemo$Person(java.lang.String, java.lang.String);&#13;
  public java.lang.String toString();&#13;
  public final int hashCode();&#13;
  public final boolean equals(java.lang.Object);&#13;
  public java.lang.String name();&#13;
  public java.lang.String email();&#13;
}</pre>&#13;
&#13;
<p>The <em>$</em> in the filename has to be escaped from the Unix shell.&#13;
We see that the compiler has generated the constructor, <a data-primary="hashCode() method" data-type="indexterm" id="idm45290665423176"/><a data-primary="equals() method" data-type="indexterm" id="idm45290665422472"/><code>toString()</code>, <code>hashCode()</code> and <code>equals()</code>, and&#13;
read-only accessors <code>name()</code> and <a data-primary="email() method" data-type="indexterm" id="idm45290665420104"/><a data-primary="name() method" data-type="indexterm" id="idm45290665419368"/><code>email()</code>.</p>&#13;
<div data-type="warning" epub:type="warning"><h6>Warning</h6>&#13;
<p>As of <a data-primary="Java 14 record" data-type="indexterm" id="idm45290665417176"/>Java 14 the <code>record</code> mechanism is a preview, so&#13;
it may change from what is described here or might even (however unlikely) not appear in the final Java 14&#13;
or in a future Java release (though we hope it will appear as is, nonpreview, in Java 15).&#13;
If you are using Java 14 you need the <code>--enable-preview</code> option on&#13;
commands like <a data-primary="javap command" data-type="indexterm" id="idm45290665415192"/><a data-primary="javac command" data-type="indexterm" id="idm45290665414488"/><a data-primary="JShell" data-secondary="command" data-type="indexterm" id="idm45290665413816"/><em>javap</em>, <em>javac</em>, and <em>jshell</em>, as well as <code>--source 14</code> on&#13;
commands that read the source file.</p>&#13;
</div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="See Also" data-type="sect2"><div class="sect2" id="idm45290665410968">&#13;
<h2>See Also</h2>&#13;
&#13;
<p>The original description of and rationale for the <code>record</code> mechanism is in <a href="https://openjdk.java.net/jeps/359">Java Enhancement Proposal JEP-359</a> at OpenJDK.net.<a data-primary="" data-startref="ds_sdo" data-type="indexterm" id="idm45290665408472"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="7.19 Program: Timing Comparisons" data-type="sect1"><div class="sect1" id="javacook-structure-SECT-17">&#13;
<h1>7.19 Program: Timing Comparisons</h1>&#13;
&#13;
<p><a data-primary="Timing Comparisons program" data-type="indexterm" id="tcp_ab"/><a data-primary="ArrayList" data-type="indexterm" id="al_a"/><a data-primary="data structures" data-secondary="Timing Comparisons program" data-type="indexterm" id="ds_tcp"/>New developers sometimes worry about the overhead of these collections and think they should use arrays instead of data structures. To investigate, I wrote a program that creates and accesses 250,000 objects, once through a Java array and again through an <code>ArrayList</code>. This is a lot more objects than most programs use. First the code for the <code>Array</code> version:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">Array</code> <code class="o">{</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kd">final</code> <code class="kt">int</code> <code class="n">MAX</code> <code class="o">=</code> <code class="mi">250000</code><code class="o">;</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">args</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="k">new</code> <code class="n">Array</code><code class="o">().</code><code class="na">run</code><code class="o">());</code>&#13;
    <code class="o">}</code>&#13;
    <code class="kd">public</code> <code class="kt">int</code> <code class="nf">run</code><code class="o">()</code> <code class="o">{</code>&#13;
        <code class="n">MutableInteger</code> <code class="n">list</code><code class="o">[]</code> <code class="o">=</code> <code class="k">new</code> <code class="n">MutableInteger</code><code class="o">[</code><code class="n">MAX</code><code class="o">];</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">i</code><code class="o">=</code><code class="mi">0</code><code class="o">;</code> <code class="n">i</code><code class="o">&lt;</code><code class="n">list</code><code class="o">.</code><code class="na">length</code><code class="o">;</code> <code class="n">i</code><code class="o">++)</code> <code class="o">{</code>&#13;
            <code class="n">list</code><code class="o">[</code><code class="n">i</code><code class="o">]</code> <code class="o">=</code> <code class="k">new</code> <code class="n">MutableInteger</code><code class="o">(</code><code class="n">i</code><code class="o">);</code>&#13;
        <code class="o">}</code>&#13;
        <code class="kt">int</code> <code class="n">sum</code> <code class="o">=</code> <code class="mi">0</code><code class="o">;</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">i</code><code class="o">=</code><code class="mi">0</code><code class="o">;</code> <code class="n">i</code><code class="o">&lt;</code><code class="n">list</code><code class="o">.</code><code class="na">length</code><code class="o">;</code> <code class="n">i</code><code class="o">++)</code> <code class="o">{</code>&#13;
            <code class="n">sum</code> <code class="o">+=</code> <code class="n">list</code><code class="o">[</code><code class="n">i</code><code class="o">].</code><code class="na">getValue</code><code class="o">();</code>&#13;
        <code class="o">}</code>&#13;
        <code class="k">return</code> <code class="n">sum</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p>And here’s the code for the <code>ArrayList</code> version:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">ArrayLst</code> <code class="o">{</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kd">final</code> <code class="kt">int</code> <code class="n">MAX</code> <code class="o">=</code> <code class="mi">250000</code><code class="o">;</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">args</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="k">new</code> <code class="n">ArrayLst</code><code class="o">().</code><code class="na">run</code><code class="o">());</code>&#13;
    <code class="o">}</code>&#13;
    <code class="kd">public</code> <code class="kt">int</code> <code class="nf">run</code><code class="o">()</code> <code class="o">{</code>&#13;
        <code class="n">ArrayList</code><code class="o">&lt;</code><code class="n">MutableInteger</code><code class="o">&gt;</code> <code class="n">list</code> <code class="o">=</code> <code class="k">new</code> <code class="n">ArrayList</code><code class="o">&lt;&gt;();</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">i</code><code class="o">=</code><code class="mi">0</code><code class="o">;</code> <code class="n">i</code><code class="o">&lt;</code><code class="n">MAX</code><code class="o">;</code> <code class="n">i</code><code class="o">++)</code> <code class="o">{</code>&#13;
            <code class="n">list</code><code class="o">.</code><code class="na">add</code><code class="o">(</code><code class="k">new</code> <code class="n">MutableInteger</code><code class="o">(</code><code class="n">i</code><code class="o">));</code>&#13;
        <code class="o">}</code>&#13;
        <code class="kt">int</code> <code class="n">sum</code> <code class="o">=</code> <code class="mi">0</code><code class="o">;</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="kt">int</code> <code class="n">i</code><code class="o">=</code><code class="mi">0</code><code class="o">;</code> <code class="n">i</code><code class="o">&lt;</code><code class="n">MAX</code><code class="o">;</code> <code class="n">i</code><code class="o">++)</code> <code class="o">{</code>&#13;
            <code class="n">sum</code> <code class="o">+=</code> <code class="o">((</code><code class="n">MutableInteger</code><code class="o">)</code><code class="n">list</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code class="n">i</code><code class="o">)).</code><code class="na">getValue</code><code class="o">();</code>&#13;
        <code class="o">}</code>&#13;
        <code class="k">return</code> <code class="n">sum</code><code class="o">;</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p>The <code>Vector</code>-based version, <code>ArrayVec</code>, is sufficiently similar that I don’t feel the need to kill a tree reprinting its code—it’s online.</p>&#13;
&#13;
<p>How can we time this? As covered in <a data-type="xref" href="ch17.html#javacook-reflection-SECT-5">Recipe 17.7</a>, you can either use the operating system’s <em>time</em> command, if available, or just use a bit of Java that times a run of your main program. To be portable, I chose to use the latter on an older, slower machine. Its exact speed doesn’t matter because the important thing is to compare only versions of this program running on the same machine.</p>&#13;
&#13;
<p>Finally (drum roll, please), the results:</p>&#13;
<pre data-type="programlisting" id="I_7_tt270">$ <strong>java performance.Time Array </strong>&#13;
Starting class class Array&#13;
1185103928&#13;
runTime=4.310&#13;
$ <strong>java performance.Time ArrayLst</strong>&#13;
Starting class class ArrayLst&#13;
1185103928&#13;
runTime=5.626&#13;
$ <strong>java performance.Time ArrayVec</strong>&#13;
Starting class class ArrayVec&#13;
1185103928&#13;
runTime=6.699&#13;
$</pre>&#13;
&#13;
<p>Notice that I have ignored one oft-quoted bit of advice that recommends giving a good initial estimate on the size of the <code>ArrayList</code>. I did time it that way as well; in this example, it made a difference of less than 4% in the total runtime.</p>&#13;
&#13;
<p>The bottom line is that the efficiency of <code>ArrayList</code> is not totally awful compared to arrays. Obviously there is more overhead in calling a “get” method than in retrieving an element from an array. The overhead of objects whose methods actually do some computation probably outweighs the overhead of fetching and storing objects in an <code>ArrayList</code> rather than in an <code>Array</code>. Unless you are dealing with large numbers of objects, you may not need to worry about it. <code>Vector</code> is slightly slower but still only about two-thirds the speed of the original array version. If you are concerned about the time, once the finished size of the <code>ArrayList</code> is known, you can convert the <code>ArrayList</code> to an array (see <a data-type="xref" href="#javacook-structure-SECT-12">Recipe 7.14</a>).<a data-primary="" data-startref="al_a" data-type="indexterm" id="idm45290665083112"/><a data-primary="" data-startref="ds_tcp" data-type="indexterm" id="idm45290665082136"/><a data-primary="" data-startref="ds_ch" data-type="indexterm" id="idm45290665081192"/><a data-primary="" data-startref="tcp_ab" data-type="indexterm" id="idm45290665080248"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<div data-type="footnotes"><p data-type="footnote" id="idm45290673293208"><sup><a href="ch07.html#idm45290673293208-marker">1</a></sup> You could copy it yourself using a <code>for</code> loop if you wish, but <code>System.arrayCopy()</code> is likely to be faster because it’s implemented in native code.</p><p data-type="footnote" id="idm45290671381032"><sup><a href="ch07.html#idm45290671381032-marker">2</a></sup> Both <code>List</code> and <code>Set</code> extend <code>Collection</code>.</p></div></div></section></body></html>