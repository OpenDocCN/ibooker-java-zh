<html><head></head><body><section data-pdf-bookmark="Chapter 2. Interacting with the Environment" data-type="chapter" epub:type="chapter"><div class="chapter" id="javacook-environ">&#13;
<h1><span class="label">Chapter 2. </span>Interacting with the Environment</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="2.0 Introduction" data-type="sect1"><div class="sect1" id="javacook-environ-intro">&#13;
<h1>2.0 Introduction</h1>&#13;
&#13;
<p><a data-primary="runtime environment" data-type="indexterm" id="re_ch"/>This chapter describes how your Java program can deal with its immediate surroundings with what we call the runtime environment. In one sense, everything you do in a Java program using almost any Java API involves the environment. Here we focus more narrowly on things that directly surround your program. Along the way we’ll be introduced to the<a data-primary="System class" data-type="indexterm" id="idm45290706728408"/> <code>System</code> class, which knows a lot about your particular system.</p>&#13;
&#13;
<p>Two other runtime classes deserve brief mention. The&#13;
first,<a data-primary="java.lang.Runtime class" data-type="indexterm" id="idm45290706726488"/> <code>java.lang.Runtime</code>, lies behind many of the methods in the <code>System</code>&#13;
class. <a data-primary="System.exit() method" data-type="indexterm" id="idm45290706724760"/><code>System.exit()</code>, for example, just calls<a data-primary="Runtime.exit() method" data-type="indexterm" id="idm45290706723640"/> <code>Runtime.exit()</code>. <code>Runtime</code>&#13;
is technically part of the environment, but the only time we use it&#13;
directly is to run other programs, which is covered in&#13;
<a data-type="xref" href="ch18.html#javacook-otherlang-SECT-1">Recipe 18.1</a>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="2.1 Getting Environment Variables" data-type="sect1"><div class="sect1" id="javacook-environ-SECT-1">&#13;
<h1>2.1 Getting Environment Variables</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-environ-SECT-1.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="runtime environment" data-secondary="environment variables, acquiring" data-type="indexterm" id="idm45290706717880"/><a data-primary="environment variables" data-type="indexterm" id="idm45290706716888"/>You want to get the value of environment variables from within your Java program.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-environ-SECT-1.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use <code>System.getenv()</code>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-environ-SECT-1.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>The seventh edition of Unix, released in 1979, had a new feature known as environment&#13;
variables. Environment variables are in all modern Unix systems (including macOS) and&#13;
in most later  command-line systems, such as the DOS or Command Prompt in Windows, but they are&#13;
not in some older platforms or other Java runtimes. Environment variables are commonly&#13;
used for customizing an individual computer user’s runtime environment, hence the name. To&#13;
take one familiar example, on Unix or DOS the environment variable <code>PATH</code> determines where&#13;
the system looks for executable programs. So, of course people want to know how they access environment variables from their Java program.</p>&#13;
&#13;
<p>The answer is that you can do this in all modern versions of Java, but you should exercise&#13;
caution in depending on being able to specify environment variables because some rare operating&#13;
systems may not provide them. That said, it’s unlikely you’ll run into such a system because all&#13;
“standard” desktop systems provide them at present.</p>&#13;
&#13;
<p>In some ancient versions of Java,<a data-primary="System.getenv() method" data-type="indexterm" id="idm45290706708968"/> <code>System.getenv()</code> was deprecated and/or just didn’t work. Nowadays the<a data-primary="getenv() method" data-type="indexterm" id="idm45290706707720"/> <code>getenv()</code> method is no longer deprecated, though it still carries the warning that system properties (see <a data-type="xref" href="#javacook-environ-SECT-2">Recipe 2.2</a>) should be used instead. Even among systems that support environment variables, their names are case sensitive on some platforms and case insensitive on others. The code in <a data-type="xref" href="#javacook-environ-EX-1">Example 2-1</a> is a short program that uses the <code>getenv()</code> method.</p>&#13;
<div data-type="example" id="javacook-environ-EX-1">&#13;
<h5><span class="label">Example 2-1. </span>main/src/main/java/environ/GetEnv.java</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">GetEnv</code> <code class="o">{</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">argv</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"System.getenv(\"PATH\") = "</code> <code class="o">+</code> <code class="n">System</code><code class="o">.</code><code class="na">getenv</code><code class="o">(</code><code class="s">"PATH"</code><code class="o">));</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre></div>&#13;
&#13;
<p>Running this code will produce output similar to the following:</p>&#13;
<pre data-type="programlisting" id="I_2_tt46">C:\javasrc&gt;<strong>java environ.GetEnv</strong>&#13;
System.getenv("PATH") = C:\windows\bin;c:\jdk1.8\bin;c:\documents&#13;
    and settings\ian\bin&#13;
C:\javasrc&gt;</pre>&#13;
&#13;
<p>The no-argument form of the method <code>System.getenv()</code> returns <em>all</em> the environment&#13;
variables in the form of an immutable <code>String Map</code>. You can iterate through this map&#13;
and access all the user’s settings or retrieve multiple environment settings.</p>&#13;
&#13;
<p>Both forms of <code>getenv()</code> require you to have permissions to access the environment, so they typically do not work in restricted environments such as applets.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="2.2 Getting Information from System Properties" data-type="sect1"><div class="sect1" id="javacook-environ-SECT-2">&#13;
<h1>2.2 Getting Information from System Properties</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-environ-SECT-2.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="runtime environment" data-secondary="system properties, acquiring" data-type="indexterm" id="runenv_sp"/><a data-primary="system properties, getting information from" data-type="indexterm" id="sp_gi"/>You need to get information from the system properties.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-environ-SECT-2.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p><a data-primary="System.getProperties() method" data-type="indexterm" id="idm45290706662328"/><a data-primary="System.getProperty() method" data-type="indexterm" id="idm45290706661656"/>Use <code>System.getProperty()</code> or <code>System.getProperties()</code>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-environ-SECT-2.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>What is a <em>property</em> anyway? A <a data-primary="properties" data-type="indexterm" id="idm45290706657224"/>property is just a name and value pair stored in a <code>java.util.Properties</code> object, which we discuss more fully in <a data-type="xref" href="ch07.html#javacook-structure-SECT-7">Recipe 7.10</a>.</p>&#13;
&#13;
<p>The <code>System.Properties</code> object controls and describes the Java runtime. The <code>System</code> class has a static <code>Properties</code> member whose content is the merger of operating system specifics (<code>os.name</code>, for example), system and user tailoring (<code>java.class.path</code>), and properties defined on the command line (as we’ll see in a moment). Note that the use of periods in these names (like <code>os.arch</code>, <code>os.version</code>, <code>java.class.path</code>, and <code>java.lang.version</code>) makes it look as though there is a hierarchical relationship similar to that for package/class names. The <a data-primary="Properties class" data-type="indexterm" id="idm45290706649960"/><code>Properties</code> class, however, imposes no such relationships: each key is just a string, and dots are not special.</p>&#13;
&#13;
<p>To view all the defined system properties, you can iterate through the output of calling <code>System.getProperties()</code>&#13;
as in <a data-type="xref" href="#javacook-getstarted-EX-42">Example 2-2</a>.</p>&#13;
<div data-type="example" id="javacook-getstarted-EX-42">&#13;
<h5><span class="label">Example 2-2. </span>jshell System.getProperties()</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">jshell</code><code class="o">&gt;</code> <code class="n">System</code><code class="o">.</code><code class="na">getProperties</code><code class="o">().</code><code class="na">forEach</code><code class="o">((</code><code class="n">k</code><code class="o">,</code><code class="n">v</code><code class="o">)</code> <code class="o">-&gt;</code> <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">k</code> <code class="o">+</code> <code class="s">"-&gt;"</code> <code class="o">+</code><code class="n">v</code><code class="o">))</code>&#13;
<code class="n">awt</code><code class="o">.</code><code class="na">toolkit</code><code class="o">-&gt;</code><code class="n">sun</code><code class="o">.</code><code class="na">awt</code><code class="o">.</code><code class="na">X11</code><code class="o">.</code><code class="na">XToolkit</code>&#13;
<code class="n">java</code><code class="o">.</code><code class="na">specification</code><code class="o">.</code><code class="na">version</code><code class="o">-&gt;</code><code class="mi">11</code>&#13;
<code class="n">sun</code><code class="o">.</code><code class="na">cpu</code><code class="o">.</code><code class="na">isalist</code><code class="o">-&gt;</code>&#13;
<code class="n">sun</code><code class="o">.</code><code class="na">jnu</code><code class="o">.</code><code class="na">encoding</code><code class="o">-&gt;</code><code class="n">UTF</code><code class="o">-</code><code class="mi">8</code>&#13;
<code class="n">java</code><code class="o">.</code><code class="na">class</code><code class="o">.</code><code class="na">path</code><code class="o">-&gt;.</code>&#13;
<code class="n">java</code><code class="o">.</code><code class="na">vm</code><code class="o">.</code><code class="na">vendor</code><code class="o">-&gt;</code><code class="n">Oracle</code> <code class="n">Corporation</code>&#13;
<code class="n">sun</code><code class="o">.</code><code class="na">arch</code><code class="o">.</code><code class="na">data</code><code class="o">.</code><code class="na">model</code><code class="o">-&gt;</code><code class="mi">64</code>&#13;
<code class="n">java</code><code class="o">.</code><code class="na">vendor</code><code class="o">.</code><code class="na">url</code><code class="o">-&gt;</code><code class="nl">http:</code><code class="c1">//java.oracle.com/</code>&#13;
<code class="n">user</code><code class="o">.</code><code class="na">timezone</code><code class="o">-&gt;</code>&#13;
<code class="n">os</code><code class="o">.</code><code class="na">name</code><code class="o">-&gt;</code><code class="n">OpenBSD</code>&#13;
<code class="n">java</code><code class="o">.</code><code class="na">vm</code><code class="o">.</code><code class="na">specification</code><code class="o">.</code><code class="na">version</code><code class="o">-&gt;</code><code class="mi">11</code>&#13;
<code class="o">...</code> <code class="n">many</code> <code class="n">more</code> <code class="o">...</code>&#13;
<code class="n">jshell</code><code class="o">&gt;</code></pre></div>&#13;
&#13;
<p>Remember that properties whose names begin with “sun” are unsupported and subject to change.</p>&#13;
&#13;
<p>To retrieve one system-provided property, use <code>System.getProperty(propName)</code>.&#13;
If I just wanted to find out if the <code>System Properties</code> had a property named <code>"pencil_color"</code>, I could say:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting">        <code class="n">String</code> <code class="n">sysColor</code> <code class="o">=</code> <code class="n">System</code><code class="o">.</code><code class="na">getProperty</code><code class="o">(</code><code class="s">"pencil_color"</code><code class="o">);</code></pre>&#13;
&#13;
<p>But what does that return? Surely Java isn’t clever enough to know about everybody’s&#13;
favorite pencil color? Right you are! But we can easily tell Java about our pencil color&#13;
(or anything else we want to tell it) using the <code>-D</code>  argument.</p>&#13;
&#13;
<p>When starting a Java runtime, you can define a value in the system properties object using a <code>-D</code> option.&#13;
Its argument must have a name, an equals sign, and a value, which are parsed the same way as in a properties file (see <a data-type="xref" href="ch07.html#javacook-structure-SECT-7">Recipe 7.10</a>). You can have more than one <code>-D</code> definition between the <code>java</code> command and your class name on the command line. At the Unix or Windows command line, type:</p>&#13;
<pre data-type="programlisting" id="I_2_tt49"><strong>java -D"pencil_color=Deep Sea Green" environ.SysPropDemo</strong></pre>&#13;
&#13;
<p>When running this under an IDE, put the variable’s name and value in the appropriate dialog box, for example, in <a data-primary="Eclipse" data-secondary="Run Configuration dialog" data-type="indexterm" id="idm45290706498200"/>Eclipse’s Run Configuration dialog under Program Arguments.&#13;
You can also set environment variables and system properties using the build tools&#13;
(Maven, Gradle, etc.).</p>&#13;
&#13;
<p>The <code>SysPropDemo</code> program has code to extract just one or a few properties, so you can run it like this:</p>&#13;
<pre data-type="programlisting" id="I_2_tt52">$ <strong>java environ.SysPropDemo os.arch</strong>&#13;
os.arch = x86</pre>&#13;
&#13;
<p>If you invoke the <code>SysPropDemo</code> program with no arguments, it outputs the same information&#13;
as the <code>jshell</code> fragment in <a data-type="xref" href="#javacook-getstarted-EX-42">Example 2-2</a>.</p>&#13;
&#13;
<p>Which reminds me—this is a good time to mention system-dependent code. <a data-type="xref" href="#javacook-environ-SECT-4">Recipe 2.3</a> talks about OS-dependent code and release-dependent code.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="See Also" data-type="sect2"><div class="sect2" id="javacook-environ-SECT-2.4">&#13;
<h2>See Also</h2>&#13;
&#13;
<p><a data-type="xref" href="ch07.html#javacook-structure-SECT-7">Recipe 7.10</a> lists more details on using and naming your own <code>Properties</code> files. The javadoc page for <code>java.util.Properties</code> lists the exact rules used in the <a data-primary="load() method" data-type="indexterm" id="idm45290706485560"/><code>load()</code> method, as well as other details.<a data-primary="" data-startref="runenv_sp" data-type="indexterm" id="idm45290706484424"/><a data-primary="" data-startref="sp_gi" data-type="indexterm" id="idm45290706483448"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="2.3 Dealing with Code That Depends on the Java Version or the Operating System" data-type="sect1"><div class="sect1" id="javacook-environ-SECT-4">&#13;
<h1>2.3 Dealing with Code That Depends on the Java Version or the Operating System</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-environ-SECT-4.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="Java" data-secondary="versions of" data-type="indexterm" id="java_ver"/><a data-primary="operating systems" data-type="indexterm" id="os_ver"/><a data-primary="runtime environment" data-secondary="JDK version, finding" data-type="indexterm" id="runenv_ver"/>You need to write code that adapts to the underlying operating system.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-environ-SECT-4.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>You can use<a data-primary="System.properties" data-type="indexterm" id="idm45290706453576"/> <code>System.Properties</code> to find out the Java version and the operating system,&#13;
various features in the <code>File</code> class to find out some platform-dependent features,&#13;
and <code>java.awt.TaskBar</code> to see if you can use the system-dependent Taskbar or Dock.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-environ-SECT-4.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>Some things depend on the version of Java you are running.&#13;
Use <a data-primary="System.getProperty() method" data-type="indexterm" id="idm45290706448840"/><code>System.getProperty()</code> with an argument of <code>java.specification.version</code>.</p>&#13;
&#13;
<p>Alternatively, and with greater generality, you may want to test for the presence or absence of particular classes. One way to do this is with <code>Class.forName("class")</code> (see <a data-type="xref" href="ch17.html#javacook-reflection">Chapter 17</a>), which throws an exception if the class cannot be loaded—a good indication that it’s not present in the runtime’s library. <a data-type="xref" href="#example02checkswing">Example 2-3</a> shows code for this, from an application wanting to find out whether the common Swing UI components are&#13;
available. The javadoc for the standard classes reports the version of the JDK in which this class first appeared, under the heading “Since.” If there is no such heading, it normally means that the class has been present since the beginnings of Java:</p>&#13;
<div data-type="example" id="example02checkswing">&#13;
<h5><span class="label">Example 2-3. </span><em>main/src/main/java/starting/CheckForSwing.java</em></h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">CheckForSwing</code> <code class="o">{</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">args</code><code class="o">)</code> <code class="o">{</code>&#13;
        <code class="k">try</code> <code class="o">{</code>&#13;
            <code class="n">Class</code><code class="o">.</code><code class="na">forName</code><code class="o">(</code><code class="s">"javax.swing.JButton"</code><code class="o">);</code>&#13;
        <code class="o">}</code> <code class="k">catch</code> <code class="o">(</code><code class="n">ClassNotFoundException</code> <code class="n">e</code><code class="o">)</code> <code class="o">{</code>&#13;
            <code class="n">String</code> <code class="n">failure</code> <code class="o">=</code>&#13;
                <code class="s">"Sorry, but this version of MyApp needs \n"</code> <code class="o">+</code>&#13;
                <code class="s">"a Java Runtime with JFC/Swing components\n"</code> <code class="o">+</code>&#13;
                <code class="s">"having the final names (javax.swing.*)"</code><code class="o">;</code>&#13;
            <code class="c1">// Better to make something appear in the GUI. Either a</code>&#13;
            <code class="c1">// JOptionPane, or: myPanel.add(new Label(failure));</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">err</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">failure</code><code class="o">);</code>&#13;
        <code class="o">}</code>&#13;
        <code class="c1">// No need to print anything here - the GUI should work...</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre></div>&#13;
&#13;
<p>It’s important to distinguish between testing this code at compile time and at runtime. In both cases, it must be compiled on a system that includes the classes you are testing for: JDK &gt;= 1.1 and Swing, respectively. These tests are only attempts to help the poor backwater Java runtime user trying to run your up-to-date application. The goal is to provide this user with a message more meaningful than the simple “class not found” error that the runtime gives. It’s also important to note that this test becomes unreachable if you write it inside any code that depends on the code you are testing.&#13;
Put the test early in the main flow of your application, before any GUI objects are constructed. Otherwise the code just sits there wasting space on newer runtimes and never gets run on Java systems that don’t include Swing. Obviously this is a very early example, but you can use the same technique to test for any runtime feature added at any stage of Java’s evolution (see <a data-type="xref" href="app01.html#javacook-then_now">Appendix A</a> for an outline of the features added in each release of Java). You can also use this technique to determine whether a needed third-party library has been successfully added to your CLASSPATH.</p>&#13;
&#13;
<p>Also, although Java is designed to be portable, some things aren’t. These include&#13;
such variables as the filename separator. Everybody on Unix knows that the&#13;
<a data-primary="/ (filename separator)" data-type="indexterm" id="idm45290706310600"/><a data-primary="filename separator (/)" data-type="indexterm" id="idm45290706309992"/>filename separator is a slash character (/) and that a backward slash, or&#13;
backslash (\), is an <a data-primary="escape character (\)" data-type="indexterm" id="idm45290706309144"/><a data-primary="\ (escape character)" data-type="indexterm" id="idm45290706308472"/>escape character. Back in the late 1970s, a group at&#13;
Microsoft was actually working on Unix—their version was called&#13;
<a data-primary="Xenix" data-type="indexterm" id="idm45290706307544"/>Xenix, later taken over by SCO—and the people working on DOS saw and liked&#13;
the Unix filesystem model. The earliest versions of MS-DOS didn’t have&#13;
directories; it just had user numbers like the system it was a clone of,&#13;
Digital Research CP/M (itself a clone of various other systems). So the&#13;
Microsoft developers set out to clone the Unix filesystem organization.&#13;
Unfortunately, MS-DOS had already committed the slash character for use as an&#13;
option delimiter, for which Unix had used a <a data-primary="- (dash)" data-type="indexterm" id="idm45290706306232"/>dash (<code>-</code>); and the  <a data-primary=": (PATH separator)" data-type="indexterm" id="idm45290706305016"/><a data-primary="PATH separator (:)" data-type="indexterm" id="idm45290706304280"/><code>PATH</code>&#13;
separator (:) was also used as a drive letter delimiter, as in <code>C</code>: or&#13;
<code>A</code>:. So we now have commands like those shown&#13;
in<a data-primary="DOS directory list command" data-type="indexterm" id="idm45290706302296"/><a data-primary="directories" data-secondary="listing" data-type="indexterm" id="idm45290706301624"/><a data-primary="Unix" data-secondary="directory list command" data-type="indexterm" id="idm45290706300680"/> <a data-type="xref" href="#javacook-environ-dirPaths">Table 2-1</a>.</p>&#13;
<table id="javacook-environ-dirPaths">&#13;
<caption><span class="label">Table 2-1. </span>Directory listing commands</caption>&#13;
<thead>&#13;
<tr>&#13;
<th>System</th>&#13;
<th>Directory list command</th>&#13;
<th>Meaning</th>&#13;
<th>Example PATH setting</th>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td><p>Unix</p></td>&#13;
<td><p><em>ls -R /</em></p></td>&#13;
<td><p>Recursive listing of /, the top-level directory</p></td>&#13;
<td><p><em>PATH=/bin:/usr/bin</em></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>DOS</p></td>&#13;
<td><p><em>dir/s \</em></p></td>&#13;
<td><p>Directory with subdirectories option (i.e., recursive) of \, the top-level directory (but only of the current drive)</p></td>&#13;
<td><p><em>PATH=C:\windows;D:\mybin</em></p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
&#13;
<p>Where does this get us? If we are going to generate filenames in Java, we may need to know whether to put a / or a \ or some other character. Java has two solutions to this. First, when moving between Unix and Microsoft systems, at least, it is <em>permissive</em>: either / or \ can be used,<sup><a data-type="noteref" href="ch02.html#idm45290706287432" id="idm45290706287432-marker">1</a></sup> and the code that deals with the operating system sorts it out. Second, and more generally, Java makes the platform-specific information available in a platform-independent way. For the file separator (and also the <code>PATH</code> separator), the <a data-primary="java.io.File class" data-type="indexterm" id="idm45290706285496"/><code>java.io.File</code> class makes available some static variables containing this information. Because the <a data-primary="File class" data-type="indexterm" id="idm45290706284376"/><code>File</code>  class manages platform-dependent information, it makes sense to anchor this information here. The variables are shown in <a data-type="xref" href="#javacook-environ-filesepstuff">Table 2-2</a>.<a data-primary="files" data-secondary="properties of" data-type="indexterm" id="idm45290706282248"/><a data-primary="pathSeparator property" data-type="indexterm" id="idm45290706281272"/><a data-primary="pathSeparatorChar property" data-type="indexterm" id="idm45290706280600"/><a data-primary="separator property" data-type="indexterm" id="idm45290706279912"/><a data-primary="separatorChar property" data-type="indexterm" id="idm45290706279240"/></p>&#13;
<table id="javacook-environ-filesepstuff">&#13;
<caption><span class="label">Table 2-2. </span><span class="label">Table 2-2. </span>File properties</caption>&#13;
<thead>&#13;
<tr>&#13;
<th>Name</th>&#13;
<th>Type</th>&#13;
<th>Meaning</th>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td><p><code>separator</code></p></td>&#13;
<td><p><code>static String</code></p></td>&#13;
<td><p>The system-dependent filename separator character (e.g., / or \)</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>separatorChar</code></p></td>&#13;
<td><p><code>static char</code></p></td>&#13;
<td><p>The system-dependent filename separator character (e.g., / or \)</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>pathSeparator</code></p></td>&#13;
<td><p><code>static String</code></p></td>&#13;
<td><p>The system-dependent path separator character, represented as a string for convenience</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>pathSeparatorChar</code></p></td>&#13;
<td><p><code>static char</code></p></td>&#13;
<td><p>The system-dependent path separator character</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
&#13;
<p>Both filename and path separators are normally characters, but they are also available in <code>String</code> form for convenience.</p>&#13;
&#13;
<p>A second, more general, mechanism is the  <code>System</code><a data-primary="system properties object" data-type="indexterm" id="idm45290706262568"/> <code>Properties</code> object mentioned in <a data-type="xref" href="#javacook-environ-SECT-2">Recipe 2.2</a>. You can use this to determine the operating system you are running on. Here is code that simply lists the system properties; it can be informative to run this on several different implementations:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">SysPropDemo</code> <code class="o">{</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">argv</code><code class="o">)</code> <code class="kd">throws</code> <code class="n">IOException</code> <code class="o">{</code>&#13;
        <code class="k">if</code> <code class="o">(</code><code class="n">argv</code><code class="o">.</code><code class="na">length</code> <code class="o">==</code> <code class="mi">0</code><code class="o">)</code>&#13;
            <code class="c1">// tag::sysprops[]</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">getProperties</code><code class="o">().</code><code class="na">list</code><code class="o">(</code><code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">);</code>&#13;
            <code class="c1">// end::sysprops[]</code>&#13;
        <code class="k">else</code> <code class="o">{</code>&#13;
            <code class="k">for</code> <code class="o">(</code><code class="n">String</code> <code class="n">s</code> <code class="o">:</code> <code class="n">argv</code><code class="o">)</code> <code class="o">{</code>&#13;
                <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="n">s</code> <code class="o">+</code> <code class="s">" = "</code> <code class="o">+</code>&#13;
                    <code class="n">System</code><code class="o">.</code><code class="na">getProperty</code><code class="o">(</code><code class="n">s</code><code class="o">));</code>&#13;
            <code class="o">}</code>&#13;
        <code class="o">}</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p>Some OSes, for example, provide a mechanism called the null device that can be used to discard output (typically used for timing purposes). Here is code that asks the system properties for the <code>os.name</code> and uses it to make up a name that can be used for discarding data (if no null device is known for the given platform, we return the name <code>jnk</code>, which means that on such platforms, we’ll occasionally create, well, junk files; I just remove these files when I stumble across them):</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kn">package</code><code> </code><code class="n">com</code><code class="o">.</code><code class="na">darwinsys</code><code class="o">.</code><code class="na">lang</code><code class="o">;</code><code>&#13;
</code><code>&#13;
</code><code class="kn">import</code><code> </code><code class="nn">java.io.File</code><code class="o">;</code><code>&#13;
</code><code>&#13;
</code><code class="cm">/** Some things that are system-dependent.&#13;
 * All methods are static.&#13;
 * @author Ian Darwin&#13;
 */</code><code>&#13;
</code><code class="kd">public</code><code> </code><code class="kd">class</code><code> </code><code class="nc">SysDep</code><code> </code><code class="o">{</code><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="kd">final</code><code> </code><code class="kd">static</code><code> </code><code class="n">String</code><code> </code><code class="n">UNIX_NULL_DEV</code><code> </code><code class="o">=</code><code> </code><code class="s">"/dev/null"</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="kd">final</code><code> </code><code class="kd">static</code><code> </code><code class="n">String</code><code> </code><code class="n">WINDOWS_NULL_DEV</code><code> </code><code class="o">=</code><code> </code><code class="s">"NUL:"</code><code class="o">;</code><code>&#13;
</code><code>    </code><code class="kd">final</code><code> </code><code class="kd">static</code><code> </code><code class="n">String</code><code> </code><code class="n">FAKE_NULL_DEV</code><code> </code><code class="o">=</code><code> </code><code class="s">"jnk"</code><code class="o">;</code><code>&#13;
</code><code>&#13;
</code><code>    </code><code class="cm">/** Return the name of the null device on platforms which support it,&#13;
     * or "jnk" (to create an obviously well-named temp file) otherwise.&#13;
     * @return The name to use for output.&#13;
     */</code><code>&#13;
</code><code>    </code><code class="kd">public</code><code> </code><code class="kd">static</code><code> </code><code class="n">String</code><code> </code><code class="nf">getDevNull</code><code class="o">(</code><code class="o">)</code><code> </code><code class="o">{</code><code>&#13;
</code><code>&#13;
</code><code>        </code><code class="k">if</code><code> </code><code class="o">(</code><code class="k">new</code><code> </code><code class="n">File</code><code class="o">(</code><code class="n">UNIX_NULL_DEV</code><code class="o">)</code><code class="o">.</code><code class="na">exists</code><code class="o">(</code><code class="o">)</code><code class="o">)</code><code> </code><code class="o">{</code><code>     </code><a class="co" href="#callout_interacting_with_the_environment_CO1-1" id="co_interacting_with_the_environment_CO1-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
</code><code>            </code><code class="k">return</code><code> </code><code class="n">UNIX_NULL_DEV</code><code class="o">;</code><code>&#13;
</code><code>        </code><code class="o">}</code><code>&#13;
</code><code>&#13;
</code><code>        </code><code class="n">String</code><code> </code><code class="n">sys</code><code> </code><code class="o">=</code><code> </code><code class="n">System</code><code class="o">.</code><code class="na">getProperty</code><code class="o">(</code><code class="s">"os.name"</code><code class="o">)</code><code class="o">;</code><code> </code><a class="co" href="#callout_interacting_with_the_environment_CO1-2" id="co_interacting_with_the_environment_CO1-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
</code><code>        </code><code class="k">if</code><code> </code><code class="o">(</code><code class="n">sys</code><code class="o">=</code><code class="o">=</code><code class="kc">null</code><code class="o">)</code><code> </code><code class="o">{</code><code>                            </code><a class="co" href="#callout_interacting_with_the_environment_CO1-3" id="co_interacting_with_the_environment_CO1-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
</code><code>            </code><code class="k">return</code><code> </code><code class="n">FAKE_NULL_DEV</code><code class="o">;</code><code>&#13;
</code><code>        </code><code class="o">}</code><code>&#13;
</code><code>        </code><code class="k">if</code><code> </code><code class="o">(</code><code class="n">sys</code><code class="o">.</code><code class="na">startsWith</code><code class="o">(</code><code class="s">"Windows"</code><code class="o">)</code><code class="o">)</code><code> </code><code class="o">{</code><code>            </code><a class="co" href="#callout_interacting_with_the_environment_CO1-4" id="co_interacting_with_the_environment_CO1-4"><img alt="4" src="assets/4.png"/></a><code>&#13;
</code><code>            </code><code class="k">return</code><code> </code><code class="n">WINDOWS_NULL_DEV</code><code class="o">;</code><code>&#13;
</code><code>        </code><code class="o">}</code><code>&#13;
</code><code>        </code><code class="k">return</code><code> </code><code class="n">FAKE_NULL_DEV</code><code class="o">;</code><code>                       </code><a class="co" href="#callout_interacting_with_the_environment_CO1-5" id="co_interacting_with_the_environment_CO1-5"><img alt="5" src="assets/5.png"/></a><code>&#13;
</code><code>    </code><code class="o">}</code><code>&#13;
</code><code class="o">}</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_interacting_with_the_environment_CO1-1" id="callout_interacting_with_the_environment_CO1-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>If <code>/dev/null</code> exists, use it.</p></dd>&#13;
<dt><a class="co" href="#co_interacting_with_the_environment_CO1-2" id="callout_interacting_with_the_environment_CO1-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>If not, ask <code>System properties</code> if it knows the OS name.</p></dd>&#13;
<dt><a class="co" href="#co_interacting_with_the_environment_CO1-3" id="callout_interacting_with_the_environment_CO1-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>Nope, so give up, return <code>jnk</code>.</p></dd>&#13;
<dt><a class="co" href="#co_interacting_with_the_environment_CO1-4" id="callout_interacting_with_the_environment_CO1-4"><img alt="4" src="assets/4.png"/></a></dt>&#13;
<dd><p>We know it’s Microsoft Windows, so use <code>NUL:</code>.</p></dd>&#13;
<dt><a class="co" href="#co_interacting_with_the_environment_CO1-5" id="callout_interacting_with_the_environment_CO1-5"><img alt="5" src="assets/5.png"/></a></dt>&#13;
<dd><p>All else fails, go with <code>jnk</code>.</p></dd>&#13;
</dl>&#13;
&#13;
<p>Although Java’s Swing GUI aims to be portable, Apple’s implementation for macOS does not automatically do the right thing for everyone. For example, a <code>JMenuBar</code> menu container appears by default at the top of the application window. This is the norm on Windows and on most Unix platforms, but Mac users expect the menu bar for the active application to appear at the top of the screen. To enable normal behavior, you have to set the <code>System</code> property <code>apple.laf.useScreenMenuBar</code> to the value <code>true</code> before the Swing GUI starts up. You might want to set some other properties too, such as a short name for your application to appear in the menu bar (the default is the full class name of your main application class).</p>&#13;
&#13;
<p>There is an example of this in the book’s source code, at&#13;
<em>src/main/java/gui/MacOsUiHints.java</em>.</p>&#13;
&#13;
<p>There is probably no point in setting these properties unless you are, in&#13;
fact, being run under macOS. How do you tell? Apple’s recommended way&#13;
is to check for the system property <code>mrj.runtime</code> and, if so, assume&#13;
you are on macOS:</p>&#13;
&#13;
<pre data-type="programlisting">boolean isMacOS = System.getProperty("mrj.version") != null;&#13;
if (isMacOS) {&#13;
  System.setProperty("apple.laf.useScreenMenuBar",  "true");&#13;
  System.setProperty("com.apple.mrj.application.apple.menu.about.name",&#13;
  "My Super App");&#13;
}</pre>&#13;
&#13;
<p>On the other hand, these properties are likely harmless on non-Mac systems, so you&#13;
could just skip the test and set the two properties unconditionally.</p>&#13;
&#13;
<p>Finally, the Mac’s Dock or the Taskbar on most other systems can be accessed&#13;
using the <a data-primary="java.awtTaskbar class" data-type="indexterm" id="idm45290705933224"/><code>java.awt.Taskbar</code> class that was added in Java 9.&#13;
This is not discussed here, but there is an example <code>TaskbarDemo</code> in the <code>main/gui</code> subdirectory.<a data-primary="" data-startref="java_ver" data-type="indexterm" id="idm45290705931272"/><a data-primary="" data-startref="os-ver" data-type="indexterm" id="idm45290705930264"/><a data-primary="" data-startref="runenv_ver" data-type="indexterm" id="idm45290705988264"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="2.4 Using Extensions or Other Packaged APIs" data-type="sect1"><div class="sect1" id="javacook-environ-SECT-5">&#13;
<h1>2.4 Using Extensions or Other Packaged APIs</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="javacook-environ-SECT-5.1">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="extensions" data-type="indexterm" id="idm45290705941352"/><a data-primary="APIs, packaged" data-type="indexterm" id="idm45290705940760"/><a data-primary="packaged APIs" data-type="indexterm" id="idm45290705940088"/><a data-primary="runtime environment" data-secondary="extensions and" data-type="indexterm" id="idm45290705939416"/><a data-primary="runtime environment" data-secondary="packaged APIs and" data-type="indexterm" id="idm45290705997592"/>You have a JAR file of classes you want to use.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="javacook-environ-SECT-5.2">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Simply add the JAR file to your <a data-primary="CLASSPATH" data-secondary="JAR files, adding" data-type="indexterm" id="idm45290705994680"/><code>CLASSPATH</code>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="javacook-environ-SECT-5.3">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>As you build more sophisticated applications, you will need to use more and more third-party libraries. You can add these to your <code>CLASSPATH</code>.</p>&#13;
&#13;
<p>It used to be recommended that you&#13;
drop these JAR files into the Java Extensions mechanism directory, typically something like <em>\jdk1.x\jre\lib\ext</em>., instead of listing each JAR file in your <code>CLASSPATH</code> variable.&#13;
However, this is no longer generally recommended and is no longer available in the latest JDKs.&#13;
Instead, you may wish to use build tools&#13;
like Maven (see <a data-type="xref" href="ch01.html#javacook-getstarted-maven">Recipe 1.7</a>) or Gradle, as well as IDEs, to&#13;
automate the addition of JAR files to your <code>CLASSPATH</code>.</p>&#13;
&#13;
<p>One reason I’ve never been fond of using the extensions directory is that it&#13;
requires modifying the installed JDK or JRE, which can lead to maintenance&#13;
issues and problems when a new JDK or JRE is installed.</p>&#13;
&#13;
<p>Java 9 introduced a major change to Java, the Java 9 Modules system for&#13;
program modularization, which we discuss in <a data-type="xref" href="#javacook-environ-modules">Recipe 2.5</a>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="2.5 Using the Java Modules System" data-type="sect1"><div class="sect1" id="javacook-environ-modules">&#13;
<h1>2.5 Using the Java Modules System</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="idm45290705845016">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="Java Platform Module System (JPMS)" data-type="indexterm" id="jpms_a"/><a data-primary="JPMS (Java Platform Module System)" data-type="indexterm" id="jpmsjpms_a"/><a data-primary="runtime environment" data-secondary="Java Platform Module System (JPMS)" data-type="indexterm" id="runenv_jpms"/>You are using Java 9 or later, and need to deal with the Modules mechanism.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="idm45290706014648">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Read on.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="idm45290706013096">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>Java’s Modules system, formerly known as Project Jigsaw, was designed to handle&#13;
the need to build large applications out of many small pieces.&#13;
To an extent this problem had been solved by tools like Maven and Gradle, but&#13;
the Modules system solves a slightly different problem than those tools.&#13;
Maven or Gradle will find dependencies, download them, install them on your&#13;
development and test runtimes, and package them into runnable JAR files.&#13;
The Modules system is more concerned with the visbility of classes from one chunk of application code&#13;
to another, typically provided by different developers who may not know or trust each other.&#13;
As such, it is an admission that Java’s original set of access modifiers—such as <code>public</code>, <code>private</code>,&#13;
<code>protected</code>, and default visibility—was not sufficient for building large-scale applications.</p>&#13;
&#13;
<p>What follows is a brief discussion of using JPMS, the Java Platform Module System, to&#13;
import modules into your application.&#13;
There is an introduction to creating your own modules in <a data-type="xref" href="ch15.html#javacook-packages">Chapter 15</a>.&#13;
For a more detailed presentation, you should refer to a book-length treatment such as<a data-primary="Java 9 Modularity: Patterns and Practices for Developing Maintainable Applications (Mak and Bakker)" data-primary-sortas="Java 09 Modularity: Patterns and Practices for Developing Maintainable Applications (Mak and Bakker)" data-type="indexterm" id="idm45290705966472"/><a data-primary="Bakker, Paul" data-secondary="Java 9 Modularity: Patterns and Practices for Developing Maintainable Applications" data-type="indexterm" id="idm45290705965256"/><a data-primary="Mak, Sander" data-secondary="Java 9 Modularity: Patterns and Practices for Developing Maintainable Applications" data-type="indexterm" id="idm45290705964456"/>&#13;
<a href="http://shop.oreilly.com/product/0636920049494.do"><em>Java 9 Modularity: Patterns and Practices for Developing Maintainable Applications</em></a> by Sander Mak and Paul Bakker (O’Reilly).</p>&#13;
&#13;
<p>Java has always been a language for large-scale development.&#13;
<a data-primary="object orientation" data-type="indexterm" id="idm45290705983048"/>Object orientation is one of the keys: classes and objects group methods,&#13;
and access modifiers can be applied so that public and private methods are&#13;
clearly separated. When developing large applications, having just a single&#13;
flat namespace of classes is still not enough. Enter packages: they gather&#13;
classes into logical groups within their own namespace. Access control can&#13;
be applied at the package level as well so that some classes are only&#13;
accessible inside a package. Modules are the next logical step up. A&#13;
module groups some number of related packages, has a distinct name, and can&#13;
restrict access to some packages while exposing other packages to different&#13;
modules as public API.</p>&#13;
&#13;
<p>One thing to understand at the outset: JPMS is not a replacement for your existing build tool.&#13;
Whether you use Maven, Gradle, Ant, or just dump all needed JAR files into a lib directory,&#13;
you still need to do that.&#13;
Also, don’t confuse Maven’s modules with JPMS modules; the former is the physical structuring&#13;
of a project into subprojects, and the latter is something the Java platform (compiler, runtime) understands.&#13;
<span class="keep-together">Usually</span> when working with Java modules, each Java module will equate to a single Maven module.</p>&#13;
&#13;
<p>When you’re dealing with a tiny, self-contained program, you don’t need to be concerned with modules.&#13;
Just put all the necessary JAR files on your <code>CLASSPATH</code> at compile time and runtime,&#13;
and all will be well. Probably.</p>&#13;
&#13;
<p>You may see <a data-primary="warning messages" data-type="indexterm" id="idm45290705891064"/>warning messages like this along the way:</p>&#13;
<pre>Illegal reflective access by com.foo.Bar&#13;
    (file:/Users/ian/.m2/repository/com/foo/1.3.1/foo-1.3.1.jar)&#13;
    to field java.util.Properties.defaults&#13;
Please consider reporting this to the maintainers of com.foo.Bar&#13;
Use --illegal-access=warn to enable warnings of further&#13;
 illegal reflective access operations&#13;
All illegal access operations will be denied in a future release</pre>&#13;
&#13;
<p>The warning message comes about as a result of JPMS doing its job,&#13;
checking that no types are accessed in encapsulated packages within a module.&#13;
Such messages will go away over time as all public Java libraries and all apps being developed get <span class="keep-together">modularized.</span></p>&#13;
&#13;
<p>Why will all be well only “probably”? If you are using certain classes that were deprecated over the&#13;
last few releases, things won’t compile. For that, you must make the requisite modules available.&#13;
In the<a data-primary="unsafe subdirectory" data-type="indexterm" id="idm45290705977624"/> <em>unsafe</em> subdirectory (also a Maven module) under <code>javasrc</code>, there is a class called&#13;
<code>LoadAverage</code>. The <a data-primary="load average" data-type="indexterm" id="idm45290705992408"/>load average is a feature of <a data-primary="Unix" data-secondary="load average in" data-type="indexterm" id="idm45290705991544"/><a data-primary="Linux" data-type="indexterm" id="idm45290705990600"/>Unix/Linux systems that gives a rough measure of&#13;
system load or busyness, by reporting the number of processes that are waiting to be run. There are almost always more processes running than CPU cores to run them on, so some always have to wait.&#13;
Higher numbers mean a busier system with slower response.</p>&#13;
&#13;
<p>Sun’s unsupported <a data-primary="Unsafe class" data-type="indexterm" id="idm45290706001496"/><code>Unsafe</code> class has a method for obtaining the load average, on systems&#13;
that support it.&#13;
The code has to use the Reflection API (see&#13;
<a data-type="xref" href="ch17.html#javacook-reflection">Chapter 17</a>) to obtain the <code>Unsafe</code> object; if you try to instantiate <code>Unsafe</code> directly&#13;
you will get a <code>SecurityException</code> (this was the case before the Modules system).&#13;
Once the instance is obtained and casted to <code>Unsafe</code>, you can invoke methods&#13;
such as <a data-primary="loadAverage() method" data-type="indexterm" id="idm45290706010248"/><code>loadAverage()</code> (<a data-type="xref" href="#javacook-environ-modules-1">Example 2-4</a>).</p>&#13;
<div data-type="example" id="javacook-environ-modules-1">&#13;
<h5><span class="label">Example 2-4. </span>unsafe/src/main/java/unsafe/LoadAverage.java (use of Unsafe.java)</h5>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="kd">public</code> <code class="kd">class</code> <code class="nc">LoadAverage</code> <code class="o">{</code>&#13;
    <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">args</code><code class="o">)</code> <code class="kd">throws</code> <code class="n">Exception</code> <code class="o">{</code>&#13;
        <code class="n">Field</code> <code class="n">f</code> <code class="o">=</code> <code class="n">Unsafe</code><code class="o">.</code><code class="na">class</code><code class="o">.</code><code class="na">getDeclaredField</code><code class="o">(</code><code class="s">"theUnsafe"</code><code class="o">);</code>&#13;
        <code class="n">f</code><code class="o">.</code><code class="na">setAccessible</code><code class="o">(</code><code class="kc">true</code><code class="o">);</code>&#13;
        <code class="n">Unsafe</code> <code class="n">unsafe</code> <code class="o">=</code> <code class="o">(</code><code class="n">Unsafe</code><code class="o">)</code> <code class="n">f</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code class="kc">null</code><code class="o">);</code>&#13;
        <code class="kt">int</code> <code class="n">nelem</code> <code class="o">=</code> <code class="mi">3</code><code class="o">;</code>&#13;
        <code class="kt">double</code> <code class="n">loadAvg</code><code class="o">[]</code> <code class="o">=</code> <code class="k">new</code> <code class="kt">double</code><code class="o">[</code><code class="n">nelem</code><code class="o">];</code>&#13;
        <code class="n">unsafe</code><code class="o">.</code><code class="na">getLoadAverage</code><code class="o">(</code><code class="n">loadAvg</code><code class="o">,</code> <code class="n">nelem</code><code class="o">);</code>&#13;
        <code class="k">for</code> <code class="o">(</code><code class="kt">double</code> <code class="n">d</code> <code class="o">:</code> <code class="n">loadAvg</code><code class="o">)</code> <code class="o">{</code>&#13;
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">printf</code><code class="o">(</code><code class="s">"%4.2f "</code><code class="o">,</code> <code class="n">d</code><code class="o">);</code>&#13;
        <code class="o">}</code>&#13;
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">();</code>&#13;
    <code class="o">}</code>&#13;
<code class="o">}</code></pre></div>&#13;
&#13;
<p>This code, which used to compile, gives warnings.&#13;
If we are using Java Modules, we must modify our<a data-primary="module-info.java file" data-type="indexterm" id="idm45290706024632"/> <em>module-info.java</em>&#13;
file to tell the compiler and VM that we require use of the module with the&#13;
semi-obvious name <code>jdk.unsupported</code>.</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">module</code> <code class="n">javasrc</code><code class="o">.</code><code class="na">unsafe</code> <code class="o">{</code>&#13;
    <code class="n">requires</code> <code class="n">jdk</code><code class="o">.</code><code class="na">unsupported</code><code class="o">;</code>&#13;
	<code class="c1">// others...</code>&#13;
<code class="o">}</code></pre>&#13;
&#13;
<p>We’ll say more about the module file format in <a data-type="xref" href="ch15.html#javacook-packages-creating-JPMS-modules">Recipe 15.9</a>.</p>&#13;
&#13;
<p>Now that we have the code in place and the module file in the top level of the source folder,&#13;
we can build the project, run the program, and compare its output against the system-level tool for&#13;
displaying the load average, <code>uptime</code>.&#13;
We’ll still get the “internal proprietary API” warnings, but it works:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">$</code> <code class="n">java</code> <code class="o">-</code><code class="n">version</code>&#13;
<code class="n">openjdk</code> <code class="n">version</code> <code class="s">"14-ea"</code> <code class="mi">2020</code><code class="o">-</code><code class="mi">03</code><code class="o">-</code><code class="mi">17</code>&#13;
<code class="n">OpenJDK</code> <code class="n">Runtime</code> <code class="nf">Environment</code> <code class="o">(</code><code class="n">build</code> <code class="mi">14</code><code class="o">-</code><code class="n">ea</code><code class="o">+</code><code class="mi">27</code><code class="o">-</code><code class="mi">1339</code><code class="o">)</code>&#13;
<code class="n">OpenJDK</code> <code class="mi">64</code><code class="o">-</code><code class="n">Bit</code> <code class="n">Server</code> <code class="n">VM</code> <code class="o">(</code><code class="n">build</code> <code class="mi">14</code><code class="o">-</code><code class="n">ea</code><code class="o">+</code><code class="mi">27</code><code class="o">-</code><code class="mi">1339</code><code class="o">,</code> <code class="n">mixed</code> <code class="n">mode</code><code class="o">,</code> <code class="n">sharing</code><code class="o">)</code>&#13;
<code class="n">$</code> <code class="n">mvn</code> <code class="n">clean</code> <code class="kn">package</code>&#13;
<code class="o">[</code><code class="n">INFO</code><code class="o">]</code> <code class="n">Scanning</code> <code class="k">for</code> <code class="n">projects</code><code class="o">...</code>&#13;
<code class="o">[</code><code class="n">INFO</code><code class="o">]</code>&#13;
<code class="o">[</code><code class="n">INFO</code><code class="o">]</code> <code class="o">--------------------&lt;</code> <code class="n">com</code><code class="o">.</code><code class="na">darwinsys</code><code class="o">:</code><code class="n">javasrc</code><code class="o">-</code><code class="n">unsafe</code> <code class="o">&gt;--------------------</code>&#13;
<code class="o">[</code><code class="n">INFO</code><code class="o">]</code> <code class="n">Building</code> <code class="n">javasrc</code> <code class="o">-</code> <code class="n">Unsafe</code> <code class="mf">1.0</code><code class="o">.</code><code class="mi">0</code><code class="o">-</code><code class="n">SNAPSHOT</code>&#13;
<code class="o">[</code><code class="n">INFO</code><code class="o">]</code> <code class="o">--------------------------------[</code> <code class="n">jar</code> <code class="o">]---------------------------------</code>&#13;
<code class="o">[</code><code class="n">INFO</code><code class="o">]</code>&#13;
<code class="o">[</code><code class="n">INFO</code><code class="o">]</code> <code class="o">---</code> <code class="n">maven</code><code class="o">-</code><code class="n">clean</code><code class="o">-</code><code class="nl">plugin:</code><code class="mf">2.5</code><code class="o">:</code><code class="n">clean</code> <code class="o">(</code><code class="k">default</code><code class="o">-</code><code class="n">clean</code><code class="o">)</code> <code class="err">@</code> <code class="n">javasrc</code><code class="o">-</code><code class="n">unsafe</code> <code class="o">---</code>&#13;
<code class="o">[</code><code class="n">INFO</code><code class="o">]</code> <code class="n">Deleting</code> <code class="o">/</code><code class="n">Users</code><code class="o">/</code><code class="n">ian</code><code class="o">/</code><code class="n">workspace</code><code class="o">/</code><code class="n">javasrc</code><code class="o">/</code><code class="n">unsafe</code><code class="o">/</code><code class="n">target</code>&#13;
<code class="o">[</code><code class="n">INFO</code><code class="o">]</code>&#13;
<code class="o">[</code><code class="n">INFO</code><code class="o">]</code> <code class="o">---</code> <code class="n">maven</code><code class="o">-</code><code class="n">resources</code><code class="o">-</code><code class="nl">plugin:</code><code class="mf">2.6</code><code class="o">:</code><code class="n">resources</code> <code class="o">(</code><code class="k">default</code><code class="o">-</code><code class="n">resources</code><code class="o">)</code> <code class="err">@</code> <code class="n">javasrc</code><code class="o">-</code><code class="n">unsafe</code> <code class="o">---</code>&#13;
<code class="o">[</code><code class="n">INFO</code><code class="o">]</code> <code class="n">Using</code> <code class="err">'</code><code class="n">UTF</code><code class="o">-</code><code class="mi">8</code><code class="err">'</code> <code class="n">encoding</code> <code class="n">to</code> <code class="n">copy</code> <code class="n">filtered</code> <code class="n">resources</code><code class="o">.</code>&#13;
<code class="o">[</code><code class="n">INFO</code><code class="o">]</code> <code class="n">skip</code> <code class="n">non</code> <code class="n">existing</code> <code class="n">resourceDirectory</code> <code class="o">/</code><code class="n">Users</code><code class="o">/</code><code class="n">ian</code><code class="o">/</code><code class="n">workspace</code><code class="o">/</code><code class="n">javasrc</code><code class="o">/</code><code class="n">unsafe</code><code class="o">/</code><code class="n">src</code><code class="o">/</code><code class="n">main</code><code class="o">/</code><code class="n">resources</code>&#13;
<code class="o">[</code><code class="n">INFO</code><code class="o">]</code>&#13;
<code class="o">[</code><code class="n">INFO</code><code class="o">]</code> <code class="o">---</code> <code class="n">maven</code><code class="o">-</code><code class="n">compiler</code><code class="o">-</code><code class="nl">plugin:</code><code class="mf">3.1</code><code class="o">:</code><code class="n">compile</code> <code class="o">(</code><code class="k">default</code><code class="o">-</code><code class="n">compile</code><code class="o">)</code> <code class="err">@</code> <code class="n">javasrc</code><code class="o">-</code><code class="n">unsafe</code> <code class="o">---</code>&#13;
<code class="o">[</code><code class="n">INFO</code><code class="o">]</code> <code class="n">Changes</code> <code class="n">detected</code> <code class="o">-</code> <code class="n">recompiling</code> <code class="n">the</code> <code class="n">module</code><code class="o">!</code>&#13;
<code class="o">[</code><code class="n">INFO</code><code class="o">]</code> <code class="n">Compiling</code> <code class="mi">2</code> <code class="n">source</code> <code class="n">files</code> <code class="n">to</code> <code class="o">/</code><code class="n">Users</code><code class="o">/</code><code class="n">ian</code><code class="o">/</code><code class="n">workspace</code><code class="o">/</code><code class="n">javasrc</code><code class="o">/</code><code class="n">unsafe</code><code class="o">/</code><code class="n">target</code><code class="o">/</code><code class="n">classes</code>&#13;
<code class="o">[</code><code class="n">WARNING</code><code class="o">]</code> <code class="o">/</code><code class="n">Users</code><code class="o">/</code><code class="n">ian</code><code class="o">/</code><code class="n">workspace</code><code class="o">/</code><code class="n">javasrc</code><code class="o">/</code><code class="n">unsafe</code><code class="o">/</code><code class="n">src</code><code class="o">/</code><code class="n">main</code><code class="o">/</code><code class="n">java</code><code class="o">/</code><code class="n">unsafe</code><code class="o">/</code><code class="n">LoadAverage</code><code class="o">.</code><code class="na">java</code><code class="o">:[</code><code class="mi">3</code><code class="o">,</code><code class="mi">16</code><code class="o">]</code> <code class="n">sun</code><code class="o">.</code><code class="na">misc</code><code class="o">.</code><code class="na">Unsafe</code> <code class="n">is</code> <code class="n">internal</code> <code class="n">proprietary</code> <code class="n">API</code> <code class="n">and</code> <code class="n">may</code> <code class="n">be</code> <code class="n">removed</code> <code class="n">in</code> <code class="n">a</code> <code class="n">future</code> <code class="n">release</code>&#13;
<code class="o">[</code><code class="n">WARNING</code><code class="o">]</code> <code class="o">/</code><code class="n">Users</code><code class="o">/</code><code class="n">ian</code><code class="o">/</code><code class="n">workspace</code><code class="o">/</code><code class="n">javasrc</code><code class="o">/</code><code class="n">unsafe</code><code class="o">/</code><code class="n">src</code><code class="o">/</code><code class="n">main</code><code class="o">/</code><code class="n">java</code><code class="o">/</code><code class="n">unsafe</code><code class="o">/</code><code class="n">LoadAverage</code><code class="o">.</code><code class="na">java</code><code class="o">:[</code><code class="mi">12</code><code class="o">,</code><code class="mi">27</code><code class="o">]</code> <code class="n">sun</code><code class="o">.</code><code class="na">misc</code><code class="o">.</code><code class="na">Unsafe</code> <code class="n">is</code> <code class="n">internal</code> <code class="n">proprietary</code> <code class="n">API</code> <code class="n">and</code> <code class="n">may</code> <code class="n">be</code> <code class="n">removed</code> <code class="n">in</code> <code class="n">a</code> <code class="n">future</code> <code class="n">release</code>&#13;
<code class="o">[</code><code class="n">WARNING</code><code class="o">]</code> <code class="o">/</code><code class="n">Users</code><code class="o">/</code><code class="n">ian</code><code class="o">/</code><code class="n">workspace</code><code class="o">/</code><code class="n">javasrc</code><code class="o">/</code><code class="n">unsafe</code><code class="o">/</code><code class="n">src</code><code class="o">/</code><code class="n">main</code><code class="o">/</code><code class="n">java</code><code class="o">/</code><code class="n">unsafe</code><code class="o">/</code><code class="n">LoadAverage</code><code class="o">.</code><code class="na">java</code><code class="o">:[</code><code class="mi">14</code><code class="o">,</code><code class="mi">17</code><code class="o">]</code> <code class="n">sun</code><code class="o">.</code><code class="na">misc</code><code class="o">.</code><code class="na">Unsafe</code> <code class="n">is</code> <code class="n">internal</code> <code class="n">proprietary</code> <code class="n">API</code> <code class="n">and</code> <code class="n">may</code> <code class="n">be</code> <code class="n">removed</code> <code class="n">in</code> <code class="n">a</code> <code class="n">future</code> <code class="n">release</code>&#13;
<code class="o">[</code><code class="n">WARNING</code><code class="o">]</code> <code class="o">/</code><code class="n">Users</code><code class="o">/</code><code class="n">ian</code><code class="o">/</code><code class="n">workspace</code><code class="o">/</code><code class="n">javasrc</code><code class="o">/</code><code class="n">unsafe</code><code class="o">/</code><code class="n">src</code><code class="o">/</code><code class="n">main</code><code class="o">/</code><code class="n">java</code><code class="o">/</code><code class="n">unsafe</code><code class="o">/</code><code class="n">LoadAverage</code><code class="o">.</code><code class="na">java</code><code class="o">:[</code><code class="mi">14</code><code class="o">,</code><code class="mi">34</code><code class="o">]</code> <code class="n">sun</code><code class="o">.</code><code class="na">misc</code><code class="o">.</code><code class="na">Unsafe</code> <code class="n">is</code> <code class="n">internal</code> <code class="n">proprietary</code> <code class="n">API</code> <code class="n">and</code> <code class="n">may</code> <code class="n">be</code> <code class="n">removed</code> <code class="n">in</code> <code class="n">a</code> <code class="n">future</code> <code class="n">release</code>&#13;
<code class="o">[</code><code class="n">INFO</code><code class="o">]</code>&#13;
<code class="o">[</code><code class="n">INFO</code><code class="o">]</code> <code class="o">---</code> <code class="n">maven</code><code class="o">-</code><code class="n">resources</code><code class="o">-</code><code class="nl">plugin:</code><code class="mf">2.6</code><code class="o">:</code><code class="n">testResources</code> <code class="o">(</code><code class="k">default</code><code class="o">-</code><code class="n">testResources</code><code class="o">)</code> <code class="err">@</code> <code class="n">javasrc</code><code class="o">-</code><code class="n">unsafe</code> <code class="o">---</code>&#13;
<code class="o">[</code><code class="n">INFO</code><code class="o">]</code> <code class="n">Using</code> <code class="err">'</code><code class="n">UTF</code><code class="o">-</code><code class="mi">8</code><code class="err">'</code> <code class="n">encoding</code> <code class="n">to</code> <code class="n">copy</code> <code class="n">filtered</code> <code class="n">resources</code><code class="o">.</code>&#13;
<code class="o">[</code><code class="n">INFO</code><code class="o">]</code> <code class="n">skip</code> <code class="n">non</code> <code class="n">existing</code> <code class="n">resourceDirectory</code> <code class="o">/</code><code class="n">Users</code><code class="o">/</code><code class="n">ian</code><code class="o">/</code><code class="n">workspace</code><code class="o">/</code><code class="n">javasrc</code><code class="o">/</code><code class="n">unsafe</code><code class="o">/</code><code class="n">src</code><code class="o">/</code><code class="n">test</code><code class="o">/</code><code class="n">resources</code>&#13;
<code class="o">[</code><code class="n">INFO</code><code class="o">]</code>&#13;
<code class="o">[</code><code class="n">INFO</code><code class="o">]</code> <code class="o">---</code> <code class="n">maven</code><code class="o">-</code><code class="n">compiler</code><code class="o">-</code><code class="nl">plugin:</code><code class="mf">3.1</code><code class="o">:</code><code class="n">testCompile</code> <code class="o">(</code><code class="k">default</code><code class="o">-</code><code class="n">testCompile</code><code class="o">)</code> <code class="err">@</code> <code class="n">javasrc</code><code class="o">-</code><code class="n">unsafe</code> <code class="o">---</code>&#13;
<code class="o">[</code><code class="n">INFO</code><code class="o">]</code> <code class="n">No</code> <code class="n">sources</code> <code class="n">to</code> <code class="n">compile</code>&#13;
<code class="o">[</code><code class="n">INFO</code><code class="o">]</code>&#13;
<code class="o">[</code><code class="n">INFO</code><code class="o">]</code> <code class="o">---</code> <code class="n">maven</code><code class="o">-</code><code class="n">surefire</code><code class="o">-</code><code class="nl">plugin:</code><code class="mf">2.12</code><code class="o">.</code><code class="mi">4</code><code class="o">:</code><code class="n">test</code> <code class="o">(</code><code class="k">default</code><code class="o">-</code><code class="n">test</code><code class="o">)</code> <code class="err">@</code> <code class="n">javasrc</code><code class="o">-</code><code class="n">unsafe</code> <code class="o">---</code>&#13;
<code class="o">[</code><code class="n">INFO</code><code class="o">]</code> <code class="n">No</code> <code class="n">tests</code> <code class="n">to</code> <code class="n">run</code><code class="o">.</code>&#13;
<code class="o">[</code><code class="n">INFO</code><code class="o">]</code>&#13;
<code class="o">[</code><code class="n">INFO</code><code class="o">]</code> <code class="o">---</code> <code class="n">maven</code><code class="o">-</code><code class="n">jar</code><code class="o">-</code><code class="nl">plugin:</code><code class="mf">2.4</code><code class="o">:</code><code class="n">jar</code> <code class="o">(</code><code class="k">default</code><code class="o">-</code><code class="n">jar</code><code class="o">)</code> <code class="err">@</code> <code class="n">javasrc</code><code class="o">-</code><code class="n">unsafe</code> <code class="o">---</code>&#13;
<code class="o">[</code><code class="n">INFO</code><code class="o">]</code> <code class="n">Building</code> <code class="nl">jar:</code> <code class="o">/</code><code class="n">Users</code><code class="o">/</code><code class="n">ian</code><code class="o">/</code><code class="n">workspace</code><code class="o">/</code><code class="n">javasrc</code><code class="o">/</code><code class="n">unsafe</code><code class="o">/</code><code class="n">target</code><code class="o">/</code><code class="n">javasrc</code><code class="o">-</code><code class="n">unsafe</code><code class="o">-</code><code class="mf">1.0</code><code class="o">.</code><code class="mi">0</code><code class="o">-</code><code class="n">SNAPSHOT</code><code class="o">.</code><code class="na">jar</code>&#13;
<code class="o">[</code><code class="n">INFO</code><code class="o">]</code> <code class="o">------------------------------------------------------------------------</code>&#13;
<code class="o">[</code><code class="n">INFO</code><code class="o">]</code> <code class="n">BUILD</code> <code class="n">SUCCESS</code>&#13;
<code class="o">[</code><code class="n">INFO</code><code class="o">]</code> <code class="o">------------------------------------------------------------------------</code>&#13;
<code class="o">[</code><code class="n">INFO</code><code class="o">]</code> <code class="n">Total</code> <code class="nl">time:</code>  <code class="mf">4.668</code> <code class="n">s</code>&#13;
<code class="o">[</code><code class="n">INFO</code><code class="o">]</code> <code class="n">Finished</code> <code class="nl">at:</code> <code class="mi">2020</code><code class="o">-</code><code class="mi">01</code><code class="o">-</code><code class="mi">05</code><code class="nl">T14:</code><code class="mi">53</code><code class="o">:</code><code class="mi">55</code><code class="o">-</code><code class="mi">05</code><code class="o">:</code><code class="mi">00</code>&#13;
<code class="o">[</code><code class="n">INFO</code><code class="o">]</code> <code class="o">------------------------------------------------------------------------</code>&#13;
<code class="n">$</code>&#13;
<code class="n">$</code> <code class="n">java</code> <code class="o">-</code><code class="n">cp</code> <code class="n">target</code><code class="o">/</code><code class="n">classes</code> <code class="n">unsafe</code><code class="o">/</code><code class="n">LoadAverage</code>&#13;
<code class="mf">3.54</code> <code class="mf">1.94</code> <code class="mf">1.62</code>&#13;
<code class="n">$</code> <code class="n">uptime</code>&#13;
<code class="mi">14</code><code class="o">:</code><code class="mi">54</code>  <code class="n">up</code> <code class="mi">1</code> <code class="n">day</code><code class="o">,</code> <code class="mi">21</code><code class="o">:</code><code class="mi">50</code><code class="o">,</code> <code class="mi">5</code> <code class="n">users</code><code class="o">,</code> <code class="n">load</code> <code class="nl">averages:</code> <code class="mf">3.54</code> <code class="mf">1.94</code> <code class="mf">1.62</code>&#13;
<code class="n">$</code></pre>&#13;
&#13;
<p>Thankfully, it works and gives the same numbers as the standard <a data-primary="Unix" data-secondary="uptime command" data-type="indexterm" id="idm45290705382536"/><a data-primary="uptime command" data-type="indexterm" id="idm45290705381688"/>Unix <em>uptime</em> command.&#13;
At least, it works on Java 11. As the warnings imply, it <em>may</em> (i.e., probably will)&#13;
be removed in a later release.</p>&#13;
&#13;
<p>If you are building a more complex app, you will probably need to put together a&#13;
more complete <a data-primary="module-info.java file" data-type="indexterm" id="idm45290705379528"/><em>module-info.java</em> file. But at this stage it’s primarily a matter of&#13;
requiring the modules you need. The standard Java API is divided into several modules,&#13;
which you can list using the <a data-primary="java command" data-type="indexterm" id="idm45290705378248"/><em>java</em> command:</p>&#13;
&#13;
<pre data-code-language="java" data-type="programlisting"><code class="n">$</code> <code class="n">java</code> <code class="o">--</code><code class="n">list</code><code class="o">-</code><code class="n">modules</code>&#13;
<code class="n">java</code><code class="o">.</code><code class="na">base</code>&#13;
<code class="n">java</code><code class="o">.</code><code class="na">compiler</code>&#13;
<code class="n">java</code><code class="o">.</code><code class="na">datatransfer</code>&#13;
<code class="n">java</code><code class="o">.</code><code class="na">desktop</code>&#13;
<code class="n">java</code><code class="o">.</code><code class="na">instrument</code>&#13;
<code class="n">java</code><code class="o">.</code><code class="na">logging</code>&#13;
<code class="n">java</code><code class="o">.</code><code class="na">management</code>&#13;
<code class="n">java</code><code class="o">.</code><code class="na">management</code><code class="o">.</code><code class="na">rmi</code>&#13;
<code class="n">java</code><code class="o">.</code><code class="na">naming</code>&#13;
<code class="n">java</code><code class="o">.</code><code class="na">net</code><code class="o">.</code><code class="na">http</code>&#13;
<code class="n">java</code><code class="o">.</code><code class="na">prefs</code>&#13;
<code class="n">java</code><code class="o">.</code><code class="na">rmi</code>&#13;
<code class="n">java</code><code class="o">.</code><code class="na">scripting</code>&#13;
<code class="n">java</code><code class="o">.</code><code class="na">se</code>&#13;
<code class="n">java</code><code class="o">.</code><code class="na">security</code><code class="o">.</code><code class="na">jgss</code>&#13;
<code class="n">java</code><code class="o">.</code><code class="na">security</code><code class="o">.</code><code class="na">sasl</code>&#13;
<code class="n">java</code><code class="o">.</code><code class="na">smartcardio</code>&#13;
<code class="n">java</code><code class="o">.</code><code class="na">sql</code>&#13;
<code class="n">java</code><code class="o">.</code><code class="na">sql</code><code class="o">.</code><code class="na">rowset</code>&#13;
<code class="n">java</code><code class="o">.</code><code class="na">transaction</code><code class="o">.</code><code class="na">xa</code>&#13;
<code class="n">java</code><code class="o">.</code><code class="na">xml</code>&#13;
<code class="n">java</code><code class="o">.</code><code class="na">xml</code><code class="o">.</code><code class="na">crypto</code>&#13;
<code class="o">...</code> <code class="n">plus</code> <code class="n">a</code> <code class="n">bunch</code> <code class="n">of</code> <code class="n">JDK</code> <code class="n">modules</code> <code class="o">...</code></pre>&#13;
&#13;
<p>Of these, <code>java.base</code> is always available and doesn’t need to be listed in your module file,&#13;
<code>java.desktop</code> adds AWT and Swing for graphics,&#13;
and <code>java.se</code> includes basically all of what used to be public API in the Java SDK.&#13;
If our load average program wanted to display the result in a Swing window, for example,&#13;
it would need to add this into its module file:</p>&#13;
<pre>requires java.desktop;</pre>&#13;
&#13;
<p>When your application is big enough to be divided into tiers or layers,&#13;
you will probably want to describe these modules using JPMS.&#13;
Since that topic comes under the heading of packaging,&#13;
it is described in <a data-type="xref" href="ch15.html#javacook-packages-creating-JPMS-modules">Recipe 15.9</a>.<a data-primary="" data-startref="jpms_a" data-type="indexterm" id="idm45290704861144"/><a data-primary="" data-startref="jpmsjpms_a" data-type="indexterm" id="idm45290704860168"/><a data-primary="runenv_jpms" data-type="indexterm" id="idm45290704859224"/><a data-primary="" data-startref="re_ch" data-type="indexterm" id="idm45290704858552"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<div data-type="footnotes"><p data-type="footnote" id="idm45290706287432"><sup><a href="ch02.html#idm45290706287432-marker">1</a></sup> When compiling strings for use on Windows, remember to double them because \ is an escape character in most places other than the MS-DOS command line: <code>String rootDir = "C:\\";</code>.</p></div></div></section></body></html>